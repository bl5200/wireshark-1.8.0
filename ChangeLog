------------------------------------------------------------------------
r43429 | gerald | 2012-06-21 10:37:00 -0700 (Thu, 21 Jun 2012) | 11 lines
Changed paths:
   M /trunk-1.8/Makefile.nmake
   M /trunk-1.8/packaging/nsis/Makefile.am

Copy over r43428 from the trunk:

  ------------------------------------------------------------------------
  r43428 | gerald | 2012-06-21 10:35:59 -0700 (Thu, 21 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/Makefile.nmake
     M /trunk/packaging/nsis/Makefile.am

  Try to fix tarball compilation on Windows.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43427 | gerald | 2012-06-21 09:30:06 -0700 (Thu, 21 Jun 2012) | 2 lines
Changed paths:
   M /trunk-1.8/docbook/release-notes.xml

Release notes talk pretty one day.

------------------------------------------------------------------------
r43426 | gerald | 2012-06-21 09:26:07 -0700 (Thu, 21 Jun 2012) | 46 lines
Changed paths:
   M /trunk-1.8/docbook/release-notes.xml
   M /trunk-1.8/epan/dissectors/packet-gmr1_dtap.c
   M /trunk-1.8/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk-1.8/epan/dissectors/packet-ipv6.c
   M /trunk-1.8/epan/dissectors/packet-ipv6.h
   M /trunk-1.8/tshark.c

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43389 | morriss | 2012-06-19 13:20:18 -0700 (Tue, 19 Jun 2012) | 5 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-ipv6.c
     M /trunk/epan/dissectors/packet-ipv6.h

  Correct the IPv6 fragment offset shown in COL_INFO.

  Make some Fragment header fields filterable (add_text() -> add_item()).
  Display (and make filterable) the reserved octet and bits.
  ------------------------------------------------------------------------
  r43401 | etxrab | 2012-06-20 00:59:20 -0700 (Wed, 20 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-gsm_a_bssmap.c

  - In INTERNAL HANDOVER COMMAND Circuit Identity Code is C(Coded optional in WS)
  - be_speech_codec ( 3.2.2.104    Speech Codec) did not cover all codecs.
  ------------------------------------------------------------------------
  r43408 | pascal | 2012-06-20 06:37:22 -0700 (Wed, 20 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-gmr1_dtap.c

  Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7383 :
  Put back items into the correct dtap_tree tree and comment pd_tree that is unused for now
  ------------------------------------------------------------------------
  r43409 | pascal | 2012-06-20 06:42:17 -0700 (Wed, 20 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-gmr1_dtap.c

  Fix compilation with gcc...
  ------------------------------------------------------------------------
  r43420 | gerald | 2012-06-20 13:44:05 -0700 (Wed, 20 Jun 2012) | 5 lines
  Changed paths:
     M /trunk/tshark.c

  If we're making two passes and we have a display filter applied, create
  a protocol tree in process_packet_first_pass(). Otherwise we crash with

  ERROR:dfvm.c:434:dfvm_apply: assertion failed: (tree)
  ------------------------------------------------------------------------


Update the release notes.

------------------------------------------------------------------------
r43407 | morriss | 2012-06-20 06:35:24 -0700 (Wed, 20 Jun 2012) | 9 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-sctp.c

Copy over from trunk:

------------------------------------------------------------------------
r43406 | morriss | 2012-06-20 09:30:07 -0400 (Wed, 20 Jun 2012) | 4 lines

Use separate filters for the RTT found on a SACK and the RTT found on a
DATA chunk: having them in both places is helpful when looking at the
messages but having them separate is helpful when graphing the RTTs.

------------------------------------------------------------------------
r43400 | guy | 2012-06-19 22:53:42 -0700 (Tue, 19 Jun 2012) | 7 lines
Changed paths:
   M /trunk-1.8/ui/win32/file_dlg_win32.c

Copy over r43394 from trunk:

  ------------------------------------------------------------------------
  r43394 | etxrab | 2012-06-19 21:42:55 -0700 (Tue, 19 Jun 2012) | 1 line

  MAke it compile by adding discard_comments = FALSE

------------------------------------------------------------------------
r43399 | guy | 2012-06-19 22:52:40 -0700 (Tue, 19 Jun 2012) | 7 lines
Changed paths:
   M /trunk-1.8/ui/win32/file_dlg_win32.c

Copy over r43302 from trunk:

  ------------------------------------------------------------------------
  r43302 | guy | 2012-06-16 18:50:52 -0700 (Sat, 16 Jun 2012) | 2 lines

  Reflect change to wtap_get_savable_file_types.

------------------------------------------------------------------------
r43398 | guy | 2012-06-19 22:48:57 -0700 (Tue, 19 Jun 2012) | 7 lines
Changed paths:
   M /trunk-1.8/ui/gtk/capture_file_dlg.c

Copy over r43397 from trunk:

  ------------------------------------------------------------------------
  r43397 | guy | 2012-06-19 22:48:06 -0700 (Tue, 19 Jun 2012) | 2 lines

  Clean up white space (no tabs).

------------------------------------------------------------------------
r43396 | guy | 2012-06-19 21:45:08 -0700 (Tue, 19 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/file.c
   M /trunk-1.8/file.h
   M /trunk-1.8/ui/gtk/capture_file_dlg.c

Copy over r43395 from the trunk:

  ------------------------------------------------------------------------
  r43395 | guy | 2012-06-19 21:44:14 -0700 (Tue, 19 Jun 2012) | 5 lines

  Handle the case where the user has added comments to a file that's not
  in a format that supports comments and they do a "Save" by popping up a
  similar question to the one we pop up in the "Save As" case and, if they
  say "choose another format", pop up a "Save As" dialog box.

------------------------------------------------------------------------
r43393 | guy | 2012-06-19 18:13:06 -0700 (Tue, 19 Jun 2012) | 15 lines
Changed paths:
   M /trunk-1.8/cfile.h
   M /trunk-1.8/file.c
   M /trunk-1.8/file.h
   M /trunk-1.8/ui/gtk/capture_file_dlg.c
   M /trunk-1.8/ui/gtk/new_packet_list.c

Copy over r43392 from trunk:

  ------------------------------------------------------------------------
  r43392 | guy | 2012-06-19 18:11:01 -0700 (Tue, 19 Jun 2012) | 10 lines

  If the file has an SHB comment or any packet comments, and the user
  tries to do "Save As" in a format for which we don't support comments
  (currently, we only support them for pcap-ng), ask whether they want to
  discard the comments and save anyway or, *if* the file can be saved in a
  format for which we *do* support comments, they want to save the file in
  some other format.

  Keep a count of packet comments so that we don't have to scan all the
  frame_data structures to determine whether we have any comments.

------------------------------------------------------------------------
r43388 | gerald | 2012-06-19 12:53:59 -0700 (Tue, 19 Jun 2012) | 14 lines
Changed paths:
   M /trunk-1.8/wiretap/Makefile.am
   M /trunk-1.8/wiretap/Makefile.nmake

Copy over r43387 from the trunk:

  ------------------------------------------------------------------------
  r43387 | gerald | 2012-06-19 12:53:03 -0700 (Tue, 19 Jun 2012) | 5 lines
  Changed paths:
     M /trunk/wiretap/Makefile.am
     M /trunk/wiretap/Makefile.nmake

  ascend_scanner.c includes ascend.h. Add corresponding makefile
  dependencies, otherwise we might have a race condition when doing
  parallel makes. Hopefully this will fix intermitten buildbot failures
  we've been getting lately.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43383 | guy | 2012-06-19 12:22:47 -0700 (Tue, 19 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/ui/gtk/capture_file_dlg.c
   M /trunk-1.8/ui/gtk/file_dlg.c
   M /trunk-1.8/ui/gtk/file_dlg.h

Copy over r43381 from trunk:

  ------------------------------------------------------------------------
  r43381 | guy | 2012-06-19 12:20:47 -0700 (Tue, 19 Jun 2012) | 5 lines

  The GTK+ file chooser already *includes* UI code to ask the user whether
  they want to overwrite an existing file; just use that.  (The Win32 file
  chooser also does that itself.)  Just do UI for "do you want to
  overwrite this {user-immutable,unwritable} file?".

------------------------------------------------------------------------
r43382 | guy | 2012-06-19 12:22:04 -0700 (Tue, 19 Jun 2012) | 11 lines
Changed paths:
   M /trunk-1.8/ui/gtk/pixmap_save.c

Copy over r43380 from the trunk:

  ------------------------------------------------------------------------
  r43380 | guy | 2012-06-19 11:47:22 -0700 (Tue, 19 Jun 2012) | 6 lines

  The "save as" dialog is modal, so we don't need to worry about keeping
  track of multiple such "save as" windows.

  Use modal dialog boxes to report errors, while we're at it.  That lets
  us keep the dialog open if we get an error.

------------------------------------------------------------------------
r43378 | gerald | 2012-06-19 10:41:23 -0700 (Tue, 19 Jun 2012) | 80 lines
Changed paths:
   M /trunk-1.8/Makefile.am
   M /trunk-1.8/debian/rules
   M /trunk-1.8/doc/Makefile.am
   M /trunk-1.8/doc/tshark.pod
   M /trunk-1.8/doc/wireshark-filter.pod
   M /trunk-1.8/dumpcap.c
   M /trunk-1.8/epan/dissectors/packet-gsm_sms.c
   M /trunk-1.8/packaging/macosx/Scripts/cli-postinstall.sh
   M /trunk-1.8/packaging/macosx/osx-app.sh
   M /trunk-1.8/packaging/nsis/Makefile.nmake
   M /trunk-1.8/packaging/nsis/wireshark.nsi
   M /trunk-1.8/ui/gtk/CMakeLists.txt
   M /trunk-1.8/ui/gtk/capture_if_dlg.c
   M /trunk-1.8/ui/gtk/main_menubar.c

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43343 | tuexen | 2012-06-18 14:50:59 -0700 (Mon, 18 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/dumpcap.c

  Fix compilation on FreeBSD.
  ------------------------------------------------------------------------
  r43345 | etxrab | 2012-06-18 23:08:58 -0700 (Mon, 18 Jun 2012) | 12 lines
  Changed paths:
     M /trunk/ui/gtk/capture_if_dlg.c

  From Pontus Fuchs:
  If there are many interfaces the button bar is not visible
  unless you manually resize the dialog. On a normal Linux PC
  you can easily reach 15-20 interfaces due to USB monitor.

  Add a vbox so that you get a scrollbar for the interface table
  instead of on the window. This way the button bar is always
  visible.

  Also increase the default height to handle 20 interfaces.

  https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7379
  ------------------------------------------------------------------------
  r43362 | darkjames | 2012-06-19 07:25:50 -0700 (Tue, 19 Jun 2012) | 4 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-gsm_sms.c

  Fix bug #7378: Wireshark 1.8.0rc1: gsm_a_dtap SMS 7-bit default alphabet regression w.r.t. 1.6.8

  proto_item_add_string() can be only used with ASCII strings.
  ------------------------------------------------------------------------
  r43367 | etxrab | 2012-06-19 07:49:12 -0700 (Tue, 19 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/ui/gtk/CMakeLists.txt
     M /trunk/ui/gtk/main_menubar.c

  Get rid of the remnats of NEW_MENU_CODE.
  It's probably not a good idea to read the menu bar code from file as it causes problems with permissions when Wireshark is run fom build dir.
  ------------------------------------------------------------------------
  r43368 | etxrab | 2012-06-19 07:54:11 -0700 (Tue, 19 Jun 2012) | 1 line
  Changed paths:
     M /trunk/Makefile.am
     M /trunk/packaging/nsis/wireshark.nsi

  Don't install main-menubar-ui.xml
  ------------------------------------------------------------------------
  r43370 | morriss | 2012-06-19 08:39:52 -0700 (Tue, 19 Jun 2012) | 9 lines
  Changed paths:
     M /trunk/Makefile.am
     M /trunk/debian/rules
     M /trunk/doc/Makefile.am

  Don't install idl2wrs except in Debian's special wireshark-dev package.

  (Normal Wireshark installations can't be used to develop dissectors so there's
  no need to install it or its man page.)

  http://www.wireshark.org/lists/wireshark-dev/201206/msg00073.html

  (The Debian changes are untested.)
  ------------------------------------------------------------------------
  r43371 | gerald | 2012-06-19 08:44:10 -0700 (Tue, 19 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/doc/tshark.pod
     M /trunk/doc/wireshark-filter.pod

  Remove what appears to be an errant vi/vim command and add a newline.
  ------------------------------------------------------------------------
  r43377 | morriss | 2012-06-19 10:32:49 -0700 (Tue, 19 Jun 2012) | 1 line
  Changed paths:
     M /trunk/packaging/macosx/Scripts/cli-postinstall.sh
     M /trunk/packaging/macosx/osx-app.sh
     M /trunk/packaging/nsis/Makefile.nmake

  Followup to r43370: don't install idl2wrs or its man page.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43341 | gerald | 2012-06-18 13:58:11 -0700 (Mon, 18 Jun 2012) | 1 line
Changed paths:
   M /trunk-1.8/tools/git-compare-abis.sh

Use a tag that compiles (r43301).
------------------------------------------------------------------------
r43340 | gerald | 2012-06-18 13:56:26 -0700 (Mon, 18 Jun 2012) | 1 line
Changed paths:
   M /trunk-1.8/version.conf

Switch back to interim versions.
------------------------------------------------------------------------
r43337 | gerald | 2012-06-18 11:43:07 -0700 (Mon, 18 Jun 2012) | 2 lines
Changed paths:
   M /trunk-1.8/ChangeLog
   M /trunk-1.8/version.conf

Build 1.8.0rc2.

------------------------------------------------------------------------
r43336 | gerald | 2012-06-18 10:26:50 -0700 (Mon, 18 Jun 2012) | 57 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-dtls.c
   M /trunk-1.8/epan/dissectors/packet-ip.c
   M /trunk-1.8/epan/dissectors/packet-ip.h
   M /trunk-1.8/epan/dissectors/packet-ipv6.c
   M /trunk-1.8/epan/dissectors/packet-megaco.c
   M /trunk-1.8/epan/dissectors/packet-mpls-pm.c
   M /trunk-1.8/epan/dissectors/packet-nhrp.h
   M /trunk-1.8/epan/dissectors/packet-ssl-utils.c
   M /trunk-1.8/epan/dissectors/packet-ssl.c

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43303 | sake | 2012-06-17 02:02:04 -0700 (Sun, 17 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-ssl-utils.c

  Fix reading back exported SSL keys. Bug was introduced in r43097.
  ------------------------------------------------------------------------
  r43304 | sake | 2012-06-17 04:30:25 -0700 (Sun, 17 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-dtls.c
     M /trunk/epan/dissectors/packet-ssl.c

  Enhance dissection of the NewSessionTicket handshake message.
  ------------------------------------------------------------------------
  r43204 | wmeier | 2012-06-11 08:47:50 -0700 (Mon, 11 Jun 2012) | 5 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-ip.c
     M /trunk/epan/dissectors/packet-ip.h

  Create dscp_vals_ext value_str_ext (based upon dscp_vals); Use it as appropriate.
  Also:
   - use val_to_str_const() [instead of val_to_str()] in a few cases;
   - do some trivial formatting cleanup.
  ------------------------------------------------------------------------
  r43211 | wmeier | 2012-06-11 12:07:53 -0700 (Mon, 11 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-ip.h
     M /trunk/epan/dissectors/packet-megaco.c
     M /trunk/epan/dissectors/packet-mpls-pm.c
     M /trunk/epan/dissectors/packet-nhrp.h

  Use dscp_vals_ext everyplace (instead of dscp_vals);
  (dscp_vals is now a static array in packet-ip.c)
  ------------------------------------------------------------------------
  r43221 | jmayer | 2012-06-12 03:38:22 -0700 (Tue, 12 Jun 2012) | 4 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-ip.c
     M /trunk/epan/dissectors/packet-ip.h
     M /trunk/epan/dissectors/packet-ipv6.c

  Manually revert r41953

    BACKPORT to 1.8
  ------------------------------------------------------------------------
  r43222 | jmayer | 2012-06-12 03:44:57 -0700 (Tue, 12 Jun 2012) | 4 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-ip.c
     M /trunk/epan/dissectors/packet-ip.h
     M /trunk/epan/dissectors/packet-ipv6.c

  Revert r41952

    BACKPORT to 1.8
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43331 | guy | 2012-06-18 01:35:03 -0700 (Mon, 18 Jun 2012) | 7 lines
Changed paths:
   M /trunk-1.8/ui/qt/simple_dialog_qt.cpp

Copy over r43330 from trunk:

  ------------------------------------------------------------------------
  r43330 | guy | 2012-06-18 01:30:53 -0700 (Mon, 18 Jun 2012) | 2 lines

  Add "simple dialog" routines to pop up modal message boxes.

------------------------------------------------------------------------
r43328 | guy | 2012-06-17 23:00:17 -0700 (Sun, 17 Jun 2012) | 7 lines
Changed paths:
   M /trunk-1.8/ui/gtk/simple_dialog.c

Copy over r43327 from trunk:

  ------------------------------------------------------------------------
  r43327 | guy | 2012-06-17 22:59:33 -0700 (Sun, 17 Jun 2012) | 2 lines

  Add initialization to squelch compiler warnings.

------------------------------------------------------------------------
r43326 | guy | 2012-06-17 22:58:22 -0700 (Sun, 17 Jun 2012) | 8 lines
Changed paths:
   M /trunk-1.8/ui/gtk/simple_dialog.c

Copy over r43325 from the trunk:

  ------------------------------------------------------------------------
  r43325 | guy | 2012-06-17 22:57:26 -0700 (Sun, 17 Jun 2012) | 3 lines

  Use the GTK+ message type, not the Wireshark message type, in GTK+
  calls.

------------------------------------------------------------------------
r43324 | guy | 2012-06-17 16:30:28 -0700 (Sun, 17 Jun 2012) | 8 lines
Changed paths:
   M /trunk-1.8/ui/gtk/simple_dialog.c

Copy over r43323 from the trunk:

  ------------------------------------------------------------------------
  r43323 | guy | 2012-06-17 16:24:06 -0700 (Sun, 17 Jun 2012) | 3 lines

  Stuff the "Don't show this message again" checkbox in the dialog's
  content area.

------------------------------------------------------------------------
r43322 | guy | 2012-06-17 15:33:11 -0700 (Sun, 17 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/file.c
   M /trunk-1.8/ui/alert_box.c
   M /trunk-1.8/ui/gtk/simple_dialog.c
   M /trunk-1.8/ui/simple_dialog.h

Copy over r43321 from the trunk:

  ------------------------------------------------------------------------
  r43321 | guy | 2012-06-17 15:32:03 -0700 (Sun, 17 Jun 2012) | 5 lines

  Add "simple dialog" routines to pop up modal message boxes.  Use them in
  file.c and routines called from it; non-modal dialogs end up, in some
  cases, either hidden, devoid of the input focus and not dismissable, or
  both.

------------------------------------------------------------------------
r43319 | gerald | 2012-06-17 10:07:27 -0700 (Sun, 17 Jun 2012) | 1 line
Changed paths:
   M /trunk-1.8/epan/enterprise-numbers
   M /trunk-1.8/manuf

[Automatic manuf, services and enterprise-numbers update for 2012-06-17]
------------------------------------------------------------------------
r43318 | guy | 2012-06-17 09:54:19 -0700 (Sun, 17 Jun 2012) | 7 lines
Changed paths:
   M /trunk-1.8/wiretap/file_access.c

Copy over r43317 from the trunk:

  ------------------------------------------------------------------------
  r43317 | guy | 2012-06-17 09:53:31 -0700 (Sun, 17 Jun 2012) | 2 lines

  Forgot to use wtap_dump_can_write_encaps()'s final name.

------------------------------------------------------------------------
r43316 | guy | 2012-06-17 09:45:32 -0700 (Sun, 17 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/file.c
   M /trunk-1.8/ui/win32/file_dlg_win32.c
   M /trunk-1.8/wiretap/file_access.c
   M /trunk-1.8/wiretap/wtap.def
   M /trunk-1.8/wiretap/wtap.h

Copy over r43315 from the trunk:

  ------------------------------------------------------------------------
  r43315 | guy | 2012-06-17 09:44:09 -0700 (Sun, 17 Jun 2012) | 5 lines

  Export a wtap_dump_can_write_encaps() routine from Wiretap; it takes a
  file type and a GArray of encapsulation types and returns TRUE if a
  capture with all those encapsulation types can be written to a file in
  that file type and FALSE otherwise.  Use it where appropriate.

------------------------------------------------------------------------
r43313 | pascal | 2012-06-17 09:19:27 -0700 (Sun, 17 Jun 2012) | 14 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-gtp.c

Copy over revisions from the trunk:

------------------------------------------------------------------------
r43280 | pascal | 2012-06-16 15:09:51 +0200 (sam. 16 juin 2012) | 3 lignes

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7371 :
Add dissection of Release 8 or higher P-GW QoS profile

------------------------------------------------------------------------
r43312 | pascal | 2012-06-17 18:08:43 +0200 (dim. 17 juin 2012) | 2 lignes

Allow future forward compatibility


------------------------------------------------------------------------
r43301 | guy | 2012-06-16 18:47:59 -0700 (Sat, 16 Jun 2012) | 31 lines
Changed paths:
   M /trunk-1.8/cfile.h
   M /trunk-1.8/file.c
   M /trunk-1.8/summary.c
   M /trunk-1.8/summary.h
   M /trunk-1.8/ui/gtk/capture_file_dlg.c
   M /trunk-1.8/ui/gtk/summary_dlg.c
   M /trunk-1.8/wiretap/file_access.c
   M /trunk-1.8/wiretap/wtap.h

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43300 | guy | 2012-06-16 18:32:50 -0700 (Sat, 16 Jun 2012) | 16 lines

  Have wtap_get_savable_file_types() take an array of encapsulations and
  only return file types that could handle a single file with all those
  encapsulations - this means that

	1) if there's more then one encapsulation, the file format has
  to handle per-packet encapsulation;

	2) just because a file format handles per-packet encapsulation,
  that doesn't mean that it can handle the *particular* encapsulations
  being handed to it.

  This fixes some cases where we were claiming that a file could be saved
  in a format that doesn't actually support it (e.g., ISDN files being
  reported as savable in pcap-NG format - there's no LINKTYPE_ value for
  ISDN including B and D channels).

  ------------------------------------------------------------------------
  r43278 | guy | 2012-06-15 16:54:05 -0700 (Fri, 15 Jun 2012) | 7 lines

  For a capture file, keep an array of all encapsulation types seen.

  Show all of them in the summary dialog; we will be using it in the
  future to figure out what capture file formats we can write to (just
  because a capture file format supports per-packet encapsulations, that
  doesn't mean that it supports *all possible* encapsulations).

------------------------------------------------------------------------
r43289 | guy | 2012-06-16 12:27:24 -0700 (Sat, 16 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/ui/gtk/main_proto_draw.c

Copy over r43277 from the trunk:

  ------------------------------------------------------------------------
  r43277 | darkjames | 2012-06-15 16:04:59 -0700 (Fri, 15 Jun 2012) | 5 lines

  highlight_field: use passed GtkTreeView for proto_tree_draw.

  highlight_field() is also called when we open packet in new window and we click some bytes,
  it caused redrawing packet details in *main window* but with protocol tree from (possibly) another frame.

------------------------------------------------------------------------
r43287 | guy | 2012-06-16 12:06:37 -0700 (Sat, 16 Jun 2012) | 7 lines
Changed paths:
   M /trunk-1.8/doc/README.developer

Copy over r43224 from the trunk:

  ------------------------------------------------------------------------
  r43224 | wmeier | 2012-06-12 06:03:05 -0700 (Tue, 12 Jun 2012) | 2 lines

  Note that calls to "expert" functions should not be under 'if (tree)'.

------------------------------------------------------------------------
r43286 | guy | 2012-06-16 12:00:58 -0700 (Sat, 16 Jun 2012) | 14 lines
Changed paths:
   M /trunk-1.8/capture_sync.c
   M /trunk-1.8/epan/filesystem.c
   M /trunk-1.8/rawshark.c

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43173 | cmaynard | 2012-06-08 20:54:29 -0700 (Fri, 08 Jun 2012) | 2 lines

  Undo an accidental portion of the last commit.

  ------------------------------------------------------------------------
  r43172 | cmaynard | 2012-06-08 20:41:23 -0700 (Fri, 08 Jun 2012) | 2 lines

  Be sure to specify FORMAT_MESSAGE_IGNORE_INSERTS in the dwFlags arg to
  all FormatMessage() calls where FORMAT_MESSAGE_FROM_SYSTEM is also
  specified.  (Ref: http://blogs.msdn.com/b/oldnewthing/archive/2007/11/28/6564257.aspx)

------------------------------------------------------------------------
r43285 | guy | 2012-06-16 11:35:13 -0700 (Sat, 16 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/airpcap_loader.c

Copy over r43198 from the trunk:

  ------------------------------------------------------------------------
  r43198 | etxrab | 2012-06-11 00:14:52 -0700 (Mon, 11 Jun 2012) | 4 lines

  From Evan Huus:
  Airpcap memory leak.

  https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7352

------------------------------------------------------------------------
r43284 | guy | 2012-06-16 11:28:39 -0700 (Sat, 16 Jun 2012) | 7 lines
Changed paths:
   M /trunk-1.8/AUTHORS

Copy over r43191 from the trunk:

  ------------------------------------------------------------------------
  r43191 | cmaynard | 2012-06-10 17:53:23 -0700 (Sun, 10 Jun 2012) | 2 lines

  Remove duplicate entry.

------------------------------------------------------------------------
r43283 | guy | 2012-06-16 11:17:12 -0700 (Sat, 16 Jun 2012) | 37 lines
Changed paths:
   M /trunk-1.8/ui/gtk/capture_file_dlg.c
   M /trunk-1.8/ui/gtk/capture_if_dlg.c
   M /trunk-1.8/ui/gtk/capture_if_dlg.h
   M /trunk-1.8/ui/gtk/main.c
   M /trunk-1.8/ui/gtk/main_menubar.c
   M /trunk-1.8/ui/gtk/main_toolbar.c
   M /trunk-1.8/ui/gtk/main_toolbar.h
   M /trunk-1.8/ui/gtk/menus.h

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43252 | guy | 2012-06-13 20:50:39 -0700 (Wed, 13 Jun 2012) | 6 lines

  In effect, disable closing the main window while a capture is being
  stopped - there's no guaranteed way to make the UI's close button
  inactive (on X11, it depends on whether the window manager allows that),
  but we can just do nothing and return TRUE from the delete event handler
  to ignore the delete event.

  ------------------------------------------------------------------------
  r43251 | guy | 2012-06-13 20:50:28 -0700 (Wed, 13 Jun 2012) | 3 lines

  Re-enable the File -> Quit menu item when the capture stops (or is
  started again).

  ------------------------------------------------------------------------
  r43250 | guy | 2012-06-13 19:19:46 -0700 (Wed, 13 Jun 2012) | 5 lines

  Disable some menu items and toolbar items while we're waiting for a
  capture to stop, so that we don't try to quit while we're in the middle
  of quitting or try to stop or restart the capture we're in the middle of
  stopping.
  ------------------------------------------------------------------------
  r43249 | guy | 2012-06-13 19:11:34 -0700 (Wed, 13 Jun 2012) | 2 lines

  No pcap, no capture to stop.

  ------------------------------------------------------------------------
  r43248 | guy | 2012-06-13 18:34:52 -0700 (Wed, 13 Jun 2012) | 5 lines

  When stopping the capture before asking whether to save the results, run
  the main loop until we're done reading the captured packets.  Hopefully
  this clears up bug 7318 in Evan Huus's case; I can't reproduce that
  myself.

------------------------------------------------------------------------
r43282 | guy | 2012-06-16 10:54:07 -0700 (Sat, 16 Jun 2012) | 9 lines
Changed paths:
   M /trunk-1.8/epan/ftypes/ftype-double.c

Copy over r43212 from the trunk:

  ------------------------------------------------------------------------
  r43212 | darkjames | 2012-06-11 12:27:57 -0700 (Mon, 11 Jun 2012) | 4 lines

  Fix bug 6917

  strtod() is locale-aware, change it to g_ascii_strtod()

------------------------------------------------------------------------
r43281 | guy | 2012-06-16 10:47:18 -0700 (Sat, 16 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/editcap.c

Copy over r43271 from the trunk:

  ------------------------------------------------------------------------
  r43271 | etxrab | 2012-06-15 05:27:21 -0700 (Fri, 15 Jun 2012) | 4 lines

  Try to fix pcap-ng - most files created by editcap -c have no IDB
  https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7350

  By using wtap_dump_open_ng() in all places.

------------------------------------------------------------------------
r43279 | etxrab | 2012-06-16 02:49:13 -0700 (Sat, 16 Jun 2012) | 1 line
Changed paths:
   M /trunk-1.8/asn1/m3ap/M3AP-IEs.asn
   M /trunk-1.8/epan/dissectors/packet-m3ap.c

Copy over r43270 from trunk Log:  Correct a discrepancy in the specification.
------------------------------------------------------------------------
r43276 | gerald | 2012-06-15 13:45:07 -0700 (Fri, 15 Jun 2012) | 23 lines
Changed paths:
   M /trunk-1.8/doc/README.developer
   M /trunk-1.8/epan/dissectors/packet-dtls.c
   M /trunk-1.8/epan/dissectors/packet-ssl.c
   M /trunk-1.8/epan/libwireshark.def
   M /trunk-1.8/epan/prefs-int.h
   M /trunk-1.8/epan/prefs.c
   M /trunk-1.8/epan/prefs.h
   M /trunk-1.8/plugins/asn1/packet-asn1.c
   M /trunk-1.8/plugins/mate/packet-mate.c
   M /trunk-1.8/ui/gtk/prefs_dlg.c

Copy over r43228 from the trunk:

  ------------------------------------------------------------------------
  r43228 | morriss | 2012-06-12 18:13:12 -0700 (Tue, 12 Jun 2012) | 6 lines
  Changed paths:
     M /trunk/doc/README.developer
     M /trunk/epan/dissectors/packet-dtls.c
     M /trunk/epan/dissectors/packet-ssl.c
     M /trunk/epan/libwireshark.def
     M /trunk/epan/prefs-int.h
     M /trunk/epan/prefs.c
     M /trunk/epan/prefs.h
     M /trunk/plugins/asn1/packet-asn1.c
     M /trunk/plugins/mate/packet-mate.c
     M /trunk/ui/gtk/prefs_dlg.c

  Create, and start using, file name preferences.

  File name preferences are basically just string preferences except that the
  GUI will present a "Browse" button that allows the user to go and find the
  file s/he wants (rather than having to blindly type in the full path).
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43275 | gerald | 2012-06-15 11:18:07 -0700 (Fri, 15 Jun 2012) | 14 lines
Changed paths:
   M /trunk-1.8/Makefile.am
   M /trunk-1.8/ui/qt/Makefile.am
   M /trunk-1.8/ui/qt/Makefile.common

Copy over r43274 from the trunk:

  ------------------------------------------------------------------------
  r43274 | gerald | 2012-06-15 11:17:20 -0700 (Fri, 15 Jun 2012) | 4 lines
  Changed paths:
     M /trunk/Makefile.am
     M /trunk/ui/qt/Makefile.am
     M /trunk/ui/qt/Makefile.common

  Don't install the Qt resource images. They get converted to C arrays in
  qrc_*.cpp so they shouldn't be necessary even when we're building and
  installing qtshark.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43269 | darkjames | 2012-06-15 01:28:47 -0700 (Fri, 15 Jun 2012) | 4 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-yami.c

Backport part of r43267 to 1.8

Double registration of yami module cause not calling proto_reg_handoff_yami after changing preferences.

------------------------------------------------------------------------
r43265 | gerald | 2012-06-14 12:50:41 -0700 (Thu, 14 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/packaging/nsis/uninstall.nsi

Copy over r43264 from the trunk:

  ------------------------------------------------------------------------
  r43264 | gerald | 2012-06-14 12:49:57 -0700 (Thu, 14 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/packaging/nsis/uninstall.nsi

  Add back an absolute path prefix.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43262 | gerald | 2012-06-14 11:54:48 -0700 (Thu, 14 Jun 2012) | 13 lines
Changed paths:
   M /trunk-1.8/packaging/nsis/common.nsh
   M /trunk-1.8/packaging/nsis/uninstall.nsi
   M /trunk-1.8/packaging/nsis/wireshark.nsi
   M /trunk-1.8/packaging/ws-manifest.pl

Copy over r43261 from the trunk:

  ------------------------------------------------------------------------
  r43261 | gerald | 2012-06-14 11:53:55 -0700 (Thu, 14 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/packaging/nsis/common.nsh
     M /trunk/packaging/nsis/uninstall.nsi
     M /trunk/packaging/nsis/wireshark.nsi
     M /trunk/packaging/ws-manifest.pl

  More NSIS cleanup.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43258 | wmeier | 2012-06-14 06:43:34 -0700 (Thu, 14 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-bacapp.c
   M /trunk-1.8/epan/dissectors/packet-banana.c
   M /trunk-1.8/epan/dissectors/packet-bfcp.c
   M /trunk-1.8/epan/dissectors/packet-bgp.c
   M /trunk-1.8/epan/dissectors/packet-cell_broadcast.c
   M /trunk-1.8/epan/dissectors/packet-cip.c
   M /trunk-1.8/epan/dissectors/packet-cipsafety.c
   M /trunk-1.8/epan/dissectors/packet-dmx.c
   M /trunk-1.8/epan/dissectors/packet-dvb-data-mpe.c
   M /trunk-1.8/epan/dissectors/packet-llrp.c
   M /trunk-1.8/epan/dissectors/packet-moldudp.c
   M /trunk-1.8/epan/dissectors/packet-moldudp64.c
   M /trunk-1.8/epan/dissectors/packet-mpeg-pat.c
   M /trunk-1.8/epan/dissectors/packet-mpeg-sect.c
   M /trunk-1.8/epan/dissectors/packet-openwire.c

Copy over SVN #43226 from trunk

------------------------------------------------------------------------
r43226 | wmeier | 2012-06-12 17:22:46 -0400 (Tue, 12 Jun 2012) | 2 lines

Fix: code under 'if(tree)' (in)directly calls sub-dissector/col_...()/expert...() fcns

------------------------------------------------------------------------


------------------------------------------------------------------------
r43254 | pascal | 2012-06-14 00:22:14 -0700 (Thu, 14 Jun 2012) | 11 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-nas_eps.c

Copy over r43253 from the trunk:

------------------------------------------------------------------------
r43253 | pascal | 2012-06-14 09:14:59 +0200 (jeu., 14 juin 2012) | 3 lines

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7368 :
Identity request, Identity response and Authentication failure message dissection are swapped

------------------------------------------------------------------------


------------------------------------------------------------------------
r43247 | gerald | 2012-06-13 16:05:47 -0700 (Wed, 13 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/packaging/u3/win32/Makefile.nmake

Copy over r43246 from the trunk:

  ------------------------------------------------------------------------
  r43246 | gerald | 2012-06-13 16:04:57 -0700 (Wed, 13 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/packaging/u3/win32/Makefile.nmake

  Fix things to match what we're doing in our portableapps counterpart.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43245 | gerald | 2012-06-13 15:29:21 -0700 (Wed, 13 Jun 2012) | 15 lines
Changed paths:
   M /trunk-1.8/packaging/portableapps/win32/Makefile.nmake
   M /trunk-1.8/packaging/portableapps/win32/makenmake.pl
   M /trunk-1.8/packaging/u3/win32/Makefile.nmake
   M /trunk-1.8/packaging/u3/win32/makenmake.pl
   M /trunk-1.8/packaging/ws-manifest.pl

Copy over r43244 from the trunk:

  ------------------------------------------------------------------------
  r43244 | gerald | 2012-06-13 15:28:28 -0700 (Wed, 13 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/packaging/portableapps/win32/Makefile.nmake
     M /trunk/packaging/portableapps/win32/makenmake.pl
     M /trunk/packaging/u3/win32/Makefile.nmake
     M /trunk/packaging/u3/win32/makenmake.pl
     M /trunk/packaging/ws-manifest.pl

  Don't add uninstall.exe to the U3/PortableApps manifest. Define
  STAGING_DIR. Update some makefile dependencies.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43240 | gerald | 2012-06-13 14:04:32 -0700 (Wed, 13 Jun 2012) | 12 lines
Changed paths:
   M /trunk-1.8/packaging/nsis/Makefile.nmake
   M /trunk-1.8/packaging/nsis/wireshark.nsi

Copy over r43239 from the trunk:

  ------------------------------------------------------------------------
  r43239 | gerald | 2012-06-13 14:03:54 -0700 (Wed, 13 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/packaging/nsis/Makefile.nmake
     M /trunk/packaging/nsis/wireshark.nsi

  Define STAGING_DIR and use it in various places instead of hard-coding
  "..\.." or "..\..\wireshark-gtk2".
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43238 | gerald | 2012-06-13 13:12:52 -0700 (Wed, 13 Jun 2012) | 37 lines
Changed paths:
   M /trunk-1.8/packaging/nsis/AdditionalTasksPage.ini
   M /trunk-1.8/packaging/nsis/Makefile.nmake
   A /trunk-1.8/packaging/nsis/common.nsh (from /trunk/packaging/nsis/common.nsh:43236)
   A /trunk-1.8/packaging/nsis/uninstall.nsi (from /trunk/packaging/nsis/uninstall.nsi:43236)
   M /trunk-1.8/packaging/nsis/wireshark.nsi

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43236 | gerald | 2012-06-13 12:06:27 -0700 (Wed, 13 Jun 2012) | 17 lines
  Changed paths:
     M /trunk/packaging/nsis/AdditionalTasksPage.ini
     M /trunk/packaging/nsis/Makefile.nmake
     A /trunk/packaging/nsis/common.nsh
     A /trunk/packaging/nsis/uninstall.nsi
     M /trunk/packaging/nsis/wireshark.nsi

  Move the "uninstall" parts of wireshark.nsi to uninstall.nsi and the
  common parts to common.nsh. Creating an installer now requires two
  NSIS runs:

    - uninstaller.nsi, which creates an installer (uninstall_installer.exe)
      that only writes uninstall.exe to ../../wireshark-gtk2.

    - wireshark.nsi, which bundles uninstall.exe along with the rest of
      our installation files.

  If we ever get around to signing our executables this will let us sign
  all of them. It also cleans up the .nsi file contents a bit.

  Instead of keeping separate list of file extensions, manage them from
  a single macro. Print the extensions we register / deregister in the
  detail pane.
  ------------------------------------------------------------------------
  r43237 | gerald | 2012-06-13 13:11:41 -0700 (Wed, 13 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/packaging/nsis/uninstall.nsi
     M /trunk/packaging/nsis/wireshark.nsi

  Use terminology that conforms better with the MSDN documentation and a
  style that conforms better with the rest of the NSIS output.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43225 | wmeier | 2012-06-12 07:02:09 -0700 (Tue, 12 Jun 2012) | 22 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-wreth.c

Copy from trunk:

------------------------------------------------------------------------
r43217 | wmeier | 2012-06-11 16:51:47 -0400 (Mon, 11 Jun 2012) | 15 lines

Fix bugs and other issues:
- remove 'if (tree)' around code which (eventually) calls col_...() functions;
- remove unneeded check_col() usage;
- use extended value-strings where appropriate;
- use col_set_str() instead of col_add_fstr();
- fix mismatch between proto_tree_add_item() size arg and the FT type in the
   referenced hf[] entry (in a few cases);
- FT_STRING fields should have ENC_ASCII|ENC_NA as the 'encoding' arg
   in the corresponding proto_tree_add_item() call;
- do whitespace cleanup.

Note: 1 issue remains:
See: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7260#c12

------------------------------------------------------------------------


------------------------------------------------------------------------
r43223 | pascal | 2012-06-12 05:36:29 -0700 (Tue, 12 Jun 2012) | 10 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-gsm_a_bssmap.c

Copy from the trunk:

------------------------------------------------------------------------
r43214 | pascal | 2012-06-11 22:12:17 +0200 (lun., 11 juin 2012) | 3 lines

From Alexander via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7360 :
Service handover IE is not correctly dissected

------------------------------------------------------------------------

------------------------------------------------------------------------
r43220 | gerald | 2012-06-11 16:26:55 -0700 (Mon, 11 Jun 2012) | 53 lines
Changed paths:
   M /trunk-1.8/docbook/release-notes.xml
   M /trunk-1.8/epan/dissectors/packet-per.c
   M /trunk-1.8/epan/dissectors/packet-rsvp.c
   M /trunk-1.8/epan/dissectors/packet-udp.c
   M /trunk-1.8/epan/proto.c
   M /trunk-1.8/ui/gtk/print_dlg.c

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43184 | wmeier | 2012-06-10 08:10:11 -0700 (Sun, 10 Jun 2012) | 5 lines
  Changed paths:
     M /trunk/epan/proto.c

  Fix bug wherein values in a custom column aren't displayed as a value_string (when appropriate).
  Essentially: BASE_CUSTOM is "base_display_e value" (like BASE_DEC) *not* a bit-mask
   (like BASE_EXT_STRING).
  Bug introduced in SVN #39902
  ------------------------------------------------------------------------
  r43186 | wmeier | 2012-06-10 12:23:50 -0700 (Sun, 10 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/proto.c

  Fix "BASE_CUSTOM field is incorrectly formatted when applied as a column".
  Resolves Bug #6671 - https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6671
  ------------------------------------------------------------------------
  r43187 | cmaynard | 2012-06-10 12:43:40 -0700 (Sun, 10 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-udp.c

  Fix UDP-Lite checksum verification bug introduced with r40387 and reported by "answer" via http://ask.wireshark.org/questions/11798/is-udp-lite-checksum-correct-ipv6
  There is a difference between the UDP and UDP-Lite pseudo header that wasn't realized when r40387 was committed.  Details of the difference in http://tools.ietf.org/html/rfc3828#section-3.2
  ------------------------------------------------------------------------
  r43193 | cmaynard | 2012-06-10 19:43:16 -0700 (Sun, 10 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/ui/gtk/print_dlg.c

  Set the default for printing or exporting packets to displayed packets only.
  ------------------------------------------------------------------------
  r43195 | cmaynard | 2012-06-10 20:51:47 -0700 (Sun, 10 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/docbook/release-notes.xml

  Expand the item regarding displayed packets, rather than all packets, as being the default when saving to also include exporting and printing as well.
  ------------------------------------------------------------------------
  r43194 | wmeier | 2012-06-10 20:36:04 -0700 (Sun, 10 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-rsvp.c

  From Evan Huus: Missing breaks in packet-rsvp.c
  https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7353
  ------------------------------------------------------------------------
  r43203 | pascal | 2012-06-11 06:54:06 -0700 (Mon, 11 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-per.c

  Use restricted character string decoding for IA5String type
  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6246
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43219 | gerald | 2012-06-11 16:22:50 -0700 (Mon, 11 Jun 2012) | 73 lines
Changed paths:
   M /trunk-1.8/asn1/snmp/packet-snmp-template.c
   M /trunk-1.8/asn1/t124/packet-t124-template.c
   M /trunk-1.8/epan/dissectors/packet-bzr.c
   M /trunk-1.8/epan/dissectors/packet-diameter.c
   M /trunk-1.8/epan/dissectors/packet-h248_annex_e.c
   M /trunk-1.8/epan/dissectors/packet-homeplug-av.c
   M /trunk-1.8/epan/dissectors/packet-ieee80211.c
   M /trunk-1.8/epan/dissectors/packet-mndp.c
   M /trunk-1.8/epan/dissectors/packet-nflog.c
   M /trunk-1.8/epan/dissectors/packet-opensafety.c
   M /trunk-1.8/epan/dissectors/packet-sip.c
   M /trunk-1.8/epan/dissectors/packet-snmp.c
   M /trunk-1.8/epan/dissectors/packet-syslog.c
   M /trunk-1.8/epan/dissectors/packet-t124.c
   M /trunk-1.8/epan/dissectors/packet-uasip.c
   M /trunk-1.8/epan/dissectors/packet-vmlab.c

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43174 | cmaynard | 2012-06-09 08:43:08 -0700 (Sat, 09 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-syslog.c

  Allow syslog to work with "Decode As" for TCP.
  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5241
  ------------------------------------------------------------------------
  r43175 | cmaynard | 2012-06-09 08:54:15 -0700 (Sat, 09 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-sip.c

  Add sip.to.tag and sip.from.tag filters.
  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5226
  ------------------------------------------------------------------------
  r43176 | cmaynard | 2012-06-09 10:08:46 -0700 (Sat, 09 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-ieee80211.c

  Do not use BASE_NONE for FT_UINT8 types.
  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7333 (I think).
  ------------------------------------------------------------------------
  r43177 | cmaynard | 2012-06-09 10:47:58 -0700 (Sat, 09 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/asn1/t124/packet-t124-template.c
     M /trunk/epan/dissectors/packet-bzr.c
     M /trunk/epan/dissectors/packet-h248_annex_e.c
     M /trunk/epan/dissectors/packet-homeplug-av.c
     M /trunk/epan/dissectors/packet-nflog.c
     M /trunk/epan/dissectors/packet-opensafety.c
     M /trunk/epan/dissectors/packet-t124.c

  Do not use BASE_NONE for FT_*INT* types.
  ------------------------------------------------------------------------
  r43178 | cmaynard | 2012-06-09 10:51:30 -0700 (Sat, 09 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-mndp.c

  Do not use BASE_NONE for FT_*INT* types.
  ------------------------------------------------------------------------
  r43179 | cmaynard | 2012-06-09 10:56:08 -0700 (Sat, 09 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/asn1/snmp/packet-snmp-template.c
     M /trunk/epan/dissectors/packet-diameter.c
     M /trunk/epan/dissectors/packet-snmp.c
     M /trunk/epan/dissectors/packet-vmlab.c

  Do not use BASE_NONE for FT_*INT* types.
  ------------------------------------------------------------------------
  r43180 | wmeier | 2012-06-09 11:24:09 -0700 (Sat, 09 Jun 2012) | 11 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-uasip.c

  str_to_ipaddr() had a bug; use inet_pton() instead;
  See: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6844#c27

  Also: Improve handling of an invalid value for the 'proxy IP Address'
  preference. If the address is invalid, setting the preference
  to "" in proto_reg_handoff...() doesn't work well.
  Instead, issue a g_warning for an invalid IP address when it'
  s processed in proto_reg_handoff...()
  (AFAIK, there's not a way for a dissector to validate the semantic
  value of a preference and report an error).
  ------------------------------------------------------------------------
  r43181 | wmeier | 2012-06-09 11:42:20 -0700 (Sat, 09 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-uasip.c

  Fix compiler error
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43218 | gerald | 2012-06-11 16:14:50 -0700 (Mon, 11 Jun 2012) | 53 lines
Changed paths:
   M /trunk-1.8/docbook/Makefile.common
   M /trunk-1.8/epan/dissectors/packet-glusterfs.c
   M /trunk-1.8/epan/dissectors/packet-smb2.c
   M /trunk-1.8/epan/dissectors/packet-ua3g.c
   M /trunk-1.8/epan/proto.c
   M /trunk-1.8/wiretap/netscreen.c

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43139 | darkjames | 2012-06-06 12:59:55 -0700 (Wed, 06 Jun 2012) | 4 lines
  Changed paths:
     M /trunk/wiretap/netscreen.c

  Fix bug #7340

  interface name can also contain hyphen (v1-untrust, v1-trust).
  ------------------------------------------------------------------------
  r43144 | etxrab | 2012-06-06 13:44:21 -0700 (Wed, 06 Jun 2012) | 1 line
  Changed paths:
     M /trunk/epan/dissectors/packet-glusterfs.c

  From Niels de Vos: GlusterFS: Display SETATTR attribute valid as a list of flags https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7341
  ------------------------------------------------------------------------
  r43147 | wmeier | 2012-06-07 10:39:11 -0700 (Thu, 07 Jun 2012) | 4 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-smb2.c

  Fix invalid hf[] entry 'display' field value.
  result: incorect display of value (and, incidentally,
          a crash in 'tshark -G values'
  ------------------------------------------------------------------------
  r43148 | rbalint | 2012-06-07 11:44:20 -0700 (Thu, 07 Jun 2012) | 1 line
  Changed paths:
     M /trunk/docbook/Makefile.common

  fix building Developer Guide from release tarball
  ------------------------------------------------------------------------
  r43150 | wmeier | 2012-06-07 14:10:02 -0700 (Thu, 07 Jun 2012) | 11 lines
  Changed paths:
     M /trunk/epan/proto.c

  Don't crash in 'proto_registrar_dump_values' if BASE_EXT_STRING and no extended string.
  Note: this shows up when doing 'tshark -G values'.

  BASE_EXT_STRING with a missing extended string does *not* cause issues
  with the normal display code:

  ToDo (eventually): Add some code to enforce requirement that hf[] entries with BASE_EXT_STRING
  (or BASE_RANGE_STRING) set must also have a 'strings' value.
  ------------------------------------------------------------------------
  r43164 | wmeier | 2012-06-08 14:17:42 -0700 (Fri, 08 Jun 2012) | 5 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-ua3g.c

  Fix bug I introduced in SVN #43129.

  Fixes fuzz crash reported in Bug #7346.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43206 | morriss | 2012-06-11 09:07:51 -0700 (Mon, 11 Jun 2012) | 9 lines
Changed paths:
   M /trunk-1.8/Makefile.am
   M /trunk-1.8/packaging/nsis/wireshark.nsi

Copy over from trunk:

------------------------------------------------------------------------
r43202 | pascal | 2012-06-11 09:48:11 -0400 (Mon, 11 Jun 2012) | 2 lines

Add TGPPS9.xml to makefile and NSIS installer

------------------------------------------------------------------------

------------------------------------------------------------------------
r43169 | gerald | 2012-06-08 16:02:45 -0700 (Fri, 08 Jun 2012) | 27 lines
Changed paths:
   M /trunk-1.8/epan/Makefile.am
   M /trunk-1.8/tools/git-compare-abis.sh
   M /trunk-1.8/wiretap/Makefile.am
   M /trunk-1.8/wsutil/Makefile.am

Forward-port r43165 and r43168 from trunk-1.6.

  ------------------------------------------------------------------------
  r43165 | gerald | 2012-06-08 14:23:25 -0700 (Fri, 08 Jun 2012) | 4 lines
  Changed paths:
     M /trunk-1.6/epan/Makefile.am
     M /trunk-1.6/wiretap/Makefile.am
     M /trunk-1.6/wsutil/Makefile.am
  
  Use separate commands in the dumpabi recipes instead a big huge long
  chain. If abi-compliance-checker fails print the contents of its
  log file.
  ------------------------------------------------------------------------
  r43168 | gerald | 2012-06-08 15:43:50 -0700 (Fri, 08 Jun 2012) | 2 lines
  Changed paths:
     M /trunk-1.6/epan/Makefile.am
     M /trunk-1.6/wiretap/Makefile.am
     M /trunk-1.6/wsutil/Makefile.am
  
  Make sure ln happens in the right directory.
  ------------------------------------------------------------------------

We don't currently have a usable tag for "git describe --tags
--abbrev=0" to latch onto so just use the master-1.8 branch commit.
Apparently if you gaze long into an abyss of commits CVS gazes back at
you.

------------------------------------------------------------------------
r43167 | morriss | 2012-06-08 15:35:41 -0700 (Fri, 08 Jun 2012) | 34 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-diameter.c

Copy over from trunk (mainly for the last revision but also to keep the files
in sync):

------------------------------------------------------------------------
r43166 | morriss | 2012-06-08 18:23:11 -0400 (Fri, 08 Jun 2012) | 10 lines

Don't register 3 (IPAddress) hf's with the same abbreviation but with 3
different types; instead use different abbreviations (filters).

This is in order to prevent running into

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=2402

and seg-faulting when someone applies a filter of, for example,
diameter.Framed-IP-Address .

------------------------------------------------------------------------
r43163 | morriss | 2012-06-08 16:08:43 -0400 (Fri, 08 Jun 2012) | 1 line

Thinking about it more, how we're storing the application ID isn't a problem.
------------------------------------------------------------------------
r43162 | morriss | 2012-06-08 15:59:33 -0400 (Fri, 08 Jun 2012) | 9 lines

Don't call val_to_str() only to then compare the result with "Uknown": use
match_strval() instead.

Also, don't retrieve the application ID 3 more times; we've already got it
in a variable...

Point out a bug regarding how we're storing the application ID for use by
subdissectors (from r34570).

------------------------------------------------------------------------

------------------------------------------------------------------------
r43161 | morriss | 2012-06-08 12:23:35 -0700 (Fri, 08 Jun 2012) | 14 lines
Changed paths:
   A /trunk-1.8/diameter/TGPPS9.xml
   M /trunk-1.8/diameter/dictionary.xml

Copy over the below without the SVN properties changes:

------------------------------------------------------------------------
r43160 | morriss | 2012-06-08 15:17:04 -0400 (Fri, 08 Jun 2012) | 7 lines

Add support for 3GPP S9 (29.215).

Massively reindent dictionary.xml to try to make it more readable
to us humans.  Fix some typos too.

Set SVN properties on all the files.

------------------------------------------------------------------------

------------------------------------------------------------------------
r43146 | morriss | 2012-06-07 05:10:18 -0700 (Thu, 07 Jun 2012) | 3 lines
Changed paths:
   M /trunk-1.8/docbook/developer-guide.xml
   M /trunk-1.8/docbook/user-guide.xml

Version 1.7 --> 1.8.
Extend the copyright for these documents into 2012.

------------------------------------------------------------------------
r43143 | gerald | 2012-06-06 13:43:49 -0700 (Wed, 06 Jun 2012) | 12 lines
Changed paths:
   M /trunk-1.8/config.nmake
   M /trunk-1.8/tools/win64-setup.sh

Copy over r43142 from the trunk:

  ------------------------------------------------------------------------
  r43142 | gerald | 2012-06-06 13:42:47 -0700 (Wed, 06 Jun 2012) | 3 lines
  Changed paths:
     M /trunk/config.nmake
     M /trunk/tools/win64-setup.sh

  Update the Lua configuration on Win64 to reflect the recent change to
  Visual Studio 2010.
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43135 | gerald | 2012-06-06 11:53:40 -0700 (Wed, 06 Jun 2012) | 2 lines
Changed paths:
   M /trunk-1.8/version.conf

Switch back to interim versions.

------------------------------------------------------------------------
r43134 | gerald | 2012-06-06 10:08:20 -0700 (Wed, 06 Jun 2012) | 2 lines
Changed paths:
   M /trunk-1.8/version.conf

Build 1.8.0rc1.

------------------------------------------------------------------------
r43132 | gerald | 2012-06-06 08:46:27 -0700 (Wed, 06 Jun 2012) | 45 lines
Changed paths:
   M /trunk-1.8/epan/dissectors/packet-noe.c
   M /trunk-1.8/epan/dissectors/packet-ua.c
   M /trunk-1.8/epan/dissectors/packet-ua3g.c
   M /trunk-1.8/epan/dissectors/packet-uasip.c
   M /trunk-1.8/epan/dissectors/packet-uaudp.c
   M /trunk-1.8/epan/dissectors/packet-uaudp.h

Copy over revisions from the trunk:

  ------------------------------------------------------------------------
  r43129 | wmeier | 2012-06-05 21:54:47 -0700 (Tue, 05 Jun 2012) | 20 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-noe.c
     M /trunk/epan/dissectors/packet-ua.c
     M /trunk/epan/dissectors/packet-ua3g.c
     M /trunk/epan/dissectors/packet-uasip.c
     M /trunk/epan/dissectors/packet-uaudp.c
     M /trunk/epan/dissectors/packet-uaudp.h

  Fix some bugs & do extensive cleanup;
  Bugs fixed:
   - Calling col_...() fcns or dissectors under 'if (tree)'
   - Potential buffer overflows (if bad data)
   - Misc incorrect data display issues
  Cleanup including;
   - Remove unneeded #includes
   - Fix excessive use of value_strings
   - Use extended value_strings & val_to_str_(ext_)const as appropriate
   - Optimize repeated fetches of the same data from a tvb
   - Do general code simplification
   - Remove or #if 0 unused code;
   - Add XXX comments for code which may be incorrect
   - Remove unneeded prefs callback to proto_reg_handoff...()
   - Remove unneeded use of check_col()
   - Define several functions as static
   - Move proto_reg_handoff...() to the end of the file
   - Fix whitespace (including "4 space tabs")
   - ...
  ------------------------------------------------------------------------
  r43130 | wmeier | 2012-06-05 22:36:43 -0700 (Tue, 05 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-uasip.c

  Fix compiler error
  ------------------------------------------------------------------------
  r43131 | wmeier | 2012-06-05 22:58:42 -0700 (Tue, 05 Jun 2012) | 2 lines
  Changed paths:
     M /trunk/epan/dissectors/packet-uaudp.c

  Fix compiler error (I hope)
  ------------------------------------------------------------------------

------------------------------------------------------------------------
r43127 | gerald | 2012-06-05 16:20:48 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk-1.8/CMakeOptions.txt
   M /trunk-1.8/ChangeLog
   M /trunk-1.8/NEWS
   M /trunk-1.8/config.nmake
   M /trunk-1.8/configure.in

Disable warnings-as-errors by default. Update the ChangeLog and NEWS.

------------------------------------------------------------------------
r43125 | gerald | 2012-06-05 15:19:20 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk-1.8/ui/gtk/Makefile.common
   M /trunk-1.8/ui/gtk/about_dlg.c

Use the normal logos.

------------------------------------------------------------------------
r43123 | gerald | 2012-06-05 10:36:26 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   A /trunk-1.8/version.conf

Add version.conf.

------------------------------------------------------------------------
r43122 | gerald | 2012-06-05 09:46:30 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk-1.8/ui/gtk/main_welcome.c

Use the release badge.

------------------------------------------------------------------------
r43121 | gerald | 2012-06-05 09:32:07 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk-1.8/config.nmake
   M /trunk-1.8/configure.in
   M /trunk-1.8/debian/changelog
   M /trunk-1.8/debian/wireshark-common.files
   M /trunk-1.8/docbook/release-notes.xml
   M /trunk-1.8/epan/Makefile.am
   M /trunk-1.8/make-version.pl
   M /trunk-1.8/wiretap/Makefile.am
   M /trunk-1.8/wsutil/Makefile.am

1.7.2 → 1.8.0rc1. Add version.conf and adjust debian/wireshark-common.files.

------------------------------------------------------------------------
r43119 | gerald | 2012-06-05 09:18:22 -0700 (Tue, 05 Jun 2012) | 1 line
Changed paths:
   A /trunk-1.8 (from /trunk:43118)

Create the 1.8 branch.
------------------------------------------------------------------------
r43118 | gerald | 2012-06-05 09:14:20 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add YAMI and SDH.

------------------------------------------------------------------------
r43117 | darkjames | 2012-06-05 08:52:08 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-yami.c

yami: dissect header messages, add parameter names to parent tree item.

------------------------------------------------------------------------
r43116 | morriss | 2012-06-05 08:29:25 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/wslua/wslua_tree.c

Fix Coverity 702396: tvbr is ep_ allocated so it can't be NULL.

------------------------------------------------------------------------
r43115 | morriss | 2012-06-05 08:26:09 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/wslua/wslua_tvb.c

Fix Coverity 702397: reference tvbr *after* checking that it is not NULL.

------------------------------------------------------------------------
r43114 | morriss | 2012-06-05 08:20:31 -0700 (Tue, 05 Jun 2012) | 3 lines
Changed paths:
   M /trunk/plugins/mate/mate_util.c

Fix Coverity 702421: Handle the possibility that fvalue_to_string_repr()
may return NULL.

------------------------------------------------------------------------
r43113 | morriss | 2012-06-05 08:05:17 -0700 (Tue, 05 Jun 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_mac.c

Fix Coverity 703495: reference fpinf *after* checking that it is not NULL.

Also replace some 4 space tabs with spaces.

------------------------------------------------------------------------
r43112 | darkjames | 2012-06-05 08:02:49 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-yami.c

packet-yami: cleanup, remove non-ASCII character.

------------------------------------------------------------------------
r43111 | darkjames | 2012-06-05 07:50:37 -0700 (Tue, 05 Jun 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wreth.c

packet-wreth: cleanup

- make function and arrays static
- comment out unused hf-entry.
- comment out unused variable.

------------------------------------------------------------------------
r43110 | darkjames | 2012-06-05 07:17:50 -0700 (Tue, 05 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-yami.c

Dissector for YAMI protocol.

------------------------------------------------------------------------
r43109 | etxrab | 2012-06-05 06:12:28 -0700 (Tue, 05 Jun 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
openSAFETY - Names for certain SOD objects, automatic SCM UDID detecion.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7335
------------------------------------------------------------------------
r43108 | etxrab | 2012-06-05 04:19:33 -0700 (Tue, 05 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sdh.c

Set SVN properties.
------------------------------------------------------------------------
r43107 | etxrab | 2012-06-05 03:54:21 -0700 (Tue, 05 Jun 2012) | 4 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/h248v1support.asn
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/h248/packet-h248-template.h
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h
   M /trunk/epan/dissectors/packet-h248_10.c
   M /trunk/epan/dissectors/packet-h248_2.c
   M /trunk/epan/dissectors/packet-h248_3gpp.c
   M /trunk/epan/dissectors/packet-h248_7.c
   M /trunk/epan/dissectors/packet-h248_annex_c.c
   M /trunk/epan/dissectors/packet-h248_annex_e.c
   M /trunk/epan/dissectors/packet-h248_q1950.c

from Alex Lindberg:
Update to packet-h248.c and associated h248 dissecorts.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7332
------------------------------------------------------------------------
r43106 | etxrab | 2012-06-05 03:42:38 -0700 (Tue, 05 Jun 2012) | 6 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-erf.c
   A /trunk/epan/dissectors/packet-sdh.c
   M /trunk/wiretap/wtap.h

From Andrew Kampjes:
SDH support for wireshark.

- Added GPL license.
- Removed not needed includes.
- Skipped th .h file as it wasn't used.
------------------------------------------------------------------------
r43105 | guy | 2012-06-05 01:59:37 -0700 (Tue, 05 Jun 2012) | 5 lines
Changed paths:
   M /trunk/wiretap/file_wrappers.c

Casting a negative value to unsigned makes it positive; I'm not sure
that will do the right thing here.  Instead, cast its negative (which is
positive) to unsigned, use that value as the adjustment, and flip the
signs of the subsequent adjustment operations.

------------------------------------------------------------------------
r43104 | etxrab | 2012-06-05 01:39:58 -0700 (Tue, 05 Jun 2012) | 1 line
Changed paths:
   M /trunk/wiretap/file_wrappers.c

Add another cast to make it build on Win32.
------------------------------------------------------------------------
r43103 | guy | 2012-06-05 01:04:15 -0700 (Tue, 05 Jun 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/file_wrappers.c

Making "had" a ptrdiff_t caused warnings, even if it eliminated a
warning about assigning the difference between two (64-bit) pointers to
a (32-bit) variable.  That difference is guaranteed to fit in an
unsigned int; make "had" an unsigned int, and cast the difference to
unsigned int before assigning it to "had".

------------------------------------------------------------------------
r43102 | guy | 2012-06-05 00:24:17 -0700 (Tue, 05 Jun 2012) | 9 lines
Changed paths:
   M /trunk/wiretap/file_wrappers.c

From Jakub Zawadzki: when seeking backwards, if the seek will put you at
a position that's in our data buffer, just reposition within the
buffer, don't do any seeks or I/O on the underlying file.  This lets us
do some backwards seeking on a pipe, to allow the rewind-and-try scheme
we use to try to identify capture file types to work, at least for some
capture file formats (those that have magic numbers at the beginning or
have heuristics that don't require much data), on pipes, allowing, for
example, TShark to read those formats from a pipe.

------------------------------------------------------------------------
r43101 | guy | 2012-06-04 23:52:18 -0700 (Mon, 04 Jun 2012) | 21 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_statusbar.c

If we do a Save or Save As with a move, don't reread the capture file,
just tweak the elements in the capture_file structure as necessary and
poke the UI to update stuff such as the windows title.

If we do a Save or Save As with a copy, don't reread the capture file,
just close the old wtap, open a wtap for the copy, and tweak the
elements in the capture_file structure as necessary and poke the UI to
update stuff such as the windows title.

Otherwise, don't do a full read-and-dissect pass on the capture file,
just close the old wtap, open a wtap for the new file, tweak the
elements in the capture_file structure as necessary and poke the UI to
update stuff such as the windows title, and rescan the file to update
the packet offsets (and cause Wiretap to regenerate, for a gzipped file,
the information needed to support fast random access to the gzipped
file).

This should speed up Save and Save As a bit, as well as removing some
glitches in the UI (e.g., you won't see the packet list disappear and
reappear).

------------------------------------------------------------------------
r43100 | etxrab | 2012-06-04 22:27:06 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

From Adam Langley: Add support for decrypting ECDHE-RSA-RC4-SHA. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7331
------------------------------------------------------------------------
r43099 | etxrab | 2012-06-04 22:22:41 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

From Adam Langley: Add support for CLIENT_RANDOM lines in SSL keylog. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7330
------------------------------------------------------------------------
r43098 | etxrab | 2012-06-04 22:16:06 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

From Alex Lindberg: Add preference to packet-ber.c to toggle BER warning on leading zero bits. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7328
------------------------------------------------------------------------
r43097 | etxrab | 2012-06-04 22:10:18 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

From Adam Langley: Clean up code for handling keylog files. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7329
------------------------------------------------------------------------
r43096 | guy | 2012-06-04 19:49:56 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/file.c

Fix some comments.

------------------------------------------------------------------------
r43095 | guy | 2012-06-04 19:46:54 -0700 (Mon, 04 Jun 2012) | 18 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_statusbar.c

Distinguish between "failed" and "user stopped it" for "save as" and
"export specified packets".  For "failed", let the user try again with a
different file, in case it failed due to, for example, running out of
space or quota (probably the most likely failure mode for writing, and
trying to a different volume might be the best workaround).  For "user
stopped it", presumably they don't want to try again (the most likely
reason is "it was taking too damn long").
 
Put "Exporting to: ...", not "Saving: ..." in the statusbar if we're
doing "export specified packets".

In process_specified_packets(), allow a null range pointer to be
specified, meaning "save 'em all"; that avoids the possibly-expensive
(with a large capture) operation of initializing the range.

If a "safe save" atop an existing file fails or is stopped, get rid of
the temporary file we created.

------------------------------------------------------------------------
r43094 | gerald | 2012-06-04 16:47:11 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpcap.c

Fix compilation.

------------------------------------------------------------------------
r43093 | gerald | 2012-06-04 16:39:40 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add WSE Remote Ethernet & resort.

------------------------------------------------------------------------
r43092 | alagoutte | 2012-06-04 15:34:27 -0700 (Mon, 04 Jun 2012) | 15 lines
Changed paths:
   A /trunk/epan/dissectors/packet-wreth.c

 From Clement Marrast via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7260
 New dissector for WSE Remote Ethernet protocol

 From me :
 * Fix Compilation under linux
 * Use proto_tree_add_item*
 * Make build-in dissector
 * Include Status.* and Codef.* in dissector
 * Reorder function (to respect Wireshark Codelines)
 * Add Modelines Info and fix indent (use 4 spaces)
 * Fix check* tools
 * Add Clement to AUTHORS

With the dissector....

------------------------------------------------------------------------
r43091 | alagoutte | 2012-06-04 15:26:40 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-pgsql.c
   M /trunk/epan/dissectors/packet-pvfs2.c
   M /trunk/epan/dissectors/packet-rpcap.c
   M /trunk/epan/dissectors/packet-rtmpt.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r43090 | alagoutte | 2012-06-04 15:26:18 -0700 (Mon, 04 Jun 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-parlay.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang
(Manual Fix, not found how to fix the generator...)

------------------------------------------------------------------------
r43089 | alagoutte | 2012-06-04 15:25:27 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-msproxy.c
   M /trunk/epan/dissectors/packet-nbns.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r43088 | alagoutte | 2012-06-04 15:25:10 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/plugins/unistim/packet-unistim.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r43087 | alagoutte | 2012-06-04 15:24:46 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-memcache.c
   M /trunk/epan/dissectors/packet-mq.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r43086 | alagoutte | 2012-06-04 15:22:32 -0700 (Mon, 04 Jun 2012) | 13 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common

From Clement Marrast via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7260
New dissector for WSE Remote Ethernet protocol

From me :
* Fix Compilation under linux
* Use proto_tree_add_item*
* Make build-in dissector
* Include Status.* and Codef.* in dissector
* Reorder function (to respect Wireshark Codelines)
* Add Modelines Info and fix indent (use 4 spaces)
* Fix check* tools
* Add Clement to AUTHORS

------------------------------------------------------------------------
r43085 | jmayer | 2012-06-04 14:54:29 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/STATUS.gtk3

gtk3 libs for win are now available.

------------------------------------------------------------------------
r43084 | pascal | 2012-06-04 14:31:18 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/tcp_graph.c

C++ -> C-style comments

------------------------------------------------------------------------
r43083 | etxrab | 2012-06-04 13:42:09 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/ui/gtk/tcp_graph.c

Make it possible to build with GTK3 on Windows
------------------------------------------------------------------------
r43082 | gerald | 2012-06-04 13:29:24 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add entries for Gluster.

------------------------------------------------------------------------
r43081 | guy | 2012-06-04 13:08:59 -0700 (Mon, 04 Jun 2012) | 6 lines
Changed paths:
   M /trunk/ui/alert_box.c
   M /trunk/ui/alert_box.h
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/find_dlg.c
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/gui_utils.h
   M /trunk/ui/gtk/io_stat.c
   M /trunk/ui/gtk/main.c

Use the modal version of the bad display filter alert box in the I/O
statistics window.

Get rid of the non-modal version (it's not being used any more), and
remove the now-redundant _modal from the modal version.

------------------------------------------------------------------------
r43080 | guy | 2012-06-04 12:58:54 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/find_dlg.c

Use the modal bad display filter alert dialog.

------------------------------------------------------------------------
r43079 | guy | 2012-06-04 12:45:44 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/find_dlg.c

Clean up indentation.

------------------------------------------------------------------------
r43078 | guy | 2012-06-04 12:44:48 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main.c

Use the modal version of the bad display filter alert box.

------------------------------------------------------------------------
r43077 | guy | 2012-06-04 12:37:04 -0700 (Mon, 04 Jun 2012) | 6 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/file_dlg.c
   M /trunk/ui/gtk/file_dlg.h

And do the same with the color filter import and export dialogs (which
really don't belong here - they have nothing to do with capture files).

Absorb the test for the target file's existence into
file_target_exist_ui().

------------------------------------------------------------------------
r43076 | guy | 2012-06-04 12:04:45 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

And do the same with the merge dialog.

------------------------------------------------------------------------
r43075 | guy | 2012-06-04 11:41:36 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

Clean up indentation.

------------------------------------------------------------------------
r43074 | guy | 2012-06-04 11:40:45 -0700 (Mon, 04 Jun 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/gui_utils.h

Do with the open dialog what we've done with the save and "export
selected packets" dialog.

------------------------------------------------------------------------
r43073 | gerald | 2012-06-04 11:33:21 -0700 (Mon, 04 Jun 2012) | 4 lines
Changed paths:
   M /trunk/epan/Makefile.am
   M /trunk/wiretap/Makefile.am

There doesn't appear to be a way to convey the message "This library is
under development. Maybe you should use a stable version." via the
version number. Use the next best thing and set each number to zero.

------------------------------------------------------------------------
r43072 | guy | 2012-06-04 10:21:32 -0700 (Mon, 04 Jun 2012) | 7 lines
Changed paths:
   M /trunk/ui/gtk/file_dlg.c
   M /trunk/ui/gtk/file_dlg.h

file_target_exist_ui() is used only on UN*Xes; on Win32, we'd use the
Windows file dialog, which has its own built-in version of the "do you
want to overwrite that file?" dialog, and Notepad and WordPad, at least,
just appear to error out if you try to overwrite a file with the
read-only flag set, rather than asking whether you want to override
that.

------------------------------------------------------------------------
r43071 | etxrab | 2012-06-04 09:56:08 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/config.nmake

Update GTK 3.0 package Id
------------------------------------------------------------------------
r43070 | gerald | 2012-06-04 08:36:42 -0700 (Mon, 04 Jun 2012) | 3 lines
Changed paths:
   M /trunk/ChangeLog

There's no sense in making everyone check out a large, old list of
changes.

------------------------------------------------------------------------
r43069 | darkjames | 2012-06-04 07:45:50 -0700 (Mon, 04 Jun 2012) | 10 lines
Changed paths:
   M /trunk/epan/dfilter/gencode.c
   M /trunk/epan/dfilter/semcheck.c

display filter: restore comparision of fields.

like:
  udp.srcport == udp.dstport
  frame.cap_len != frame.len
(probably you can use it for better ones)

part of bug #7263


------------------------------------------------------------------------
r43068 | darkjames | 2012-06-04 07:37:24 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gadu-gadu.c

packet-gadu-gadu: set COL_INFO in undissected/unknown packet types.

------------------------------------------------------------------------
r43067 | etxrab | 2012-06-04 07:31:53 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-aim.c

Try to make the buildbot happy.
------------------------------------------------------------------------
r43066 | etxrab | 2012-06-04 06:52:46 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-aarp.c
   M /trunk/epan/dissectors/packet-actrace.c
   M /trunk/epan/dissectors/packet-adwin.c
   M /trunk/epan/dissectors/packet-afp.c
   M /trunk/epan/dissectors/packet-afs.c
   M /trunk/epan/dissectors/packet-aim-chat.c
   M /trunk/epan/dissectors/packet-aim.c
   M /trunk/epan/dissectors/packet-ajp13.c
   M /trunk/epan/dissectors/packet-alcap.c

Get rid of a couple of warnings.
------------------------------------------------------------------------
r43065 | etxrab | 2012-06-04 06:21:44 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-bt-dht.c
   M /trunk/epan/dissectors/packet-snmp.c

Get rid of a couple of warnings.
------------------------------------------------------------------------
r43064 | etxrab | 2012-06-04 05:20:37 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-ldap.c

Get rid of a couple of warnings.
------------------------------------------------------------------------
r43063 | etxrab | 2012-06-04 04:44:52 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

Get rid of a couple of warnings.
------------------------------------------------------------------------
r43062 | etxrab | 2012-06-04 04:18:17 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp-utils.h

Revert previous change as it did not compile.
------------------------------------------------------------------------
r43061 | etxrab | 2012-06-04 03:36:43 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp-utils.h

Try to get rid of a couple of warnings.
------------------------------------------------------------------------
r43060 | guy | 2012-06-04 03:27:59 -0700 (Mon, 04 Jun 2012) | 18 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.h
   M /trunk/ui/gtk/file_dlg.c
   M /trunk/ui/gtk/file_dlg.h
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/ui/gtk/range_utils.c
   M /trunk/ui/gtk/range_utils.h

Make the "Export Selected Packets As..." code path more like the "Save
As..." code path.

Extract the code for the "do you want to overwrite this file" and "OK,
you do - are you aware it's {user-immutable, read-only}?" code paths
into a common routine for use by both of those and, potentially, other
save/export/etc. code paths in the future.

For "Save As", allow us to save atop the current capture file, as that's
just what "Save" does if there are unsaved changes, and "safe save"
makes that work.  *Don't* allow that for "Export Selected Packets
As...", however.

The file chooser is run as a modal dialog, so we don't need to worry
about creating more than one of them or about the number of marked
packets etc. being changed out from under us.  Get rid of a bunch of
static variables.

------------------------------------------------------------------------
r43059 | pascal | 2012-06-04 03:02:08 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/epan/dissectors/packet-gsm_map.c

Fix 'lvalue required as left operand of assignment' error when compiling with gcc 4.3.2

------------------------------------------------------------------------
r43058 | etxrab | 2012-06-04 02:04:36 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-giop.c
   M /trunk/epan/dissectors/packet-giop.h

Try to get rid of a couple of warnings.
------------------------------------------------------------------------
r43057 | etxrab | 2012-06-04 01:56:48 -0700 (Mon, 04 Jun 2012) | 1 line
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/asn1/gsm_map/packet-gsm_map-template.c
   M /trunk/asn1/ldap/ldap.cnf
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-ldap.c

Get rid of a couple of warnings.
------------------------------------------------------------------------
r43056 | guy | 2012-06-04 01:46:51 -0700 (Mon, 04 Jun 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

Clean up indentation.

------------------------------------------------------------------------
r43055 | pascal | 2012-06-04 01:42:12 -0700 (Mon, 04 Jun 2012) | 3 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-gluster_cli.c

From Niels de Vos via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7325 :
Add support for the Gluster CLI RPC-protocol

------------------------------------------------------------------------
r43054 | cmaynard | 2012-06-03 23:22:50 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

Remove a few of "if (tree)" checks surrounding expert_add_info_format().

------------------------------------------------------------------------
r43053 | guy | 2012-06-03 20:15:05 -0700 (Sun, 03 Jun 2012) | 7 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.common
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/main_menubar_private.h
   M /trunk/ui/gtk/main_toolbar.c
   M /trunk/ui/gtk/main_toolbar.h
   A /trunk/ui/gtk/main_toolbar_private.h
   M /trunk/ui/gtk/menus.h
   M /trunk/ui/gtk/new_packet_list.c

Add some more routines to main.c that handle updates to "auto scroll in
live capture" and colorization, so that the ones in main_menubar.c don't
have to know about anything other than the main menubar.

Move some toolbar routines that should only be used by routines in
main.c into a main_toolbar_private.h header.

------------------------------------------------------------------------
r43052 | guy | 2012-06-03 20:09:54 -0700 (Sun, 03 Jun 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

We need main.h for main_update_for_unsaved_changes(), regardless of
whether we have pcap or not.

------------------------------------------------------------------------
r43051 | guy | 2012-06-03 19:24:42 -0700 (Sun, 03 Jun 2012) | 11 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.common
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/drag_and_drop.c
   M /trunk/ui/gtk/edit_packet_comment_dlg.c
   M /trunk/ui/gtk/export_sslkeys.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h
   M /trunk/ui/gtk/main_menubar.c
   A /trunk/ui/gtk/main_menubar_private.h
   M /trunk/ui/gtk/menus.h
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/ui/gtk/summary_dlg.c

Have a main_update_for_unsaved_changes() routine that, if changes are
made to the capture file (adding/removing/editing comments, for now) or
if a capture file with unsaved changes are unsaved, updates the menu
bar, the toolbar, *and* the titlebar, which now has a GNOME-style "*" to
indicate unsaved changes.

Make set_menus_for_capture_file() a private interface between main.c and
main_menubar.c, and have its callers, such as
main_update_for_unsaved_changes(), be responsible for updating the
toolbar as well.

------------------------------------------------------------------------
r43050 | wmeier | 2012-06-03 18:09:56 -0700 (Sun, 03 Jun 2012) | 17 lines
Changed paths:
   M /trunk/radius/dictionary.3gpp

From René Scheibe:

"
I just noticed when upgrading from 1.2.15 to 1.6.8 that the file
dictionary.3gpp now contains an invalid entry. There is a typo (3GGP
instead of 3GPP) and the decoding is incorrect too.

wireshark:
ATTRIBUTE   3GGP-IMEISV   20   octets

freeradius:
ATTRIBUTE   3GPP-IMEISV   20   string
"

http://www.wireshark.org/lists/wireshark-dev/201206/msg00021.html


------------------------------------------------------------------------
r43049 | guy | 2012-06-03 16:41:39 -0700 (Sun, 03 Jun 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

set_file_type_list() uses two items from the capture_file structure;
just pass it a pointer to a capture_file structure and have it use them
as it chooses.

------------------------------------------------------------------------
r43048 | guy | 2012-06-03 16:38:11 -0700 (Sun, 03 Jun 2012) | 8 lines
Changed paths:
   M /trunk/file.c

As we might use cf->lnk_t while a capture is in progress, we need up
update it after each burst of packets.  (This is broken - we should have
cf->lnk_t be WTAP_ENCAP_PER_PACKET in all capture file formats that can
handle more than one packet type, and, in order to support writing out
*some* such files in formats that can only handle one packet type, just
use the type of the first packet when doing a one-pass operation and
gather up all the packet types in a multi-pass operation.)

------------------------------------------------------------------------
r43047 | guy | 2012-06-03 15:03:05 -0700 (Sun, 03 Jun 2012) | 9 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/ui/gtk/afp_stat.c
   M /trunk/ui/gtk/camel_srt.c
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/compare_stat.c
   M /trunk/ui/gtk/conversations_table.c
   M /trunk/ui/gtk/dcerpc_stat.c
   M /trunk/ui/gtk/diameter_stat.c
   M /trunk/ui/gtk/expert_comp_dlg.c
   M /trunk/ui/gtk/fc_stat.c
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/ui/gtk/gtp_stat.c
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/gui_utils.h
   M /trunk/ui/gtk/hostlist_table.c
   M /trunk/ui/gtk/io_stat.c
   M /trunk/ui/gtk/ldap_stat.c
   M /trunk/ui/gtk/mac_lte_stat_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_statusbar.c
   M /trunk/ui/gtk/mcast_stream_dlg.c
   M /trunk/ui/gtk/ncp_stat.c
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c
   M /trunk/ui/gtk/rpc_progs.c
   M /trunk/ui/gtk/rpc_stat.c
   M /trunk/ui/gtk/rtp_player.c
   M /trunk/ui/gtk/scsi_stat.c
   M /trunk/ui/gtk/sctp_assoc_analyse.c
   M /trunk/ui/gtk/sctp_byte_graph_dlg.c
   M /trunk/ui/gtk/sctp_chunk_stat_dlg.c
   M /trunk/ui/gtk/sctp_graph_dlg.c
   M /trunk/ui/gtk/smb2_stat.c
   M /trunk/ui/gtk/smb_stat.c
   M /trunk/ui/gtk/tap_param_dlg.c
   M /trunk/ui/gtk/tcp_graph.c
   M /trunk/ui/gtk/voip_calls_dlg.c
   M /trunk/ui/gtk/wlan_stat_dlg.c

g_filename_display_basename() returns a g_mallocated string, so its
callers either need to free it or their callers need to free it or....

This means that cf_get_display_name() must always return a g_mallocated
string and its callers or... must free it.

For some of those callers, create a new set_window_title() routine to do
the work - they're all using the same pattern.

------------------------------------------------------------------------
r43046 | etxrab | 2012-06-03 13:59:41 -0700 (Sun, 03 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dfilter/grammar.lemon
   M /trunk/epan/dfilter/semcheck.c
   M /trunk/epan/dfilter/sttype-test.c

Fix warnings
------------------------------------------------------------------------
r43045 | guy | 2012-06-03 13:39:45 -0700 (Sun, 03 Jun 2012) | 13 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/stock_icons.c
   M /trunk/ui/gtk/stock_icons.h

When allowing the user to save a capture file before closing it, if it's
a live capture:

	have the dialog note that what's being saved are captured
	packets;

	have the dialog note that the capture will be stopped if you
	close/quit;

	actually stop the capture before saving the file or closing it.

This should fix bug 7318 (it appears to do so in my tests).

------------------------------------------------------------------------
r43044 | guy | 2012-06-03 12:31:59 -0700 (Sun, 03 Jun 2012) | 8 lines
Changed paths:
   M /trunk/file.c
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/main_statusbar.c

Use g_filename_display_basename() rather than get_basename() when we're
getting the basename for display purposes, so it's converted from the
GLib/GTK+ locale filename encoding to UTF-8.  (For Windows, the locale
filename encoding is UTF-8, and the internal encoding is UTF-16, so the
file names should *probably* all be valid UTF-8 - Windows may not
support invalid UTF-16 in file names.  For Qt, I'm not sure whether the
file dialogs ever return file names in some non-UTF-8 encoding.)

------------------------------------------------------------------------
r43043 | guy | 2012-06-03 11:48:51 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/file.c

Update a comment.

------------------------------------------------------------------------
r43042 | guy | 2012-06-03 11:40:23 -0700 (Sun, 03 Jun 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_titlebar.h
   M /trunk/ui/ui_util.h

Move the declaration of main_set_window_name() frm ui/ui_util.h to
ui/gtk/main_titlebar.h.

------------------------------------------------------------------------
r43041 | guy | 2012-06-03 11:35:34 -0700 (Sun, 03 Jun 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/CMakeLists.txt
   M /trunk/ui/gtk/Makefile.common
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/gui_utils.h
   M /trunk/ui/gtk/main.c
   A /trunk/ui/gtk/main_titlebar.c
   A /trunk/ui/gtk/main_titlebar.h
   M /trunk/ui/gtk/prefs_gui.c
   M /trunk/ui/gtk/prefs_layout.c
   M /trunk/ui/ui_util.h

Move routines that handle the main window title bar out of
ui/gtk/gui_utils.c into ui/gtk/main_titlebar.c, and the declaration of
one of them out of ui/ui_util.h into ui/gtk/main_titlebar.h, and rename
them to clarify that they work on the window name and titlebar.

------------------------------------------------------------------------
r43040 | etxrab | 2012-06-03 11:03:51 -0700 (Sun, 03 Jun 2012) | 1 line
Changed paths:
   M /trunk/tools/checkAPIs.pl

Add more depricated functions
------------------------------------------------------------------------
r43039 | etxrab | 2012-06-03 11:03:00 -0700 (Sun, 03 Jun 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

Get rid of mor hbox:es
------------------------------------------------------------------------
r43038 | etxrab | 2012-06-03 10:52:05 -0700 (Sun, 03 Jun 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/expert_comp_dlg.c

From Evan Huus: Reset the comment tree when the filter changes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7317
------------------------------------------------------------------------
r43037 | guy | 2012-06-03 10:35:34 -0700 (Sun, 03 Jun 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

Note in a comment that we should perhaps handle safe-saving on top of a
symlink.

------------------------------------------------------------------------
r43036 | guy | 2012-06-03 10:25:08 -0700 (Sun, 03 Jun 2012) | 6 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

gedit, at least, says

	The file "xxx" is read-only.

if you try to save over a file that has no read permission bits.

------------------------------------------------------------------------
r43035 | pascal | 2012-06-03 10:15:21 -0700 (Sun, 03 Jun 2012) | 3 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-glusterfs_hndsk.c

From Niels de Vos via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7324 :
Add support for the Gluster Handshake and Callback RPC-protocols

------------------------------------------------------------------------
r43034 | guy | 2012-06-03 10:08:38 -0700 (Sun, 03 Jun 2012) | 6 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Update a link (that's where it redirected to).

Remove "/en-us" from links; presumably it'll go to the appropriate
country and language for you (or will default to the country and primary
language of Redmond, Washington :-)).

------------------------------------------------------------------------
r43033 | pascal | 2012-06-03 09:49:58 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Convert space to tab

------------------------------------------------------------------------
r43032 | alagoutte | 2012-06-03 09:49:01 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Make checkhf tools Happy, Remove hf_ieee80211_chan*

------------------------------------------------------------------------
r43031 | alagoutte | 2012-06-03 09:47:15 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Add 802.11 AP Channel Report IE (51)

------------------------------------------------------------------------
r43030 | alagoutte | 2012-06-03 09:45:30 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Enhance 802.11 Secondary Channel Offset (62)

------------------------------------------------------------------------
r43029 | alagoutte | 2012-06-03 09:43:19 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Enhance 802.11 HT Info 1.1 (60)

------------------------------------------------------------------------
r43028 | alagoutte | 2012-06-03 09:41:11 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Cleanup Header (Remove e-mail of original author to report bugs...)

------------------------------------------------------------------------
r43027 | alagoutte | 2012-06-03 09:39:55 -0700 (Sun, 03 Jun 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Enhance 802.11 (Vendor Specific) HT Capability (45)
And fix last Dead Store warning found by Clang


------------------------------------------------------------------------
r43026 | guy | 2012-06-03 09:39:27 -0700 (Sun, 03 Jun 2012) | 13 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Update some links (the "[Ff]amily[Ii]d=" links just redirected to the
"id=" links when I last tried them).

There  are apparently both x86 and x86 versions of the VC++ 2005
distributables and, at least for the non-SP1 versions, there's also an
IA64 version.  List them.

If the URLs have the country and language in them, the displaylang= item
doesn't seem to work (tried with both "displaylang=en" and
"displaylang=de" with both "en-us" and "de-de").  Remove it.

Fix some typoes.

------------------------------------------------------------------------
r43025 | alagoutte | 2012-06-03 09:37:56 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Enhance 802.11 (vendor specifiq) HT Info 1.0 (Draft)

------------------------------------------------------------------------
r43024 | pascal | 2012-06-03 09:17:38 -0700 (Sun, 03 Jun 2012) | 3 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-gluster_pmap.c

From Niels de Vos via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7323 :
Add support for the Gluster Portmapper and DUMP RPC-protocols

------------------------------------------------------------------------
r43023 | pascal | 2012-06-03 08:52:15 -0700 (Sun, 03 Jun 2012) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-glusterd.c

From Niels de Vos via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7315 :
Initial support for the GlusterD RPC-protocol

------------------------------------------------------------------------
r43020 | gerald | 2012-06-03 07:03:36 -0700 (Sun, 03 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-06-03]
------------------------------------------------------------------------
r43019 | etxrab | 2012-06-03 02:26:15 -0700 (Sun, 03 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dfilter/dfilter-macro.c
   M /trunk/epan/dfilter/dfilter.c
   M /trunk/epan/dfilter/dfunctions.c
   M /trunk/epan/dfilter/drange.c
   M /trunk/epan/dfilter/gencode.c
   M /trunk/epan/dfilter/semcheck.c
   M /trunk/epan/dfilter/sttype-function.c
   M /trunk/epan/dfilter/sttype-range.c

Try to squelch warnings
------------------------------------------------------------------------
r43018 | pascal | 2012-06-03 01:15:43 -0700 (Sun, 03 Jun 2012) | 6 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Add references to MSVC++ 2008 64-bit redistributables.
Add version numbers for MSVC++ 2010 64-bit redistributables.
--Cette ligne, et les suivantes ci-dessous, seront ignorées--

M    docbook/wsdg_src/WSDG_chapter_tools.xml

------------------------------------------------------------------------
r43017 | guy | 2012-06-03 00:47:20 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Fix end of closing tag.

------------------------------------------------------------------------
r43016 | guy | 2012-06-03 00:07:35 -0700 (Sun, 03 Jun 2012) | 3 lines
Changed paths:
   M /trunk/config.nmake

Default to the version recommended in the Developer's Guide, namely
MSVC++ 2010 Express Edition.

------------------------------------------------------------------------
r43015 | guy | 2012-06-03 00:04:13 -0700 (Sun, 03 Jun 2012) | 2 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Close XML tag.

------------------------------------------------------------------------
r43014 | guy | 2012-06-02 20:55:37 -0700 (Sat, 02 Jun 2012) | 9 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Say "For {compiler}, you need" rather than "For {compiler}, use" - when
discussing VC++ 2010, at least, you may need *both* of them if you'll be
doing both 32-bit and 64-bit builds; hopefully this makes it sound a bit
less like a choice of one or the other but not both.

Get rid of reference to 32-bit builds with MSVC++ 2008 (did it do 64-bit
builds? I didn't see any reference to 64-bit redistributables for it on
the pages for the other redistributables).

------------------------------------------------------------------------
r43013 | guy | 2012-06-02 20:49:05 -0700 (Sat, 02 Jun 2012) | 3 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Mention vcredist_x64.exe in the table, and mark the vcredist_*.exe as
filenames throughout.  Do the same with some other file names.

------------------------------------------------------------------------
r43012 | guy | 2012-06-02 20:32:46 -0700 (Sat, 02 Jun 2012) | 3 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

I don't know what the version number is of the MSVC++ 2010 SP1 x86-64
redistributables.

------------------------------------------------------------------------
r43011 | guy | 2012-06-02 20:24:22 -0700 (Sat, 02 Jun 2012) | 2 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Mention the installers for the 64-bit versions of the redistributables.

------------------------------------------------------------------------
r43010 | guy | 2012-06-02 19:53:36 -0700 (Sat, 02 Jun 2012) | 7 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Indicate what you're supposed to do with vcredist_x86.exe (download it
to the WIRESHARK_LIB_DIR, and don't run it after downloading it).

Indicate that the version of vcredist_x86.exe you download depends not
only on the major version of the VC++ you have but on what service packs
you have.

------------------------------------------------------------------------
r43009 | etxrab | 2012-06-02 16:53:04 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/airpcap_dlg.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/capture_info_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/prefs_dlg.c
   M /trunk/ui/gtk/tcp_graph.c

From Evan Huus Convert a bunch more GTK-2 calls to their cross-version ws_ equivalent
------------------------------------------------------------------------
r43008 | pascal | 2012-06-02 12:20:04 -0700 (Sat, 02 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common

Revert files committed by error in revision 43007

------------------------------------------------------------------------
r43007 | pascal | 2012-06-02 12:15:07 -0700 (Sat, 02 Jun 2012) | 3 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/plugins/docsis/packet-bpkmattr.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7322 :
Add a missing break in packet-bpkmattr.c (CID 280484)

------------------------------------------------------------------------
r43006 | guy | 2012-06-02 11:53:13 -0700 (Sat, 02 Jun 2012) | 7 lines
Changed paths:
   M /trunk/acinclude.m4
   M /trunk/configure.in
   M /trunk/ui/gtk/capture_file_dlg.c

If the user tries to save a capture file atop a file that has all its
write bits turned off or, on 4.4-Lite-based systems, has its "user
immutable" bit turned on, ask them if they really want to overwrite the
file (as those are both used to say "this file is precious, don't let me
easily accidentally trash it") and, if the "user immutable" bit is set,
turn it off first so that the move in the "safe save" won't fail.

------------------------------------------------------------------------
r43005 | guy | 2012-06-02 11:13:12 -0700 (Sat, 02 Jun 2012) | 9 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

The only reason we need to do locale conversions is that path names as
returned by the file selection dialog are in the locale's character
encoding.  Just convert those, and use the formatting capabilities of
the GTK+ message dialog rather than formattting the message to a string
and translating it in its entirety.

Use g_filename_display_basename() to do the locale conversion while
we're at it.

------------------------------------------------------------------------
r43004 | guy | 2012-06-02 10:05:12 -0700 (Sat, 02 Jun 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

Clean up indentation.

------------------------------------------------------------------------
r43003 | guy | 2012-06-02 09:59:47 -0700 (Sat, 02 Jun 2012) | 4 lines
Changed paths:
   M /trunk/file.c

If the rename in a safe "Save As" fails, the current file's name has
*not* changed; what we need to, on Windows, reopen is the *old* file
name, not the name we're saving as.

------------------------------------------------------------------------
r43002 | etxrab | 2012-06-02 08:52:42 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dfilter/dfilter-macro.c
   M /trunk/epan/dfilter/dfunctions.c
   M /trunk/epan/dfilter/dfvm.c

Try to squelch warnings
------------------------------------------------------------------------
r43001 | etxrab | 2012-06-02 08:32:54 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/ftypes/ftype-bytes.c
   M /trunk/epan/ftypes/ftype-integer.c
   M /trunk/epan/ftypes/ftype-pcre.c
   M /trunk/epan/ftypes/ftype-string.c
   M /trunk/epan/ftypes/ftype-tvbuff.c
   M /trunk/epan/ftypes/ftypes.c

Try to squelch warnings
------------------------------------------------------------------------
r43000 | etxrab | 2012-06-02 08:32:34 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/wiretap/erf.c
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/k12.c
   M /trunk/wiretap/k12text.l
   M /trunk/wiretap/ngsniffer.c
   M /trunk/wiretap/pppdump.c
   M /trunk/wiretap/visual.c

Try to squelch warnings
------------------------------------------------------------------------
r42999 | etxrab | 2012-06-02 07:56:18 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/wiretap/ngsniffer.c

Try to squelch warnings
------------------------------------------------------------------------
r42998 | etxrab | 2012-06-02 07:13:14 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/wiretap/catapult_dct2000.c
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/k12.c
   M /trunk/wiretap/lanalyzer.c
   M /trunk/wiretap/netmon.c
   M /trunk/wiretap/netscaler.c
   M /trunk/wiretap/nettl.c
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/pppdump.c

Try to squelch warnings
------------------------------------------------------------------------
r42997 | etxrab | 2012-06-02 06:28:42 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/voip_calls.c

From Evan Huus Memory leak in voip_calls.c https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7320
------------------------------------------------------------------------
r42996 | etxrab | 2012-06-02 06:25:02 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ssh.c

From Evan Huus Useless null check in packet-ssh.c https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7319
------------------------------------------------------------------------
r42995 | rbalint | 2012-06-02 05:57:40 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/Makefile.am.inc

Don't complain about using GNU make extensions during running ./autogen.sh
------------------------------------------------------------------------
r42994 | rbalint | 2012-06-02 05:57:26 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-cipsafety.h
   M /trunk/epan/dissectors/packet-enip.h
   M /trunk/epan/dissectors/packet-lldp.h

Fix header file includes to allow make dumpabi run without errors
------------------------------------------------------------------------
r42993 | etxrab | 2012-06-02 03:11:46 -0700 (Sat, 02 Jun 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/epan/dissectors/packet-nbap.c

Put more mesage names in info col
------------------------------------------------------------------------
r42992 | gerald | 2012-06-01 16:35:32 -0700 (Fri, 01 Jun 2012) | 3 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Fix or remove download links as appropriate. Remove the entry for the
.NET Framework 3.0; it looks like we never really supported it.

------------------------------------------------------------------------
r42991 | morriss | 2012-06-01 14:18:59 -0700 (Fri, 01 Jun 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/packet_info.h
   M /trunk/ui/gtk/decode_as_dlg.c

Only propose decoding PPID 0 if that PPID is in the currently-selected frame.

(I used PPID 0xffffffff as an end-of-list marker so that PPID can no longer
be used in this dialog; if someone starts using that PPID then we'll have
to put a count of PPIDs in pinfo.)

------------------------------------------------------------------------
r42990 | gerald | 2012-06-01 13:54:04 -0700 (Fri, 01 Jun 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Try to be a bit more clear that "lost" is from Wireshark's perspective,
not necessarily one of the TCP endpoints.

------------------------------------------------------------------------
r42989 | pascal | 2012-06-01 13:32:15 -0700 (Fri, 01 Jun 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7316 :
Use correct field type for OUI

------------------------------------------------------------------------
r42988 | morriss | 2012-06-01 12:46:53 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Clean up some indentation (get rid of 4-space tabs) and white space.

------------------------------------------------------------------------
r42987 | morriss | 2012-06-01 12:22:01 -0700 (Fri, 01 Jun 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Remember the 'lower' UDP port information even if we got the UDP packet
non-heuristically.  This prevents us from trying to decode the user's UDP
payload as FP.

(This is a followup/revision to r31113/bug 4218.)

------------------------------------------------------------------------
r42986 | guy | 2012-06-01 12:05:28 -0700 (Fri, 01 Jun 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/wtap.def

Export those file_ routines that Wiretap plugins would use (others
should only be used inside Wiretap).

------------------------------------------------------------------------
r42985 | morriss | 2012-06-01 11:35:20 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

Some code/white space cleanup.
------------------------------------------------------------------------
r42984 | guy | 2012-06-01 11:09:14 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

No more GIOP plugins, no more plugins/giop directory.

------------------------------------------------------------------------
r42983 | guy | 2012-06-01 11:01:42 -0700 (Fri, 01 Jun 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-glusterfs.c

Squelch warning about uninitialized variable (the dataflow analysis
isn't sophisticated enough to know that can't happen).

------------------------------------------------------------------------
r42982 | guy | 2012-06-01 10:26:28 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   M /trunk/configure.in

No more GIOP plugins, no more plugins/giop directory.

------------------------------------------------------------------------
r42981 | guy | 2012-06-01 10:11:00 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi

No more GIOP plugins, no more GIOP loadable DLL.

------------------------------------------------------------------------
r42980 | guy | 2012-06-01 10:10:09 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

No more GIOP plugins, no more GIOP plugin directory.

------------------------------------------------------------------------
r42979 | pascal | 2012-06-01 10:10:03 -0700 (Fri, 01 Jun 2012) | 3 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-gluster.h
   A /trunk/epan/dissectors/packet-glusterfs.c

From Niels de Vos via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7310 :
Initial support for the GlusterFS RPC-protocol

------------------------------------------------------------------------
r42978 | guy | 2012-06-01 10:08:32 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   D /trunk/plugins/giop

No more GIOP plugins, so get rid of the directory for the former plugins.

------------------------------------------------------------------------
r42977 | guy | 2012-06-01 09:55:10 -0700 (Fri, 01 Jun 2012) | 11 lines
Changed paths:
   M /trunk/file.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.h

TShark doesn't need wtap_fdreopen(), as it doesn't do saves and thus
doesn't do safe saves, so wtap_fdreopen() always needs to reopen the
random file descriptor.

At the point where a safe save is done, the sequential read is done, so
the sequential stream is closed; there's no need to reopen it.

(The former fourth argument to wtap_fdreopen() wasn't an indication of
whether the file was compressed, it was an indicationof whether the
random stream should be reopened.)

------------------------------------------------------------------------
r42976 | etxrab | 2012-06-01 08:58:30 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   D /trunk/plugins/giop/packet-coseventcomm.c

Make packet-coseventcomm.c a bultin dissector
------------------------------------------------------------------------
r42975 | etxrab | 2012-06-01 08:57:41 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt

Make packet-coseventcomm.c a bultin dissector
------------------------------------------------------------------------
r42974 | etxrab | 2012-06-01 08:57:05 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-coseventcomm.c (from /trunk/plugins/giop/packet-coseventcomm.c:42972)
   M /trunk/plugins/Makefile.am
   M /trunk/plugins/Makefile.nmake

Make packet-coseventcomm.c a bultin dissector
------------------------------------------------------------------------
r42973 | gerald | 2012-06-01 08:35:29 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   M /trunk/test/config.sh

Add more manufacturer names.

------------------------------------------------------------------------
r42972 | wmeier | 2012-06-01 07:44:35 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   M /trunk/plugins/asn1/Makefile.am
   M /trunk/plugins/docsis/Makefile.am
   M /trunk/plugins/ethercat/Makefile.am
   M /trunk/plugins/giop/Makefile.am
   M /trunk/plugins/gryphon/Makefile.am
   M /trunk/plugins/irda/Makefile.am
   M /trunk/plugins/m2m/Makefile.am
   M /trunk/plugins/mate/Makefile.am
   M /trunk/plugins/opcua/Makefile.am
   M /trunk/plugins/profinet/Makefile.am
   M /trunk/plugins/unistim/Makefile.am
   M /trunk/plugins/wimax/Makefile.am
   M /trunk/plugins/wimaxasncp/Makefile.am

Set Makefile.common as a plugin.c dependency so plugin.c is rebuilt if Makefile.common is changed

------------------------------------------------------------------------
r42971 | wmeier | 2012-06-01 07:08:12 -0700 (Fri, 01 Jun 2012) | 3 lines
Changed paths:
   M /trunk/plugins/asn1/Makefile.nmake
   M /trunk/plugins/docsis/Makefile.nmake
   M /trunk/plugins/ethercat/Makefile.nmake
   M /trunk/plugins/giop/Makefile.nmake
   M /trunk/plugins/gryphon/Makefile.nmake
   M /trunk/plugins/irda/Makefile.nmake
   M /trunk/plugins/m2m/Makefile.nmake
   M /trunk/plugins/mate/Makefile.nmake
   M /trunk/plugins/opcua/Makefile.nmake
   M /trunk/plugins/profinet/Makefile.nmake
   M /trunk/plugins/unistim/Makefile.nmake
   M /trunk/plugins/wimax/Makefile.nmake
   M /trunk/plugins/wimaxasncp/Makefile.nmake

Windows: Set Makefile.common as a plugin.c dependency so plugin.c is rebuilt if Makefile.common is changed
ToDo: ditto for Makefile.am ?

------------------------------------------------------------------------
r42970 | etxrab | 2012-06-01 06:01:32 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

For RLC re-assembly to work we need to fake urnti.
------------------------------------------------------------------------
r42969 | etxrab | 2012-06-01 05:28:05 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Don't call subdissectors if the CRCI bit is set.
------------------------------------------------------------------------
r42968 | etxrab | 2012-06-01 05:27:04 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-cosnaming.c (from /trunk/plugins/giop/packet-cosnaming.c:42965)
   M /trunk/plugins/giop/CMakeLists.txt
   M /trunk/plugins/giop/Makefile.common
   D /trunk/plugins/giop/packet-cosnaming.c

Make the cosnaming dissector a builtin dissector.
------------------------------------------------------------------------
r42967 | etxrab | 2012-06-01 03:31:34 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-tango.c (from /trunk/plugins/giop/packet-tango.c:42965)
   M /trunk/plugins/giop/CMakeLists.txt
   M /trunk/plugins/giop/Makefile.common
   D /trunk/plugins/giop/packet-tango.c

Make the tango dissector a builtin dissector.
------------------------------------------------------------------------
r42966 | etxrab | 2012-06-01 03:26:49 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   M /trunk/file.c

make it compile.
 I suppose we do random access if compressed.
------------------------------------------------------------------------
r42965 | etxrab | 2012-06-01 02:04:28 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/plugins/giop/CMakeLists.txt

parlay changes to Cmake
------------------------------------------------------------------------
r42964 | etxrab | 2012-06-01 01:48:31 -0700 (Fri, 01 Jun 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-parlay.c (from /trunk/plugins/giop/packet-parlay.c:42959)
   M /trunk/plugins/giop/Makefile.common
   D /trunk/plugins/giop/packet-parlay.c

Make the parlay dissector a buil tin dissector.
------------------------------------------------------------------------
r42963 | guy | 2012-06-01 01:45:39 -0700 (Fri, 01 Jun 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.c

Move wtap_fdreopen() to file_access.c for now, as it requires many of
the same #includes.

------------------------------------------------------------------------
r42962 | guy | 2012-06-01 01:33:25 -0700 (Fri, 01 Jun 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap.c

Need fcntl.h for the O_ #defines on Windows.

------------------------------------------------------------------------
r42961 | guy | 2012-06-01 01:05:12 -0700 (Fri, 01 Jun 2012) | 20 lines
Changed paths:
   M /trunk/file.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/file_wrappers.h
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.def
   M /trunk/wiretap/wtap.h

Sigh.  There appears to be no way to get Windows to allow us to rename a
file that we ourselves have open.  In the "safe save" code path for
capture files, on Windows temporarily close the file descriptors for the
currently-open capture before doing the rename and then, if the rename
failed, reopen them, leaving the rest of the wtap and capture_file
structures intact.

Rename filed_open() to file_fdopen(), to make its name match what it
does a bit better (it's an fdopen()-style routine, i.e. do the
equivalent of an open with an already-open file descriptor rather than a
pathname, in the file_wrappers.c set of routines).

Remove the file_ routines from the .def file for Wiretap - they should
only be called by code inside Wiretap.

Closing a descriptor open for input has no reason to fail (closing a
descriptor open for *writing* could fail if the file is on a server and
dirty pages are pushed asynchronously to the server and synchronously on
a close), so just have file_close() return void.

------------------------------------------------------------------------
r42960 | etxrab | 2012-06-01 00:02:04 -0700 (Fri, 01 Jun 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/proto_hier_stats_dlg.c

From Alexander Koeppe.
Patch that creates the filter according to the protocol tree selected.
Fixes
IPv6 filters built from "Protocol Hierarchy Statistics" dialog not specific
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7250
------------------------------------------------------------------------
r42959 | etxrab | 2012-05-31 23:14:08 -0700 (Thu, 31 May 2012) | 1 line
Changed paths:
   M /trunk/epan/conversation.c

Remove debug code left by mistake
------------------------------------------------------------------------
r42958 | etxrab | 2012-05-31 22:55:45 -0700 (Thu, 31 May 2012) | 1 line
Changed paths:
   M /trunk/epan/conversation.c

Fix a couple of warnings
------------------------------------------------------------------------
r42957 | etxrab | 2012-05-31 22:55:20 -0700 (Thu, 31 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/rrc/packet-rrc-template.c
   M /trunk/epan/dissectors/packet-rrc.c

Fix a couple of warnings
------------------------------------------------------------------------
r42956 | etxrab | 2012-05-31 22:36:52 -0700 (Thu, 31 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_mac.c

Fix a couple of warnings
------------------------------------------------------------------------
r42953 | gerald | 2012-05-31 16:34:19 -0700 (Thu, 31 May 2012) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Update the release notes. The new protocol count is now over 100.

------------------------------------------------------------------------
r42952 | gerald | 2012-05-31 14:40:55 -0700 (Thu, 31 May 2012) | 21 lines
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

From Martin Kaiser via bug 7312:

there's three coverity defects about division by zero in ui/cli/tap-iostat.c,
function iostat_packet()

This can be triggered from the command line

martin@greta# ./tshark -z io,stat,0.2,AVG\(frame.number\)
Capturing on eth0
Floating point exception

it->num is 0, wireshark crashes in

parent->max_vals[it->colnum] =                       
MAX(parent->max_vals[it->colnum], it->counter/it->num);

(and similar for other data types)

My proposal for a fix is to not update parent->max_vals[it->colnum] when
it->num==0, see the attached patch.

------------------------------------------------------------------------
r42951 | gerald | 2012-05-31 14:30:40 -0700 (Thu, 31 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-erf.c

g_snprintf → ep_strbuf. I can't find an ERF file with a virtual
container but the conversion seemed be straightforward enough.

------------------------------------------------------------------------
r42950 | morriss | 2012-05-31 14:19:39 -0700 (Thu, 31 May 2012) | 3 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

Look only for calls to strlen() within an snprintf() call (not for any file
that has the string "strlen" somewhere after a call to snprintf()).

------------------------------------------------------------------------
r42949 | pascal | 2012-05-31 13:40:07 -0700 (Thu, 31 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dmx.c

From Erwin Rol via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7311 :
Fix a cut and paste error in packet-dmx.c

------------------------------------------------------------------------
r42948 | gerald | 2012-05-31 13:24:04 -0700 (Thu, 31 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dmx-chan.c

Fix a possible zero division found by scan-build. While we're at it replace
occurrences of g_snprintf+strlen with ep_strbuf.

------------------------------------------------------------------------
r42947 | gerald | 2012-05-31 13:12:27 -0700 (Thu, 31 May 2012) | 3 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

If we're feeding the output of strlen to an snprintf-style function
there's a good chance we're doing something wrong.

------------------------------------------------------------------------
r42946 | pascal | 2012-05-31 11:56:02 -0700 (Thu, 31 May 2012) | 2 lines
Changed paths:
   M /trunk/config.nmake

Use GeoIP package 1.4.8-2 for win64 also (I guess that's what was intended in r42933)

------------------------------------------------------------------------
r42945 | etxrab | 2012-05-31 06:23:42 -0700 (Thu, 31 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Set dir if we don't have it.
------------------------------------------------------------------------
r42944 | pascal | 2012-05-31 06:22:52 -0700 (Thu, 31 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Display hf_smb_server_guid, hf_smb_volume_guid and hf_smb_dfs_referral_server_guid as FT_GUID

------------------------------------------------------------------------
r42943 | etxrab | 2012-05-31 06:09:27 -0700 (Thu, 31 May 2012) | 1 line
Changed paths:
   M /trunk/tools/Makefile.am

Add fix-encoding-args.pl to the distribution.
------------------------------------------------------------------------
r42942 | etxrab | 2012-05-31 05:46:51 -0700 (Thu, 31 May 2012) | 1 line
Changed paths:
   M /trunk/diameter/TGPPRx.xml
   M /trunk/diameter/TGPPSh.xml
   M /trunk/diameter/dictionary.xml
   M /trunk/diameter/imscxdx.xml

Minor updates to the AVP:s
------------------------------------------------------------------------
r42941 | etxrab | 2012-05-31 05:46:09 -0700 (Thu, 31 May 2012) | 1 line
Changed paths:
   M /trunk/tools/wireshark_gen.py

Remove redundant code from the template.
------------------------------------------------------------------------
r42940 | pascal | 2012-05-31 01:56:19 -0700 (Thu, 31 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

From Niels de Vos via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7306 :
RPC: show the AUTH_GLUSTERFS/lk_owner as hex

------------------------------------------------------------------------
r42939 | pascal | 2012-05-31 01:25:00 -0700 (Thu, 31 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7307

------------------------------------------------------------------------
r42938 | pascal | 2012-05-31 01:08:44 -0700 (Thu, 31 May 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

Clean GeoIP-1.4.8-*-win??ws folder with setup target

------------------------------------------------------------------------
r42937 | etxrab | 2012-05-31 00:25:11 -0700 (Thu, 31 May 2012) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ipv6.c

From Sheetal Kshirsagar and Andrew Williams:
Updating the RPL SRH dissector and implementing RPL Options header dissection.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6986
------------------------------------------------------------------------
r42936 | etxrab | 2012-05-30 22:42:02 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-adwin.c

Try to squelch a couple of warnings
------------------------------------------------------------------------
r42935 | gerald | 2012-05-30 16:14:07 -0700 (Wed, 30 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/prefs.c

Add some needed parenthesis as pointed out by Jakub and the OS X
builders.

------------------------------------------------------------------------
r42933 | gerald | 2012-05-30 15:55:02 -0700 (Wed, 30 May 2012) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/tools/win32-setup.sh
   M /trunk/tools/win64-setup.sh

Use the updated GeoIP package (1.4.8-2).

------------------------------------------------------------------------
r42932 | darkjames | 2012-05-30 15:39:56 -0700 (Wed, 30 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-jxta.c

Revert r42853, cleanup packet-jxta which might really fix CID 280210

References: http://www.wireshark.org/lists/wireshark-dev/201205/msg00226.html

------------------------------------------------------------------------
r42930 | gerald | 2012-05-30 14:42:24 -0700 (Wed, 30 May 2012) | 10 lines
Changed paths:
   M /trunk/epan/prefs.c
   M /trunk/test/suite-capture.sh

In recent versions of GLib (test with 2.32) g_log_default_handler
helpfully ignores G_LOG_LEVEL_INFO and G_LOG_LEVEL_DEBUG messages by
default. If the console_log_level preference includes either of those
two levels set the G_MESSAGES_DEBUG environment variable so that those
messages are printed.

Add checks for various console log messages to the stdin capture suite.

Fixes bug 7265.

------------------------------------------------------------------------
r42929 | morriss | 2012-05-30 14:32:32 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/Makefile.am

The GIOP plugin is now one big plugin (instead of 2, or was it 4?).
------------------------------------------------------------------------
r42928 | etxrab | 2012-05-30 13:51:36 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/plugins/giop/Makefile.am

Dissable -Werror
------------------------------------------------------------------------
r42927 | etxrab | 2012-05-30 12:51:54 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/plugins/giop/Makefile.am

Forgot to change the name to giop
------------------------------------------------------------------------
r42926 | etxrab | 2012-05-30 12:03:56 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi

Replace IDL generated dissector with common dll
------------------------------------------------------------------------
r42925 | etxrab | 2012-05-30 12:02:53 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/tools/wireshark_gen.py

Modify IDL generated plugin interface (untested)
------------------------------------------------------------------------
r42924 | etxrab | 2012-05-30 12:01:29 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/plugins/giop/Makefile.am
   A /trunk/plugins/giop/Makefile.common
   M /trunk/plugins/giop/Makefile.nmake
   A /trunk/plugins/giop/moduleinfo.nmake
   M /trunk/plugins/giop/packet-coseventcomm.c
   M /trunk/plugins/giop/packet-cosnaming.c
   M /trunk/plugins/giop/packet-parlay.c
   M /trunk/plugins/giop/packet-tango.c
   A /trunk/plugins/giop/plugin.rc.in

Add files to use 'new plugin build style'
------------------------------------------------------------------------
r42923 | morriss | 2012-05-30 11:29:37 -0700 (Wed, 30 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

From Richard Sharpe on -dev:

Attached is a patch that fixes (I think) the handling of extended
responses on NTCreate&X requests.

------------------------------------------------------------------------
r42922 | pascal | 2012-05-30 11:27:40 -0700 (Wed, 30 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c

Prefix TransportFormatSet_type_enum values with NBAP_ to avoid a clash with 'PCH' in <WinNT.h>

------------------------------------------------------------------------
r42921 | cmaynard | 2012-05-30 10:26:00 -0700 (Wed, 30 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Mark pinfo as unused.  Change args to proto_tree_add_text().

------------------------------------------------------------------------
r42920 | cmaynard | 2012-05-30 10:02:44 -0700 (Wed, 30 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

PPP CCP improvements.  And yay, checkAPIs no longer complains about the number of useless add_text()'s since the ratio is finally below 50%.  This ratio should continue to drop as more and more fields become filterable.

------------------------------------------------------------------------
r42919 | gerald | 2012-05-30 08:36:48 -0700 (Wed, 30 May 2012) | 3 lines
Changed paths:
   M /trunk/config.nmake

Revert GEOIP_CFLAGS back to r42905. It looks like the builders picked up
the wrong archive yesterday before I had a chance to upload the right one.

------------------------------------------------------------------------
r42918 | cmaynard | 2012-05-30 08:30:07 -0700 (Wed, 30 May 2012) | 2 lines
Changed paths:
   M /trunk/config.nmake

Ugh.  Fix GEOIP_CFLAGS again.  3rd time's the charm?

------------------------------------------------------------------------
r42917 | cmaynard | 2012-05-30 08:05:21 -0700 (Wed, 30 May 2012) | 2 lines
Changed paths:
   M /trunk/config.nmake

Try it with Windows style path separator instead.

------------------------------------------------------------------------
r42916 | cmaynard | 2012-05-30 07:33:00 -0700 (Wed, 30 May 2012) | 2 lines
Changed paths:
   M /trunk/config.nmake

Fix GEOIP_CFLAGS so GeoIP.h can be found.

------------------------------------------------------------------------
r42915 | etxrab | 2012-05-30 07:04:45 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Stab at DCH 31 dissection.
------------------------------------------------------------------------
r42914 | etxrab | 2012-05-30 04:48:05 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/asn1/rrc/rrc.cnf
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-rrc.c
   M /trunk/epan/dissectors/packet-rrc.h

Dissect non segmented MiB and SiB:s
------------------------------------------------------------------------
r42913 | pascal | 2012-05-30 01:49:56 -0700 (Wed, 30 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/lte-rrc/lte-rrc.cnf
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/epan/dissectors/packet-lte-rrc.c

Use ett variable for proto_item_add_subtree function call

------------------------------------------------------------------------
r42912 | etxrab | 2012-05-30 01:41:00 -0700 (Wed, 30 May 2012) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Add an application id.
------------------------------------------------------------------------
r42911 | darkjames | 2012-05-29 23:44:37 -0700 (Tue, 29 May 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/hostlist_table.c

Fix part of bug #4030

GeoIP strings from r39299 are encoded in UTF-8 so don't use format_text.

------------------------------------------------------------------------
r42910 | darkjames | 2012-05-29 23:13:12 -0700 (Tue, 29 May 2012) | 3 lines
Changed paths:
   M /trunk/AUTHORS

Fix make-authors-short.pl warning:
  Use of uninitialized value $nextline in pattern match (m//) at ./make-authors-short.pl line 23, <> line 3660

------------------------------------------------------------------------
r42909 | darkjames | 2012-05-29 22:39:39 -0700 (Tue, 29 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Fix bug #5077 in IPv6.

------------------------------------------------------------------------
r42908 | darkjames | 2012-05-29 22:33:37 -0700 (Tue, 29 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Cleanup geoip support in ipv6.

------------------------------------------------------------------------
r42907 | gerald | 2012-05-29 17:11:11 -0700 (Tue, 29 May 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

Back out previous change.

------------------------------------------------------------------------
r42906 | gerald | 2012-05-29 17:04:03 -0700 (Tue, 29 May 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

Extract into the right directory.

------------------------------------------------------------------------
r42905 | gerald | 2012-05-29 16:31:00 -0700 (Tue, 29 May 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi
   M /trunk/tools/win32-setup.sh
   M /trunk/tools/win64-setup.sh

Use GeoIP 1.4.8 which includes a DLL instead of a static library.

------------------------------------------------------------------------
r42904 | pascal | 2012-05-29 14:51:52 -0700 (Tue, 29 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c
   M /trunk/epan/dissectors/packet-ntlmssp.c

Avoid using C99 '%hh' length modifier

------------------------------------------------------------------------
r42903 | pascal | 2012-05-29 14:36:39 -0700 (Tue, 29 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dvb-ait.c
   M /trunk/epan/dissectors/packet-mpeg-sect.c
   M /trunk/epan/dissectors/packet-mpeg-sect.h

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7301:
Dissector for DVB Application Information Table (AIT)

------------------------------------------------------------------------
r42902 | pascal | 2012-05-29 14:09:46 -0700 (Tue, 29 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iso7816.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7302:
Small updates to ISO 7816 dissector

------------------------------------------------------------------------
r42901 | pascal | 2012-05-29 13:28:41 -0700 (Tue, 29 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7303
Remove unnecessary null checks before calling proto_item_set_len() in DVB-CI dissector

------------------------------------------------------------------------
r42900 | darkjames | 2012-05-29 13:27:22 -0700 (Tue, 29 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gadu-gadu.c

Fix bug #7304, stupid mistake.

------------------------------------------------------------------------
r42899 | darkjames | 2012-05-29 13:01:25 -0700 (Tue, 29 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

Fix bug #5735

dissect_attribute_value_pairs() should be also called with NULL tree.
Broken from r29964.

------------------------------------------------------------------------
r42898 | etxrab | 2012-05-29 07:34:34 -0700 (Tue, 29 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_mac.c

Handle E-DCH
------------------------------------------------------------------------
r42897 | sahlberg | 2012-05-29 04:25:38 -0700 (Tue, 29 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi-sbc.c
   M /trunk/epan/dissectors/packet-scsi.h

SCSI SBC: Add dissection of GET_LBA_STATUS command


------------------------------------------------------------------------
r42896 | etxrab | 2012-05-29 01:23:10 -0700 (Tue, 29 May 2012) | 4 lines
Changed paths:
   M /trunk/radius/dictionary.starent

From Porus Mehta:
Wireshark's RADIUS dictionaries for Starent need an update.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6243
------------------------------------------------------------------------
r42895 | etxrab | 2012-05-29 01:00:35 -0700 (Tue, 29 May 2012) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-arp.c

From Deepti Ragha:
Additions to the ARP dissector as per the IANA specifications for ARP

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7216
------------------------------------------------------------------------
r42894 | etxrab | 2012-05-29 00:45:40 -0700 (Tue, 29 May 2012) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ldp.c
   M /trunk/epan/dissectors/packet-mpls.c

From Aditya Ambadkar and Diana Chris:
Enhancement to LDP dissector to support changes proposed in RFC6391 - flow aware transport of PW over an MPLS PSN.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7046
------------------------------------------------------------------------
r42893 | etxrab | 2012-05-29 00:31:38 -0700 (Tue, 29 May 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

From Evan Huus:
Fix to
BACapp item length causes Buildbot crash output: randpkt-2011-04-13-1899.pcap

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5825

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7296
------------------------------------------------------------------------
r42892 | etxrab | 2012-05-29 00:27:35 -0700 (Tue, 29 May 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/update.c

From Evan Huus:
Misc resource leaks.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7296
------------------------------------------------------------------------
r42891 | guy | 2012-05-28 18:18:16 -0700 (Mon, 28 May 2012) | 5 lines
Changed paths:
   M /trunk/file.c

Test was backwards - if fname_new is *NON*-null, it was the name of a
temporary file to which we were writing in order to do a "safe save". 
Thanks to Coverity for pointing this out - should fix CIDs 703317 and
703316.

------------------------------------------------------------------------
r42890 | guy | 2012-05-28 17:05:39 -0700 (Mon, 28 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dmx.c

From Erwin Rol: fix a copy-and-paste leftover.

------------------------------------------------------------------------
r42889 | pascal | 2012-05-28 13:34:27 -0700 (Mon, 28 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-rlc.c
   M /trunk/epan/dissectors/packet-rlc.h
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Keep backward compatibility with UDP framing format for UMTS RLC dissector
Fix a few typo errors while we are at it

------------------------------------------------------------------------
r42888 | etxrab | 2012-05-28 13:11:59 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_mac.c

Use C/T as rbid
------------------------------------------------------------------------
r42887 | etxrab | 2012-05-28 13:09:00 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/rrc/packet-rrc-template.c
   M /trunk/asn1/rrc/rrc.cnf
   M /trunk/epan/dissectors/packet-rrc.c

Use ett instead of hf variable
------------------------------------------------------------------------
r42886 | cmaynard | 2012-05-28 11:37:10 -0700 (Mon, 28 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/ui/gtk/io_stat.c

Fix Coverity CID's 702388 and 702422: OVERFLOW_BEFORE_WIDEN.

------------------------------------------------------------------------
r42885 | etxrab | 2012-05-28 10:55:47 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-artnet.c

Set but not used variable
------------------------------------------------------------------------
r42884 | etxrab | 2012-05-28 09:00:20 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-artnet.c

Remove C++ style comments initilize some variables.
------------------------------------------------------------------------
r42883 | darkjames | 2012-05-28 08:59:00 -0700 (Mon, 28 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-gssapi.c
   M /trunk/epan/proto.c
   M /trunk/epan/strutil.c

While iterating over string characters don't use strlen(), but check for NUL.

------------------------------------------------------------------------
r42882 | etxrab | 2012-05-28 08:30:09 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dmx.c

Set SVN properties.
------------------------------------------------------------------------
r42881 | etxrab | 2012-05-28 08:29:36 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dmx-chan.c
   M /trunk/epan/dissectors/packet-dmx-sip.c
   M /trunk/epan/dissectors/packet-dmx-test.c
   M /trunk/epan/dissectors/packet-dmx-text.c

Set SVN properties.
------------------------------------------------------------------------
r42880 | etxrab | 2012-05-28 08:24:54 -0700 (Mon, 28 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-artnet.c
   A /trunk/epan/dissectors/packet-dmx-chan.c
   A /trunk/epan/dissectors/packet-dmx-sip.c
   A /trunk/epan/dissectors/packet-dmx-test.c
   A /trunk/epan/dissectors/packet-dmx-text.c
   A /trunk/epan/dissectors/packet-dmx.c
   M /trunk/epan/dissectors/packet-rdm.c

From Erwin Rol:
Artnet, RDM and DMX dissector updates

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7286
------------------------------------------------------------------------
r42879 | etxrab | 2012-05-28 08:09:33 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-rlc.c

Extend the switch statement.
------------------------------------------------------------------------
r42878 | etxrab | 2012-05-28 07:50:54 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-rlc.h
   M /trunk/epan/dissectors/packet-umts_fp.h

Move defenition of rlc_mode.
------------------------------------------------------------------------
r42877 | etxrab | 2012-05-28 06:53:33 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c

Try to pacify the Ubuntu buildbot.
------------------------------------------------------------------------
r42876 | etxrab | 2012-05-28 06:38:40 -0700 (Mon, 28 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-rlc.c
   M /trunk/epan/dissectors/packet-rlc.h
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Enhance CHANNEL_HSDSCH dissection.
------------------------------------------------------------------------
r42875 | sahlberg | 2012-05-28 02:40:54 -0700 (Mon, 28 May 2012) | 7 lines
Changed paths:
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-ldap.c

Sometimes you might have plaintext LDAP for a SASL LDAP connection if the handshake never occured.

Observed with exchange in some configurations.

From Matthieu Patou <mat@matws.net>


------------------------------------------------------------------------
r42874 | guy | 2012-05-27 18:23:28 -0700 (Sun, 27 May 2012) | 9 lines
Changed paths:
   M /trunk/summary.c

That doesn't work correctly if we read in a file with no interface
information, as it'll fill in whatever stuff happens to be in the
capture info.  We should somehow figure uot whether this is a capture we
just did (note: cf->is_tempfile does *NOT* necessarily tell us that, as
it's set for the result of a merge, and is cleared if we save the
capture) and fill in the interface information only if that's the case.

Put in a comment to note that we need to do that.

------------------------------------------------------------------------
r42873 | guy | 2012-05-27 18:17:48 -0700 (Sun, 27 May 2012) | 13 lines
Changed paths:
   M /trunk/summary.c

Correctly implement what was my intent when removing the HAVE_LIBPCAP
stuff - arrange that the interface summary list is set, if we've read a
capture file that has interface information, *regardless* of whether we
have libpcap/WinPcap or not.

That means that summary_fill_in() should fill in the interface
information for the summary if there's interface information from the
capture file, and summary_fill_in_capture() - which is called only if
HAVE_LIBPCAP is defined, and can exist only if HAVE_LIBPCAP is defined
(as it takes an argument of a type that's defined only if HAVE_LIBPCAP
is defined) - just fills in interface information from the capture
options and does so only if there's none from the file.

------------------------------------------------------------------------
r42872 | guy | 2012-05-27 17:43:13 -0700 (Sun, 27 May 2012) | 10 lines
Changed paths:
   M /trunk/wiretap/libpcap.c

Interface lists currently have to be constructed in the open routine
(otherwise, nobody sees them); do so.

Fix some cases where we weren't doing the proper post-processing after
doing the heuristics for format changes that didn't involve magic-number
changes (discovered because constructing the interface list is now being
done as part of that post-processing).

Fixes bug 7287.

------------------------------------------------------------------------
r42871 | guy | 2012-05-27 17:31:27 -0700 (Sun, 27 May 2012) | 11 lines
Changed paths:
   M /trunk/summary.c
   M /trunk/summary.h
   M /trunk/ui/gtk/summary_dlg.c

Don't use pcap LINKTYPE_ values in the iface_options structure, use
Wiretap encapsulation values; rename the field in question encap_type to
emphasize that.  (Code that looks at that field already assumes it's a
Wiretap encapsulation value.)

For live captures, map the LINKTYPE_ value to a Wiretap encapsulation
value.

wtap_encap_string() never returns NULL, so don't check for a null return
value.

------------------------------------------------------------------------
r42870 | guy | 2012-05-27 16:50:14 -0700 (Sun, 27 May 2012) | 2 lines
Changed paths:
   M /trunk/summary.h

Clean up indentation (use spaces, not tabs).

------------------------------------------------------------------------
r42869 | guy | 2012-05-27 16:41:03 -0700 (Sun, 27 May 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap.h

Clean up indentation (remove tabs from one structure definition).

------------------------------------------------------------------------
r42868 | guy | 2012-05-27 16:32:12 -0700 (Sun, 27 May 2012) | 2 lines
Changed paths:
   M /trunk/summary.c

Clean up indentation (use spaces, not tabs).

------------------------------------------------------------------------
r42867 | guy | 2012-05-27 13:47:57 -0700 (Sun, 27 May 2012) | 6 lines
Changed paths:
   M /trunk/ui/gtk/airpcap_gui_utils.c

From Evan Huus in bug 7295:

cppcheck realized that if_info is known not to be null in that code
path, and therefore that checking whether it's null in that code path is
unnecessary.  Remove it.

------------------------------------------------------------------------
r42866 | guy | 2012-05-27 13:45:16 -0700 (Sun, 27 May 2012) | 6 lines
Changed paths:
   M /trunk/ui/gtk/dfilter_expr_dlg.c

From Evan Huus from bug 7295:

Fix an ancient copy-and-pasteo of mine ("me" here meaning Guy Harris,
not Evan Huus) - remove an unused data structure (used in the code I
copied and pasted to make this code, not used here).

------------------------------------------------------------------------
r42865 | guy | 2012-05-27 13:40:09 -0700 (Sun, 27 May 2012) | 14 lines
Changed paths:
   M /trunk/wiretap/vwr.c

vwr_read_rec_header()'s return value is used only to distinguish success
(read a record header) from failure (got an EOF or an error).  Make it
just return a Boolean.

If it fails in vwr_read(), don't overwrite *err_info (yes,
vwr_read_rec_header() might have set *err_info, so don't lose - and
leak! - the value it returned) - trust vwr_read_rec_header(), or the
routines it calls, to have set it.  (If there's a code path where that
doesn't happen, that code path needs to be fixed; the setting of
*err_info in vwr_read() should *not* be restored.)

Thanks to Evan Huus for finding a useless variable with cppcheck, and
reporting it in bug 7295, provoking me to look at this.

------------------------------------------------------------------------
r42862 | gerald | 2012-05-27 07:03:33 -0700 (Sun, 27 May 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-05-27]
------------------------------------------------------------------------
r42861 | jmayer | 2012-05-27 03:15:56 -0700 (Sun, 27 May 2012) | 7 lines
Changed paths:
   M /trunk/macosx-setup.sh
   M /trunk/macosx-support-lib-patches/gnutls-pkgconfig.patch

- Update cmake, gnutls and pixman to current version
- unpack an xz file with xzcat instead of gzcat
- remove some trailing whitespace
- the update of gnutls required two changes in the gnutls
  build stuff: a) gnutls.pc is now generated from gnutls.pc.in
  and b) we now need to build with --without-p11-kit

------------------------------------------------------------------------
r42860 | guy | 2012-05-25 17:53:50 -0700 (Fri, 25 May 2012) | 2 lines
Changed paths:
   M /trunk/file.c

I already got rid of that variable - it just mirrors cf->filename.

------------------------------------------------------------------------
r42859 | guy | 2012-05-25 17:44:49 -0700 (Fri, 25 May 2012) | 6 lines
Changed paths:
   M /trunk/file.c

We can't save a live capture file with a ws_rename() on Windows, as we
have the file open.  Go back to doing it with a copy on Windows.

Explain what the problem is, and give a way in which we might be able to
make it work on Windows (without using any NT native API calls...).

------------------------------------------------------------------------
r42857 | guy | 2012-05-25 14:58:10 -0700 (Fri, 25 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

See if this fixes the include problem.

------------------------------------------------------------------------
r42856 | guy | 2012-05-25 14:52:50 -0700 (Fri, 25 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Fix some build problems.

------------------------------------------------------------------------
r42855 | guy | 2012-05-25 14:25:55 -0700 (Fri, 25 May 2012) | 8 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.h
   M /trunk/ui/gtk/drag_and_drop.c
   M /trunk/ui/gtk/export_sslkeys.c
   M /trunk/ui/gtk/file_import_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/main_proto_draw.c
   M /trunk/ui/gtk/main_toolbar.c
   M /trunk/ui/gtk/print_dlg.c
   M /trunk/ui/win32/file_dlg_win32.c
   M /trunk/ui/win32/file_dlg_win32.h

Use GTK+'s GtkMessageDialog for the questions we ask in the process of
saving files, and run it modal (which we're already doing with the
GtkFileChooserDialog); this means less callback-based state machine
stuff, simplifying the code paths a bit.

If we're saving a file before closing it, don't bother reloading it
after saving it.

------------------------------------------------------------------------
r42854 | guy | 2012-05-25 11:50:47 -0700 (Fri, 25 May 2012) | 6 lines
Changed paths:
   M /trunk/merge.c

On a read error, always return a pointer to the merge_in_file_t for the
file from which we got the error.

On a successful read, always clear out err - wtap_read() doesn't set *err
on success.

------------------------------------------------------------------------
r42853 | gerald | 2012-05-25 11:25:31 -0700 (Fri, 25 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-jxta.c

Add a null check to fix Coverity CID 280210. It doesn't look like we'd
run into this in the wild.

------------------------------------------------------------------------
r42851 | guy | 2012-05-25 02:58:42 -0700 (Fri, 25 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/export_sslkeys.c
   M /trunk/ui/gtk/main_proto_draw.c
   M /trunk/ui/gtk/print_dlg.c

Well, "ui/gtk/capture_file_dlg.h" is needed on Win32.

------------------------------------------------------------------------
r42850 | guy | 2012-05-25 02:26:45 -0700 (Fri, 25 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/export_sslkeys.c
   M /trunk/ui/gtk/main_proto_draw.c
   M /trunk/ui/gtk/prefs_print.c
   M /trunk/ui/gtk/print_dlg.c

ui/gtk/capture_file_dlg.h doesn't need to be included in these files.

------------------------------------------------------------------------
r42849 | cmaynard | 2012-05-24 19:51:23 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-hello.c

Fix Coverity CID 700177 Unused pointer value.

------------------------------------------------------------------------
r42848 | cmaynard | 2012-05-24 19:43:39 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-beep.c

The rest of the fix for Coverity CID's 280507 and 280508.  (There were multiple occurrences grouped into the 2 CID's, but I hadn't noticed them all.)

------------------------------------------------------------------------
r42847 | cmaynard | 2012-05-24 19:18:49 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-beep.c

tvb_length_remaining() can return a negative number, so be sure to handle it.  Fixes Coverity CID's 280507 and 280508.

------------------------------------------------------------------------
r42846 | cmaynard | 2012-05-24 19:04:29 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/netscaler.c

In ns_hrtime2nsec(), cast "val" to guint64 to fix Coverity CID 702389 Unintentional integer overflow.

------------------------------------------------------------------------
r42845 | cmaynard | 2012-05-24 18:49:49 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Add a "fallthrough" comment to avoid a missing break report from Coverity.  Fixes Coverity CID 702382 Missing break in switch.

------------------------------------------------------------------------
r42844 | cmaynard | 2012-05-24 18:32:26 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

In cap_pipe_open_live(), be sure to call ws_close(fd) before returning due to a couple of error condtions.  Fixes Coverity CID 702395 Resource leak.

------------------------------------------------------------------------
r42843 | cmaynard | 2012-05-24 18:14:29 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-pipe.c

Fix Coverity CID 701035: Dereference after null check of hfinfo.

------------------------------------------------------------------------
r42842 | cmaynard | 2012-05-24 17:54:49 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c

Fix Coverity CID 700201: Dereference after null check, by ensuring "decoder" is not NULL before passing it to ssl_decrypt_record().

------------------------------------------------------------------------
r42841 | cmaynard | 2012-05-24 17:43:32 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/decode_as_dlg.c

If either create_persconffile_dir() or ws_fopen() fail, then bail out.  This avoids potentially dereferencing "daf" if it's NULL and fixes Coverity CID 281275.

------------------------------------------------------------------------
r42840 | cmaynard | 2012-05-24 17:29:46 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/c1222/packet-c1222-template.c
   M /trunk/epan/dissectors/packet-c1222.c

tvb_length_remaining() can return a negative number, so be sure to handle it.  Fixes Coverity CID 281367.

------------------------------------------------------------------------
r42839 | cmaynard | 2012-05-24 16:35:23 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-snmp.c

tvb_length_remaining() can return a negative number, so be sure to handle it.  Fixes Coverity CID's 280233-280235.

------------------------------------------------------------------------
r42838 | cmaynard | 2012-05-24 16:31:38 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pres.c

Update asn1-generated dissector.

------------------------------------------------------------------------
r42837 | cmaynard | 2012-05-24 16:14:30 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gadu-gadu.c

tvb_reported_length_remaining() can return a negative number.  In dissect_gadu_gadu_userlist80_compressed(), bail out if it does.  Fixes Coverity CID 703085.  In dissect_gadu_gadu_stringz_cp1250(), be sure to compare against its return value as being only positve rather than non-zero.  Also, fixed a couple of typos.

------------------------------------------------------------------------
r42836 | morriss | 2012-05-24 14:38:22 -0700 (Thu, 24 May 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Don't include a Clear button in the packet- and capture-file-comment dialogs:
the user can just Ctrl-A + backspace if they want to do that.

------------------------------------------------------------------------
r42835 | morriss | 2012-05-24 14:35:41 -0700 (Thu, 24 May 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c
   M /trunk/ui/gtk/summary_dlg.c

Enable word wrapping for capture-file comments.
------------------------------------------------------------------------
r42834 | morriss | 2012-05-24 14:33:25 -0700 (Thu, 24 May 2012) | 17 lines
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

Get rid of the button row for the capture-file comments.  Instead, turn the
whole summary dialog into an editor-like dialog with an OK and Cancel buttons
(OK sets the new capture file comment, Cancel doesn't).

In order to keep the dialog the same regardless of the file type (and avoid
having a Cancel and OK button when there's no text field to edit), allow
users to create or edit capture-file comments even if the file type is not
PCAPNG (they can add a comment via the add/edit comment UI anyway).

Don't include a Clear button: the user can just Ctrl-A + backspace if they
want to do that.

Don't set the comment text to "[None]" if there's no comment, just leave it
blank.

Don't allow the user to create more than 1 Summary dialog at a time.

------------------------------------------------------------------------
r42833 | guy | 2012-05-24 12:18:31 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Word-wrap comments in the display.

------------------------------------------------------------------------
r42832 | morriss | 2012-05-24 11:59:39 -0700 (Thu, 24 May 2012) | 5 lines
Changed paths:
   M /trunk/summary.c
   M /trunk/summary.h
   M /trunk/ui/gtk/summary_dlg.c

Use cf_update_capture_comment() to save the capture comment (instead of
summary_update_comment() which is no longer necessary).
cf_update_capture_comment() has the advantage that it doesn't mark the file
as unsaved unless the comment actually changed.

------------------------------------------------------------------------
r42831 | morriss | 2012-05-24 11:55:38 -0700 (Thu, 24 May 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

Free the new comment after calling gtk_text_buffer_set_text().
------------------------------------------------------------------------
r42830 | morriss | 2012-05-24 11:54:03 -0700 (Thu, 24 May 2012) | 1 line
Changed paths:
   M /trunk/file.c

cf_update_capture_comment(): free the shb_inf when we're done with it.
------------------------------------------------------------------------
r42829 | morriss | 2012-05-24 11:26:52 -0700 (Thu, 24 May 2012) | 6 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

menu_dissector_filter(): free the action_name when we're done with it.

capture_cb(): if we strrchr() didn't find a seperator, don't use
g_strdup_printf() to format the action_name (since that would have to be
freed), just set it to the action_name.

------------------------------------------------------------------------
r42828 | morriss | 2012-05-24 11:11:55 -0700 (Thu, 24 May 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Free the comment after calling gtk_text_buffer_set_text().
------------------------------------------------------------------------
r42827 | morriss | 2012-05-24 08:16:18 -0700 (Thu, 24 May 2012) | 7 lines
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

Also allow the user to edit the capture-file comment if there is one (not
only if the capture file format is PCAPNG).  This can happen if the user
does not have a PCAPNG file but has added a capture-file comment via the
add/edit capture file comment UI.

Replace some tabs with spaces and wrap a few long lines.

------------------------------------------------------------------------
r42826 | morriss | 2012-05-24 07:52:06 -0700 (Thu, 24 May 2012) | 5 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

Followup to r42823: check for RVALS used without BASE_RANGE_STRING.

Also: identify problematic fields by hf_variable_name instead of name or
abbreviation (the variable name is sure to be unique).

------------------------------------------------------------------------
r42825 | darkjames | 2012-05-24 05:26:34 -0700 (Thu, 24 May 2012) | 4 lines
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-snmp.c

Fix bug #7283

When Engine ID is 128 we should only break when we know the enterprise id.

------------------------------------------------------------------------
r42824 | etxrab | 2012-05-24 02:24:05 -0700 (Thu, 24 May 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/erf.c
   M /trunk/wiretap/erf.h
   M /trunk/wiretap/libpcap.c

From Stephen Donnelly:
Add frame.interface_id support for pcap DLT_ERF file format

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7281
------------------------------------------------------------------------
r42823 | etxrab | 2012-05-24 02:17:11 -0700 (Thu, 24 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn3270.c
   M /trunk/epan/dissectors/packet-usb-hid.c

From Martin Kaiser:
RVALS() needs BASE_RANGE_STRING 

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7282
------------------------------------------------------------------------
r42822 | guy | 2012-05-24 00:51:39 -0700 (Thu, 24 May 2012) | 6 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

Now that cf_save_packets() can avoid doing a "fast path" save if the
source isn't compressed and the target is (or vice versa), enable the
"compressed" checkbox in the Save As and Export Specified Packets
dialog.  Fix it to clear the checkbox if the selected file format
doesn't support gzipping.

------------------------------------------------------------------------
r42821 | darkjames | 2012-05-24 00:50:41 -0700 (Thu, 24 May 2012) | 5 lines
Changed paths:
   M /trunk/AUTHORS

Cleanup AUTHORS file.

- Merge duplicated entries for: Dominic Bechaz, Holger Hans Peter Freyther 
- Remove duplicated entry for: Shiang-Ming Huang

------------------------------------------------------------------------
r42820 | etxrab | 2012-05-23 23:56:04 -0700 (Wed, 23 May 2012) | 4 lines
Changed paths:
   M /trunk/AUTHORS

From Mayuresh Raut.
Addition of DDMAP TLV and Downstream FEC stack change sub-TLV to DDMAP [RFC 6424]

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7006
------------------------------------------------------------------------
r42819 | etxrab | 2012-05-23 23:55:18 -0700 (Wed, 23 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls-echo.c

From Mayuresh Raut.
Addition of DDMAP TLV and Downstream FEC stack change sub-TLV to DDMAP [RFC 6424]

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7006
------------------------------------------------------------------------
r42818 | guy | 2012-05-23 22:05:29 -0700 (Wed, 23 May 2012) | 8 lines
Changed paths:
   M /trunk/capinfos.c
   M /trunk/cfile.h
   M /trunk/file.c
   M /trunk/summary.c
   M /trunk/summary.h
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/summary_dlg.c
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/file_wrappers.h
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.def
   M /trunk/wiretap/wtap.h

Keep track, in Wiretap, of whether the file is compressed, and provide
an API to fetch that.

When doing "Save" on a compressed file, write it out compressed.

In the Statistics -> Summary dialog and in capinfos, report whether the
file is gzip-compressed.

------------------------------------------------------------------------
r42817 | guy | 2012-05-23 19:30:43 -0700 (Wed, 23 May 2012) | 3 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

We have to tell cf_save_packets() whether to save them in compressed
form; say "don't" for now.

------------------------------------------------------------------------
r42816 | guy | 2012-05-23 19:16:53 -0700 (Wed, 23 May 2012) | 15 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/win32/file_dlg_win32.c

In the "Save As" and "Export Specified Packets" code path, do a "safe
save" if the destination file exists.

Don't forbid overwriting an existing file in either of those cases (we
still forbid overwriting the current capture file) - the GUI asks the
user whether they want to do the overwrite, and allows them to cancel
out of it - and don't remove the file before writing to it (doing so
makes the save *un*safe).

Attempt to do a save of an unedited temporary file by just moving the
file on Windows as well as on UN*X - ws_rename() will remove the target
if necessary on Windows (and won't do it as a separate operation before
attempting the rename), so it behaves like ws_rename() on UN*X (which is
just a wrapper around rename()).

------------------------------------------------------------------------
r42814 | pascal | 2012-05-23 13:51:38 -0700 (Wed, 23 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iso7816.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7275 :
iso7816: dissect ATR (answer to reset)

------------------------------------------------------------------------
r42813 | guy | 2012-05-23 10:17:39 -0700 (Wed, 23 May 2012) | 3 lines
Changed paths:
   M /trunk/image/file_dlg_win32.rc

Shrink the height of the "Save As" dialog, now that it no longer has
widgets to specify a range.

------------------------------------------------------------------------
r42812 | darkjames | 2012-05-23 05:20:15 -0700 (Wed, 23 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-image-gif.c

Fix bug #7277

Check tvb length before fetching data.

------------------------------------------------------------------------
r42811 | etxrab | 2012-05-23 03:47:52 -0700 (Wed, 23 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Dissect MAC and RLC for CHANNEL_FACH_FDD
------------------------------------------------------------------------
r42810 | etxrab | 2012-05-23 00:27:35 -0700 (Wed, 23 May 2012) | 1 line
Changed paths:
   M /trunk/epan/Makefile.common

Add conv_id.h
------------------------------------------------------------------------
r42809 | etxrab | 2012-05-23 00:13:43 -0700 (Wed, 23 May 2012) | 1 line
Changed paths:
   A /trunk/epan/conv_id.h

Add file missing from http://anonsvn.wireshark.org/viewvc/viewvc.cgi?view=rev&revision=42806
------------------------------------------------------------------------
r42808 | etxrab | 2012-05-22 23:55:31 -0700 (Tue, 22 May 2012) | 5 lines
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

From Florent Drouin:
(Jeff Morriss, Michael Mann )
Add absolute timestamps to -z io,stat

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7207
------------------------------------------------------------------------
r42807 | etxrab | 2012-05-22 23:41:37 -0700 (Tue, 22 May 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/erf.c

From Stephen Donnelly:
Add frame.interface_id support for ERF file format

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7266
------------------------------------------------------------------------
r42806 | etxrab | 2012-05-22 23:36:47 -0700 (Tue, 22 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tcp.h
   M /trunk/ui/cli/tap-iousers.c
   M /trunk/ui/gtk/conversations_table.c
   M /trunk/ui/gtk/conversations_table.h
   M /trunk/ui/gtk/conversations_tcpip.c

From Robert Bullen:
The Wireshark and tshark TCP conversations stats tables aggregate reused connections into a single line item

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7248
------------------------------------------------------------------------
r42805 | etxrab | 2012-05-22 23:26:46 -0700 (Tue, 22 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Fix a typo
------------------------------------------------------------------------
r42804 | etxrab | 2012-05-22 23:25:00 -0700 (Tue, 22 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtn.c
   M /trunk/epan/dissectors/packet-dtn.h

From Jim Wright:
Enhance the DTN dissector so that it understands ECOS blocks (Extended Class of Service)

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7242
------------------------------------------------------------------------
r42803 | guy | 2012-05-22 20:27:34 -0700 (Tue, 22 May 2012) | 7 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Fix comparison of file extension with extensions for the file type -
compare extension with extension, not dot-plus-extension with extension.

Skip unnecesary test.

Clean up white space.

------------------------------------------------------------------------
r42802 | wmeier | 2012-05-22 20:26:35 -0700 (Tue, 22 May 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-yhoo.c
   M /trunk/epan/dissectors/packet-ymsg.c

   All:
   - whitespace cleanup;
   - Remove redundant code;

   packet-ymsg.c:
   - Check if bytes available before doing tvb fetch for heuristic check;
   - Required tcp pdu "fixed part length" is 10 (not 8);
   - Use val_to_str_const() as appropriate;
   - Remove some unneeded initializations.

------------------------------------------------------------------------
r42801 | wmeier | 2012-05-22 20:22:51 -0700 (Tue, 22 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-yhoo.c
   M /trunk/epan/dissectors/packet-ymsg.c

From Evan Huus: "Fix Potential padding issues in Yahoo dissectors"
   https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7276

------------------------------------------------------------------------
r42800 | guy | 2012-05-22 20:05:17 -0700 (Tue, 22 May 2012) | 12 lines
Changed paths:
   M /trunk/ui/qt/main_window.cpp
   M /trunk/ui/win32/file_dlg_win32.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.h

In Windows, in the Save As and Export Selected Packets dialog, append
the default extension for the file type iff

	the file type we're using has a list of extensions;

	the file has no extension or it has one but it's not one of the
	ones in the list.

*Don't* expect a file extension to be at most 5 characters plus the dot
- the extension for pcap-ng, our default capture file type, is "pcapng",
and that's 6 characters!

------------------------------------------------------------------------
r42799 | guy | 2012-05-22 18:06:51 -0700 (Tue, 22 May 2012) | 2 lines
Changed paths:
   M /trunk/image/file_dlg_win32.rc
   M /trunk/ui/win32/file_dlg_win32.c

No packet range stuff for the "Save As" dialog.

------------------------------------------------------------------------
r42798 | cmaynard | 2012-05-22 17:56:15 -0700 (Tue, 22 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Fix Coverity CID 703086: Dereference after null check in decode_tcp_ports().

------------------------------------------------------------------------
r42797 | morriss | 2012-05-22 16:59:41 -0700 (Tue, 22 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Fix: packet-gsm_a_gm.c:3965:6: error: comparison is always true due to limited range of data type [-Werror=type-limits]

------------------------------------------------------------------------
r42796 | guy | 2012-05-22 16:57:54 -0700 (Tue, 22 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nflog.c

Suppress a (legitimate) compiler warning for now, and leave a comment
indicating that we should do *something* about nanoseconds values >= 1
billion.

------------------------------------------------------------------------
r42795 | guy | 2012-05-22 15:57:37 -0700 (Tue, 22 May 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c

Separate callback to control the file type combo box in the "Export
Specified Packets" dialog.

------------------------------------------------------------------------
r42794 | guy | 2012-05-22 15:39:30 -0700 (Tue, 22 May 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/win32/file_dlg_win32.c
   M /trunk/ui/win32/file_dlg_win32.h

Do the "Save As always saves the entire capture, Export Specified
Packets saves specified packets" stuff for Windows.

------------------------------------------------------------------------
r42793 | darkjames | 2012-05-22 15:34:57 -0700 (Tue, 22 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nflog.c

nflog dissector:

 - dissect NFULA_TIMESTAMP as 16B time.
 - fix byte_order_types (selecting BE selected little endian)

------------------------------------------------------------------------
r42792 | guy | 2012-05-22 15:17:57 -0700 (Tue, 22 May 2012) | 20 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.h
   M /trunk/ui/gtk/drag_and_drop.c
   M /trunk/ui/gtk/file_import_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/new_packet_list.c

"Save As" always saves everything and, when the save is done, makes the
new file the current file, as is the case in most if not all other GUI
applications.

A new "Export Specified Packets" menu option allows you to specify which
packets to write out, with the default being the displayed packets (and
those on which the displayed packets depend for, e.g.  reassembly), and
never makes the resulting file the current file.

The two operations are conceptually distinct.  Lumping them into one
menu item, with the default for "Save As" being "displayed packets only"
and thus making it behave like the latter operation, was causing some
confusion; see, for example, bug 6640.

Make the dialog popped up if you try to "Save As" or "Export Specified
Packets" on top of an existing file ask the "do you want to do this?"
question in the main part of the message, and note in the secondary text
that doing that will overwrite what's in the file; that matches what
TextEdit on OS X and the GNOME text editor say.

------------------------------------------------------------------------
r42791 | etxrab | 2012-05-22 14:12:59 -0700 (Tue, 22 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c

Fix PCH dissection
------------------------------------------------------------------------
r42790 | pascal | 2012-05-22 13:34:20 -0700 (Tue, 22 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Dissect Operator Specific Use container in Protocol Configuration Options IE
Put protocol and container ID in a subtree

------------------------------------------------------------------------
r42783 | etxrab | 2012-05-22 08:39:12 -0700 (Tue, 22 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Set paging indication and start fixing TFI list.
------------------------------------------------------------------------
r42782 | morriss | 2012-05-22 07:00:19 -0700 (Tue, 22 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Get rid of non-ASCII chars.  Remove a few trailing commas.
------------------------------------------------------------------------
r42781 | etxrab | 2012-05-22 05:35:49 -0700 (Tue, 22 May 2012) | 1 line
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

cf_save -> cf_save_as
------------------------------------------------------------------------
r42780 | etxrab | 2012-05-22 04:53:52 -0700 (Tue, 22 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf

Collect and use E-DCH data. + one file.
------------------------------------------------------------------------
r42779 | etxrab | 2012-05-22 04:53:12 -0700 (Tue, 22 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Collect and use E-DCH data.
------------------------------------------------------------------------
r42778 | guy | 2012-05-22 04:44:55 -0700 (Tue, 22 May 2012) | 56 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

Replace the File -> Export menu with separate:

	File -> Export Packet Dissections

	    (for the "print to file", "export as CSV", "export as C array",
	    "export as PSML", and "export as PDML" items)

	File-> Export Selected Packet Bytes

	File -> Export SSL Session Keys

	File -> Export Objects

	    (for exporting objects transferred over HTTP, DICOM, or SMB)

menu items.

The operations under Export really weren't that related - about all they
had in common was that they wrote to a file stuff other than packets
in a capture file format; the operations in the groups *under* Export
were related, so the groups are now menu items of their own.

This way, the File menu more immediately indicates what options of that
sort are available.

It also means that the Export Packet Dissections item might make it
clearer that what you get from that is *NOT* something that can just be
read back into Wireshark, as at least one user who asked "how do I get
my capture back from this?" on ask.wireshark.com thought.  If that
doesn't suffice, perhaps renaming it to "Export Dissected Packets" would
help; if *that* doesn't suffice, perhaps Kevin Cullimore's suggestion
that it say "Report" rather than "Export" will do the trick:

	From: Kevin Cullimore <kcullimo@runbox.com>
	Subject: [Wireshark-users] Re: Should the "export as text" item be in an "Export Human-readable..." item in the File menu?
	Date: May 19, 2012 8:31:23 PM PDT
	To: wireshark-users <wireshark-users@wireshark.org>

	Would classifying the asymmetric export (ones that lack a
	corresponding "import" action) formats as "reports" help clear
	up the original ambiguity/misunderstanding? It seems that most
	of the gui-based network tools I'm forced to periodically
	interact with rely upon that term with at least some success.

(Or perhaps some other verb would be right in some cases, e.g. "Save SSL
Session Keys".)

This also sets a pattern for another upcoming change - splitting "Save
As" into "Save As", which always saves every packet and makes the new
file the current file, and "{Verb} Specified Packets", which lets you
specify which packets to save and does *not* make the new file the
current file.  That'd simplify the code a bit, and might clear up the
new only-in-the-trunk issue in bug 6640 - having "Save As" default to
saving displayed packets currently means that it acts more like the
latter of those functions.

------------------------------------------------------------------------
r42777 | guy | 2012-05-22 03:36:40 -0700 (Tue, 22 May 2012) | 24 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.h

We're an editor now, as we let you add, delete, and edit frame comments,
so "Save" should, for non-temporary files, mean "save the current state
of the capture file on top of the existing file" without prompting for a
file name.

That means we have to do a "safe save" - i.e, write the capture out to a
new file and, if that succeeds, rename the new file on top of the old
file - as the actual packet data to write out is in the file we're
overwriting, not in memory.  (We'd want to do that anyway, of
course....)

Update some comments.

Clean up indentation slightly, and get rid of an unnecessary variable
(in all the cases where we use it, we assign it the same value, and that
value isn't modified out from under us before we use it).

Note that after a "Save", or a "Save As" that writes out all captured
packets, we shouldn't have to close the current file and open the new
file and reread it - we should be able to open the new file and update
the frame offsets in the frame_data structures.

Note that we need to do some a better job of reporting rename failures.

------------------------------------------------------------------------
r42776 | guy | 2012-05-22 03:05:01 -0700 (Tue, 22 May 2012) | 8 lines
Changed paths:
   M /trunk/disabled_protos.c
   M /trunk/filters.c

Note that, given that ws_rename() is a wrapper around ws_stdio_rename()
on Windows, and that ws_stdio_rename() uses MoveFileEx() with
MOVEFILE_REPLACE_EXISTING and should therefore remove the target if it
exists, the extra "remove the target first" stuff should not be
necessary on Windows - if we remove it, it also keeps the code from
removing the target and then having the rename fail, with the result
that the target no longer exists.

------------------------------------------------------------------------
r42775 | guy | 2012-05-22 02:57:18 -0700 (Tue, 22 May 2012) | 8 lines
Changed paths:
   M /trunk/wsutil/file_util.h

Update comments to reflect that the GLib version is no longer relevant
(we require GLib 2.14 or later, and always use UTF-8 for pathnames on
Windows), to note that ws_stdio_rename() should have UN*X-style
rename semantics in that it removes the target if necessary, and to give
more details in other ways.

Clean up indetation a bit.

------------------------------------------------------------------------
r42774 | sahlberg | 2012-05-22 00:51:12 -0700 (Tue, 22 May 2012) | 25 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

TCP: Some protocols running ontop of TCP needs the PDUs to be delivered in order. for example decryption of DCERPCoverHTTP.
For such protocols, hte state gets out of sync of for example the same PDU is invoked twice in a row, which sometimes can happen if there is tcp retransmission and we see the same PDU twice. First for hte original segment and a second time for the tcp retransmission.
These protocols might lack an easy way to detect that a PDU is seen twice or out of order.

To handle this a little better, offer a TCP option that defaults to being disabled but when enabled skips invoking any subdissector for retransmitted or out of order packets.
(For some virtualization environments it sometimes becomes VERY common to see false tcp retransmissions due to segments being captured twice making this even worse)


We dont want this option to default to ON because for most cases we do want the current behaviour where the subdissector is called twice, or more, for any PDU that is retrasnmitted on the TPC layer.
For example, assume a SMB response packet is retransmitted on the TCP level.
This may result in a capture file that looks like
1 -> SMB request
2 <- SMB response to 1  
... 1 second ...
3 <- SMB response to 1   TCP retransmission

For this case we definitely want packet 3 to be passed to the SMB layer so that 
the request/respons ematching will detect that the response time for this transaction was > 1.0 second
We want smb.time to indicate the delta betwenn packets 1 and 3
as well as the SMB Service Response Time to indicate that this command took very long.





------------------------------------------------------------------------
r42773 | sahlberg | 2012-05-21 23:23:36 -0700 (Mon, 21 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/req_resp_hdrs.c

HTTP: RPC/HTTP do a better detection and parsing of RPC over HTTP

From Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r42772 | sahlberg | 2012-05-21 22:56:39 -0700 (Mon, 21 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

packet-smb2: dissect the channel sequence in the SMB 2.2 header

From Stefan Metzmacher <metze@samba.org>

------------------------------------------------------------------------
r42771 | sahlberg | 2012-05-21 22:55:05 -0700 (Mon, 21 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

SMB: Add dissection of TRANS2_REQUEST_TRANSPORT_ENCRYPTION messages

From Stefan Metzmacher <metze@samba.org>

------------------------------------------------------------------------
r42770 | sahlberg | 2012-05-21 22:53:28 -0700 (Mon, 21 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

SMB: Dissect TRANS2_SET_FS_INFORMATION infolevel

From Stefan Metzmacher <metze@samba.org>

------------------------------------------------------------------------
r42769 | sahlberg | 2012-05-21 22:51:16 -0700 (Mon, 21 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

SMB: Call dissect_nt_quota() via a new dissect_sfsi_request/response()

From Stefan Metzmacher <metze@samba.org>


------------------------------------------------------------------------
r42768 | sahlberg | 2012-05-21 22:48:55 -0700 (Mon, 21 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

SMB2: Add dissection of the encrypted SMB2 headers

From Matthieu Patou <mat@matws.net>


------------------------------------------------------------------------
r42767 | sahlberg | 2012-05-21 22:46:47 -0700 (Mon, 21 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

SMB2: Add support for the "encrypted" flag for shares

From Michael Adam <obnox@samba.org>

------------------------------------------------------------------------
r42766 | sahlberg | 2012-05-21 22:45:30 -0700 (Mon, 21 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

SMB2: Fix, the flag is called PERSISTENT_HANDLES, not LARGE_MTU

From Michael Adam <obnox@samba.org>


------------------------------------------------------------------------
r42765 | sahlberg | 2012-05-21 22:44:07 -0700 (Mon, 21 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

SMB2: Add support for SMB2_GLOBAL_CAP_ENCRYPTION flag

From Michael Adam <obnox@samba.org>


------------------------------------------------------------------------
r42764 | guy | 2012-05-21 20:52:12 -0700 (Mon, 21 May 2012) | 12 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_statusbar.c
   M /trunk/ui/qt/wireshark_application.cpp

The GUI's state machine requires that, when reloading a capture after a
save, we post capture file callback events similar to the ones posted
when reading a capture - otherwise, the reload will leave the welcome
screen up.

Rename cf_cb_file_save_reload_finished to cf_cb_file_reload_finished,
add a cf_cb_file_reload_started callback, have them work similarly to
read_finished and read_started except that the reload uses "Reloading"
in the progress bar and status bar.

Clean up some indentation while we're at it.

------------------------------------------------------------------------
r42763 | guy | 2012-05-21 19:37:32 -0700 (Mon, 21 May 2012) | 3 lines
Changed paths:
   M /trunk/packet-range.c

Note that packet_range_calc() and packet_range_calc_user() can be
painfully slow with a large capture.

------------------------------------------------------------------------
r42762 | morriss | 2012-05-21 18:59:34 -0700 (Mon, 21 May 2012) | 8 lines
Changed paths:
   M /trunk/file.c

Finish fixing https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7270#c4 :

Revert r42758 as it only helps in one case; rather, fix it correctly: if
we're redissecting or refiltering, clear any frame dependencies as we go
along.  (Fortunately, frame dependencies are all forward dependencies--
meaning that a given frame can only be depended upon by a later frame--
so we can do this as we rescan the packets/frames.)

------------------------------------------------------------------------
r42760 | pascal | 2012-05-21 14:49:11 -0700 (Mon, 21 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-lsp.c

Fix indentation

------------------------------------------------------------------------
r42759 | pascal | 2012-05-21 13:51:22 -0700 (Mon, 21 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-lsp.c

From gyanesh via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7267 :
Add dissector function for SPB link metric sub tlv (type 29)

------------------------------------------------------------------------
r42758 | morriss | 2012-05-21 12:44:24 -0700 (Mon, 21 May 2012) | 6 lines
Changed paths:
   M /trunk/file.c

Partial fix for https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7270#c4 :

Clear the dependent_of_displayed flag when there's no dfilter.  This only
helps the case when you clear a display filter before moving on to another
display filter.

------------------------------------------------------------------------
r42755 | pascal | 2012-05-21 12:27:38 -0700 (Mon, 21 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-gsm_a_rp.c
   M /trunk/epan/dissectors/packet-gsm_a_rr.c
   M /trunk/epan/dissectors/packet-gsm_bsslap.c
   M /trunk/epan/dissectors/packet-gsm_bssmap_le.c
   M /trunk/epan/dissectors/packet-gsm_sms.c
   M /trunk/epan/dissectors/packet-nas_eps.c
   M /trunk/epan/dissectors/packet-sgsap.c

Display Element ID in hexadecimal (like in 3GPP specs)
Display EPS bearer ID in decimal

------------------------------------------------------------------------
r42754 | wmeier | 2012-05-21 11:25:29 -0700 (Mon, 21 May 2012) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-infiniband.c

Fix "Function call argument is an uninitialized value" issue found by scan-build.
(It seems to me that this issue would rarely, if ever, actually occur).

Also:
- Use val_to_str_const() as appropriate;
- Localize some variables;
- Remove unneeded initializers;
- Do some parenthesizing;
- Use a consistent formatting style;
- Do whitespace cleanup.

------------------------------------------------------------------------
r42752 | morriss | 2012-05-21 10:09:15 -0700 (Mon, 21 May 2012) | 5 lines
Changed paths:
   M /trunk/file.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7270 :

Don't mark frames as dependent upon a displayed frame unless the (supposedly)
displayed frame is actually displayed.  (Fix to r41214 <sigh>.)

------------------------------------------------------------------------
r42748 | wmeier | 2012-05-21 09:12:56 -0700 (Mon, 21 May 2012) | 3 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

Cleanup whitespace;
Reformat hf[] entries.

------------------------------------------------------------------------
r42747 | wmeier | 2012-05-21 08:56:26 -0700 (Mon, 21 May 2012) | 3 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

Init some variables to prevent scan-build "Function call argument is an uninitialized value" messages.
(Not actually a bug due to the way the code works ?)

------------------------------------------------------------------------
r42746 | wmeier | 2012-05-21 08:06:24 -0700 (Mon, 21 May 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nhrp.c

Init a pointer to prevent a (not actually valid) scan-build "Function call argument is an uninitialized value" msg
Also:
 - #if 0 out some unused hf[] entries;
 - use val_to_str_const() in a few places;
 - remove some unneeded initializers;
 - do col_set_str()/col_clear() before referencing tvb;
 - reformat hf[] entries;
 - Fix whitespace (4-space tabs, etc).

------------------------------------------------------------------------
r42745 | wmeier | 2012-05-21 07:25:27 -0700 (Mon, 21 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sync.c

Additional cleanup:
- use #if 0/#endif to comment out code(instead of /* ...*/
- remove unused #define
- replace col_clear()/col_add() by col_set()

------------------------------------------------------------------------
r42744 | wmeier | 2012-05-21 07:02:40 -0700 (Mon, 21 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sync.c

From Evan Huus: Unused Prefs registration;
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7273

From me: whitespace cleanup;

------------------------------------------------------------------------
r42743 | wmeier | 2012-05-21 06:18:57 -0700 (Mon, 21 May 2012) | 2 lines
Changed paths:
   M /trunk/tap-rtp-common.c

Fix some indentation.

------------------------------------------------------------------------
r42742 | darkjames | 2012-05-21 06:07:33 -0700 (Mon, 21 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gadu-gadu.c

Improve Gadu-Gadu dissector (part III)

------------------------------------------------------------------------
r42741 | pascal | 2012-05-21 02:37:58 -0700 (Mon, 21 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

From Evan Huus via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7271 :
Remove useless null check

------------------------------------------------------------------------
r42740 | pascal | 2012-05-21 02:18:39 -0700 (Mon, 21 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Add packet-sync.c to epan\CMakeLists.txt

------------------------------------------------------------------------
r42739 | etxrab | 2012-05-21 01:21:26 -0700 (Mon, 21 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

From David Wei:
fix for Higher bitrates than 16 Mbps flag.
------------------------------------------------------------------------
r42738 | etxrab | 2012-05-21 00:42:09 -0700 (Mon, 21 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/wslua/wslua_gui.c
   M /trunk/epan/wslua/wslua_pinfo.c
   M /trunk/epan/wslua/wslua_proto.c

From Evan Huus:
Fix Three memory leaks and a bad if-condition, as caught by CppCheck.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7272
------------------------------------------------------------------------
r42737 | etxrab | 2012-05-21 00:34:20 -0700 (Mon, 21 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sync.c

Use new_register_dissector.
------------------------------------------------------------------------
r42736 | etxrab | 2012-05-21 00:28:13 -0700 (Mon, 21 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp.c

From Michael Mann:
Check for enabled XML dissecto.
Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6625
xmpp decoder crashes when xml is disabled
------------------------------------------------------------------------
r42735 | etxrab | 2012-05-21 00:11:36 -0700 (Mon, 21 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-sync.c

From David Wei:
New dissector for MBMS synchronisation protocol.
------------------------------------------------------------------------
r42734 | wmeier | 2012-05-20 19:20:53 -0700 (Sun, 20 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.h

Whitespace cleanup;

------------------------------------------------------------------------
r42733 | wmeier | 2012-05-20 19:13:49 -0700 (Sun, 20 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

General cleanup:
- 4-space tabs, trailing whitespace, etc
- use a consistent formatting style
- ...

------------------------------------------------------------------------
r42732 | wmeier | 2012-05-20 18:00:12 -0700 (Sun, 20 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Prevent (what seems to me to be) a possible null pointer dereference.

------------------------------------------------------------------------
r42731 | jmayer | 2012-05-20 17:23:13 -0700 (Sun, 20 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Two cases where gcc has problems to detect that a specific specific
variable may not be used uninitialized.

------------------------------------------------------------------------
r42730 | wmeier | 2012-05-20 17:20:09 -0700 (Sun, 20 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Fix 'unused parameter' warning.

------------------------------------------------------------------------
r42729 | etxrab | 2012-05-20 14:24:18 -0700 (Sun, 20 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Set up conversations for more channel types
------------------------------------------------------------------------
r42728 | pascal | 2012-05-20 13:56:42 -0700 (Sun, 20 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Upgrade NAS dissector to Release 10 (v10.6.1)

------------------------------------------------------------------------
r42727 | darkjames | 2012-05-20 11:32:44 -0700 (Sun, 20 May 2012) | 14 lines
Changed paths:
   M /trunk/epan/strutil.c

Revert r35131 fix bug #5738

g_unichar_isprint() is for *wide characters*.
For UTF-8 multibyte characters we could 
use g_utf8_validate() and g_utf8_next_char(),
but IMHO format_text_* should be ASCII-only.

We rather need to store encoding of FT_STRING[Z]
and in proto_item_fill_label() call appropiate
function.
For ENC_ASCII use format_text(),
for unicode (ENC_UTF*, ENC_UCS*) use format_text_utf(),
etc..

------------------------------------------------------------------------
r42724 | gerald | 2012-05-20 07:03:32 -0700 (Sun, 20 May 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-05-20]
------------------------------------------------------------------------
r42723 | tuexen | 2012-05-20 03:57:12 -0700 (Sun, 20 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Make the compiler happy.

------------------------------------------------------------------------
r42722 | pascal | 2012-05-20 02:50:34 -0700 (Sun, 20 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-nas_eps.c

Upgrade NAS EPS dissector to Release 10 (10.6.1)

------------------------------------------------------------------------
r42721 | guy | 2012-05-20 01:56:06 -0700 (Sun, 20 May 2012) | 13 lines
Changed paths:
   M /trunk/cfile.c
   M /trunk/cfile.h
   M /trunk/file.c
   M /trunk/rawshark.c
   M /trunk/tshark.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/drag_and_drop.c
   M /trunk/ui/gtk/file_import_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/main_toolbar.c
   M /trunk/ui/gtk/main_toolbar.h
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/ui/gtk/summary_dlg.c

Change the "user_saved" member of a capture_file structure to
"unsaved_changes", and have it be TRUE iff changes have been made to the
file since it was read - *not* if it's a temporary file from a live
capture.

Check the "is_tempfile" member, and the "unsaved_changes" member, when
appropriate.

Just have a set_toolbar_for_capture_file() routine that updates the
"save", "close", and "reload" toolbar as appropriate, given a
capture_file structure - absorb the function of
set_toolbar_for_unsaved_capture_file() into it.

------------------------------------------------------------------------
r42720 | pascal | 2012-05-19 12:05:36 -0700 (Sat, 19 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/asn1/gsm_map/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-lmp.c
   M /trunk/epan/dissectors/packet-mp4ves.c
   M /trunk/epan/dissectors/packet-mpls-pm.c
   M /trunk/epan/dissectors/packet-mpls-psc.c
   M /trunk/epan/dissectors/packet-omron-fins.c
   M /trunk/epan/dissectors/packet-ospf.c

Fix RVALS() macro usage

------------------------------------------------------------------------
r42719 | wmeier | 2012-05-19 10:21:32 -0700 (Sat, 19 May 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/conversations_table.c

Add an 'if' test to prevent a potential null pointer dereference
identified by clang scan-build.


------------------------------------------------------------------------
r42718 | wmeier | 2012-05-19 09:55:22 -0700 (Sat, 19 May 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/conversations_table.c

Rework 'ct_nb_switch_page_cb()' slightly to prevent a scan-build "null pointer de-reference" message;
(In practice, the "null pointer de-reference" would not actually occur ?).

------------------------------------------------------------------------
r42717 | wmeier | 2012-05-19 09:07:50 -0700 (Sat, 19 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/proto.c

Rework proto_registrar_dump_protocols() to prevent a Clang scan-build "de-reference of a null poiunter" warning
(In practice, bug would not actually occur).

------------------------------------------------------------------------
r42716 | pascal | 2012-05-19 09:06:12 -0700 (Sat, 19 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/lpp/lpp.cnf
   M /trunk/asn1/rrlp/rrlp.cnf
   M /trunk/epan/dissectors/packet-lpp.c
   M /trunk/epan/dissectors/packet-rrlp.c

Use col_append_sep_str instead of col_append_str

------------------------------------------------------------------------
r42715 | wmeier | 2012-05-19 07:20:55 -0700 (Sat, 19 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-acn.c
   M /trunk/epan/dissectors/packet-afp.c
   M /trunk/epan/dissectors/packet-afs.c
   M /trunk/epan/dissectors/packet-aim-messaging.c
   M /trunk/epan/dissectors/packet-ansi_683.c
   M /trunk/epan/dissectors/packet-ansi_a.c

Fix some "warning: Value stored to '...' is never read" clang scan-build warnings.
Also; Do some whitespace cleanup in a few cases.

------------------------------------------------------------------------
r42714 | darkjames | 2012-05-19 06:27:43 -0700 (Sat, 19 May 2012) | 7 lines
Changed paths:
   M /trunk/wiretap/file_wrappers.c

Z_BLOCK was added in zlib-1.2.0.5

Pass Z_NO_FLUSH to inflate() when Z_BLOCK is not defined,
just in case also disable fast seeking when it's not defined.

References: http://www.wireshark.org/lists/wireshark-dev/201205/msg00145.html 

------------------------------------------------------------------------
r42713 | pascal | 2012-05-19 05:32:10 -0700 (Sat, 19 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

From Thomas Loockx via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7269 :
Add BGP MDT-SAFI dissection (RFC6037)

------------------------------------------------------------------------
r42712 | pascal | 2012-05-19 03:35:43 -0700 (Sat, 19 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-hello.c

From gyanesh via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7262 :
Digest details display issue in SPB Digest subtlv (ISIS hello pdu)

------------------------------------------------------------------------
r42711 | darkjames | 2012-05-19 00:57:45 -0700 (Sat, 19 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gadu-gadu.c

Improve Gadu-Gadu dissector and fix some comments.

------------------------------------------------------------------------
r42710 | etxrab | 2012-05-18 23:20:05 -0700 (Fri, 18 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c

Fix the DCH data collection for conversation setup
------------------------------------------------------------------------
r42709 | darkjames | 2012-05-18 10:43:48 -0700 (Fri, 18 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gadu-gadu.c

Improve Gadu-Gadu dissector.

------------------------------------------------------------------------
r42708 | morriss | 2012-05-18 10:19:50 -0700 (Fri, 18 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.nmake

There's no need to include Custom.common here; it gets pulled in by Makefile.common
------------------------------------------------------------------------
r42707 | morriss | 2012-05-18 09:20:36 -0700 (Fri, 18 May 2012) | 1 line
Changed paths:
   A /trunk/epan/dissectors/Custom.common (from /trunk/epan/dissectors/Custom.nmake:42706)
   D /trunk/epan/dissectors/Custom.nmake
   M /trunk/epan/dissectors/Makefile.am
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/Makefile.nmake

Allow custom dissectors in automake too.
------------------------------------------------------------------------
r42706 | guy | 2012-05-17 21:06:35 -0700 (Thu, 17 May 2012) | 4 lines
Changed paths:
   M /trunk/dumpcap.c

Expand a comment.

Clear the struct sigaction *before* we fill in any fields in it.

------------------------------------------------------------------------
r42705 | guy | 2012-05-17 20:31:50 -0700 (Thu, 17 May 2012) | 4 lines
Changed paths:
   M /trunk/file.c

When saving packets, fill in hdr.presence_flags from the flags in the
frame_data structure; there's no guarantee that the wtap_pkthdr in the
wtap structure reflects the current packet.

------------------------------------------------------------------------
r42691 | pascal | 2012-05-17 14:24:48 -0700 (Thu, 17 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb-ccid.c

Tabs -> spaces

------------------------------------------------------------------------
r42689 | pascal | 2012-05-17 14:11:22 -0700 (Thu, 17 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-iso7816.c
   M /trunk/epan/dissectors/packet-usb-ccid.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7255 :
dissector for generic ISO 7816 messages (atr and apdus)

------------------------------------------------------------------------
r42687 | tuexen | 2012-05-17 13:49:09 -0700 (Thu, 17 May 2012) | 2 lines
Changed paths:
   M /trunk/macosx-setup.sh

Use some newer versions.

------------------------------------------------------------------------
r42686 | wmeier | 2012-05-17 13:41:46 -0700 (Thu, 17 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-v5dl.c

Fix an "unused variable" warning....

------------------------------------------------------------------------
r42685 | wmeier | 2012-05-17 13:36:23 -0700 (Thu, 17 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

Fix the fix ....

------------------------------------------------------------------------
r42684 | wmeier | 2012-05-17 13:30:59 -0700 (Thu, 17 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

Silence a "may be used uninitialiuzed" warning.....

------------------------------------------------------------------------
r42683 | wmeier | 2012-05-17 13:13:22 -0700 (Thu, 17 May 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hpteam.c
   M /trunk/epan/dissectors/packet-mactelnet.c
   M /trunk/epan/dissectors/packet-netbios.c
   M /trunk/epan/dissectors/packet-ntp.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-rtp-midi.c
   M /trunk/epan/dissectors/packet-slowprotocols.c
   M /trunk/epan/dissectors/packet-v5dl.c
   M /trunk/epan/dissectors/packet-v5ef.c
   M /trunk/epan/dissectors/packet-yhoo.c

General cleanup including as appropriate:
 - Remove unneeded #include files (string.h, addr_resolv.h);
 - Remove unneeded 'if(!initialized){...}' in proto_reg_handoff();
 - Reformat hf[] entries;
 - Remove unneeded variable initializations;
 - "localize" some variables;
 - Whitespace/indentation/long lines/formatting
(in one case: re-order code slightly to not do col_set_str() & etc until
              after initial "frame acceptance testing" by dissector.

------------------------------------------------------------------------
r42682 | darkjames | 2012-05-17 12:41:19 -0700 (Thu, 17 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-smb2.c

Fix copy&paste: hf variable name in hfi->abbrev

------------------------------------------------------------------------
r42679 | tuexen | 2012-05-17 08:31:15 -0700 (Thu, 17 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-megaco.c

No leading whitespaces in the INFO column.

------------------------------------------------------------------------
r42678 | wmeier | 2012-05-17 07:35:11 -0700 (Thu, 17 May 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ehs.c
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-gsm_sms_ud.c
   M /trunk/epan/dissectors/packet-gvrp.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-skinny.c
   M /trunk/epan/dissectors/packet-usb.c

General Cleanup including:
- Remove unneeded #include <stdlib.h>;
- Remove "README.developer" comments;
- Reformat hf[] entries;
- Remove unneeded variable initialization;
- "localize" some variables;
- Whitespace/indentation/long lines/formatting
- (In one case) proto_tree_add_uint returns a proto_item* (not a proto_tree *);

------------------------------------------------------------------------
r42677 | tuexen | 2012-05-17 07:34:09 -0700 (Thu, 17 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-megaco.c

Add support for specifying an SCTP port number.

------------------------------------------------------------------------
r42676 | darkjames | 2012-05-17 03:18:53 -0700 (Thu, 17 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/proto.c

Fix string buffer overflow (bug #7029)

g_strlcpy() always return the size of strlen(src), so in case of truncation it could happen that offset_r > size or offset_e > size.
Fix it by adding new function protoo_strlcpy() which returns how many bytes was copied to dest buffer.


------------------------------------------------------------------------
r42675 | pascal | 2012-05-17 01:22:34 -0700 (Thu, 17 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

Fix spice.common_cap_byte1 filter I changed by mistake in r42664

------------------------------------------------------------------------
r42668 | gerald | 2012-05-16 15:05:47 -0700 (Wed, 16 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

Use BASE_DEC for spice.common_cap_byte1. (Hopefully that's correct.)

------------------------------------------------------------------------
r42664 | pascal | 2012-05-16 14:20:16 -0700 (Wed, 16 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

From Yaniv Kaul via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7264 :
Enhance the Spice dissector to deal with sized data streams and playback data
From me: fix a few hf entries

------------------------------------------------------------------------
r42663 | pascal | 2012-05-16 13:59:56 -0700 (Wed, 16 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

From Pontus Andersson via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7259 :
GTP Extension headers are dissected incorrectly

------------------------------------------------------------------------
r42661 | cmaynard | 2012-05-16 12:55:49 -0700 (Wed, 16 May 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Largely, whitespace and formatting changes.  Added modelines to match.
Other misc. changes:
-> Delete useless, duplicate assignment of offset to 0 in dissect_vsnp().
-> Change short seq # display filter so it's not the same as the seq # filter.
-> pppoe.dump.gz looks to be malformed, so remove unnecessary "remlen" code in
   dissect_cp() and let the packets be displayed as malformed since they are.
-> Remove if (check_col()) checks.
-> Fix copy-and-paste of filter name for ipcp.opt.max_header.

------------------------------------------------------------------------
r42660 | gerald | 2012-05-16 10:57:12 -0700 (Wed, 16 May 2012) | 2 lines
Changed paths:
   M /trunk/test/suite-unittests.sh

Update INSTALL_DIR to match r42659.

------------------------------------------------------------------------
r42659 | morriss | 2012-05-16 09:36:32 -0700 (Wed, 16 May 2012) | 1 line
Changed paths:
   M /trunk/epan/Makefile.nmake

Fix the *test_install targets so they put the test tools in the right directory (wireshark-gtk2 is one dir up from here).
------------------------------------------------------------------------
r42658 | gerald | 2012-05-16 09:29:12 -0700 (Wed, 16 May 2012) | 4 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/dumpcap.c
   M /trunk/epan/dissectors/packet-dcerpc-dnsserver.c
   M /trunk/epan/dissectors/packet-dcom.c
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/pidl/dnsserver.cnf
   M /trunk/epan/frame_data.c
   M /trunk/tshark.c
   M /trunk/wiretap/catapult_dct2000.c
   M /trunk/wiretap/dbs-etherwatch.c

Fix a bunch of uninitialized variables found by Coverity Scan. CIDs
702403, 702404, 702405, 702406, 702407, 702408, 702409, 702410, 702411,
and 702412.

------------------------------------------------------------------------
r42657 | etxrab | 2012-05-16 07:56:34 -0700 (Wed, 16 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

se_allocate and store per packet data.
------------------------------------------------------------------------
r42656 | pascal | 2012-05-16 06:24:10 -0700 (Wed, 16 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7186 :
Link together access-request and access-challenge messages

------------------------------------------------------------------------
r42655 | etxrab | 2012-05-16 06:05:27 -0700 (Wed, 16 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c

Handle DCH information in RadioLinkReconfigurationPrepareFDD
------------------------------------------------------------------------
r42654 | darkjames | 2012-05-16 02:07:19 -0700 (Wed, 16 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/iax2_analysis.c
   M /trunk/ui/gtk/rtp_analysis.c

Free memory when create_tempfile() failed.

------------------------------------------------------------------------
r42653 | etxrab | 2012-05-16 01:35:53 -0700 (Wed, 16 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c

Only do HS-DSCH Control frames for now as something is broken.
------------------------------------------------------------------------
r42652 | etxrab | 2012-05-16 00:47:15 -0700 (Wed, 16 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

From David Wei:
 Corrected info column for piggybacked GTPv2 messages.
------------------------------------------------------------------------
r42651 | etxrab | 2012-05-15 23:03:06 -0700 (Tue, 15 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf

Setup frame for HSDSCH
------------------------------------------------------------------------
r42650 | etxrab | 2012-05-15 22:58:30 -0700 (Tue, 15 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-nbap.c

Bug fixes and add HSDSCH
------------------------------------------------------------------------
r42649 | etxrab | 2012-05-15 22:57:41 -0700 (Tue, 15 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Bug fixes and add HSDSCH
------------------------------------------------------------------------
r42648 | morriss | 2012-05-15 20:06:08 -0700 (Tue, 15 May 2012) | 16 lines
Changed paths:
   M /trunk/epan/prefs.c

Store a copy of the default preferences (e_prefs; the dissectors' default
preference values have been stored for a while now).

If a preference has not been changed from its default value, comment it out
when writing the preferences file.  That way you won't get warnings about
some new "gui.*" (or other non-dissector) preference when switching between
SVN Wireshark and some older version.


Also fix some ommissions in copy_prefs() (preferences that were not copied).


(All these non-dissector preferences seem to require an awful lot of code;
it would be very nice to have a non-dissector preference registration API that
the GUI and core could use so we could eliminate a lot of this code.)

------------------------------------------------------------------------
r42647 | wmeier | 2012-05-15 18:41:03 -0700 (Tue, 15 May 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-acn.c
   D /trunk/epan/dissectors/packet-acn.h
   M /trunk/epan/dissectors/packet-afs.c
   D /trunk/epan/dissectors/packet-afs.h
   M /trunk/epan/dissectors/packet-assa_r3.c
   D /trunk/epan/dissectors/packet-assa_r3_public.h
   M /trunk/epan/dissectors/packet-bgp.c
   D /trunk/epan/dissectors/packet-bgp.h
   M /trunk/epan/dissectors/packet-bootparams.c
   D /trunk/epan/dissectors/packet-bootparams.h

all:
     Merge .h files into .c files since .h files unused elsewhere;
     Do whitespace, indentation & formatting cleanup.
packet-acn.c:
     Fix 2 minor bugs wherein subtree not displayed in packet-details
     because tree variable used in proto_tree_add_text() always NULL.

------------------------------------------------------------------------
r42646 | morriss | 2012-05-15 18:20:55 -0700 (Tue, 15 May 2012) | 1 line
Changed paths:
   M /trunk/epan/prefs.c

Most dissectors don't register their preferences in subtrees, so don't allocate the submodules pe_tree until it's needed.
------------------------------------------------------------------------
r42645 | gerald | 2012-05-15 17:27:26 -0700 (Tue, 15 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/iax2_analysis.c
   M /trunk/ui/gtk/rtp_analysis.c

Check the return value of create_tempfile. Fixes CIDs 280527 and 280528.

------------------------------------------------------------------------
r42644 | cmaynard | 2012-05-15 16:44:23 -0700 (Tue, 15 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Call  dissect_osinlcp_opt_type_len() to dissect the OSINLCP option type and length, unintentionally omitted.  I guess this is what happens without enough packet captures to test against and a compiler that doesn't warn enough about unused functions.  Anyone know how to get MSVC compilers to complain about such things like the other compilers do?

------------------------------------------------------------------------
r42643 | morriss | 2012-05-15 16:39:06 -0700 (Tue, 15 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

ifdef out dissect_osinlcp_opt_type_len since it's not used--should it be?
------------------------------------------------------------------------
r42642 | gerald | 2012-05-15 15:25:35 -0700 (Tue, 15 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/hostlist_table.c

Don't leak an open file handle (CID 702423).

------------------------------------------------------------------------
r42641 | gerald | 2012-05-15 15:19:51 -0700 (Tue, 15 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/epan/dissectors/packet-nbap.c

Remove a bonus semicolon (CID 702424).

------------------------------------------------------------------------
r42640 | wmeier | 2012-05-15 15:07:00 -0700 (Tue, 15 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-cimd.c
   D /trunk/epan/dissectors/packet-cimd.h

Merge packet-cimd.h into packet-cimd.c (packet-cimd.h not used elsewhere);
Remove unneeded #includes;
Reformat hf[] entries;
Do minor code rework & whitespace cleanup.

------------------------------------------------------------------------
r42639 | cmaynard | 2012-05-15 15:02:57 -0700 (Tue, 15 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

PPP OSINLCP improvements.  Note that the protocol name has been changed from OSICP to OSINLCP, which matches RFC1377 and IANA terminology from http://www.iana.org/assignments/ppp-numbers

------------------------------------------------------------------------
r42638 | gerald | 2012-05-15 14:56:02 -0700 (Tue, 15 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mq.c
   M /trunk/epan/dissectors/packet-sigcomp.c
   M /trunk/epan/tvbuff.c

Assign some variables that scan-build was complaining about.

------------------------------------------------------------------------
r42637 | pascal | 2012-05-15 14:18:39 -0700 (Tue, 15 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Spaces -> tabs

------------------------------------------------------------------------
r42636 | pascal | 2012-05-15 14:16:06 -0700 (Tue, 15 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7261 :
Add some sanity checks when dissecting SQ_TYPE_NULL

------------------------------------------------------------------------
r42635 | cmaynard | 2012-05-15 14:01:52 -0700 (Tue, 15 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

PPP IPCP improvements.

------------------------------------------------------------------------
r42634 | wmeier | 2012-05-15 13:57:21 -0700 (Tue, 15 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-ndr.c
   M /trunk/epan/dissectors/packet-ipp.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-l1-events.c
   M /trunk/epan/dissectors/packet-memcache.c
   M /trunk/epan/dissectors/packet-osi.c
   M /trunk/epan/dissectors/packet-rfid-felica.c
   M /trunk/epan/dissectors/packet-rpc.c
   M /trunk/epan/dissectors/packet-smb-browse.c
   M /trunk/epan/dissectors/packet-text-media.c
   M /trunk/epan/dissectors/packet-ucp.c

Remove unneeded includes (ctype.h, stdio.h);
In one case, define our own size for a string buffer
 (instead of using a magic constant 'BUFSIZ');
In a few cases: do some whitespace, indentation & reformatting cleanup.

------------------------------------------------------------------------
r42633 | pascal | 2012-05-15 12:25:33 -0700 (Tue, 15 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

From Alexander Lüders & Frank Lahm via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7254 :
Enhancements for FPSpotlightRPC AFP function

------------------------------------------------------------------------
r42632 | wmeier | 2012-05-15 12:23:35 -0700 (Tue, 15 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aim-admin.c
   M /trunk/epan/dissectors/packet-aim-adverts.c
   M /trunk/epan/dissectors/packet-aim-bos.c
   M /trunk/epan/dissectors/packet-aim-buddylist.c
   M /trunk/epan/dissectors/packet-aim-chat.c
   M /trunk/epan/dissectors/packet-aim-chatnav.c
   M /trunk/epan/dissectors/packet-aim-directory.c
   M /trunk/epan/dissectors/packet-aim-email.c
   M /trunk/epan/dissectors/packet-aim-icq.c
   M /trunk/epan/dissectors/packet-aim-invitation.c
   M /trunk/epan/dissectors/packet-aim-location.c
   M /trunk/epan/dissectors/packet-aim-oft.c
   M /trunk/epan/dissectors/packet-aim-popup.c
   M /trunk/epan/dissectors/packet-aim-signon.c
   M /trunk/epan/dissectors/packet-aim-sst.c
   M /trunk/epan/dissectors/packet-aim-stats.c
   M /trunk/epan/dissectors/packet-aim-translate.c
   M /trunk/epan/dissectors/packet-aim-userlookup.c
   M /trunk/epan/dissectors/packet-aim.c
   M /trunk/epan/dissectors/packet-app-pkix-cert.c
   M /trunk/epan/dissectors/packet-arcnet.c
   M /trunk/epan/dissectors/packet-artnet.c
   M /trunk/epan/dissectors/packet-aruba-adp.c
   M /trunk/epan/dissectors/packet-banana.c
   M /trunk/epan/dissectors/packet-bfd.c
   M /trunk/epan/dissectors/packet-brdwlk.c
   M /trunk/epan/dissectors/packet-capwap.c
   M /trunk/epan/dissectors/packet-ccsds.c
   M /trunk/epan/dissectors/packet-cell_broadcast.c
   M /trunk/epan/dissectors/packet-cgmp.c
   M /trunk/epan/dissectors/packet-cigi.c
   M /trunk/epan/dissectors/packet-cimetrics.c
   M /trunk/epan/dissectors/packet-cisco-sm.c
   M /trunk/epan/dissectors/packet-dccp.c
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-dhcp-failover.c
   M /trunk/epan/dissectors/packet-dtp.c
   M /trunk/epan/dissectors/packet-enttec.c
   M /trunk/epan/dissectors/packet-exec.c
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fcct.c
   M /trunk/epan/dissectors/packet-fcels.c
   M /trunk/epan/dissectors/packet-fcfcs.c
   M /trunk/epan/dissectors/packet-fclctl.c
   M /trunk/epan/dissectors/packet-fcoe.c
   M /trunk/epan/dissectors/packet-fcsp.c
   M /trunk/epan/dissectors/packet-g723.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-gift.c
   M /trunk/epan/dissectors/packet-git.c
   M /trunk/epan/dissectors/packet-gmrp.c
   M /trunk/epan/dissectors/packet-gnutella.c
   M /trunk/epan/dissectors/packet-gopher.c
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_a_rp.c
   M /trunk/epan/dissectors/packet-gsm_bsslap.c
   M /trunk/epan/dissectors/packet-gsm_bssmap_le.c
   M /trunk/epan/dissectors/packet-icp.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ifcp.c
   M /trunk/epan/dissectors/packet-igrp.c
   M /trunk/epan/dissectors/packet-image-gif.c
   M /trunk/epan/dissectors/packet-ipfc.c
   M /trunk/epan/dissectors/packet-ipsec.c
   M /trunk/epan/dissectors/packet-ismp.c
   M /trunk/epan/dissectors/packet-iwarp-ddp-rdmap.c
   M /trunk/epan/dissectors/packet-l2tp.c
   M /trunk/epan/dissectors/packet-laplink.c
   M /trunk/epan/dissectors/packet-llt.c
   M /trunk/epan/dissectors/packet-lsc.c
   M /trunk/epan/dissectors/packet-lwres.c
   M /trunk/epan/dissectors/packet-m3ua.c
   M /trunk/epan/dissectors/packet-manolito.c
   M /trunk/epan/dissectors/packet-mesh.c
   M /trunk/epan/dissectors/packet-mip.c
   M /trunk/epan/dissectors/packet-mmse.c
   M /trunk/epan/dissectors/packet-mpls-echo.c
   M /trunk/epan/dissectors/packet-mpls-pm.c
   M /trunk/epan/dissectors/packet-mpls-psc.c
   M /trunk/epan/dissectors/packet-mpls-y1711.c
   M /trunk/epan/dissectors/packet-msdp.c
   M /trunk/epan/dissectors/packet-mstp.c
   M /trunk/epan/dissectors/packet-mstp.h
   M /trunk/epan/dissectors/packet-multipart.c
   M /trunk/epan/dissectors/packet-nbd.c
   M /trunk/epan/dissectors/packet-ndp.c
   M /trunk/epan/dissectors/packet-netdump.c
   M /trunk/epan/dissectors/packet-netsync.c
   M /trunk/epan/dissectors/packet-nhrp.c
   M /trunk/epan/dissectors/packet-nt-tpcp.c
   M /trunk/epan/dissectors/packet-olsr.c
   M /trunk/epan/dissectors/packet-openwire.c
   M /trunk/epan/dissectors/packet-opsi.c
   M /trunk/epan/dissectors/packet-pcli.c
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-pktgen.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-pvfs2.c
   M /trunk/epan/dissectors/packet-pw-cesopsn.c
   M /trunk/epan/dissectors/packet-pw-eth.c
   M /trunk/epan/dissectors/packet-pw-hdlc.c
   M /trunk/epan/dissectors/packet-pw-satop.c
   M /trunk/epan/dissectors/packet-redbackli.c
   M /trunk/epan/dissectors/packet-rlm.c
   M /trunk/epan/dissectors/packet-rmi.c
   M /trunk/epan/dissectors/packet-rmt-alc.c
   M /trunk/epan/dissectors/packet-rmt-common.c
   M /trunk/epan/dissectors/packet-rmt-fec.c
   M /trunk/epan/dissectors/packet-rmt-lct.c
   M /trunk/epan/dissectors/packet-rmt-norm.c
   M /trunk/epan/dissectors/packet-rsh.c
   M /trunk/epan/dissectors/packet-rsync.c
   M /trunk/epan/dissectors/packet-rtnet.c
   M /trunk/epan/dissectors/packet-sccpmg.c
   M /trunk/epan/dissectors/packet-sita.c
   M /trunk/epan/dissectors/packet-sndcp-xid.c
   M /trunk/epan/dissectors/packet-synergy.c
   M /trunk/epan/dissectors/packet-syslog.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-teamspeak2.c
   M /trunk/epan/dissectors/packet-teredo.c
   M /trunk/epan/dissectors/packet-tivoconnect.c
   M /trunk/epan/dissectors/packet-tnef.c
   M /trunk/epan/dissectors/packet-tte-pcf.c
   M /trunk/epan/dissectors/packet-turbocell.c
   M /trunk/epan/dissectors/packet-turnchannel.c
   M /trunk/epan/dissectors/packet-udld.c
   M /trunk/epan/dissectors/packet-udp.c
   M /trunk/epan/dissectors/packet-uma.c
   M /trunk/epan/dissectors/packet-v5ua.c
   M /trunk/epan/dissectors/packet-vtp.c
   M /trunk/epan/dissectors/packet-wbxml.c
   M /trunk/epan/dissectors/packet-wlccp.c
   M /trunk/epan/dissectors/packet-wol.c
   M /trunk/epan/dissectors/packet-wow.c
   M /trunk/epan/dissectors/packet-wsmp.c
   M /trunk/epan/dissectors/packet-wtls.c
   M /trunk/epan/dissectors/packet-wtp.c
   M /trunk/epan/dissectors/packet-x11.c
   M /trunk/epan/dissectors/packet-x25.c
   M /trunk/epan/dissectors/packet-xdmcp.c
   M /trunk/epan/dissectors/packet-xot.c

Remove unneeded #includes (stdlib, stdio, ctypes, time);
In a few cases: do some whitespace, indentation cleanup & reformatting.

------------------------------------------------------------------------
r42631 | gerald | 2012-05-15 12:13:10 -0700 (Tue, 15 May 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Evan Huus via bug 6805:

Look before we loop

Check the value of various key count parameters against the size of their
parent tag *before* we start looping on them.

Stick an expert error on the field and bound the loop at a sane point if the
count is bogus.

------------------------------------------------------------------------
r42630 | gerald | 2012-05-15 12:11:08 -0700 (Tue, 15 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Fix a few scan-build warnings along with some whitespace.

------------------------------------------------------------------------
r42629 | etxrab | 2012-05-15 08:46:15 -0700 (Tue, 15 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/epan/dissectors/packet-nbap.c

Remove more unfinished code.
------------------------------------------------------------------------
r42628 | etxrab | 2012-05-15 08:00:52 -0700 (Tue, 15 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Use converstaion info to dissect FP DCH flows. Revert unfinished code.
------------------------------------------------------------------------
r42627 | guy | 2012-05-14 22:42:58 -0700 (Mon, 14 May 2012) | 13 lines
Changed paths:
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

Make the encoding argument uniformly guint rather than gint.

Put the code that's currently common to the ENC_ASCII and ENC_UTF_8
cases in tvb_get_ephemeral_string_enc() into tvb_get_ephemeral_string(),
and call tvb_get_ephemeral_string() in those cases.  Skip the
tvb_ensure_bytes_exist() and ensure_contiguous() calls in the ENC_UTF_16
and ENC_UCS_2 cases, as they're unnecessary there.

Update the comment for tvb_get_ephemeral_string_enc().

Make tvb_get_ephemeral_stringz_enc() handle the encodings that
tvb_get_ephemeral_string_enc() does.

------------------------------------------------------------------------
r42626 | guy | 2012-05-14 16:19:13 -0700 (Mon, 14 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/dcerpc/idl2wrs.c

Make the "idl-light"-to-dissector generator handle hex (and octal)
values in enums (and, while we're at it, add some error checking for
valid values).  (The regenerated dissectors don't differ usefully from
the fixed dissectors, so we don't check them in.)

------------------------------------------------------------------------
r42625 | guy | 2012-05-14 16:05:28 -0700 (Mon, 14 May 2012) | 23 lines
Changed paths:
   M /trunk/epan/dissectors/dcerpc/drsuapi/packet-dcerpc-drsuapi-template.c
   M /trunk/epan/dissectors/dcerpc/idl2wrs.c
   M /trunk/epan/dissectors/packet-dcerpc-budb.c
   M /trunk/epan/dissectors/packet-dcerpc-butc.c
   M /trunk/epan/dissectors/packet-dcerpc-drsuapi.c
   M /trunk/epan/dissectors/packet-dcerpc-drsuapi.h

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Change the "idl-light"-to-dissector generator to use ENC_NA for
structures and ENC_LITTLE_ENDIAN for bitmasks (are they always
little-endian, or should they check the data representation?).  Also
change it to properly set the display format for FT_ABSOLUTE_TIME fields
(it now specifies whether to show local time, UTC, or UTC with a
1-origin day-of-year).

Change one routine in the template for the DRSUAPI dissector to use
ENC_UTF_16|ENC_LITTLE_ENDIAN with proto_tree_add_item() (the field it
dissects is known to be a string, so there's no need to check its data
type).

Regenerate the BUDB, BUTC, and DRSUAPI dissectors.  (The generated BUTC
dissector handles pointers differently - either the old dissector was
wrong, or the generator is wrong, or the IDL for the protocol is wrong,
or the difference doesn't actually affect dissection.)

The generator doesn't currently handle hex values in enums correctly;
manually fix packet-dcerpc-drsuapi.h.

------------------------------------------------------------------------
r42624 | pascal | 2012-05-14 14:46:02 -0700 (Mon, 14 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

From Frank Lahm via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7256 :
Fix subquery_count loop variable updating

------------------------------------------------------------------------
r42623 | gerald | 2012-05-14 10:54:47 -0700 (Mon, 14 May 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi
   M /trunk/tools/win32-setup.sh
   M /trunk/tools/win64-setup.sh

Try using an OBS-derived Gtk2 bundle, second try.

------------------------------------------------------------------------
r42622 | darkjames | 2012-05-13 23:32:16 -0700 (Sun, 13 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.c
   M /trunk/epan/wslua/wslua_tree.c

tvb_unicode_strsize() returns number of bytes, NOT number of UCS-2 characters.

------------------------------------------------------------------------
r42621 | guy | 2012-05-13 17:49:05 -0700 (Sun, 13 May 2012) | 15 lines
Changed paths:
   M /trunk/epan/libwireshark.def
   M /trunk/epan/proto.h
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h
   M /trunk/epan/wslua/make-init-lua.pl
   M /trunk/epan/wslua/template-init.lua
   M /trunk/epan/wslua/wslua_tree.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Add new "add_packet_field" method to the TreeItem class, taking a
protocol field (*not* a protocol), TvbRange, and encoding value as
arguments.

Add the ENC_ values to init.lua.  Make them all hex #defines so
make-init-lua.pl can easily extract them.

Export tvb_unicode_strsize() for use by Lua (and elsewhere as desired). 
Note that it handles UTF-16 and UTF-8, and fix the comment to note that
its count of hexadectets *does* include the null terminator (that's what
the code does).

------------------------------------------------------------------------
r42620 | pascal | 2012-05-13 14:02:42 -0700 (Sun, 13 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

From Frank Lahm via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7246 :
Patch adding dissection of time data

------------------------------------------------------------------------
r42619 | pascal | 2012-05-13 12:03:48 -0700 (Sun, 13 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Revert 42618 (in 3GPP vocabulary multirat means multi radio access technology)

------------------------------------------------------------------------
r42618 | cmaynard | 2012-05-13 11:01:35 -0700 (Sun, 13 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

More typos: Multirat -> Multirate.

------------------------------------------------------------------------
r42617 | cmaynard | 2012-05-13 10:55:06 -0700 (Sun, 13 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Convert tabs to spaces.  Fix some typos.

------------------------------------------------------------------------
r42616 | etxrab | 2012-05-13 09:34:53 -0700 (Sun, 13 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Tabs spelling
------------------------------------------------------------------------
r42614 | wmeier | 2012-05-13 07:53:26 -0700 (Sun, 13 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c

General cleanup:
- whitespace;
- formatting (including long lines & hf[] entries).

------------------------------------------------------------------------
r42612 | gerald | 2012-05-13 07:03:29 -0700 (Sun, 13 May 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-05-13]
------------------------------------------------------------------------
r42611 | etxrab | 2012-05-13 07:00:10 -0700 (Sun, 13 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Renove redundant code
------------------------------------------------------------------------
r42610 | etxrab | 2012-05-13 06:58:10 -0700 (Sun, 13 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Fix de_rr_cell_opt_sacch decoding the DTX cell options wrongly, by using proto_tree_add_split_bits_item_ret_val https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7253
------------------------------------------------------------------------
r42609 | guy | 2012-05-12 16:00:15 -0700 (Sat, 12 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/x11-extension-implementation.h
   M /trunk/tools/process-x11-xcb.pl

A routine that processes a struct_XXX() won't necessarily use its
encoding argument; mark it as (potentially) unused.

------------------------------------------------------------------------
r42608 | guy | 2012-05-12 15:56:46 -0700 (Sat, 12 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c

"byte_order" is an encoding value, so it should be guint.

------------------------------------------------------------------------
r42607 | guy | 2012-05-12 15:25:29 -0700 (Sat, 12 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ziop.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Replaced the "little_endian" Boolean value with an "byte_order" value
containing the setting of the byte-order ENC_ bit. 

------------------------------------------------------------------------
r42606 | wmeier | 2012-05-12 15:19:02 -0700 (Sat, 12 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c

Fix a compile error

------------------------------------------------------------------------
r42605 | wmeier | 2012-05-12 15:14:02 -0700 (Sat, 12 May 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-rdp.c
   D /trunk/epan/dissectors/packet-rdp.h

General cleanup:
- Fix two minor bugs which resulted in missing entries in packet details pane;
- Remove packet-rdp.h: It's not used elsewhere;
- Define 3 global fcns as static: they're only referenced within packet-rdp.c;;
- Localize some variable definitions & remove uneeded variable initializations;
- ...
- Fix whitespace and indentation.


------------------------------------------------------------------------
r42604 | guy | 2012-05-12 13:27:35 -0700 (Sat, 12 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-miop.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Replaced the "little_endian" Boolean value with an "byte_order" value
containing the setting of the byte-order ENC_ bit. 

------------------------------------------------------------------------
r42603 | cmaynard | 2012-05-12 13:26:42 -0700 (Sat, 12 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntp.c

Fix display filter prefix from "ntpctrl." to "ntp.ctrl."  Part of a patch submitted by Michael Mann in bug 2794, but for some reason the patch specified the filter prefix as "nap.ctrl.", which I don't think is right.

------------------------------------------------------------------------
r42602 | guy | 2012-05-12 13:10:18 -0700 (Sat, 12 May 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Mention ENC_UCS_2 and ENC_UTF_16.

------------------------------------------------------------------------
r42601 | guy | 2012-05-12 13:07:08 -0700 (Sat, 12 May 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c
   M /trunk/epan/dissectors/x11-enum.h
   M /trunk/epan/dissectors/x11-extension-errors.h
   M /trunk/epan/dissectors/x11-extension-implementation.h
   M /trunk/epan/dissectors/x11-glx-render-enum.h
   M /trunk/tools/process-x11-xcb.pl

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Updated tools/process-x11-xcb.pl to support different encoding values
for different fields.  Replaced the "little_endian" Boolean value with a
"byte_order" value containing the setting of the byte-order ENC_ bit. 
Regenerated X11 fields from current x.org git.

------------------------------------------------------------------------
r42600 | darkjames | 2012-05-12 12:49:49 -0700 (Sat, 12 May 2012) | 2 lines
Changed paths:
   M /trunk/doc/dumpcap.pod

From r37696 default file format for dumpcap is pcap-ng. Fix manuals.

------------------------------------------------------------------------
r42599 | cmaynard | 2012-05-12 10:55:09 -0700 (Sat, 12 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

From Evan Huus via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7239
Make inputint and outputint fields UINT32s instead of UINT16s.

------------------------------------------------------------------------
r42598 | pascal | 2012-05-12 08:19:25 -0700 (Sat, 12 May 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/io_stat.c

From Akos Lukovics:
Fix div-by-zero error in the moving average filter of IO graph
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6236

------------------------------------------------------------------------
r42597 | alagoutte | 2012-05-12 06:12:01 -0700 (Sat, 12 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jim Young via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7252
Add wlan.ra field value to wlan.addr

The (hidden) field wlan.addr==xx:xx:xx:xx:xx:xx currently matches wlan.da,
wlan.bssid, wlan.sa and wlan.da fields but not wlan.ra field.

------------------------------------------------------------------------
r42596 | darkjames | 2012-05-12 00:57:51 -0700 (Sat, 12 May 2012) | 7 lines
Changed paths:
   M /trunk/ui/gtk/main_proto_draw.c

Fix bug #7251

We're already checking in gtk if end highlight offsets don't exceed len.
Do the same for start offset.

I wonder if it this checks should be also done when adding items to tree...

------------------------------------------------------------------------
r42595 | guy | 2012-05-11 18:59:00 -0700 (Fri, 11 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c

hf_x11_keycodes is an FT_NONE; use ENC_NA with it.

------------------------------------------------------------------------
r42594 | guy | 2012-05-11 18:54:49 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c

string16_with_buffer_preallocated() takes a byte-order gboolean as its
argument.

------------------------------------------------------------------------
r42593 | guy | 2012-05-11 17:43:46 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42592 | guy | 2012-05-11 16:55:54 -0700 (Fri, 11 May 2012) | 12 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h
   M /trunk/epan/tvbuff.c

Add ENC_UTF_16 and ENC_UCS_2.  Note that UTF-16 and UCS-2 are not the
same, and that the routines to get "Unicode" strings are really doing
UCS-2 (and not doing anything about code values that aren't valid in
UCS-2 strings).

Have tvb_get_ephemeral_string_enc() separate cases for ASCII and UTF-8,
even though they're *currently* treated the same.

For FT_UINT_STRING, treat an encoding value of TRUE as meaning
"little-endian ASCII"; pass all other encodings through to
tvb_get_ephemeral_string_enc().

------------------------------------------------------------------------
r42591 | cmaynard | 2012-05-11 13:24:27 -0700 (Fri, 11 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Despite the OSX-10.5-x86 buildbot insisting that they are, neither 'flags' nor 'fh_tree' were used uninitialized, but make a change to shut it up.

------------------------------------------------------------------------
r42590 | guy | 2012-05-11 13:02:52 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/plugins/wimaxasncp/packet-wimaxasncp.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42589 | guy | 2012-05-11 12:53:43 -0700 (Fri, 11 May 2012) | 2 lines
Changed paths:
   M /trunk/plugins/m2m/packet-m2m.c

Show m2m.fch_burst_tlv_value in decimal.

------------------------------------------------------------------------
r42588 | guy | 2012-05-11 12:27:59 -0700 (Fri, 11 May 2012) | 5 lines
Changed paths:
   M /trunk/plugins/wimax/msg_dsd.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Add hf[] entries for some fields that didn't have them.

------------------------------------------------------------------------
r42587 | guy | 2012-05-11 12:22:25 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/plugins/unistim/packet-unistim.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42586 | guy | 2012-05-11 12:20:23 -0700 (Fri, 11 May 2012) | 5 lines
Changed paths:
   M /trunk/plugins/opcua/opcua_extensionobjecttable.c
   M /trunk/plugins/opcua/opcua_simpletypes.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Clean up indentation.

------------------------------------------------------------------------
r42585 | guy | 2012-05-11 12:08:31 -0700 (Fri, 11 May 2012) | 6 lines
Changed paths:
   M /trunk/plugins/m2m/packet-m2m.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Also, fix the type of what appears to be a 24-bit integral field
(cut-and-pasteo?).

------------------------------------------------------------------------
r42584 | guy | 2012-05-11 11:57:51 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/plugins/ethercat/packet-ethercat-datagram.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42583 | guy | 2012-05-11 11:54:32 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/plugins/ethercat/packet-ecatmb.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42582 | guy | 2012-05-11 11:52:36 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42581 | cmaynard | 2012-05-11 11:01:51 -0700 (Fri, 11 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Further LCP improvements:
-> Support RFC 2153's Vendor Specific decode
-> Make more fields filterable by converting some add_text()'s to add_xyz().
-> Don't wrap call_dissector_only() within an if(tree){} block.

------------------------------------------------------------------------
r42580 | guy | 2012-05-11 10:35:56 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

Clean up indentation.  (HT should not be assumed to work on 4-space tab
stops.)

------------------------------------------------------------------------
r42579 | guy | 2012-05-11 10:29:56 -0700 (Fri, 11 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h
   M /trunk/ui/cli/tap-iostat.c
   M /trunk/ui/gtk/io_stat.c

proto_registrar_get_ftype() returns an FT_ value; make its return type
"enum ftenum" to reflect that, and fix the "switch doesn't handle XXX"
warnings that provokes.

------------------------------------------------------------------------
r42578 | gerald | 2012-05-11 10:15:12 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/ascend.y

Use "%parse-param" instead of a global variable. Fixes a scan-build
warning.

------------------------------------------------------------------------
r42577 | guy | 2012-05-11 09:38:08 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cops.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_bitmask() calls.

------------------------------------------------------------------------
r42576 | etxrab | 2012-05-11 05:14:29 -0700 (Fri, 11 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Custom.nmake
   M /trunk/epan/dissectors/Makefile.common

Make it possible to add "dirty" custom dissectors.
------------------------------------------------------------------------
r42575 | pascal | 2012-05-11 03:22:32 -0700 (Fri, 11 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.h

Commit forgotten file in revision 42573

------------------------------------------------------------------------
r42574 | pascal | 2012-05-11 02:50:28 -0700 (Fri, 11 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

Remove useless '+0' in proto_tree_add_* function calls

------------------------------------------------------------------------
r42573 | pascal | 2012-05-11 02:44:55 -0700 (Fri, 11 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

From Niels de Vos:
Add dissection of AUTH_GLUSTERFS as used in GlusterFS-3.3
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7244

------------------------------------------------------------------------
r42572 | pascal | 2012-05-11 02:38:49 -0700 (Fri, 11 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

From Niels de Vos:
Add a helper function to dissect AUTH_UNIX groups
Fix hf_rpc_auth_lk_owner entry
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7244

------------------------------------------------------------------------
r42571 | pascal | 2012-05-11 02:03:22 -0700 (Fri, 11 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

From Frank Lahm:
In FPSpotlightRPC packets, check for elements with 0 childs (denoted by L in TLV is sizeof(TLV tag))
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7245

------------------------------------------------------------------------
r42570 | etxrab | 2012-05-11 01:42:23 -0700 (Fri, 11 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/rnsap/packet-rnsap-template.c
   M /trunk/asn1/rnsap/rnsap.cnf
   M /trunk/epan/dissectors/packet-rnsap.c

Make it possible to dissect private IE's
------------------------------------------------------------------------
r42569 | guy | 2012-05-11 01:29:40 -0700 (Fri, 11 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h264.c

Get rid of non-ASCII character.

------------------------------------------------------------------------
r42568 | guy | 2012-05-11 01:10:42 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/c1222/packet-c1222-template.c
   M /trunk/epan/dissectors/packet-c1222.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_bitmask() calls.

------------------------------------------------------------------------
r42567 | guy | 2012-05-11 01:05:35 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_bits_item() calls.

------------------------------------------------------------------------
r42566 | guy | 2012-05-11 00:49:27 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/x509ce/x509ce.cnf
   M /trunk/epan/dissectors/packet-x509ce.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42565 | guy | 2012-05-11 00:44:43 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xml.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42564 | guy | 2012-05-11 00:38:59 -0700 (Fri, 11 May 2012) | 5 lines
Changed paths:
   M /trunk/asn1/x2ap/packet-x2ap-template.c
   M /trunk/asn1/x2ap/x2ap.cnf
   M /trunk/epan/dissectors/packet-x2ap.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Fix a field that was presumably intended to be of type FT_IPv6.

------------------------------------------------------------------------
r42563 | guy | 2012-05-11 00:36:41 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-vcdu.c

Fix a commented-out proto_tree_add_uint() call that presumably was
intended to be a proto_tree_add_item() call.

------------------------------------------------------------------------
r42562 | guy | 2012-05-11 00:34:47 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/ulp/ulp.cnf
   M /trunk/epan/dissectors/packet-ulp.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42561 | guy | 2012-05-11 00:32:30 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ucp.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42560 | guy | 2012-05-11 00:10:43 -0700 (Fri, 11 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tnef.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42559 | etxrab | 2012-05-10 22:21:22 -0700 (Thu, 10 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h264.c

Correct wrong value in h264_level_bitrate_values
------------------------------------------------------------------------
r42558 | guy | 2012-05-10 20:38:04 -0700 (Thu, 10 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-srvloc.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.  (We actually need to support additional
encodings with ENC_ values and use them.)

------------------------------------------------------------------------
r42557 | guy | 2012-05-10 20:32:56 -0700 (Thu, 10 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/spnego/spnego.cnf
   M /trunk/epan/dissectors/packet-spnego.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42556 | guy | 2012-05-10 20:28:26 -0700 (Thu, 10 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/snmp/snmp.cnf
   M /trunk/epan/dissectors/packet-snmp.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42555 | guy | 2012-05-10 20:24:32 -0700 (Thu, 10 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.  (dissect_smb2_olb_buffer() dissects an
offset-length-buffer the contents of which are a structured blob of
bytes, so the top-level item should be an FT_NONE, hence ENC_NA.)

------------------------------------------------------------------------
r42554 | morriss | 2012-05-10 11:33:24 -0700 (Thu, 10 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Fix CID 700200: the Israeli variant case can't happen in
dissect_application_isup() so comment it out for now.

------------------------------------------------------------------------
r42553 | martinm | 2012-05-10 09:10:44 -0700 (Thu, 10 May 2012) | 2 lines
Changed paths:
   M /trunk/mergecap.c

Avoid needlessly shadowing another variable.

------------------------------------------------------------------------
r42552 | cmaynard | 2012-05-10 09:09:10 -0700 (Thu, 10 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/packet.h

Trivial typo: if -> it

------------------------------------------------------------------------
r42551 | martinm | 2012-05-10 09:05:02 -0700 (Thu, 10 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/cli/tap-follow.c

Avoid needlessly shadowing a variable.

------------------------------------------------------------------------
r42550 | martinm | 2012-05-10 08:57:57 -0700 (Thu, 10 May 2012) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iuup.c

Add parenthesis to clarify intent.

From Visual Studio Code Analyzer:
c:\buildbot\wireshark\trunk-vs-eca\vscodeanalysis\build\epan\dissectors\packet-iuup.c(322)
: warning C6336: Arithmetic operator has precedence over question
operator, use parentheses to clarify intent
c:\buildbot\wireshark\trunk-vs-eca\vscodeanalysis\build\epan\dissectors\packet-iuup.c(342)
: warning C6336: Arithmetic operator has precedence over question
operator, use parentheses to clarify intent
c:\buildbot\wireshark\trunk-vs-eca\vscodeanalysis\build\epan\dissectors\packet-iuup.c(401)
: warning C6336: Arithmetic operator has precedence over question
operator, use parentheses to clarify intent

------------------------------------------------------------------------
r42549 | martinm | 2012-05-10 08:49:25 -0700 (Thu, 10 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Avoid needlessly shadowing a variable.

------------------------------------------------------------------------
r42548 | martinm | 2012-05-10 07:34:21 -0700 (Thu, 10 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Formatting of { } wasn't consistent, so settle on having { at the end of
the line rather than on a  line on its own.

------------------------------------------------------------------------
r42547 | cmaynard | 2012-05-10 06:19:55 -0700 (Thu, 10 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bthci_evt.c

AFH Channel Map should be an FT_BYTES, not an FT_UINT_BYTES.
Ref: Core Version 2.1 + EDR, section 7.5.5 available from:
     https://www.bluetooth.org/Technical/Specifications/adopted.htm

------------------------------------------------------------------------
r42546 | guy | 2012-05-09 23:34:37 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-pipe.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42545 | guy | 2012-05-09 23:13:56 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sll.c

Fix a proto_tree_add_ipv4() call that was presumably intended to be a
proto_tree_add_item() call.

------------------------------------------------------------------------
r42544 | guy | 2012-05-09 22:57:12 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/sbc-ap/packet-sbc-ap-template.c
   M /trunk/epan/dissectors/packet-sbc-ap.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42543 | guy | 2012-05-09 22:55:02 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-s1ap.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42542 | guy | 2012-05-09 22:52:22 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtmpt.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42541 | etxrab | 2012-05-09 22:44:25 -0700 (Wed, 09 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c

Use the defines in IE value_string
------------------------------------------------------------------------
r42540 | cmaynard | 2012-05-09 19:49:57 -0700 (Wed, 09 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

PPP code, identifier, length and magic number are now filterable.  Don't call call_dissector() from within an if(tree){} block.  Mark dissect_lcp_linkqualmon_opt()'s pinfo arg as unused.

------------------------------------------------------------------------
r42539 | guy | 2012-05-09 19:36:50 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsvp.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42538 | guy | 2012-05-09 19:32:11 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/rrlp/rrlp.cnf
   M /trunk/epan/dissectors/packet-rrlp.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42537 | guy | 2012-05-09 19:28:01 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42536 | guy | 2012-05-09 19:20:37 -0700 (Wed, 09 May 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdp.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

This involves marking string fields as special.

XXX - we need ENC_UTF_16 so that we can make the Unicode strings just be
FT_STRING and add them with ENC_UTF_16|ENC_LITTLE_ENDIAN.

------------------------------------------------------------------------
r42535 | guy | 2012-05-09 18:54:33 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

Don't create alternative fields for the encrypted value of a string
attribute unless the attribute is encrypted.

------------------------------------------------------------------------
r42534 | cmaynard | 2012-05-09 18:34:11 -0700 (Wed, 09 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c

PPP_OSICP -> PPP_OSINLCP

------------------------------------------------------------------------
r42533 | cmaynard | 2012-05-09 18:26:53 -0700 (Wed, 09 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Mention that dissect_ip_tcp_options() is used by more protocols than just IP and TCP.

------------------------------------------------------------------------
r42532 | cmaynard | 2012-05-09 18:21:37 -0700 (Wed, 09 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/ppptypes.h

PPP LCP improvements, mostly with LCP options.  checkAPIs.pl and checkfiltername.pl are happy, but checkhf.pl complains; however, all complaints are false positives - maybe a Perl expert is able to modify checkhf.pl to avoid reporting them?  Lots of changes so fuzz testing was performed, but no captures exist w/all the LCP options, so some are likely still untested.  Compiled on Windows using MSVC2010EE, which is notorious for not reporting problems that other compilers do.  Hopefully there are no warnings, but we'll see what the buildbots say ...

------------------------------------------------------------------------
r42531 | guy | 2012-05-09 18:08:50 -0700 (Wed, 09 May 2012) | 7 lines
Changed paths:
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-ranap.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Also, fix a call for IPv4 addresses to use ENC_BIG_ENDIAN (yes, we do
support ENC_LITTLE_ENDIAN for IPv4 addresses - at least one protocol
apparently puts IPv4 addresses out byte-swapped!).

------------------------------------------------------------------------
r42530 | guy | 2012-05-09 18:01:18 -0700 (Wed, 09 May 2012) | 23 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-radius.h
   M /trunk/epan/radius_dict.l

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

For RADIUS, this means that, for string attributes that are encrypted,
we need separate fields for the encrypted and decrypted versions, the
former of which is an FT_BYTES (as its value is *NOT* a text string!)
and the latter of which is FT_STRING.

While we're at it:

	make some routines static that don't need to be exported;

	"encrypt=" takes a value between 1 and 3 - get the value from
	the dictionary and store it, and only do User-Password-style
	decryption for encrypt=1 attributes;

	rename "hf64" to "hf_alt", as it's a general "alternate field",
	used for 64-bit values for integral attributess, IPv6 addresses
	for "combo IP" attributes, and encrypted values for string
	fields;

	give the URL for the FreeRADIUS dictionary file format man page.

------------------------------------------------------------------------
r42529 | gerald | 2012-05-09 17:21:40 -0700 (Wed, 09 May 2012) | 2 lines
Changed paths:
   M /trunk/plugins/wimax/mac_hd_generic_decoder.c
   M /trunk/plugins/wimax/msg_dlmap.c

Better fixes for the last commit.

------------------------------------------------------------------------
r42528 | gerald | 2012-05-09 16:08:47 -0700 (Wed, 09 May 2012) | 2 lines
Changed paths:
   M /trunk/plugins/wimax/mac_hd_generic_decoder.c
   M /trunk/plugins/wimax/msg_dlmap.c
   M /trunk/plugins/wimax/msg_ulmap.c
   M /trunk/plugins/wimax/wimax_compact_dlmap_ie_decoder.c
   M /trunk/plugins/wimax/wimax_compact_ulmap_ie_decoder.c

Fix a few scan-build warnings.

------------------------------------------------------------------------
r42527 | guy | 2012-05-09 15:14:03 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cops.c

Get rid of one remaining Booleans-as-encoding-argument in a
proto_tree_add_item() call.

------------------------------------------------------------------------
r42526 | guy | 2012-05-09 15:10:31 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/qsig/packet-qsig-template.c
   M /trunk/epan/dissectors/packet-qsig.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42525 | guy | 2012-05-09 15:08:00 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/kerberos/kerberos.cnf

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42524 | guy | 2012-05-09 15:05:21 -0700 (Wed, 09 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/q932-ros/q932-ros.cnf
   M /trunk/epan/dissectors/packet-q932-ros.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42523 | wmeier | 2012-05-09 13:39:21 -0700 (Wed, 09 May 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
 "attached is a simple fix for CID281213. Although the bug can't crash wireshark,
 dissect_si_string() is not really fit for handling negative string lengths (and
 doesn't need to)."

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7243

------------------------------------------------------------------------
r42522 | gerald | 2012-05-09 12:17:48 -0700 (Wed, 09 May 2012) | 2 lines
Changed paths:
   M /trunk/tools/make-manuf
   M /trunk/tools/make-services.pl
   M /trunk/tools/make-sminmpec.pl

Send a useful User-Agent header.

------------------------------------------------------------------------
r42521 | etxrab | 2012-05-09 07:24:46 -0700 (Wed, 09 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c

Setup more flows, flow info is incomplete.
------------------------------------------------------------------------
r42520 | etxrab | 2012-05-09 05:54:58 -0700 (Wed, 09 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c

Setup CPCH flows.
------------------------------------------------------------------------
r42519 | martinm | 2012-05-09 05:07:14 -0700 (Wed, 09 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Remove an accidental ; following a test.

------------------------------------------------------------------------
r42518 | etxrab | 2012-05-09 05:01:16 -0700 (Wed, 09 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Collect and use more information in converstion data to be able to dissect FP flows.
------------------------------------------------------------------------
r42517 | pascal | 2012-05-08 13:25:55 -0700 (Tue, 08 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtpt.c
   M /trunk/epan/dissectors/packet-xmcp.c

Fix last parameter for tvb_get_guid() call

------------------------------------------------------------------------
r42516 | pascal | 2012-05-08 13:20:12 -0700 (Tue, 08 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Remove unused hf entries

------------------------------------------------------------------------
r42515 | pascal | 2012-05-08 12:38:58 -0700 (Tue, 08 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

From Frank Lahm:
Display guids in FPSpotlightRPC AFP packets
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7237

------------------------------------------------------------------------
r42514 | alagoutte | 2012-05-08 10:42:54 -0700 (Tue, 08 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ldap/ldap.cnf
   M /trunk/epan/dissectors/packet-ldap.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r42513 | alagoutte | 2012-05-08 10:42:36 -0700 (Tue, 08 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-erldp.c
   M /trunk/epan/dissectors/packet-etch.c
   M /trunk/epan/dissectors/packet-fcgi.c
   M /trunk/epan/dissectors/packet-hdfs.c
   M /trunk/epan/dissectors/packet-icep.c
   M /trunk/epan/dissectors/packet-ifcp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r42512 | alagoutte | 2012-05-08 10:41:23 -0700 (Tue, 08 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls.c

Enhance MPLS Dissector
 * use proto_tree_add_item
 * start Header field by hf_mpls...


------------------------------------------------------------------------
r42511 | alagoutte | 2012-05-08 10:34:46 -0700 (Tue, 08 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-ipv6.h

Enhance Unknown IPv6 Extension Header

------------------------------------------------------------------------
r42510 | alagoutte | 2012-05-08 10:31:05 -0700 (Tue, 08 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

Add RFC6608 Subcodes for BGP Finite State Machine Error
Update other notify subcodes (draft-ietf-idr-cease-subcode-02 => RFC4484)...

------------------------------------------------------------------------
r42509 | wmeier | 2012-05-08 08:16:55 -0700 (Tue, 08 May 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

General cleanup including:
- remove unneeded #include <stdlib.h>
- rework some "function-like" macros to use
  'do {...} while (0)' construct;
- reformat hf[] entries;
- indentation/whitespace/long-lines/parentheses.

------------------------------------------------------------------------
r42508 | etxrab | 2012-05-08 07:24:13 -0700 (Tue, 08 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

From Frank Lahm:
Fixes for FPSpotlightRPC AFP dissector.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7235
------------------------------------------------------------------------
r42507 | etxrab | 2012-05-08 07:17:16 -0700 (Tue, 08 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtn.c
   M /trunk/epan/dissectors/packet-dtn.h

From Jim Wright:
Add decoding of CTEB to packet-dtn.c

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7234
------------------------------------------------------------------------
r42506 | guy | 2012-05-08 00:01:04 -0700 (Tue, 08 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pppoe.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42505 | guy | 2012-05-07 23:43:15 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppi.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42504 | guy | 2012-05-07 23:41:10 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/pkix1explicit/pkix1explicit.cnf
   M /trunk/epan/dissectors/packet-pkix1explicit.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42503 | guy | 2012-05-07 23:35:50 -0700 (Mon, 07 May 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-packetbb.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Fix a field type - FT_UINT_BYTES means "byte array preceded by a
length, with the length field included", not "byte array, not including
any length field, even if it happens to be preceded by a length field".

------------------------------------------------------------------------
r42502 | etxrab | 2012-05-07 22:35:30 -0700 (Mon, 07 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/epan/dissectors/packet-nbap.c

Pretify info_col for mor MSG:s
------------------------------------------------------------------------
r42501 | guy | 2012-05-07 19:41:15 -0700 (Mon, 07 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.  (The only non-integral/non-boolean fields
aren't fetched as array elements.)

------------------------------------------------------------------------
r42500 | guy | 2012-05-07 19:05:16 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nhrp.c

Fix a proto_tree_add_ipv4() call that was probably intended to be a
proto_tree_add_item() call.

------------------------------------------------------------------------
r42499 | guy | 2012-05-07 19:02:26 -0700 (Mon, 07 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netperfmeter.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.  (There's no spec for the protocol that I
could find, just an implementation, and it's not clear whether the
description field is ASCII or UTF-8 or something else.)

------------------------------------------------------------------------
r42498 | guy | 2012-05-07 17:37:37 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/epan/dissectors/packet-nbap.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42497 | guy | 2012-05-07 17:34:12 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-msproxy.c

Fix a proto_tree_add_uint() call that appears to have been intended to
be a proto_tree_add_item() call.

------------------------------------------------------------------------
r42496 | guy | 2012-05-07 17:31:56 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/mpeg-pes/packet-mpeg-pes-template.c
   M /trunk/epan/dissectors/packet-mpeg-pes.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42495 | guy | 2012-05-07 17:29:22 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mikey.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42494 | guy | 2012-05-07 17:24:07 -0700 (Mon, 07 May 2012) | 5 lines
Changed paths:
   M /trunk/asn1/m3ap/packet-m3ap-template.c
   M /trunk/epan/dissectors/packet-m3ap.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Clean up indentation.

------------------------------------------------------------------------
r42493 | guy | 2012-05-07 17:15:53 -0700 (Mon, 07 May 2012) | 5 lines
Changed paths:
   M /trunk/asn1/ldap/ldap.cnf
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-ldap.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Update the RFC number for LDAP.

------------------------------------------------------------------------
r42492 | guy | 2012-05-07 16:55:46 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-l2tp.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42491 | guy | 2012-05-07 16:40:44 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42490 | guy | 2012-05-07 16:37:38 -0700 (Mon, 07 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iax2.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Update the introductory comment to give the RFC for IAX2. 
(tools.ietf.org rules.)

------------------------------------------------------------------------
r42489 | guy | 2012-05-07 15:52:33 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/h450/h450.cnf
   M /trunk/epan/dissectors/packet-h450.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42488 | guy | 2012-05-07 15:46:14 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/h248/packet-h248-template.h
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h
   M /trunk/epan/dissectors/packet-h248_annex_e.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42487 | wmeier | 2012-05-07 15:11:34 -0700 (Mon, 07 May 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk/epan/dissectors/packet-gsm_a_rr.c
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-nas_eps.c
   M /trunk/epan/dissectors/packet-rsl.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-smpp.c
   M /trunk/epan/dissectors/packet-ssl-utils.c

General minor cleanup including:
- remove unneeded #includes;
- use val_to_str_const() as appropriate;
- reformat hf[] entries;
- reformat long lines;
- use #if 0/#endif to coment out code instead of /* ... */;
- remove boilerplate comments;
- whitespace & indentation


------------------------------------------------------------------------
r42486 | guy | 2012-05-07 14:11:58 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/h235/h235.cnf
   M /trunk/epan/dissectors/packet-h235.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42485 | guy | 2012-05-07 14:04:05 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/asn1/gsm_map/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42484 | rbalint | 2012-05-07 12:53:49 -0700 (Mon, 07 May 2012) | 1 line
Changed paths:
   M /trunk/doc/wireshark.pod.template
   M /trunk/file.c

Give hints to capture from stdin or pipe instead of opening it as a file
------------------------------------------------------------------------
r42483 | guy | 2012-05-07 12:47:15 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42482 | guy | 2012-05-07 12:38:26 -0700 (Mon, 07 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-elcom.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

(The field is a counted string, so the byte order is in theory relevant,
although the count is, in this case, a single byte.)

------------------------------------------------------------------------
r42481 | guy | 2012-05-07 12:30:29 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dis-pdus.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42480 | guy | 2012-05-07 11:59:18 -0700 (Mon, 07 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-coap.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

Get rid of unnecessary include of <stdio.h>.

------------------------------------------------------------------------
r42479 | guy | 2012-05-07 11:14:08 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cisco-sm.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42478 | guy | 2012-05-07 11:10:05 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/camel/camel.cnf
   M /trunk/epan/dissectors/packet-camel.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42477 | guy | 2012-05-07 11:06:47 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/c1222/c1222.cnf
   M /trunk/epan/dissectors/packet-c1222.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42476 | guy | 2012-05-07 11:03:43 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls.

------------------------------------------------------------------------
r42475 | guy | 2012-05-07 11:00:13 -0700 (Mon, 07 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-assa_r3.c

Get rid of remaining Booleans-as-encoding-arguments in
proto_tree_add_item() calls; for the items that don't actually have hf_
entries (which is a bug in the dissector!), assume the short
fixed-length ones are integral and the "to the end of the packet" ones
are byte arrays (hence ENC_NA).

------------------------------------------------------------------------
r42474 | guy | 2012-05-07 10:41:29 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Revert previous change - packet-umts_fp.h wasn't changed.

------------------------------------------------------------------------
r42473 | guy | 2012-05-07 10:40:05 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

packet-umts_fp.h now requires epan/conversation.h.

------------------------------------------------------------------------
r42472 | guy | 2012-05-07 10:39:09 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-k12.c

packet-umts_fp.h now requires epan/conversation.h.

------------------------------------------------------------------------
r42471 | guy | 2012-05-07 10:38:26 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fp_hint.c

packet-umts_fp.h now requires epan/conversation.h.

------------------------------------------------------------------------
r42470 | guy | 2012-05-07 10:37:30 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

packet-umts_fp.h now requires epan/conversation.h.

------------------------------------------------------------------------
r42469 | martinm | 2012-05-07 10:10:12 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Include <epan/conversation.h> from packet-umts_fp.h.

------------------------------------------------------------------------
r42468 | guy | 2012-05-07 10:04:41 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

packet-umts_fp.h now requires epan/conversation.h.

------------------------------------------------------------------------
r42467 | guy | 2012-05-07 09:41:03 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_mac.c

packet-umts_fp.h now requires epan/conversation.h.

------------------------------------------------------------------------
r42466 | etxrab | 2012-05-07 09:09:49 -0700 (Mon, 07 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_fp.h

Use converstaion info in umts_fp.
------------------------------------------------------------------------
r42465 | morriss | 2012-05-07 08:13:28 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Decode the Israeli TCM and CAM messages.

------------------------------------------------------------------------
r42464 | wmeier | 2012-05-07 06:35:45 -0700 (Mon, 07 May 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-canopen.c

General cleanup:
- Setup COL_PROTO & COL_INFO before fetching from the tvb;
- Improve byte pane highlighing: Use proper length in proto_tree_add_item() calls;
- Remove unneeded include;
- Use VALS macro when referencing a value_string in hf[];
- Simplify/rework code slightly;
- Whitespace.

------------------------------------------------------------------------
r42463 | wmeier | 2012-05-07 06:30:58 -0700 (Mon, 07 May 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-socketcan.c

General fixes and cleanup:
- Calls to a sub-dissector must not be under 'if (tree)';
- Setup COL_PROTO & COL_INFO before fetching from the tvb;
- Move proto_reg_handoff_...() to the end of the file;
- prefs callback not required;
- Localize a global variable;
- whitespace.

------------------------------------------------------------------------
r42462 | wmeier | 2012-05-07 06:13:49 -0700 (Mon, 07 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-data.c
   M /trunk/epan/dissectors/packet-data.h

(Minor): packet_reg_handoff() & prefs callback not req'd;
         whitespace (trailing spaces) cleanup.

------------------------------------------------------------------------
r42461 | etxrab | 2012-05-07 04:14:30 -0700 (Mon, 07 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c

Use defines in value_string values.
------------------------------------------------------------------------
r42460 | darkjames | 2012-05-07 03:51:14 -0700 (Mon, 07 May 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/main_proto_draw.c
   M /trunk/ui/gtk/packet_win.c

Avoid calling tvb_get_ptr() on 0-length TVBs.

It seems to be better fix than r42420

------------------------------------------------------------------------
r42459 | etxrab | 2012-05-07 00:43:03 -0700 (Mon, 07 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

From David Wei:
Fix to PCI and PVI in Bearer QoS and ARP IE:s for GTPv2.
------------------------------------------------------------------------
r42458 | cmaynard | 2012-05-06 21:15:10 -0700 (Sun, 06 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/to_str.c

Trivial typo: of -> or

------------------------------------------------------------------------
r42457 | wmeier | 2012-05-06 18:27:36 -0700 (Sun, 06 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/sigcomp-udvm.c

From Evan Huus:
 CppCheck found a bunch of redundant assignments to the variable
 'operand_address'.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7232

------------------------------------------------------------------------
r42456 | wmeier | 2012-05-06 18:18:17 -0700 (Sun, 06 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c

From Evan Huus:
 In dissect_sdp_media_attribute() we can leak 'key' in an error condition.
 Simply move the allocation to after the error check.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7231

------------------------------------------------------------------------
r42455 | wmeier | 2012-05-06 18:12:03 -0700 (Sun, 06 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-pcep.c

From Evan Huus: remove unused variables
 https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7229
 https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7230

------------------------------------------------------------------------
r42454 | wmeier | 2012-05-06 17:49:39 -0700 (Sun, 06 May 2012) | 8 lines
Changed paths:
   M /trunk/dumpcap.c

From Evan Huus:
 In get_capture_device_open_failure_messages() in dumpcap.c, there are some
 statements that should have been guarded by ifdefs, causing a little
 unnecessary work on some platforms, and a bunch of unused-variable warnings
 from static analyzers. The patch fixes the problem.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7228

------------------------------------------------------------------------
r42453 | etxrab | 2012-05-06 15:10:13 -0700 (Sun, 06 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/epan/dissectors/packet-nbap.c

Move converation setup code, pretify som messages info col. entries.
------------------------------------------------------------------------
r42448 | gerald | 2012-05-06 07:03:29 -0700 (Sun, 06 May 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-05-06]
------------------------------------------------------------------------
r42447 | wmeier | 2012-05-05 14:47:55 -0700 (Sat, 05 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_abis_oml.c

Prefs callback not required ....

------------------------------------------------------------------------
r42446 | wmeier | 2012-05-05 14:29:13 -0700 (Sat, 05 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_abis_oml.c
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c
   M /trunk/plugins/profinet/packet-dcom-cba-acco.c
   M /trunk/plugins/profinet/packet-dcom-cba.c
   M /trunk/plugins/profinet/packet-pn-dcp.c
   M /trunk/plugins/profinet/packet-pn-mrp.c
   M /trunk/plugins/profinet/packet-pn-mrrt.c
   M /trunk/plugins/profinet/packet-pn-ptcp.c
   M /trunk/plugins/profinet/packet-pn.c
   M /trunk/tap-megaco-common.c
   M /trunk/ui/cli/tap-camelsrt.c
   M /trunk/ui/cli/tap-comparestat.c
   M /trunk/ui/cli/tap-diameter-avp.c
   M /trunk/ui/cli/tap-icmpstat.c
   M /trunk/ui/cli/tap-iostat.c
   M /trunk/ui/cli/tap-iousers.c
   M /trunk/ui/cli/tap-macltestat.c
   M /trunk/ui/cli/tap-megacostat.c
   M /trunk/ui/cli/tap-rlcltestat.c
   M /trunk/ui/cli/tap-rpcprogs.c
   M /trunk/ui/cli/tap-rpcstat.c
   M /trunk/ui/cli/tap-rtp.c
   M /trunk/ui/cli/tap-scsistat.c
   M /trunk/ui/cli/tap-smbsids.c
   M /trunk/ui/cli/tap-smbstat.c

AFAICT '#include sys/types.h' is not needed for these files.

------------------------------------------------------------------------
r42445 | tuexen | 2012-05-05 14:06:16 -0700 (Sat, 05 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c

Fix a typo which resulted in displaying the wrong SCTP stream reset response
sequence number.

------------------------------------------------------------------------
r42444 | wmeier | 2012-05-05 14:00:32 -0700 (Sat, 05 May 2012) | 2 lines
Changed paths:
   M /trunk/summary.c

Actually remove #include <sys/types.h> ....

------------------------------------------------------------------------
r42443 | wmeier | 2012-05-05 13:51:14 -0700 (Sat, 05 May 2012) | 2 lines
Changed paths:
   M /trunk/summary.c
   M /trunk/ui/cli/tap-afpstat.c
   M /trunk/ui/cli/tap-ansi_astat.c
   M /trunk/ui/cli/tap-camelcounter.c
   M /trunk/ui/cli/tap-dcerpcstat.c
   M /trunk/ui/cli/tap-expert.c
   M /trunk/ui/cli/tap-gsm_astat.c
   M /trunk/ui/cli/tap-h225counter.c
   M /trunk/ui/cli/tap-h225rassrt.c
   M /trunk/ui/cli/tap-hosts.c
   M /trunk/ui/cli/tap-icmpv6stat.c
   M /trunk/ui/cli/tap-mgcpstat.c
   M /trunk/ui/cli/tap-protocolinfo.c
   M /trunk/ui/cli/tap-protohierstat.c
   M /trunk/ui/cli/tap-radiusstat.c
   M /trunk/ui/cli/tap-sctpchunkstat.c
   M /trunk/ui/cli/tap-sipstat.c
   M /trunk/ui/cli/tap-sv.c
   M /trunk/ui/cli/tap-wspstat.c
   M /trunk/ui/gtk/afp_stat.c
   M /trunk/ui/gtk/camel_counter.c
   M /trunk/ui/gtk/camel_srt.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_info_dlg.c
   M /trunk/ui/gtk/conversations_eth.c
   M /trunk/ui/gtk/conversations_fc.c
   M /trunk/ui/gtk/conversations_fddi.c
   M /trunk/ui/gtk/conversations_ip.c
   M /trunk/ui/gtk/conversations_ipv6.c
   M /trunk/ui/gtk/conversations_ipx.c
   M /trunk/ui/gtk/conversations_jxta.c
   M /trunk/ui/gtk/conversations_ncp.c
   M /trunk/ui/gtk/conversations_rsvp.c
   M /trunk/ui/gtk/conversations_sctp.c
   M /trunk/ui/gtk/conversations_tcpip.c
   M /trunk/ui/gtk/conversations_tr.c
   M /trunk/ui/gtk/conversations_udpip.c
   M /trunk/ui/gtk/conversations_usb.c
   M /trunk/ui/gtk/conversations_wlan.c
   M /trunk/ui/gtk/diameter_stat.c
   M /trunk/ui/gtk/dissector_tables_dlg.c
   M /trunk/ui/gtk/drag_and_drop.c
   M /trunk/ui/gtk/edit_packet_comment_dlg.c
   M /trunk/ui/gtk/expert_comp_dlg.c
   M /trunk/ui/gtk/fc_stat.c
   M /trunk/ui/gtk/funnel_stat.c
   M /trunk/ui/gtk/gsm_map_summary.c
   M /trunk/ui/gtk/gtp_stat.c
   M /trunk/ui/gtk/gui_stat_util.c
   M /trunk/ui/gtk/h225_counter.c
   M /trunk/ui/gtk/h225_ras_srt.c
   M /trunk/ui/gtk/hostlist_eth.c
   M /trunk/ui/gtk/hostlist_fc.c
   M /trunk/ui/gtk/hostlist_fddi.c
   M /trunk/ui/gtk/hostlist_ip.c
   M /trunk/ui/gtk/hostlist_ipv6.c
   M /trunk/ui/gtk/hostlist_ipx.c
   M /trunk/ui/gtk/hostlist_jxta.c
   M /trunk/ui/gtk/hostlist_ncp.c
   M /trunk/ui/gtk/hostlist_rsvp.c
   M /trunk/ui/gtk/hostlist_sctp.c
   M /trunk/ui/gtk/hostlist_tcpip.c
   M /trunk/ui/gtk/hostlist_tr.c
   M /trunk/ui/gtk/hostlist_udpip.c
   M /trunk/ui/gtk/hostlist_usb.c
   M /trunk/ui/gtk/hostlist_wlan.c
   M /trunk/ui/gtk/io_stat.c
   M /trunk/ui/gtk/ldap_stat.c
   M /trunk/ui/gtk/mac_lte_stat_dlg.c
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/manual_addr_resolv.c
   M /trunk/ui/gtk/mcast_stream.c
   M /trunk/ui/gtk/megaco_stat.c
   M /trunk/ui/gtk/mgcp_stat.c
   M /trunk/ui/gtk/mtp3_summary.c
   M /trunk/ui/gtk/ncp_stat.c
   M /trunk/ui/gtk/packet_win.c
   M /trunk/ui/gtk/radius_stat.c
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c
   M /trunk/ui/gtk/rtp_stream.c
   M /trunk/ui/gtk/sctp_chunk_stat.c
   M /trunk/ui/gtk/smb2_stat.c
   M /trunk/ui/gtk/smb_stat.c
   M /trunk/ui/gtk/summary_dlg.c
   M /trunk/ui/gtk/tap_param_dlg.c
   M /trunk/ui/gtk/wlan_stat_dlg.c

AFAICT '#include sys/types.h' is not needed for these files.

------------------------------------------------------------------------
r42442 | cmaynard | 2012-05-05 11:54:27 -0700 (Sat, 05 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

Display CHAP password's Ident and String components.

------------------------------------------------------------------------
r42441 | pascal | 2012-05-05 10:35:35 -0700 (Sat, 05 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6906 :
Restore dissection without private key when RSA-NULL-MD5 or RSA-NULL-SHA cipher is used 

------------------------------------------------------------------------
r42440 | wmeier | 2012-05-05 09:02:36 -0700 (Sat, 05 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.nmake

Cosmetic change....

------------------------------------------------------------------------
r42439 | morriss | 2012-05-05 08:09:19 -0700 (Sat, 05 May 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/main_filter_toolbar.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6892 :

Sort the recent filters list by "most recently used" (that is, put the most
recently used filter at the head of the list).

------------------------------------------------------------------------
r42438 | morriss | 2012-05-05 07:37:19 -0700 (Sat, 05 May 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_filter_toolbar.c

Clean up white space and indentation; remove tabs.
------------------------------------------------------------------------
r42437 | pascal | 2012-05-04 21:57:40 -0700 (Fri, 04 May 2012) | 4 lines
Changed paths:
   M /trunk/plugins/opcua/opcua_simpletypes.c

From Nhi Nguyen:
OPC UA bytestring node id decoding is wrong
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7226

------------------------------------------------------------------------
r42436 | guy | 2012-05-04 19:52:41 -0700 (Fri, 04 May 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/mp2t.c

Directly calculate the time stamp based on the offset in the stream from
the first bit in the stream.  This prevents accumulated truncation
errors.

Get the seek offset from file_tell().

------------------------------------------------------------------------
r42435 | morriss | 2012-05-04 18:55:21 -0700 (Fri, 04 May 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Add support for Israeli national variant of (ITU) ISUP; Only the BCM
message is decoded for now.

Also clean up lots of white space and replace tabs (including 4-space tabs)
with spaces.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=4231

------------------------------------------------------------------------
r42434 | morriss | 2012-05-04 17:19:49 -0700 (Fri, 04 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cipsafety.c
   M /trunk/epan/dissectors/packet-dvbci.c
   M /trunk/epan/dissectors/packet-eap.c

Fix some more hf encodings.
------------------------------------------------------------------------
r42433 | morriss | 2012-05-04 17:03:59 -0700 (Fri, 04 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-aastra-aasp.c
   M /trunk/epan/dissectors/packet-bfd.c
   M /trunk/epan/dissectors/packet-bzr.c

Fix some encoding arguments.
------------------------------------------------------------------------
r42432 | morriss | 2012-05-04 16:49:07 -0700 (Fri, 04 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

As suggested in http://www.wireshark.org/lists/wireshark-dev/201204/msg00062.html :
  
Don't use ENC_BIG_ENDIAN or ENC_LITTLE_ENDIAN with ENC_ASCII: ASCII has no
endianism, so ENC_NA is more appropriate.

------------------------------------------------------------------------
r42431 | morriss | 2012-05-04 14:56:32 -0700 (Fri, 04 May 2012) | 15 lines
Changed paths:
   M /trunk/configure.in
   M /trunk/epan/emem.c
   M /trunk/epan/emem.h

The rest of the fix for https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7221
(emem alignment problems on SPARC) :

Have emem use 8-byte alignment when we need it.

Since I can't seem to write code that which reliably (across GCC versions and
optimization levels) determines if 8-byte alignment is needed for doubles,
"when" is defined as "if we're compiling for a CPU other than i386."

Windows doesn't need a check because it's either i386 or 64-bit (x86_64 or
maybe ia64--both of which get 8-byte alignment from G_MEM_ALIGN).

(And, yes, all of this is ignoring the 16-byte alignment requirements of long
doubles.)

------------------------------------------------------------------------
r42430 | wmeier | 2012-05-04 14:39:30 -0700 (Fri, 04 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-brdwlk.c

AFAICT sys/types.h & netinet/in.h #includes are not needed.
Also: remove "boilerplate" comment and do whitespace cleanup.

------------------------------------------------------------------------
r42429 | wmeier | 2012-05-04 14:29:00 -0700 (Fri, 04 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ansi_637.c
   M /trunk/epan/dissectors/packet-ansi_683.c
   M /trunk/epan/dissectors/packet-ansi_801.c
   M /trunk/epan/dissectors/packet-bssap.c
   M /trunk/epan/dissectors/packet-csm-encaps.c
   M /trunk/epan/dissectors/packet-dcerpc-bossvr.c
   M /trunk/epan/dissectors/packet-dcerpc-cds_clerkserver.c
   M /trunk/epan/dissectors/packet-dcerpc-cds_solicit.c
   M /trunk/epan/dissectors/packet-dcerpc-conv.c
   M /trunk/epan/dissectors/packet-dcerpc-cprpc_server.c
   M /trunk/epan/dissectors/packet-dcerpc-dtsprovider.c
   M /trunk/epan/dissectors/packet-dcerpc-dtsstime_req.c
   M /trunk/epan/dissectors/packet-dcerpc-fileexp.c
   M /trunk/epan/dissectors/packet-dcerpc-fldb.c
   M /trunk/epan/dissectors/packet-dcerpc-ftserver.c
   M /trunk/epan/dissectors/packet-dcerpc-icl_rpc.c
   M /trunk/epan/dissectors/packet-dcerpc-krb5rpc.c
   M /trunk/epan/dissectors/packet-dcerpc-llb.c
   M /trunk/epan/dissectors/packet-dcerpc-rdaclif.c
   M /trunk/epan/dissectors/packet-dcerpc-rep_proc.c
   M /trunk/epan/dissectors/packet-dcerpc-roverride.c
   M /trunk/epan/dissectors/packet-dcerpc-rpriv.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_acct.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_attr.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_attr_schema.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_bind.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_misc.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_pgo.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_prop_acct.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_prop_acl.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_prop_attr.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_prop_pgo.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_prop_plcy.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_pwd_mgmt.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_repadm.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_replist.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_repmgr.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_unix.c
   M /trunk/epan/dissectors/packet-dcerpc-rsec_login.c
   M /trunk/epan/dissectors/packet-dcerpc-secidmap.c
   M /trunk/epan/dissectors/packet-dcerpc-tkn4int.c
   M /trunk/epan/dissectors/packet-dcerpc-ubikdisk.c
   M /trunk/epan/dissectors/packet-dcerpc-ubikvote.c
   M /trunk/epan/dissectors/packet-dcerpc-update.c
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fcct.c
   M /trunk/epan/dissectors/packet-fcels.c
   M /trunk/epan/dissectors/packet-fcfcs.c
   M /trunk/epan/dissectors/packet-fclctl.c
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-fcsb3.c
   M /trunk/epan/dissectors/packet-fcsp.c
   M /trunk/epan/dissectors/packet-fmp.c
   M /trunk/epan/dissectors/packet-fmp_notify.c
   M /trunk/epan/dissectors/packet-gsm_sms.c
   M /trunk/epan/dissectors/packet-gssapi.c
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-ipmi-app.c
   M /trunk/epan/dissectors/packet-ipmi-bridge.c
   M /trunk/epan/dissectors/packet-ipmi-chassis.c
   M /trunk/epan/dissectors/packet-ipmi-picmg.c
   M /trunk/epan/dissectors/packet-ipmi-pps.c
   M /trunk/epan/dissectors/packet-ipmi-se.c
   M /trunk/epan/dissectors/packet-ipmi-storage.c
   M /trunk/epan/dissectors/packet-ipmi-transport.c
   M /trunk/epan/dissectors/packet-ipmi-update.c
   M /trunk/epan/dissectors/packet-ipmi.c
   M /trunk/epan/dissectors/packet-isns.c
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ndp.c
   M /trunk/epan/dissectors/packet-nt-tpcp.c
   M /trunk/epan/dissectors/packet-olsr.c
   M /trunk/epan/dissectors/packet-tzsp.c

AFAICT sys/types.h & netinet/in.h #includes are not needed for these files.
(Let's see if any of the buildbots give any errors).
Also: remove trailing whitespace on lines.

------------------------------------------------------------------------
r42428 | pascal | 2012-05-04 14:20:22 -0700 (Fri, 04 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/epan/dissectors/packet-lte-rrc.c

Fix typo error

------------------------------------------------------------------------
r42427 | guy | 2012-05-04 14:18:01 -0700 (Fri, 04 May 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/k12.c

Clean up indentation.

------------------------------------------------------------------------
r42426 | darkjames | 2012-05-04 12:50:44 -0700 (Fri, 04 May 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-websocket.c

Websocket masked tvb was never freed, set it as child of original tvb.
Also change data memory allocator from ep_ to glib one.

------------------------------------------------------------------------
r42425 | pascal | 2012-05-04 10:56:28 -0700 (Fri, 04 May 2012) | 3 lines
Changed paths:
   M /trunk/asn1/lte-rrc/lte-rrc.cnf
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/epan/dissectors/packet-lte-rrc.c

FALSE -> ENC_BIG_ENDIAN conversion
Enhance dissesction of SoundingRS-UL-ConfigDedicated/setup/duration parameter

------------------------------------------------------------------------
r42424 | guy | 2012-05-04 10:18:15 -0700 (Fri, 04 May 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/ngsniffer.c

ng_file_seek_rand() is supposed to return a Boolean; make it do so.

------------------------------------------------------------------------
r42423 | guy | 2012-05-04 09:56:18 -0700 (Fri, 04 May 2012) | 13 lines
Changed paths:
   M /trunk/wiretap/5views.c
   M /trunk/wiretap/aethra.c
   M /trunk/wiretap/airopeek9.c
   M /trunk/wiretap/ascendtext.c
   M /trunk/wiretap/ber.c
   M /trunk/wiretap/btsnoop.c
   M /trunk/wiretap/catapult_dct2000.c
   M /trunk/wiretap/commview.c
   M /trunk/wiretap/cosine.c
   M /trunk/wiretap/csids.c
   M /trunk/wiretap/daintree-sna.c
   M /trunk/wiretap/dbs-etherwatch.c
   M /trunk/wiretap/dct3trace.c
   M /trunk/wiretap/erf.c
   M /trunk/wiretap/etherpeek.c
   M /trunk/wiretap/eyesdn.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/hcidump.c
   M /trunk/wiretap/i4btrace.c
   M /trunk/wiretap/ipfix.c
   M /trunk/wiretap/iptrace.c
   M /trunk/wiretap/iseries.c
   M /trunk/wiretap/k12.c
   M /trunk/wiretap/k12text.l
   M /trunk/wiretap/lanalyzer.c
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/mime_file.c
   M /trunk/wiretap/mpeg.c
   M /trunk/wiretap/netmon.c
   M /trunk/wiretap/netscaler.c
   M /trunk/wiretap/netscreen.c
   M /trunk/wiretap/nettl.c
   M /trunk/wiretap/network_instruments.c
   M /trunk/wiretap/netxray.c
   M /trunk/wiretap/ngsniffer.c
   M /trunk/wiretap/packetlogger.c
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/radcom.c
   M /trunk/wiretap/snoop.c
   M /trunk/wiretap/tnef.c
   M /trunk/wiretap/toshiba.c
   M /trunk/wiretap/visual.c
   M /trunk/wiretap/vms.c
   M /trunk/wiretap/vwr.c
   M /trunk/wiretap/wtap-int.h

file_seek() used to be a wrapper around fseek() or gzseek(), both of
which could use lseek() and were thus expensive due to system call
overhead.  To avoid making a system call for every packet on a
sequential read, we maintained a data_offset field in the wtap structure
for sequential reads.

It's now a routine that just returns information from the FILE_T data
structure, so it's cheap.  Use it, rather than maintaining the data_offset
field.

Readers for some file formats need to maintain file offset themselves;
have them do so in their private data structures.

------------------------------------------------------------------------
r42422 | pascal | 2012-05-04 09:35:59 -0700 (Fri, 04 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

FALSE -> ENC_BIG_ENDIAN conversion

------------------------------------------------------------------------
r42421 | etxrab | 2012-05-04 08:10:31 -0700 (Fri, 04 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c

Set up conversations for the FP data flow.
------------------------------------------------------------------------
r42420 | darkjames | 2012-05-04 03:28:16 -0700 (Fri, 04 May 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/packet_win.c

Fix opening packet window when frame has got cap_len = 0 (i.e. last frame from mime_file reader)

Workaround, if someone has better idea how to fix it, please do.

------------------------------------------------------------------------
r42419 | darkjames | 2012-05-04 01:17:46 -0700 (Fri, 04 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/CMakeLists.txt

Add proto_hier_tree_model.c to CMakeLists

------------------------------------------------------------------------
r42418 | darkjames | 2012-05-04 00:34:06 -0700 (Fri, 04 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btobex.c
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-nas_eps.c
   M /trunk/epan/dissectors/packet-rsl.c

value_string_ext: Reorder entries in value_string arrays to get Binary Search instead of Linear Search.

------------------------------------------------------------------------
r42417 | darkjames | 2012-05-04 00:27:41 -0700 (Fri, 04 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Fix conflicting entries in CIP vendor list.

344 is registered to KEBA.
(Ref: http://www.odva.org/Home/CIPSUPPLIERDIRECTORY/LicensedVendorList/tabid/86/lng/en-US/Default.aspx)


------------------------------------------------------------------------
r42416 | etxrab | 2012-05-03 23:31:31 -0700 (Thu, 03 May 2012) | 1 line
Changed paths:
   M /trunk/asn1/nbap/nbap.cnf
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-ranap.c

Dissect transport layer address NSAP
------------------------------------------------------------------------
r42415 | darkjames | 2012-05-03 23:08:22 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/proto_hier_tree_model.c

cleanup proto_hier_tree_model a little.

------------------------------------------------------------------------
r42414 | darkjames | 2012-05-03 22:56:38 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_proto_draw.c

Fix memleak of GtkTextBuffer

------------------------------------------------------------------------
r42413 | guy | 2012-05-03 22:43:48 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/netscaler.c

Fix comments.

------------------------------------------------------------------------
r42412 | guy | 2012-05-03 22:42:42 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/netscaler.c

Get rid of declaration of non-existent routine.

------------------------------------------------------------------------
r42411 | etxrab | 2012-05-03 21:44:23 -0700 (Thu, 03 May 2012) | 1 line
Changed paths:
   M /trunk/epan/libwireshark.def
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h
   M /trunk/ui/gtk/Makefile.common
   M /trunk/ui/gtk/dfilter_expr_dlg.c
   A /trunk/ui/gtk/proto_hier_tree_model.c
   A /trunk/ui/gtk/proto_hier_tree_model.h

From Jakub Zawadzki: Use custom model in Filter Expression dialog.
------------------------------------------------------------------------
r42410 | etxrab | 2012-05-03 21:35:43 -0700 (Thu, 03 May 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/main.c

From Evan Huus: - Make sure that unsupported link-layer types *always* have a dlt of -1 in the `device.links` list so that we can tell if they're unsupported. - When building the combo-box of link-layer types, make the unsupported ones insensitive (disabled), and be sure to default to a supported one if we have one. - Compiling a capture filter requires a supported link-layer type, so disable the 'Compile BPF' button if there are none. - It is not always a programming error to have no active pointer in the combo-box, as this can happen when all the available entries are unsupported (and thus disabled). Don't abort with g_assert_not_reached() when this happens. - Unlock the `pcap_compile_mtx` mutex in all cases after compiling a packet filter. This was causing a deadlock (complete program hang) if you tried to compile two different filters in a row on the same interface. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7135
------------------------------------------------------------------------
r42409 | guy | 2012-05-03 19:35:12 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/netscaler.c

Make everything static that doesn't need to be exported.

------------------------------------------------------------------------
r42408 | guy | 2012-05-03 19:16:51 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/netscaler.c

Fix indentation.

------------------------------------------------------------------------
r42407 | morriss | 2012-05-03 18:33:58 -0700 (Thu, 03 May 2012) | 14 lines
Changed paths:
   M /trunk/epan/emem.c

Partial fix for https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7221
(emem alignment problems on SPARC) :

Add the room for the pointer to the next (from r31577) *before* calculating
the canary+pad: that way the complete allocation
(allocation+canary_ptr+canary+pad) will end on an 8-byte boundary (as was the
case before r31577).

This only solves the alignment problem when using canaries (i.e., not, by
default, se_ allocations).

(And, yes, this is ignoring the 16-byte alignment requirements of long
doubles.)

------------------------------------------------------------------------
r42406 | wmeier | 2012-05-03 14:35:54 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Don't use spaces before (and after) packet-waveagent.c entry

------------------------------------------------------------------------
r42405 | wmeier | 2012-05-03 14:01:22 -0700 (Thu, 03 May 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mdshdr.c
   M /trunk/epan/dissectors/packet-mpeg-sect.c
   M /trunk/epan/dissectors/packet-newmail.c

General cleanup including:
- remove unneeded #includes;
- remove "boilerplate" coments;
- reformat long lines;
- whitespace changes.

------------------------------------------------------------------------
r42404 | wmeier | 2012-05-03 13:35:44 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcfzs.c

More whitespace cleanup;

------------------------------------------------------------------------
r42403 | wmeier | 2012-05-03 13:15:53 -0700 (Thu, 03 May 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcfzs.c

General cleanup:
- use gboolean instead of gint8 for a TRUE/FALSE flag;
- remove unneeded #includes;
- remove "boilerplate" comments;
- reformat hf[] entries;
- whitespace fixes.

------------------------------------------------------------------------
r42402 | wmeier | 2012-05-03 12:31:03 -0700 (Thu, 03 May 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-fcsb3.c
   M /trunk/epan/dissectors/packet-fcsp.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-fddi.c
   M /trunk/epan/dissectors/packet-fefd.c
   M /trunk/epan/dissectors/packet-fip.c
   M /trunk/epan/dissectors/packet-fix.c
   M /trunk/epan/dissectors/packet-fmp.c
   M /trunk/epan/dissectors/packet-fr.c
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/dissectors/packet-fw1.c

General cleanup to include:
- remove unneeded includes;
- remove "boilerplate" comments;
- reformat hf[] entries;
- reformat long lines;
- unneeded use of check_col();
- whitespace fixes.

------------------------------------------------------------------------
r42401 | etxrab | 2012-05-03 08:31:45 -0700 (Thu, 03 May 2012) | 1 line
Changed paths:
   M /trunk/epan/uat.h

Fix a typo.
------------------------------------------------------------------------
r42400 | etxrab | 2012-05-03 08:31:01 -0700 (Thu, 03 May 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Fix a typo.
------------------------------------------------------------------------
r42399 | cmaynard | 2012-05-03 07:51:36 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-ldap.c

Fix Coverity CID 280809 (formerly CID 809): Uninitialized scalar variable.

------------------------------------------------------------------------
r42398 | cmaynard | 2012-05-03 07:35:55 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lldp.c

Delete extraneous return statement, which effectively made the entire dissect_ieee_802_3_tlv() function dead code.  Fixes Coverity CID 281470 (formerly CID 1470).  [I guess the new Coverity version does cross-reference the CID's after all.]

------------------------------------------------------------------------
r42397 | cmaynard | 2012-05-03 07:24:17 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-p1.c

Regenerated the file.

------------------------------------------------------------------------
r42396 | cmaynard | 2012-05-03 07:22:43 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-pes.c

Add back the missing line of code to increment the offset.

------------------------------------------------------------------------
r42395 | cmaynard | 2012-05-03 07:00:56 -0700 (Thu, 03 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp-midi.c

Fix logic bug.  I'm sure this was something Coverity found and I fixed but forgot to commit it.  Unfortunately Coverity has upgraded to Scan 5.5 and things are different now so I can't cross reference which CID this was anymore.

------------------------------------------------------------------------
r42394 | cmaynard | 2012-05-02 18:58:35 -0700 (Wed, 02 May 2012) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Add Klaus Heckelmann to the list of Wireshark authors for his contribution to resolving bug 7221.

------------------------------------------------------------------------
r42393 | cmaynard | 2012-05-02 18:48:59 -0700 (Wed, 02 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c
   M /trunk/epan/dissectors/packet-icmp.h
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/ui/cli/tap-icmpstat.c
   M /trunk/ui/cli/tap-icmpv6stat.c

From Klaus Heckelmann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7221: Avoid wireshark crash on platforms where an 8 byte alignment is required by changing the resp_time field in the icmp_transaction_t from a double to an nstime_t.

------------------------------------------------------------------------
r42392 | pascal | 2012-05-02 14:55:59 -0700 (Wed, 02 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-per.c

Attempt to fix clang warnings (dead assignment, dereference of null pointer, branch condition evaluates to a garbage value)

------------------------------------------------------------------------
r42391 | guy | 2012-05-02 14:25:48 -0700 (Wed, 02 May 2012) | 7 lines
Changed paths:
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/file_wrappers.h

Add a file_skip() routine to skip N bytes forward in the file - it's
currently just a wrapper around file_seek(), but could be implemented by
reading forward if, for example, we add support for reading
(sequentially only!) from a pipe.

Sort the declarations of file-reading routines into one block.

------------------------------------------------------------------------
r42390 | guy | 2012-05-02 14:11:28 -0700 (Wed, 02 May 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/file_wrappers.c

Put all the comments about the "don't check the CRC" flag together, and
expand the resulting comment a bit.

------------------------------------------------------------------------
r42389 | pascal | 2012-05-02 13:40:49 -0700 (Wed, 02 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Attempt to fix clang warnings (dead assignment and dereference of null pointer)

------------------------------------------------------------------------
r42388 | cmaynard | 2012-05-02 13:37:59 -0700 (Wed, 02 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

Properly decrypt user-password according to http://tools.ietf.org/html/rfc2865#section-5.2
This fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6779
#BACKPORT

------------------------------------------------------------------------
r42387 | pascal | 2012-05-02 08:29:50 -0700 (Wed, 02 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-llrp.c

Remove most blurbs (they do not have any added value) and fix a few typo errors

------------------------------------------------------------------------
r42386 | etxrab | 2012-05-02 07:56:51 -0700 (Wed, 02 May 2012) | 1 line
Changed paths:
   M /trunk/epan/nlpid.h

Add missing updated file from previous commit.
------------------------------------------------------------------------
r42385 | etxrab | 2012-05-02 07:23:35 -0700 (Wed, 02 May 2012) | 18 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-clv.c
   M /trunk/epan/dissectors/packet-isis-clv.h
   M /trunk/epan/dissectors/packet-isis-hello.c
   M /trunk/epan/dissectors/packet-isis-lsp.c

From "oss.2nerds":
IEEE P802.1aq/D3.6 and the corresponding IETF draft
(http://tools.ietf.org/html/draft-ietf-isis-ieee-aq-05) defines a series of new
ISIS TLVs for the shortest-path-bridging protocol.

The attached patch file contains a simple dissector for one such TLV (the
MT-Port-Cap TLV) and several corresponding sub-TLVs (mcid, aux_mcid, digest,
and b-vid).  The digest sub-TLV dissector has not been exercised because no
suitable capture files are available (the digest sub-TLV seems not to be widely
implemented at this point in time).

Note that the codepoints mentioned in the IETF draft have changed.  The
IANA-assigned codepoints are further described in these pages:

http://www.ietf.org/mail-archive/web/spb-isis/current/msg00007.html
http://www.iana.org/assignments/isis-tlv-codepoints/isis-tlv-codepoints.xml#tlv-143

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7154
------------------------------------------------------------------------
r42384 | etxrab | 2012-05-02 05:47:59 -0700 (Wed, 02 May 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtn.c
   M /trunk/epan/dissectors/packet-dtn.h

From Jim Wright:
Add decoding of ACS to packet-dtn.c
- Changed to use proto_tree_add_item();

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7220
------------------------------------------------------------------------
r42383 | etxrab | 2012-05-02 04:05:35 -0700 (Wed, 02 May 2012) | 13 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-llrp.c

From Evan Huus:
Given the problems with the original attempt, and the fact that there's a new
version of the protocol spec out (v1.1), I took a crack at writing a new
dissector from scratch. It doesn't decode the fields within the message
parameters (there are far too many to bother with for an initial draft), but it
decodes everything else.

Even though it's not complete, I feel it's worth checking in as an intermediate
step (assuming it passes review), since it's still far better than nothing, and
adding full parameter-field decoding is going to take a lot of time simply for
transcribing all the different fields.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=1957
------------------------------------------------------------------------
r42382 | etxrab | 2012-05-02 03:49:03 -0700 (Wed, 02 May 2012) | 4 lines
Changed paths:
   M /trunk/plugins/docsis/packet-docsis.c

From Gabor Somlai:
Decoding DOCSIS 3.0 Isolation DATA frames (FC_TYPE=10).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7214
------------------------------------------------------------------------
r42381 | etxrab | 2012-05-02 00:23:32 -0700 (Wed, 02 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-gtpv2.c

From David Wei:
Change GTP and GTPv2 dissectors for pre-Rel7 UEs that do not support bitrates higher than 16 Mbps.
------------------------------------------------------------------------
r42380 | guy | 2012-05-01 21:03:49 -0700 (Tue, 01 May 2012) | 4 lines
Changed paths:
   M /trunk/capture_info.c
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ieee80211-netmon.c (from /trunk/epan/dissectors/packet-netmon-802_11.c:42379)
   A /trunk/epan/dissectors/packet-ieee80211-radiotap-defs.h (from /trunk/epan/dissectors/packet-radiotap-defs.h:42375)
   A /trunk/epan/dissectors/packet-ieee80211-radiotap-iter.c (from /trunk/epan/dissectors/packet-radiotap-iter.c:42375)
   A /trunk/epan/dissectors/packet-ieee80211-radiotap-iter.h (from /trunk/epan/dissectors/packet-radiotap-iter.h:42375)
   A /trunk/epan/dissectors/packet-ieee80211-radiotap.c (from /trunk/epan/dissectors/packet-radiotap.c:42379)
   A /trunk/epan/dissectors/packet-ieee80211-radiotap.h (from /trunk/epan/dissectors/packet-radiotap.h:42375)
   D /trunk/epan/dissectors/packet-netmon-802_11.c
   D /trunk/epan/dissectors/packet-radiotap-defs.h
   D /trunk/epan/dissectors/packet-radiotap-iter.c
   D /trunk/epan/dissectors/packet-radiotap-iter.h
   D /trunk/epan/dissectors/packet-radiotap.c
   D /trunk/epan/dissectors/packet-radiotap.h

Rename the NetMon 802.11 radio header and radiotap 802.11 radio header
dissector source files to match the "packet-ieee80211-XXX" pattern used
for other 802.11 radio header dissectors.

------------------------------------------------------------------------
r42379 | guy | 2012-05-01 20:11:00 -0700 (Tue, 01 May 2012) | 7 lines
Changed paths:
   M /trunk/capture_info.c
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ieee80211-airopeek.c
   M /trunk/epan/dissectors/packet-ieee80211-prism.c
   M /trunk/epan/dissectors/packet-ieee80211-wlancap.c
   M /trunk/epan/dissectors/packet-netmon-802_11.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-tzsp.c
   M /trunk/wiretap/etherpeek.c
   M /trunk/wiretap/netmon.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

Use WTAP_ENCAP_IEEE_802_11_xxx for all the "802.11 plus radio header"
encapsulations.

For pre-V9 AiroPeek captures, leave the radio information in the packet
data, just as we do with the Prism, AVS, radiotap, and NetMon headers. 
Add a dissector for it.

------------------------------------------------------------------------
r42378 | guy | 2012-05-01 19:30:56 -0700 (Tue, 01 May 2012) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Reflect the rename of packet-airopeek.c to packet-peekremote.c.

------------------------------------------------------------------------
r42377 | guy | 2012-05-01 18:44:40 -0700 (Tue, 01 May 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   D /trunk/epan/dissectors/packet-airopeek.c
   A /trunk/epan/dissectors/packet-peekremote.c (from /trunk/epan/dissectors/packet-airopeek.c:42375)

Rename packet-airopeek.c to packet-peekremote.c, and rename the protocol
as well, as it may also be used by OmniPeek.  Add some comments about
it.

------------------------------------------------------------------------
r42376 | guy | 2012-05-01 15:29:08 -0700 (Tue, 01 May 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Remove unnecessary null-pointer check.

------------------------------------------------------------------------
r42375 | morriss | 2012-05-01 11:59:12 -0700 (Tue, 01 May 2012) | 1 line
Changed paths:
   M /trunk/tools/list_protos_in_cap.sh
   M /trunk/tools/svnadd
   M /trunk/tools/test-fuzzed-cap.sh
   M /trunk/tools/valgrind-wireshark.sh

Add copyright notices. Fix SVN properties on svnadd.
------------------------------------------------------------------------
r42373 | cmaynard | 2012-04-30 19:47:52 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Fix 2 redundant redeclaration warnings and a bug where logical AND (&&) was incorrectly used where bit-wise AND (&) was meant.

------------------------------------------------------------------------
r42372 | wmeier | 2012-04-30 19:42:51 -0700 (Mon, 30 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Add new HTTP Status Codes from RFC 6585;
Also: Add codes 226 & 426 as specified in the IANA HTTP Status Code Registry

------------------------------------------------------------------------
r42371 | guy | 2012-04-30 18:04:24 -0700 (Mon, 30 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c

Indicate why the flags have a field width of 6.

Add the RFC numbers for the BFD RFCs, and a URL for the last I-D that
discussed version 0.

------------------------------------------------------------------------
r42370 | cmaynard | 2012-04-30 18:00:28 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/pidl/frsrpc.cnf

Forgot to commit this change with r42341 which initializes 'type' to 0 to avoid a clang warning.

------------------------------------------------------------------------
r42368 | guy | 2012-04-30 16:08:26 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c

No C++-style comments, please; some C compilers reject them.

------------------------------------------------------------------------
r42367 | guy | 2012-04-30 16:03:51 -0700 (Mon, 30 Apr 2012) | 9 lines
Changed paths:
   M /trunk/plugins/gryphon/packet-gryphon.c

The message length isn't needed in cmd_sched_rep() - it's just the
containing packet length, so if we go past it, we'll get an exception
thrown.  Get rid of it.

The answer to "Should msglen be returned instead of offset?" is "no" -
the command dissectors return the new offset.

Get rid of an unused - and unnecessary - variable.

------------------------------------------------------------------------
r42366 | guy | 2012-04-30 15:05:33 -0700 (Mon, 30 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c

Add some initializations to squelch (bogus) warnings (either the version
is 0 or it isn't, so the variables are not, in fact, used uninitialized).

------------------------------------------------------------------------
r42365 | alagoutte | 2012-04-30 14:54:45 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

Try to fix some Logic error (Function call argument is an uninitialized value ) Warning found by Clang

------------------------------------------------------------------------
r42364 | wmeier | 2012-04-30 14:50:21 -0700 (Mon, 30 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c

Rework code slightly:
 - use proto_tree_add_item() istead of tvb_get...()/proto_tree_add_uint() in a few cases;
 - misc ...
Also: Whitespace cleanup and reformatting of hf[] entries.

------------------------------------------------------------------------
r42363 | gerald | 2012-04-30 14:32:51 -0700 (Mon, 30 Apr 2012) | 4 lines
Changed paths:
   M /trunk/manuf
   M /trunk/tools/make-manuf

Switch to UTF-8 for remote encodings to match what the IEEE SA is
almost-but-not-quite sending. Add a link to a page with common character 
encoding errors.

------------------------------------------------------------------------
r42362 | alagoutte | 2012-04-30 14:15:17 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aim.c
   M /trunk/epan/dissectors/packet-ajp13.c
   M /trunk/epan/dissectors/packet-cops.c
   M /trunk/epan/dissectors/packet-db-lsp.c
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-dnp.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-edonkey.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r42361 | wmeier | 2012-04-30 13:49:19 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c

Parenthesize an expression to prevent a possible overflow resulting an incorrect result.

------------------------------------------------------------------------
r42360 | cmaynard | 2012-04-30 13:38:13 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Remove unused variable not found by MSVC2010EE but found by OSX buildbot.

------------------------------------------------------------------------
r42359 | cmaynard | 2012-04-30 13:24:33 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Add Selective Directed Broadcast (RFC 1770) IP option dissection support.

------------------------------------------------------------------------
r42358 | gerald | 2012-04-30 13:15:46 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/plugins/gryphon/packet-gryphon.c

Fix a couple of clang warnings and adjust capitalization.

------------------------------------------------------------------------
r42357 | wmeier | 2012-04-30 12:55:24 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c
   M /trunk/epan/dissectors/packet-dcerpc-dce122.c
   M /trunk/epan/dissectors/packet-dcom.c
   M /trunk/epan/dissectors/packet-ua3g.c

Don't use tabs in string constants;

------------------------------------------------------------------------
r42356 | wmeier | 2012-04-30 12:20:59 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Revert 3 conversions of  spaces --> tabs (in text strings) done in SVN #42354.

------------------------------------------------------------------------
r42355 | pascal | 2012-04-30 12:14:14 -0700 (Mon, 30 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-6lowpan.c
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-dvbci.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

From Martin Kaiser:
Fix some 'intermediate pointers must be const qualified' warnings
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7215

------------------------------------------------------------------------
r42354 | wmeier | 2012-04-30 12:08:15 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Whitespace cleanup; reformat hf[] entries.

------------------------------------------------------------------------
r42353 | cmaynard | 2012-04-30 10:32:33 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Add MTU probe, MTU reply and Traceroute IP option dissection support.

------------------------------------------------------------------------
r42352 | gerald | 2012-04-30 10:15:43 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Update the annotations item.

------------------------------------------------------------------------
r42351 | pascal | 2012-04-30 09:45:03 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/asn1/rrlp/RRLP-Components.asn
   M /trunk/asn1/rrlp/RRLP-Messages.asn
   M /trunk/asn1/rrlp/packet-rrlp-template.c
   M /trunk/epan/dissectors/packet-rrlp.c

Update comments with the RRLP version currently dissected

------------------------------------------------------------------------
r42350 | pascal | 2012-04-30 08:57:39 -0700 (Mon, 30 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-multipart.c

From Evan Huus:
Fix memory leak in process_body_part() when there is no body
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7212

------------------------------------------------------------------------
r42349 | gerald | 2012-04-30 08:40:39 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/tools/make-manuf

Update the IEEE OUI and IAB URLs.

------------------------------------------------------------------------
r42348 | cmaynard | 2012-04-30 07:29:54 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Add missing RFC791 PROG security definition.  Reorder ipopts[] so it matches the order at http://www.iana.org/assignments/ip-parameters, which is ordered by 'Number'.  Use the descriptions as they appear there as well.  Add TODO placeholders in ipopt[] for the yet-to-be-implemented options.

------------------------------------------------------------------------
r42347 | pascal | 2012-04-30 07:05:22 -0700 (Mon, 30 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
fix a few clang warnings in DVB-CI dissector
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7215

------------------------------------------------------------------------
r42346 | pascal | 2012-04-30 06:43:52 -0700 (Mon, 30 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hdcp.c

From Martin Kaiser:
Fix clang warnings in HDCP dissector
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7217

------------------------------------------------------------------------
r42345 | morriss | 2012-04-30 06:20:27 -0700 (Mon, 30 Apr 2012) | 4 lines
Changed paths:
   M /trunk/tools/valgrind-wireshark.sh

From Evan Huus via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7218 :

Add 'track-origins' option flag to valgrind script.

------------------------------------------------------------------------
r42344 | pascal | 2012-04-30 02:00:05 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-gtpv2.c

Fix some clang warnings (dead assignment/increment, assigned value is garbage or undefined)

------------------------------------------------------------------------
r42343 | pascal | 2012-04-30 01:38:26 -0700 (Mon, 30 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gprs-llc.c
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk/epan/dissectors/packet-gsm_sms.c

Fix a few clang warnings

------------------------------------------------------------------------
r42342 | pascal | 2012-04-30 01:21:09 -0700 (Mon, 30 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7064 :
Dissect basic security option according to RFC 791 or RFC 1108 depending on the option length and the first two bytes content.
Also dissect the extended security option.

------------------------------------------------------------------------
r42341 | cmaynard | 2012-04-29 16:39:55 -0700 (Sun, 29 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-frsrpc.c

Fix a clang warning due to 'type' not being initialized.

------------------------------------------------------------------------
r42340 | pascal | 2012-04-29 11:25:06 -0700 (Sun, 29 Apr 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Fix typo errors

------------------------------------------------------------------------
r42333 | gerald | 2012-04-29 07:03:30 -0700 (Sun, 29 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-04-29]
------------------------------------------------------------------------
r42330 | guy | 2012-04-28 19:49:17 -0700 (Sat, 28 Apr 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/file_access.c

Add ".dmp" as a suffix for pcap files of various flavors.  Add ".ntar"
as a suffix for pcap-ng files.

------------------------------------------------------------------------
r42329 | guy | 2012-04-28 19:38:55 -0700 (Sat, 28 Apr 2012) | 4 lines
Changed paths:
   M /trunk/packaging/nsis/wireshark.nsi

Add .ntar as a suffix (some pcap-ng files use it).

Sort the suffixes alphabetically.

------------------------------------------------------------------------
r42328 | guy | 2012-04-28 19:27:08 -0700 (Sat, 28 Apr 2012) | 8 lines
Changed paths:
   M /trunk/packaging/macosx/Info.plist.in

Make the extension lower case.

Say "Pcap" rather than "Libpcap" - pcap format is used by WinPcap as
well (and it's also read and written by this library called Wiretap
:-)).

Add an additional entry for pcap-NG.

------------------------------------------------------------------------
r42327 | martinm | 2012-04-28 16:58:06 -0700 (Sat, 28 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

Check result of sscanf(), and avoid a mirrored variable declaration.
From Visual Studio Analyzer output.

------------------------------------------------------------------------
r42326 | martinm | 2012-04-28 16:14:54 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Avoid needlessly shadowing a variable.  From Visual Studio Analyzer.

------------------------------------------------------------------------
r42325 | cmaynard | 2012-04-28 11:50:20 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

Initialize u32RecDataLen to 0 to avoid a clang warning and in the event it never gets initialized in either dissect_IODWriteReqHeader_block() or dissect_IODReadReqHeader_block().

------------------------------------------------------------------------
r42324 | cmaynard | 2012-04-28 11:23:19 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-ndr.c

Initialize val to 0 in case pdata != NULL but "di->conformant_run" is TRUE so the *pdata won't contain garbage as reported by clang.

------------------------------------------------------------------------
r42323 | cmaynard | 2012-04-28 11:05:27 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Fix dead initialization warning reported by clang.

------------------------------------------------------------------------
r42322 | guy | 2012-04-28 10:57:41 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x25.c

Fix long name for reverse charging field.

------------------------------------------------------------------------
r42321 | guy | 2012-04-28 10:42:55 -0700 (Sat, 28 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x25.c

Remove redundant "X.25".  (I'm not sure why the protcol name is included
in the reassembly information both here and, for example, IPv4 fragment
reassembly, but perhaps those are redundant as well.)

------------------------------------------------------------------------
r42320 | cmaynard | 2012-04-28 10:42:23 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dect.c

Initialize the bits[] array to zero.

------------------------------------------------------------------------
r42319 | pascal | 2012-04-28 10:34:23 -0700 (Sat, 28 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x25.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7213:
Update dissection of Reverse charging, fast select, and ICRD status selection facilities

------------------------------------------------------------------------
r42318 | pascal | 2012-04-28 09:48:16 -0700 (Sat, 28 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

From Evan Huus:
Remove unused variables in SMB dissector
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7211

------------------------------------------------------------------------
r42317 | martinm | 2012-04-28 09:48:11 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ftp.c

Avoid assignement and clang warning.

------------------------------------------------------------------------
r42316 | martinm | 2012-04-28 09:40:54 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Another unnecessary assignment removed to fix clang warning.

------------------------------------------------------------------------
r42315 | martinm | 2012-04-28 09:33:19 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ms-mms.c

Remove move unread updates to 'offset' to avoid clang warnings.

------------------------------------------------------------------------
r42314 | martinm | 2012-04-28 09:23:23 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

Don't look up p_fp_info only to always overwrite it.

------------------------------------------------------------------------
r42313 | martinm | 2012-04-28 09:18:28 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c

Test a return value to avoid an initialised warning from clang.

------------------------------------------------------------------------
r42312 | martinm | 2012-04-28 09:11:54 -0700 (Sat, 28 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Remove an unnecessary assignment from clang output. I can't see the
problem with the other 2 warnings for this file.
--This linen , and those below, will be ignored--

M    packet-umts_fp.c

------------------------------------------------------------------------
r42311 | guy | 2012-04-28 09:05:18 -0700 (Sat, 28 Apr 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Remove _U_ from arguments that are actually used.

Fix a comment.

------------------------------------------------------------------------
r42310 | martinm | 2012-04-28 08:57:50 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ixveriwave.c

Remove a couple of unused assignments pointed out by clang.

------------------------------------------------------------------------
r42309 | pascal | 2012-04-28 06:37:41 -0700 (Sat, 28 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Remove unused header fields

------------------------------------------------------------------------
r42308 | pascal | 2012-04-28 06:20:41 -0700 (Sat, 28 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7051 :
Add option 82 suboptions 150/151/152 decoding to DHCP dissector

------------------------------------------------------------------------
r42307 | sahlberg | 2012-04-28 01:16:17 -0700 (Sat, 28 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi-sbc.c

SCSI SBC: Add dissection of the ANCHOR and UNMAP bits in WRITESAME10/16


------------------------------------------------------------------------
r42306 | guy | 2012-04-27 20:07:04 -0700 (Fri, 27 Apr 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/dct3trace.c

If xml_get_int() fails, bail immediately; don't use the variable it
would have filled in had it not failed.  (Thanks and a tip of the Hatlo
hat to the Clang static analyzer for complaining about this.)

------------------------------------------------------------------------
r42305 | guy | 2012-04-27 19:25:15 -0700 (Fri, 27 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/crypt/eax.c

Neither C90 nor C99 explicitly guarantee that a memcpy() call with a
null source argument and a zero count will work; in practice, they
probably will (with a zero count, there's nothing to fetch from the
source),  but the Clang static analyzer still warns about it.

------------------------------------------------------------------------
r42304 | guy | 2012-04-27 19:01:40 -0700 (Fri, 27 Apr 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Get rid of some unnecessary assignments, to remove warnings from the
Clang static analyzer.

------------------------------------------------------------------------
r42303 | darkjames | 2012-04-27 13:49:15 -0700 (Fri, 27 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

Like r42302 but in other place.

Followup to r42283: the loop which allocates operation summaries may not run
to completion, so don't try to free all the operation summaries.

------------------------------------------------------------------------
r42302 | morriss | 2012-04-27 13:43:22 -0700 (Fri, 27 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

Fix fuzz failure reported in 
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7209 :

Followup to r42283: the loop which allocates operation summaries may not run
to completion, so don't try to free all the operation summaries.

------------------------------------------------------------------------
r42301 | darkjames | 2012-04-27 13:35:17 -0700 (Fri, 27 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/dfilter_expr_dlg.c

Fix sigsegv in filter expression dialog when user clicked on some BASE_CUSTOM field.

------------------------------------------------------------------------
r42300 | morriss | 2012-04-27 12:45:35 -0700 (Fri, 27 Apr 2012) | 5 lines
Changed paths:
   M /trunk/plugins/irda/packet-irda.c

As suggested in http://www.wireshark.org/lists/wireshark-dev/201204/msg00062.html :

Don't use ENC_BIG_ENDIAN or ENC_LITTLE_ENDIAN with ENC_ASCII: ASCII has no
endianism, so ENC_NA is more appropriate.

------------------------------------------------------------------------
r42299 | morriss | 2012-04-27 12:18:22 -0700 (Fri, 27 Apr 2012) | 1 line
Changed paths:
   M /trunk/docbook/release-notes.xml

Bugzilla always uses https (and has for quite a while), so use https in the URLs to the bugs.
------------------------------------------------------------------------
r42298 | morriss | 2012-04-27 12:15:24 -0700 (Fri, 27 Apr 2012) | 1 line
Changed paths:
   M /trunk/docbook/release-notes.xml

Based on mail from Guy on -dev regarding the 1.7.1 release notes: Add entry for bug 3315 (save dependent frames when saving displayed packets)
------------------------------------------------------------------------
r42297 | morriss | 2012-04-27 11:58:37 -0700 (Fri, 27 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c
   M /trunk/epan/dissectors/packet-afs.c
   M /trunk/epan/dissectors/packet-atalk.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-eiss.c
   M /trunk/epan/dissectors/packet-elcom.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-jxta.c
   M /trunk/epan/dissectors/packet-mpeg-dsmcc.c
   M /trunk/epan/dissectors/packet-rmp.c
   M /trunk/epan/dissectors/packet-teamspeak2.c

As suggested in http://www.wireshark.org/lists/wireshark-dev/201204/msg00062.html :

Don't use ENC_BIG_ENDIAN or ENC_LITTLE_ENDIAN with ENC_ASCII: ASCII has no
endianism, so ENC_NA is more appropriate.

------------------------------------------------------------------------
r42296 | guy | 2012-04-27 11:31:19 -0700 (Fri, 27 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mim.c

Update commented-out code to reflect the new reality.

------------------------------------------------------------------------
r42295 | morriss | 2012-04-27 10:58:06 -0700 (Fri, 27 Apr 2012) | 1 line
Changed paths:
   M /trunk/tools/fuzz-test.sh

Fix r42293: Make the script actually fail when tshark fails: use a new variable to indicate when we've caught a signal rather than (re-)using MAX_PASSES.
------------------------------------------------------------------------
r42294 | pascal | 2012-04-27 10:36:53 -0700 (Fri, 27 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

From Tom Bottom:
Fix AEM status field decoding
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7205

------------------------------------------------------------------------
r42293 | morriss | 2012-04-27 09:58:21 -0700 (Fri, 27 Apr 2012) | 1 line
Changed paths:
   M /trunk/tools/fuzz-test.sh

Get the script working again in the "unlimited passes" mode.
------------------------------------------------------------------------
r42292 | etxrab | 2012-04-27 07:13:06 -0700 (Fri, 27 Apr 2012) | 4 lines
Changed paths:
   M /trunk/plugins/ethercat/packet-ams.c

Fix Malformed packet AMS for Read Device Info Read State Request.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6710

check if data exists.
------------------------------------------------------------------------
r42291 | darkjames | 2012-04-27 06:54:21 -0700 (Fri, 27 Apr 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/dfilter_expr_dlg.c

Don't store protocol field names in Filter Expression dialog.

Using gtk_tree_view_column_set_cell_data_func() and formating string on request 
gives significant speedup (before patch: 12.392ms, after: 9.779ms).

------------------------------------------------------------------------
r42290 | etxrab | 2012-04-27 04:08:37 -0700 (Fri, 27 Apr 2012) | 4 lines
Changed paths:
   M /trunk/asn1/m3ap/M3AP-CommonDataTypes.asn
   M /trunk/asn1/m3ap/M3AP-Constants.asn
   M /trunk/asn1/m3ap/M3AP-Containers.asn
   M /trunk/asn1/m3ap/M3AP-IEs.asn
   M /trunk/asn1/m3ap/M3AP-PDU-Contents.asn
   M /trunk/asn1/m3ap/M3AP-PDU-Descriptions.asn
   M /trunk/asn1/m3ap/packet-m3ap-template.c
   M /trunk/epan/dissectors/packet-m3ap.c

From David Wei:
Further additions and fixes to MBMS in M3AP dissector.

from me update to 11.1
------------------------------------------------------------------------
r42289 | etxrab | 2012-04-27 03:48:03 -0700 (Fri, 27 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter_3gpp.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-gtpv2.h

From David Wei:
Further additions and fixes to MBMS in GTPv2 and DIAMETER dissectors.
------------------------------------------------------------------------
r42288 | pascal | 2012-04-27 02:04:23 -0700 (Fri, 27 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

Fix typo errors

------------------------------------------------------------------------
r42287 | darkjames | 2012-04-27 01:44:38 -0700 (Fri, 27 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nflog.c

nflog: add BYTE_ORDER_HOST, fix conflicting ENC_BIG_ENDIAN, ENC_NA value_string entries.

------------------------------------------------------------------------
r42286 | etxrab | 2012-04-27 01:44:36 -0700 (Fri, 27 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-usb.h

From Steve Magnani:
Add decoding of fields within endpoint descriptor wMaxPacketSize

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7206
------------------------------------------------------------------------
r42285 | darkjames | 2012-04-27 01:41:44 -0700 (Fri, 27 Apr 2012) | 4 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

Fix value of "Error in Parameter API"

References: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3753#c3

------------------------------------------------------------------------
r42284 | etxrab | 2012-04-27 01:32:06 -0700 (Fri, 27 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

From Tom Bottom:

The AEM status field was erroneously displayed using ACMP status field values.
Minor change to display correct (as of draft 18) AEM status field values.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7205
------------------------------------------------------------------------
r42283 | etxrab | 2012-04-27 01:24:02 -0700 (Fri, 27 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

From Evan Huus:
Memory leak in NFS Dissector

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7204
------------------------------------------------------------------------
r42282 | etxrab | 2012-04-27 01:18:58 -0700 (Fri, 27 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/prefs.c

From Evan Huus:
Get rid of unused cur_pos variable.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7203
------------------------------------------------------------------------
r42281 | etxrab | 2012-04-26 23:02:45 -0700 (Thu, 26 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c
   M /trunk/epan/wslua/wslua_tvb.c

From Evan Huus: Fix memory leaks in wslua_tvb.c fix typos in wslu_proto.c https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7202
------------------------------------------------------------------------
r42280 | etxrab | 2012-04-26 22:51:47 -0700 (Thu, 26 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

From Evan Huus: Fix memory leaks in wslua_proto.c
------------------------------------------------------------------------
r42279 | etxrab | 2012-04-26 22:47:42 -0700 (Thu, 26 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_pinfo.c

From Evan Huus: Fix memory leaks in wslua_pinfo.c https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7202
------------------------------------------------------------------------
r42278 | wmeier | 2012-04-26 22:02:36 -0700 (Thu, 26 Apr 2012) | 4 lines
Changed paths:
   M /trunk/test/captures/dhcp-nanosecond.pcapng
   M /trunk/test/captures/dhcp.pcapng

For pcapng files: revert svn:mime-type back to application/octet-stream;
See wireshark-dev discussion starting at:
http://www.wireshark.org/lists/wireshark-dev/201204/msg00145.html

------------------------------------------------------------------------
r42277 | guy | 2012-04-26 15:11:01 -0700 (Thu, 26 Apr 2012) | 7 lines
Changed paths:
   M /trunk/ui/gtk/main_airpcap_toolbar.c

Get rid of tabs; make white space consistent.

Get rid of gtk_widget_set_size_request() calls - at least on my machine
and GTK+ version, they make some of the items too small to show the full
text.  Let GTK+ figure out how big things have to be - and if that makes
the toolbar too wide, redesign the toolbar.

------------------------------------------------------------------------
r42276 | morriss | 2012-04-26 11:45:07 -0700 (Thu, 26 Apr 2012) | 1 line
Changed paths:
   M /trunk/tools/svnadd

Add a TODO comment; indicate why PCAP-NG files don't use application/vnd.tcpdump.pcap
------------------------------------------------------------------------
r42275 | guy | 2012-04-26 11:02:04 -0700 (Thu, 26 Apr 2012) | 7 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

Consistently InterCapitalize StatusBar.

Separate "Toolbar" from the toolbar name in the View menu items.

Use "l", rather than "W", as the whatchamacallit for the wireless
toolbar - "W" is already used for "show packet in new window".

------------------------------------------------------------------------
r42274 | guy | 2012-04-26 10:36:39 -0700 (Thu, 26 Apr 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

While we're at it, add back the shortcuts, or whatever the heck the
Alt+{letter}+... things are called, for the Expand and Collapse items.

------------------------------------------------------------------------
r42273 | morriss | 2012-04-26 10:31:46 -0700 (Thu, 26 Apr 2012) | 1 line
Changed paths:
   M /trunk/test/captures/wpa-Induction.pcap.gz
   M /trunk/tools/svnadd

Use a mime-type of application/x-gzip for *.gz files
------------------------------------------------------------------------
r42272 | guy | 2012-04-26 09:58:30 -0700 (Thu, 26 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Just use a Boring Old ASCII Dash for hex ranges.

------------------------------------------------------------------------
r42271 | wmeier | 2012-04-26 09:47:37 -0700 (Thu, 26 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-conv.c
   M /trunk/epan/dissectors/packet-dcom-sysact.c
   M /trunk/epan/dissectors/packet-dhcpv6.c
   M /trunk/epan/dissectors/packet-distcc.c
   M /trunk/epan/dissectors/packet-dlsw.c
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-dpnss-link.c
   M /trunk/epan/dissectors/packet-dpnss.c
   M /trunk/epan/dissectors/packet-drda.c
   M /trunk/epan/dissectors/packet-dtpt.c
   M /trunk/epan/dissectors/packet-dua.c
   M /trunk/epan/dissectors/packet-eapol.c
   M /trunk/epan/dissectors/packet-echo.c
   M /trunk/epan/dissectors/packet-enc.c
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-epmd.c
   M /trunk/epan/dissectors/packet-esis.c
   M /trunk/epan/dissectors/packet-fcip.c

Minor: reformatting, unneeded #includes, whitespace cleanup;
Also: use val_to_str_const(0 instead of val_to_str() in a few cases.

------------------------------------------------------------------------
r42270 | guy | 2012-04-26 09:30:33 -0700 (Thu, 26 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Remove duplicate comment.

------------------------------------------------------------------------
r42269 | guy | 2012-04-26 09:27:03 -0700 (Thu, 26 Apr 2012) | 5 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Add a pcoreytohll() macro to extract "Corey-endian" 64-bit quantities,
and use it.

Fix some comments.

------------------------------------------------------------------------
r42268 | guy | 2012-04-26 09:25:14 -0700 (Thu, 26 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ixveriwave.c

Fix presumed typo (zero-origin bit 5 is 0x0020, not 0x0002).

------------------------------------------------------------------------
r42267 | etxrab | 2012-04-26 09:11:34 -0700 (Thu, 26 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Prepare to use value_string or range_string.
------------------------------------------------------------------------
r42266 | wmeier | 2012-04-26 09:05:05 -0700 (Thu, 26 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcom-oxid.c
   M /trunk/epan/dissectors/packet-dcom.c
   M /trunk/epan/dissectors/packet-dec-bpdu.c
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-diameter_3gpp.c
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-dtp.c
   M /trunk/epan/dissectors/packet-epl_v1.c
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/epan/dissectors/packet-evrc.c

Whitespace cleanup: Indentation, trailing, ...

------------------------------------------------------------------------
r42265 | pascal | 2012-04-26 08:44:01 -0700 (Thu, 26 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

From Evan Huus:
Add missing break
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7201

------------------------------------------------------------------------
r42264 | etxrab | 2012-04-26 08:39:52 -0700 (Thu, 26 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btrfcomm.c

From Evan Huus:
Unused structure in packet-btrfcomm.c
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7200
------------------------------------------------------------------------
r42263 | darkjames | 2012-04-26 08:35:38 -0700 (Thu, 26 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h248_2.c

Correct value for Baudot50 

From H.248.2: Gateway control protocol: Facsimile, text conversation and call discrimination packages (page 23)
[URL: http://www.itu.int/rec/dologin_pub.asp?lang=e&id=T-REC-H.248.2-200501-I!!PDF-E&type=items]

------------------------------------------------------------------------
r42262 | darkjames | 2012-04-26 08:33:46 -0700 (Thu, 26 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/proto.c

Add support for checking conflicting entries in value_string_ext.

------------------------------------------------------------------------
r42261 | etxrab | 2012-04-26 08:17:01 -0700 (Thu, 26 Apr 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

Restore Accelerators for "Expand Subtree", "Expand All" and "Collapse All".

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7197
------------------------------------------------------------------------
r42260 | darkjames | 2012-04-26 07:41:37 -0700 (Thu, 26 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eigrp.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-mip.c
   M /trunk/epan/dissectors/packet-mp4ves.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-spice.c

Fix some "conflicting" value_string warnings.

copy & paste errors, not 0-terminated value_string arrays, etc.

------------------------------------------------------------------------
r42259 | etxrab | 2012-04-26 06:23:16 -0700 (Thu, 26 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Fully dissect more IEs
------------------------------------------------------------------------
r42258 | etxrab | 2012-04-26 06:22:40 -0700 (Thu, 26 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-megaco.c

From Bodo Petermann:
Megaco parser problem with LF in header.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7198
------------------------------------------------------------------------
r42257 | pascal | 2012-04-26 06:20:02 -0700 (Thu, 26 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-slowprotocols.c

From vaicebine via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7199 :
wrong value displayed for OAMPDU event notification "Errored Frame Window" field

------------------------------------------------------------------------
r42256 | guy | 2012-04-26 01:57:33 -0700 (Thu, 26 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Use the pletohXX macros when fetching little-endian values.

------------------------------------------------------------------------
r42255 | guy | 2012-04-26 01:45:48 -0700 (Thu, 26 Apr 2012) | 7 lines
Changed paths:
   M /trunk/wiretap/vwr.c
   M /trunk/wiretap/wtap-int.h

Put the pseudo-header information for Veriwave packets into the buffer
in little-endian byte order, as that's what the dissector expects.  Add
a pletohl() macro for that purpose.

Fix comments (the Veriwave code is *not* writing data to a file!) and
clean up indentation.

------------------------------------------------------------------------
r42254 | etxrab | 2012-04-26 01:41:47 -0700 (Thu, 26 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/epan.c

Refcount edt.s as we may have atleast two "active" edt:s in certain
circumstances see bug https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5284

patch by Evan Huus
------------------------------------------------------------------------
r42253 | guy | 2012-04-26 00:44:28 -0700 (Thu, 26 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ixveriwave.c

Fix indentation.

------------------------------------------------------------------------
r42252 | guy | 2012-04-25 22:07:53 -0700 (Wed, 25 Apr 2012) | 5 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Use pntohs(), pntoh24(), and pntohl() to fetch big-endian data from the
headers.

Fix some indentation.

------------------------------------------------------------------------
r42251 | guy | 2012-04-25 21:26:03 -0700 (Wed, 25 Apr 2012) | 5 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Global variables considered harmful.  Move all the per-capture-file
global variables into a structure that's attached to the wtap_t as
private data, and make all the per-*packet* global variables local
variables.

------------------------------------------------------------------------
r42250 | guy | 2012-04-25 20:21:29 -0700 (Wed, 25 Apr 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/file_access.c

Put pcapng_open() right after libpcap_open(); pcap and pcap-ng are our
native file formats, so try them first.

Move eyesdn_open() to the section for open routines for file formats
that have a magic number - EyeSDN traces all start with "EyeSDN".

------------------------------------------------------------------------
r42249 | guy | 2012-04-25 20:06:35 -0700 (Wed, 25 Apr 2012) | 13 lines
Changed paths:
   M /trunk/wiretap/vwr.c

If you get an I/O error when looking for the FPGA version, return -1, so
we know we had a real problem with the file.  If we just get a short
read, return 0, as it means the file is probably not a VWR file.

If we get an invalid message length when reading packets (rather than
when looking for the FPGA version), return WTAP_ERR_BAD_FILE and an
"Invalid message record length" indication, not a generic fallback
"can't read the file" error.

For file_tell() errors, fetch the error code with file_error().

For file_seek() errors, use the error file_seek returned.

------------------------------------------------------------------------
r42248 | martinm | 2012-04-25 15:54:45 -0700 (Wed, 25 Apr 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Return 0 if doesn't match signature of vwr files.
Pointed out by Martin Kaiser in bug 7196.

------------------------------------------------------------------------
r42247 | pascal | 2012-04-25 14:37:10 -0700 (Wed, 25 Apr 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Convert spaces to tabs

------------------------------------------------------------------------
r42246 | tuexen | 2012-04-25 14:19:31 -0700 (Wed, 25 Apr 2012) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Set also the pcap buffer, if the default of 1 MB is used. This bug was
reported by Guy.

------------------------------------------------------------------------
r42245 | tuexen | 2012-04-25 14:09:33 -0700 (Wed, 25 Apr 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Report the packets captured and the packets dropped (either by libpcap or by dumpcap).

------------------------------------------------------------------------
r42244 | pascal | 2012-04-25 14:02:48 -0700 (Wed, 25 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

From Niels de Vos:
dissect AUTH_RSA as Gluster AUTH-flavor
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7190

------------------------------------------------------------------------
r42243 | pascal | 2012-04-25 13:59:35 -0700 (Wed, 25 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.h

From Niels de Vos:
Rename AUTH_DH to AUTH_RSA as specified in RFC 5531

------------------------------------------------------------------------
r42242 | tuexen | 2012-04-25 13:50:38 -0700 (Wed, 25 Apr 2012) | 3 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/pcapio.c
   M /trunk/pcapio.h

Allow writing ISB with given recv/drop counters.
No functional change by this commit.

------------------------------------------------------------------------
r42241 | pascal | 2012-04-25 13:20:23 -0700 (Wed, 25 Apr 2012) | 4 lines
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-snmp.c

From Evan Huus:
Fix Integer32 length field detection
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7192

------------------------------------------------------------------------
r42240 | pascal | 2012-04-25 13:02:12 -0700 (Wed, 25 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-mac-lte.h

Upgrade MAC LTE dissector to Release 10 (V10.5.0)

------------------------------------------------------------------------
r42239 | tuexen | 2012-04-25 12:21:25 -0700 (Wed, 25 Apr 2012) | 2 lines
Changed paths:
   M /trunk/mergecap.c

Fix typo.

------------------------------------------------------------------------
r42238 | tuexen | 2012-04-25 12:17:10 -0700 (Wed, 25 Apr 2012) | 4 lines
Changed paths:
   M /trunk/mergecap.c

Fix copy and paste error.
Reported by Evan Huus. This should fix
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7194

------------------------------------------------------------------------
r42237 | tuexen | 2012-04-25 11:38:55 -0700 (Wed, 25 Apr 2012) | 2 lines
Changed paths:
   M /trunk/mergecap.c

Fix compilation. While there, remove some trailing whitespaces.

------------------------------------------------------------------------
r42236 | tuexen | 2012-04-25 10:43:44 -0700 (Wed, 25 Apr 2012) | 5 lines
Changed paths:
   M /trunk/dumpcap.c

Fix the packet counters.
This fixes the inconsistencies reported on the command line by dumpcap
as indicated by
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7191

------------------------------------------------------------------------
r42235 | tuexen | 2012-04-25 09:05:29 -0700 (Wed, 25 Apr 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Fix locking problem.

------------------------------------------------------------------------
r42234 | etxrab | 2012-04-25 08:33:06 -0700 (Wed, 25 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Get rid of a few more of the explicitly defined ett:s
------------------------------------------------------------------------
r42233 | etxrab | 2012-04-25 07:33:06 -0700 (Wed, 25 Apr 2012) | 1 line
Changed paths:
   M /trunk/mergecap.c

use in_files->filename
------------------------------------------------------------------------
r42232 | etxrab | 2012-04-25 07:01:15 -0700 (Wed, 25 Apr 2012) | 1 line
Changed paths:
   M /trunk/mergecap.c

Add some info in SHB if writing a pcap-ng file.
------------------------------------------------------------------------
r42231 | etxrab | 2012-04-25 07:00:23 -0700 (Wed, 25 Apr 2012) | 1 line
Changed paths:
   M /trunk/wiretap/wtap.def

Add wtap_dump_fdopen_ng
------------------------------------------------------------------------
r42230 | etxrab | 2012-04-25 05:33:23 -0700 (Wed, 25 Apr 2012) | 7 lines
Changed paths:
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.h

Handle wtap_dump_fdopen() as wtap_dump_open() eg call
wtap_dump_fdopen_ng() and add a dummy IDB to be able to write pcapng files.
Solves https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6969
mergecap: Can't open or create <FILENAME>: Internal error.

We might want to add a SHB comment from mergecap giving the merged filenames or something like that, Merging of pcapng files
is a different issue, idealy we should probably start using several SHB:s in that case.
------------------------------------------------------------------------
r42229 | etxrab | 2012-04-25 03:15:07 -0700 (Wed, 25 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Add packet-gtpv2.h
------------------------------------------------------------------------
r42228 | etxrab | 2012-04-25 01:39:49 -0700 (Wed, 25 Apr 2012) | 2 lines
Changed paths:
   M /trunk/asn1/m3ap/m3ap.cnf
   M /trunk/asn1/m3ap/packet-m3ap-template.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   A /trunk/epan/dissectors/packet-gtpv2.h
   M /trunk/epan/dissectors/packet-m3ap.c

From David Wei:
Significantly improve M3AP dissection and MBMS related GTPv2 dissection.
------------------------------------------------------------------------
r42227 | martinm | 2012-04-24 17:28:19 -0700 (Tue, 24 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ixveriwave.c
   M /trunk/epan/dissectors/packet-waveagent.c
   M /trunk/wiretap/vwr.c

Remove some unnecessary includes and fix some indentation.

------------------------------------------------------------------------
r42226 | wmeier | 2012-04-24 11:27:06 -0700 (Tue, 24 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bofl.c
   M /trunk/epan/dissectors/packet-brp.c
   M /trunk/epan/dissectors/packet-cast.c
   M /trunk/epan/dissectors/packet-cdp.c
   M /trunk/epan/dissectors/packet-chdlc.c
   M /trunk/epan/dissectors/packet-clnp.c
   M /trunk/epan/dissectors/packet-cmpp.c
   M /trunk/epan/dissectors/packet-cosine.c
   M /trunk/epan/dissectors/packet-csm-encaps.c
   M /trunk/epan/dissectors/packet-csn1.c
   M /trunk/epan/dissectors/packet-csn1.h

Minor cleanup: whitespace, indentation, long-lines, style, typos, etc;
Also: remove unneeded #include <stdlib.h> in 2 cases.

------------------------------------------------------------------------
r42225 | wmeier | 2012-04-24 10:30:45 -0700 (Tue, 24 Apr 2012) | 2 lines
Changed paths:
   M /trunk/test/captures/dhcp-nanosecond.pcap
   M /trunk/test/captures/dhcp-nanosecond.pcapng
   M /trunk/test/captures/dhcp.pcapng
   M /trunk/test/captures/wpa-Induction.pcap.gz

Remove svn:keywords property; Change mime-type to vnd.tcpdump.pcap

------------------------------------------------------------------------
r42224 | wmeier | 2012-04-24 08:00:07 -0700 (Tue, 24 Apr 2012) | 2 lines
Changed paths:
   M /trunk/image/capture_comment_add.png
   M /trunk/image/capture_comment_disabled.png
   M /trunk/image/capture_comment_update.png

Remove svn:keywords property

------------------------------------------------------------------------
r42223 | wmeier | 2012-04-24 07:55:59 -0700 (Tue, 24 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nflog.c

Add svn:eol-style property; reformat a few long lines.

------------------------------------------------------------------------
r42222 | etxrab | 2012-04-24 07:48:46 -0700 (Tue, 24 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/tcp_graph.c

Add missing ";"
------------------------------------------------------------------------
r42221 | wmeier | 2012-04-24 07:37:18 -0700 (Tue, 24 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-oipf.c

Remove svn:executable property; Minor whitespace changes.

------------------------------------------------------------------------
r42220 | etxrab | 2012-04-24 05:33:00 -0700 (Tue, 24 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter_3gpp.c
   M /trunk/epan/dissectors/packet-nas_eps.c

From David Wei:
Bug fixes and improvements to Sm (GTPv2) and SGmb (DIAMETER) dissectors.
------------------------------------------------------------------------
r42219 | etxrab | 2012-04-24 01:52:18 -0700 (Tue, 24 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cisco-sm.c

From "ars" https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7188

Add dissection of  another flavor of Cisco RUDP/SM stack called BSM V1 (version 1 versus
Version 0 used for SS7). It used at place where IUA should be used namely for
backhauling ISDN PRI from Media Gateway to Media Gateway Controller.
------------------------------------------------------------------------
r42218 | etxrab | 2012-04-24 01:49:32 -0700 (Tue, 24 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ixveriwave.c

packet-ixveriwave.c:275:12: error: variable ‘vwf_txf’ set but not used.
------------------------------------------------------------------------
r42217 | etxrab | 2012-04-24 00:37:36 -0700 (Tue, 24 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-moldudp.c
   A /trunk/epan/dissectors/packet-moldudp64.c

From Evan Huus:
NASDAQ MOLD UDP 64 Dissectors.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7038
------------------------------------------------------------------------
r42216 | wmeier | 2012-04-23 14:27:37 -0700 (Mon, 23 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfcp.c

Minor cleanup:
- Add svn:keywords and svn;eol-style properties
- Move proto_reg_handoff...() to the end of the file as per convention;
- Use match_strval() instead of match_strval_idx() since idx not used;
- Use consistent indentation  & style.

------------------------------------------------------------------------
r42215 | etxrab | 2012-04-23 11:55:19 -0700 (Mon, 23 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

the blurb for field /"PCF IP Address/" (/"a11.ext.ase.pcfip/") matches the field name in packet-3g-a11.c 
------------------------------------------------------------------------
r42214 | tuexen | 2012-04-23 11:48:00 -0700 (Mon, 23 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/tcp_graph.c

Get it compiling...

------------------------------------------------------------------------
r42213 | wmeier | 2012-04-23 10:50:02 -0700 (Mon, 23 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aodv.c
   M /trunk/epan/dissectors/packet-applemidi.c
   M /trunk/epan/dissectors/packet-arcnet.c
   M /trunk/epan/dissectors/packet-arp.c
   M /trunk/epan/dissectors/packet-artnet.c
   M /trunk/epan/dissectors/packet-ascend.c

Do indentation cleanup (e.g., 4-space tabs => spaces)
Reformat a few long lines.

------------------------------------------------------------------------
r42212 | wmeier | 2012-04-23 10:43:56 -0700 (Mon, 23 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Use consistent indentation;
Use #if 0/#endif to comment out some code (rather than /* ... */

------------------------------------------------------------------------
r42211 | wmeier | 2012-04-23 09:23:57 -0700 (Mon, 23 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Replace hf[] "duplicate blurbs" by NULL;
Use consistent indentation (replace 4-space tabs by spaces);
Use consistent formatting style.

------------------------------------------------------------------------
r42210 | etxrab | 2012-04-23 08:17:31 -0700 (Mon, 23 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/tcp_graph.c

Use a crosshair cursor insted of the XOR thingy.
Selected with a define to make it easily reversed if some one does not like it.
------------------------------------------------------------------------
r42209 | wmeier | 2012-04-23 08:07:30 -0700 (Mon, 23 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/tcp_graph.c

Fix a compile error (missing semi-colon) when building for gtk3

------------------------------------------------------------------------
r42208 | ruengeler | 2012-04-23 06:47:45 -0700 (Mon, 23 Apr 2012) | 2 lines
Changed paths:
   M /trunk/capture_opts.c

Remove lines that are not needed.

------------------------------------------------------------------------
r42207 | etxrab | 2012-04-23 06:39:12 -0700 (Mon, 23 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/tcp_graph.c

g_object_unref(cursor) craches pre GTK 3.0 protect it with
#if GTK_CHECK_VERSION(3,0,0)
------------------------------------------------------------------------
r42206 | ruengeler | 2012-04-23 05:34:16 -0700 (Mon, 23 Apr 2012) | 2 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/ui/gtk/main.c

Fix bug #7178 reported by aparan

------------------------------------------------------------------------
r42205 | etxrab | 2012-04-23 04:10:08 -0700 (Mon, 23 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/prefs_dlg.c
   M /trunk/ui/gtk/prefs_gui.c

Use GtkFontChooser if GTK >= 3.2
------------------------------------------------------------------------
r42204 | ruengeler | 2012-04-23 04:06:21 -0700 (Mon, 23 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_if_dlg.c

Get rid of GTK warning when START was hit in the "Capture Interfaces Dialog" while a device was hidden.

------------------------------------------------------------------------
r42203 | etxrab | 2012-04-23 00:28:53 -0700 (Mon, 23 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

From Evan Huus:
Another case where a ridiculously large length field was causing a loop counter
to overflow. Had to pass pinfo all over the place to add expert info, but the
meat of the fix is on line 4960 (after patch applied).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7121
------------------------------------------------------------------------
r42202 | etxrab | 2012-04-23 00:19:22 -0700 (Mon, 23 Apr 2012) | 1 line
Changed paths:
   M /trunk/config.nmake

Add PKG_SUFIX
------------------------------------------------------------------------
r42201 | wmeier | 2012-04-22 19:37:35 -0700 (Sun, 22 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/value_string.c

Fix a typo.

------------------------------------------------------------------------
r42200 | wmeier | 2012-04-22 18:36:57 -0700 (Sun, 22 Apr 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

It's not kosher to alloc and init a GArray ourselves instead of calling g_array_new().

Fixes Bug #7138 (https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7138)

A puzzle: why did the buildbot fuzz-testing only start failing on this on 04/18/2012
          since the bug has existed for quite some time ?

------------------------------------------------------------------------
r42199 | wmeier | 2012-04-22 13:50:34 -0700 (Sun, 22 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Fix a crash caused by an "off by one" define

------------------------------------------------------------------------
r42198 | etxrab | 2012-04-22 12:28:21 -0700 (Sun, 22 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Basic IE dissectoon for more IE:s
------------------------------------------------------------------------
r42197 | wmeier | 2012-04-22 12:14:19 -0700 (Sun, 22 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/iseries.c

Fix a buildbot compile warning.

------------------------------------------------------------------------
r42196 | wmeier | 2012-04-22 11:44:10 -0700 (Sun, 22 Apr 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/iseries.c

Various minor cleanup:
 - fix a few small memory leaks;
 - fix some indentation to match style used (gnu);
 - remove trailing whitespace;
 - ...

------------------------------------------------------------------------
r42195 | pascal | 2012-04-22 10:54:13 -0700 (Sun, 22 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls.c

From Francesco Fondelli: fix mpls "decode as" dialog
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7089

------------------------------------------------------------------------
r42192 | gerald | 2012-04-22 07:03:30 -0700 (Sun, 22 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-04-22]
------------------------------------------------------------------------
r42191 | etxrab | 2012-04-22 06:59:28 -0700 (Sun, 22 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/color_utils.c

Add casts to make in compile on Windows
------------------------------------------------------------------------
r42190 | etxrab | 2012-04-22 06:54:35 -0700 (Sun, 22 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/tcp_graph.c

Use g_object_unref
------------------------------------------------------------------------
r42189 | guy | 2012-04-21 19:03:29 -0700 (Sat, 21 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/daintree-sna.c

Global variables considered harmful (and unnecessary).

------------------------------------------------------------------------
r42188 | guy | 2012-04-21 14:16:54 -0700 (Sat, 21 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/gui_utils.c

Another cut-and-pasteo.

------------------------------------------------------------------------
r42187 | etxrab | 2012-04-21 14:13:13 -0700 (Sat, 21 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/flow_graph.c
   M /trunk/ui/gtk/funnel_stat.c
   M /trunk/ui/gtk/iax2_analysis.c
   M /trunk/ui/gtk/io_stat.c
   M /trunk/ui/gtk/mcast_stream_dlg.c
   M /trunk/ui/gtk/packet_win.c
   M /trunk/ui/gtk/print_dlg.c
   M /trunk/ui/gtk/profile_dlg.c
   M /trunk/ui/gtk/proto_dlg.c
   M /trunk/ui/gtk/rtp_analysis.c
   M /trunk/ui/gtk/rtp_player.c
   M /trunk/ui/gtk/rtp_stream_dlg.c
   M /trunk/ui/gtk/sctp_assoc_analyse.c
   M /trunk/ui/gtk/sctp_byte_graph_dlg.c
   M /trunk/ui/gtk/sctp_chunk_stat_dlg.c
   M /trunk/ui/gtk/sctp_error_dlg.c
   M /trunk/ui/gtk/sctp_graph_dlg.c
   M /trunk/ui/gtk/sctp_stat_dlg.c
   M /trunk/ui/gtk/sip_stat.c
   M /trunk/ui/gtk/tcp_graph.c
   M /trunk/ui/gtk/uat_gui.c
   M /trunk/ui/gtk/voip_calls_dlg.c
   M /trunk/ui/gtk/wlan_stat_dlg.c

More GTK3 adaptations
------------------------------------------------------------------------
r42186 | etxrab | 2012-04-21 13:45:35 -0700 (Sat, 21 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/dlg_utils.c
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/gui_utils.h
   M /trunk/ui/gtk/main_statusbar.c
   M /trunk/ui/gtk/manual_addr_resolv.c

port gtk_scrollbar_new() gtk_paned_new() gtk_separator_new() to GTK2
------------------------------------------------------------------------
r42185 | guy | 2012-04-21 13:38:18 -0700 (Sat, 21 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/gui_utils.c

Fix probable cut-and-pasteo.

------------------------------------------------------------------------
r42184 | guy | 2012-04-21 13:13:38 -0700 (Sat, 21 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/gui_utils.c

Clean up indentation (get rid of 4-space tabs).

------------------------------------------------------------------------
r42183 | etxrab | 2012-04-21 13:06:51 -0700 (Sat, 21 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/gui_utils.h

gtk_button_box_new() for pre GTK 3.0
------------------------------------------------------------------------
r42182 | guy | 2012-04-21 12:12:50 -0700 (Sat, 21 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/gui_utils.c

Clean up indentation - don't use 4-space tabs.

------------------------------------------------------------------------
r42181 | guy | 2012-04-21 12:07:23 -0700 (Sat, 21 Apr 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/gui_utils.c

GTK+ 1.x is no longer supported, and there's no toggle_tree to move any
more; remove a comment.

------------------------------------------------------------------------
r42180 | guy | 2012-04-21 11:48:49 -0700 (Sat, 21 Apr 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/gui_utils.c

"homogeneous" is a Boolean; we can just pass it on to gtk_hbox_new() and
gtk_vbox_new().

------------------------------------------------------------------------
r42179 | guy | 2012-04-21 11:40:43 -0700 (Sat, 21 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/prefs_protocols.c
   M /trunk/ui/gtk/prefs_stream.c
   M /trunk/ui/gtk/prefs_taps.c
   M /trunk/ui/gtk/sctp_byte_graph_dlg.c

Include "ui/gtk/gui_utils.h" so the ws_gtk_box routines are declared.

------------------------------------------------------------------------
r42178 | etxrab | 2012-04-21 10:06:30 -0700 (Sat, 21 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/afp_stat.c
   M /trunk/ui/gtk/ansi_map_stat.c
   M /trunk/ui/gtk/fileset_dlg.c
   M /trunk/ui/gtk/prefs_nameres.c
   M /trunk/ui/gtk/prefs_print.c
   M /trunk/ui/gtk/prefs_protocols.c
   M /trunk/ui/gtk/prefs_stream.c
   M /trunk/ui/gtk/prefs_taps.c
   M /trunk/ui/gtk/print_dlg.c
   M /trunk/ui/gtk/profile_dlg.c
   M /trunk/ui/gtk/progress_dlg.c
   M /trunk/ui/gtk/proto_dlg.c
   M /trunk/ui/gtk/proto_hier_stats_dlg.c
   M /trunk/ui/gtk/sctp_byte_graph_dlg.c

Replace gtk_vbox_new() and gtk_hbox_new() with ws_gtk_box_new().
------------------------------------------------------------------------
r42177 | etxrab | 2012-04-21 09:45:41 -0700 (Sat, 21 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/sctp_error_dlg.c
   M /trunk/ui/gtk/sctp_graph_dlg.c

Missing include
------------------------------------------------------------------------
r42176 | etxrab | 2012-04-21 09:40:14 -0700 (Sat, 21 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/ansi_a_stat.c
   M /trunk/ui/gtk/bootp_stat.c
   M /trunk/ui/gtk/camel_counter.c
   M /trunk/ui/gtk/camel_srt.c
   M /trunk/ui/gtk/compare_stat.c
   M /trunk/ui/gtk/dcerpc_stat.c
   M /trunk/ui/gtk/diameter_stat.c
   M /trunk/ui/gtk/expert_comp_dlg.c
   M /trunk/ui/gtk/export_object.c
   M /trunk/ui/gtk/fc_stat.c
   M /trunk/ui/gtk/file_import_dlg.c
   M /trunk/ui/gtk/fileset_dlg.c
   M /trunk/ui/gtk/filter_dlg.c
   M /trunk/ui/gtk/filter_expression_save_dlg.c
   M /trunk/ui/gtk/find_dlg.c
   M /trunk/ui/gtk/firewall_dlg.c
   M /trunk/ui/gtk/flow_graph.c
   M /trunk/ui/gtk/follow_stream.c
   M /trunk/ui/gtk/funnel_stat.c
   M /trunk/ui/gtk/goto_dlg.c
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/ui/gtk/gsm_a_stat.c
   M /trunk/ui/gtk/gsm_map_stat.c
   M /trunk/ui/gtk/gsm_map_summary.c
   M /trunk/ui/gtk/gtp_stat.c
   M /trunk/ui/gtk/h225_counter.c
   M /trunk/ui/gtk/h225_ras_srt.c
   M /trunk/ui/gtk/hostlist_table.c
   M /trunk/ui/gtk/iax2_analysis.c
   M /trunk/ui/gtk/io_stat.c
   M /trunk/ui/gtk/ldap_stat.c
   M /trunk/ui/gtk/mac_lte_stat_dlg.c
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/main_statusbar.c
   M /trunk/ui/gtk/manual_addr_resolv.c
   M /trunk/ui/gtk/mcast_stream_dlg.c
   M /trunk/ui/gtk/megaco_stat.c
   M /trunk/ui/gtk/mgcp_stat.c
   M /trunk/ui/gtk/mtp3_stat.c
   M /trunk/ui/gtk/mtp3_summary.c
   M /trunk/ui/gtk/ncp_stat.c
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/ui/gtk/packet_win.c
   M /trunk/ui/gtk/pixmap_save.c
   M /trunk/ui/gtk/prefs_capture.c
   M /trunk/ui/gtk/prefs_column.c
   M /trunk/ui/gtk/prefs_filter_expressions.c
   M /trunk/ui/gtk/prefs_gui.c
   M /trunk/ui/gtk/prefs_layout.c
   M /trunk/ui/gtk/radius_stat.c
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c
   M /trunk/ui/gtk/rpc_progs.c
   M /trunk/ui/gtk/rpc_stat.c
   M /trunk/ui/gtk/rtp_analysis.c
   M /trunk/ui/gtk/rtp_player.c
   M /trunk/ui/gtk/rtp_stream_dlg.c
   M /trunk/ui/gtk/scsi_stat.c
   M /trunk/ui/gtk/sctp_chunk_stat.c
   M /trunk/ui/gtk/sctp_error_dlg.c
   M /trunk/ui/gtk/sctp_graph_dlg.c
   M /trunk/ui/gtk/simple_dialog.c
   M /trunk/ui/gtk/summary_dlg.c
   M /trunk/ui/gtk/supported_protos_dlg.c
   M /trunk/ui/gtk/tap_param_dlg.c
   M /trunk/ui/gtk/text_page_utils.c
   M /trunk/ui/gtk/time_shift_dlg.c
   M /trunk/ui/gtk/uat_gui.c
   M /trunk/ui/gtk/voip_calls_dlg.c
   M /trunk/ui/gtk/wsp_stat.c

Replace gtk_vbox_new() and gtk_hbox_new() with ws_gtk_box_new().
------------------------------------------------------------------------
r42175 | pascal | 2012-04-21 07:03:39 -0700 (Sat, 21 Apr 2012) | 2 lines
Changed paths:
   M /trunk/asn1/lte-rrc/lte-rrc.cnf
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/epan/dissectors/packet-lte-rrc.c

Prettify LTE RRC dissector

------------------------------------------------------------------------
r42174 | etxrab | 2012-04-21 01:45:52 -0700 (Sat, 21 Apr 2012) | 1 line
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake

Make it possible to download the GTK3 package
------------------------------------------------------------------------
r42173 | martinm | 2012-04-20 19:43:11 -0700 (Fri, 20 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Lose some more unused variables reported by clang.

------------------------------------------------------------------------
r42172 | martinm | 2012-04-20 19:33:54 -0700 (Fri, 20 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ixveriwave.c

Delete some unused variables, in response to clang warnings.  From Tom
Cook.

------------------------------------------------------------------------
r42171 | gerald | 2012-04-20 16:41:36 -0700 (Fri, 20 Apr 2012) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi

Switch back to the gtk.org version of the GTK+ bundle since its Cairo
doesn't crash.

------------------------------------------------------------------------
r42170 | pascal | 2012-04-20 12:56:17 -0700 (Fri, 20 Apr 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

Clean gnutls-2.12.18-*-win??ws folder with setup target

------------------------------------------------------------------------
r42169 | gerald | 2012-04-20 11:13:02 -0700 (Fri, 20 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-websocket.c

Add an arbitrary (64K) size limit for the unmasked TVBs that we
create. Fix a bunch of signedness mismatches. TVB variable names usually
end in "_tvb"; do the same here. Fixup whitespace.

------------------------------------------------------------------------
r42168 | tuexen | 2012-04-20 11:10:15 -0700 (Fri, 20 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-websocket.c

Fix compilation.
While there, remove trailing whitespaces.

------------------------------------------------------------------------
r42167 | martinm | 2012-04-20 11:09:50 -0700 (Fri, 20 Apr 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Try to fix up some clang warnings.  Will look at other modules I added
recently later.

------------------------------------------------------------------------
r42166 | guy | 2012-04-20 10:47:28 -0700 (Fri, 20 Apr 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-websocket.c

64-bit payload length?  Good luck with that; Wireshark is *NOT* set up
to handle payloads > 2^31-1, and that'll probably take a fair bit of
work to fix (not to mention working only on machines with enough address
space and memory+swap space to support reassembling such a huge chunk).

Squelch narrowing-conversion warnings - reject payloads whose length
doesn't fit in 31 bits, and stuff the payload length into a 32-bit
signed variable and use that for other payloads.

------------------------------------------------------------------------
r42165 | alagoutte | 2012-04-20 08:33:23 -0700 (Fri, 20 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb-hid.c
   M /trunk/epan/dissectors/packet-usb-hub.c
   M /trunk/epan/dissectors/packet-usb-masstorage.c
   M /trunk/epan/dissectors/packet-usb.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r42164 | alagoutte | 2012-04-20 08:32:45 -0700 (Fri, 20 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

From me for https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6843

Make WebSocket HTTP Header (Sec-WebSocket-*) filterable

------------------------------------------------------------------------
r42163 | alagoutte | 2012-04-20 08:31:15 -0700 (Fri, 20 Apr 2012) | 10 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-http.h
   A /trunk/epan/dissectors/packet-websocket.c

From me for https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6843
Add WebSocket Protocol dissector (RFC6455)
* Support Base Framing Protocol
* Support of major opcode (Text, Binary, Close, Ping, Pong...)
* Support of unmask Payload (Client-to-Server Masking)

TODO 
* Add fragmentation support
* Add WebSocket Extensions

------------------------------------------------------------------------
r42162 | etxrab | 2012-04-20 08:28:00 -0700 (Fri, 20 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/capture_if_details_dlg_win32.c
   M /trunk/ui/gtk/sctp_assoc_analyse.c
   M /trunk/ui/gtk/sctp_chunk_stat_dlg.c
   M /trunk/ui/gtk/sctp_stat_dlg.c
   M /trunk/ui/gtk/sip_stat.c
   M /trunk/ui/gtk/smb2_stat.c
   M /trunk/ui/gtk/smb_stat.c
   M /trunk/ui/gtk/stats_tree_stat.c
   M /trunk/ui/gtk/tcp_graph.c
   M /trunk/ui/gtk/wlan_stat_dlg.c

Replace gtk_vbox_new() and gtk_hbox_new() with ws_gtk_box_new().
------------------------------------------------------------------------
r42161 | etxrab | 2012-04-20 07:56:24 -0700 (Fri, 20 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/color_dlg.c
   M /trunk/ui/gtk/color_edit_dlg.c
   M /trunk/ui/gtk/conversations_table.c
   M /trunk/ui/gtk/decode_as_ber.c
   M /trunk/ui/gtk/decode_as_dcerpc.c
   M /trunk/ui/gtk/decode_as_dlg.c
   M /trunk/ui/gtk/dfilter_expr_dlg.c
   M /trunk/ui/gtk/dissector_tables_dlg.c
   M /trunk/ui/gtk/dlg_utils.c
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Replace gtk_vbox_new() and gtk_hbox_new() with ws_gtk_box_new().
------------------------------------------------------------------------
r42160 | pascal | 2012-04-20 07:41:34 -0700 (Fri, 20 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfcp.c

From Patrick White via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7061 :
Add UDP to BFCP dissector and dissect new primitives and attibutes
From me: add an expert info in case of invalid payload length to avoid a potential infinite loop

------------------------------------------------------------------------
r42159 | martinm | 2012-04-20 05:44:19 -0700 (Fri, 20 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/vwr.c

Add a couple of casts to try to make the Windows-7-x64 buildbot happy.

------------------------------------------------------------------------
r42158 | etxrab | 2012-04-20 05:32:17 -0700 (Fri, 20 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Add basic IE dissection for new IE:s
------------------------------------------------------------------------
r42157 | pascal | 2012-04-20 05:22:27 -0700 (Fri, 20 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-slowprotocols.c

From Matt via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7160 :
Offset moves too far when dissecting an Information OAMPDU with Organization Specific TLV

------------------------------------------------------------------------
r42156 | martinm | 2012-04-20 05:09:16 -0700 (Fri, 20 Apr 2012) | 2 lines
Changed paths:
   A /trunk/wiretap/vwr.h

Missed file from previous commit.

------------------------------------------------------------------------
r42155 | martinm | 2012-04-20 05:08:31 -0700 (Fri, 20 Apr 2012) | 16 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ixveriwave.c
   A /trunk/epan/dissectors/packet-waveagent.c
   M /trunk/wiretap/CMakeLists.txt
   M /trunk/wiretap/Makefile.common
   M /trunk/wiretap/file_access.c
   A /trunk/wiretap/vwr.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

Patch for https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5048
From Tom Cook and Tom Alexander.

1. A VWR encapsulation that reads VeriWave capture files (*.vwr)
generated from
WaveTest test hardware
2. Dissectors that display the VeriWave tap headers (both 802.11 and
Ethernet)
3. A dissector for the WaveAgent protocol.  The WaveAgent dissector is
heuristic and parses the WaveAgent packet (a UDP payload).

The WaveAgent dissector has been Fuzz tested.

The VWR ENCAP and dissectors have been used extensively by VeriWave
customers in a special version of WireSark compiled by VeriWave.

------------------------------------------------------------------------
r42154 | grahamb | 2012-04-20 02:33:23 -0700 (Fri, 20 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/libwireshark.def

Added de_ms_cm_3 to export list.
------------------------------------------------------------------------
r42153 | sahlberg | 2012-04-20 00:34:53 -0700 (Fri, 20 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

SCSI SBC: Add decode of BlockLimits VPD page


------------------------------------------------------------------------
r42152 | sahlberg | 2012-04-20 00:01:50 -0700 (Fri, 20 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

compile warning/error. flag unused argument with _U_



------------------------------------------------------------------------
r42151 | etxrab | 2012-04-19 22:47:02 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Add the basic code to dissect IE APN Aggregate Maximum Bit Rate (APN-AMBR)
------------------------------------------------------------------------
r42150 | etxrab | 2012-04-19 22:23:41 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/conversation.c

From Evan Huus: Clean up conversation list iterator caching. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7149
------------------------------------------------------------------------
r42149 | etxrab | 2012-04-19 22:20:04 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main.c

From Martin Kaiser: menus, main window title, icons are not reset when capture is interrupted before any data arrives. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7129
------------------------------------------------------------------------
r42148 | etxrab | 2012-04-19 22:12:20 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c
   M /trunk/epan/proto.c
   M /trunk/epan/tvbuff.c

From Evan Huus: Use Add DISSECTOR_ASSERT_HINT() macro. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7142
------------------------------------------------------------------------
r42147 | guy | 2012-04-19 18:44:49 -0700 (Thu, 19 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/iseries.c

Fix more indentation.

------------------------------------------------------------------------
r42146 | guy | 2012-04-19 18:43:12 -0700 (Thu, 19 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/iseries.c

Use consistent 2-space indentation, and don't use tabs.

------------------------------------------------------------------------
r42145 | guy | 2012-04-19 16:58:53 -0700 (Thu, 19 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/csids.c

Fix typo.

------------------------------------------------------------------------
r42144 | guy | 2012-04-19 16:19:10 -0700 (Thu, 19 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/csids.c

Don't byte-swap bytes that aren't there.

------------------------------------------------------------------------
r42143 | gerald | 2012-04-19 11:31:11 -0700 (Thu, 19 Apr 2012) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi
   M /trunk/tools/win32-setup.sh
   M /trunk/tools/win64-setup.sh

Switch to our custom GTK+ bundles derived from openSUSE Build Service
packages. Sort and normalize our DLL lists. Add several new required DLLs.

------------------------------------------------------------------------
r42142 | etxrab | 2012-04-19 06:59:55 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c

Set up RTP conversations from BSS MAP.
------------------------------------------------------------------------
r42141 | etxrab | 2012-04-19 06:59:14 -0700 (Thu, 19 Apr 2012) | 25 lines
Changed paths:
   M /trunk/epan/conversation.c
   M /trunk/epan/conversation.h

From Cristian Constantin:
while caching the last element from the conversation hash chain lists speeds-up
the operation when the hash/chain lists are actually built, it 
does NOT help a lot when a certain random conversation which is in the hash
table is looked-up.

I did some profiling and tracing and I saw that a lot of cpu time is spent in
the function conversation_lookup_hashtable() when wireshark
is asked to show the "Flow Graph", "TCP Conversations", "Voip Calls".  I used
two types of captures with over 500k packets:

- tcp packets having the _same_ src ip addr, src tcp port, dst ip addr, dst tcp 
  port
- (mostly) sip packets containing sdp payloads which advertise the _same_ ip
  addr, udp port for media

these types of captures lead to _huge_ chain lists behind the same hash bucket 
(to which the conversation is actually mapped)

the solution would be to cache the last found conversation into the head of the 
chain list and to use it whenever it is possible; most of the time the look-up
will be in O(1) instead of O(n) (n - number
of elements in the list).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7149
------------------------------------------------------------------------
r42140 | alagoutte | 2012-04-19 05:41:12 -0700 (Thu, 19 Apr 2012) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hip.c

From Francisco Vidal Meca via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7136
HIP dissector: PUZZLE and SOLUTION parameters variable size

According to specifications, puzzle and solution parameters carry Random #I and
#J fields that has variable length depending of the Hash function. The fields
are recognized with a fixed value of 8 bytes.

The #I and #J fields should be determined depending of the TLV size.

See http://tools.ietf.org/html/draft-ietf-hip-rfc5201-bis-08#section-5.2.5 .

------------------------------------------------------------------------
r42139 | etxrab | 2012-04-18 23:12:12 -0700 (Wed, 18 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-l2tp.c

From Andy Karch:Add L2TP filter on Control Message AVP value. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7145. From me make it compile and add l2tp_message_type_short_str_vals
------------------------------------------------------------------------
r42138 | etxrab | 2012-04-18 22:49:38 -0700 (Wed, 18 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/conversation.c

From Evan Huus: Convert a few instances in conversation.c to use the new macro. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7142
------------------------------------------------------------------------
r42137 | etxrab | 2012-04-18 22:44:50 -0700 (Wed, 18 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/proto.h

From Evan Huus: Add DISSECTOR_ASSERT_HINT() macro https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7142
------------------------------------------------------------------------
r42136 | etxrab | 2012-04-18 11:17:40 -0700 (Wed, 18 Apr 2012) | 1 line
Changed paths:
   M /trunk/airpcap_loader.c

From Evan Huus: Two bad NULL checks in airpcap_loader.c https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7141
------------------------------------------------------------------------
r42135 | pascal | 2012-04-18 09:55:06 -0700 (Wed, 18 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Use extended value strings for BSR and PHR and remove a useless hf entry

------------------------------------------------------------------------
r42134 | gerald | 2012-04-18 09:10:08 -0700 (Wed, 18 Apr 2012) | 2 lines
Changed paths:
   M /trunk/tools/fuzz-test.sh
   M /trunk/tools/randpkt-test.sh

Terminate our inner loops as well.

------------------------------------------------------------------------
r42133 | gerald | 2012-04-18 09:04:05 -0700 (Wed, 18 Apr 2012) | 3 lines
Changed paths:
   M /trunk/tools/fuzz-test.sh
   M /trunk/tools/randpkt-test.sh

Tell the main loop to terminate when we catch a signal instead of trying
to clean up in two places.

------------------------------------------------------------------------
r42132 | alagoutte | 2012-04-18 06:42:41 -0700 (Wed, 18 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hip.c

From Francisco Vidal Meca via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7136
HIP dissector: HIT_SUITE_LIST parameter from HIPv2

The HIT_SUITE_LIST Parameter from HIPv2 (
http://tools.ietf.org/html/draft-ietf-hip-rfc5201-bis-08 ) is unsupported.

------------------------------------------------------------------------
r42131 | darkjames | 2012-04-18 05:35:36 -0700 (Wed, 18 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cups.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-irc.c
   M /trunk/epan/dissectors/packet-megaco.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-roofnet.c
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/tvbuff.c
   M /trunk/ui/gtk/airpcap_gui_utils.c
   M /trunk/ui/gtk/airpcap_gui_utils.h
   M /trunk/ui/gtk/summary_dlg.c

Fix some: 'cast discards qualifiers from pointer target type' warnings

- Add const qualifier
- Remove some strange casts

------------------------------------------------------------------------
r42130 | etxrab | 2012-04-18 04:29:37 -0700 (Wed, 18 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

From Yaniv Kaul:
Enhance the Spice dissector to dissect KEY_DOWN, KEY_UP, {RECORD|PLAYBACK}_{VOLUME|MUTE}

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7133
------------------------------------------------------------------------
r42129 | etxrab | 2012-04-18 04:12:15 -0700 (Wed, 18 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ansi_a.c

Fix Bug 7119 ANSI MAP infinite loop.
Make conumed a guint16 to avoid wrapping add expert items.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7119
------------------------------------------------------------------------
r42128 | tuexen | 2012-04-18 03:11:33 -0700 (Wed, 18 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ancp.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7137


------------------------------------------------------------------------
r42127 | etxrab | 2012-04-18 01:32:12 -0700 (Wed, 18 Apr 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/mp2t.c

From Rolf Fiedler:
patch to fix mp2t.c to reject more byte streams that are not MPEG2.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7132
------------------------------------------------------------------------
r42126 | etxrab | 2012-04-18 01:26:08 -0700 (Wed, 18 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

Show WIRETAP_ENC
------------------------------------------------------------------------
r42125 | etxrab | 2012-04-18 01:15:32 -0700 (Wed, 18 Apr 2012) | 1 line
Changed paths:
   M /trunk/wiretap/commview.c
   M /trunk/wiretap/netxray.c

Get the Windows build going again. The Netxray "fix" cast to guint8 may not be OK.
------------------------------------------------------------------------
r42124 | alagoutte | 2012-04-18 00:33:57 -0700 (Wed, 18 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

Update Domain Name System Security (DNSSEC) Algorithm Numbers and Delegation Signer (DS) Resource Record (RR)
 Add RFC5933 : Use of GOST Signature Algorithms in DNSKEY and RRSIG Resource Records for DNSSEC
 Add RFC6605 : Elliptic Curve Digital Signature Algorithm (DSA) for DNSSEC

------------------------------------------------------------------------
r42123 | alagoutte | 2012-04-18 00:22:12 -0700 (Wed, 18 Apr 2012) | 14 lines
Changed paths:
   M /trunk/wiretap/wtap.h

From Colus Tang via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7134
Unable to display the correct IEEE802.11 MCS data rates due to header definition

The problem is due to the ieee_802_11_phdr.data_rate is defined as guint8,
since this variable is counting number of 0.5Mbps units, any datarates which is
higher than 255Mbps would get wrapped up.  In the above example, only the lower
8bit value will be put into the ieee_802_11_phdr which is 0x04 and result in
the incorrect 2Mbps display.

There are 802.11n WLAN product is capable to transmit @450Mbps, we should fix
this data_rate from guint8 to guint16.

#BACKPORT

------------------------------------------------------------------------
r42122 | etxrab | 2012-04-17 22:29:02 -0700 (Tue, 17 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-assa_r3.c

From Evan Huus: There were two cases where we could underflow an unsigned subtraction, leading to huge values and near-infinite loops. Catch them and add an expert_info warning that the packet is bad. Also fix some other expert_info messages to hang off of the right dissection tree. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7125
------------------------------------------------------------------------
r42121 | etxrab | 2012-04-17 22:24:32 -0700 (Tue, 17 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ltp.c

From Evan Huus: Catch impossible sub-field counts. Fixes LTP infinite loop https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7124
------------------------------------------------------------------------
r42119 | guy | 2012-04-17 19:48:23 -0700 (Tue, 17 Apr 2012) | 6 lines
Changed paths:
   M /trunk/doc/wireshark.pod.template
   M /trunk/wiretap/5views.c
   M /trunk/wiretap/file_access.c

If we see a 5View time-stamped header with a bad key, make sure we
return the right error code and information string.

InfoVista bought Accellent Group, and, at least according to the
InfoVista Web site, it's "5View", not "5Views".

------------------------------------------------------------------------
r42118 | guy | 2012-04-17 17:54:11 -0700 (Tue, 17 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap-int.h

Fix some indentation errors from the previous change.

------------------------------------------------------------------------
r42117 | guy | 2012-04-17 17:51:18 -0700 (Tue, 17 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap-int.h

Get rid of tabs, so we don't have to worry about 4-space vs. 8-space tabs.

------------------------------------------------------------------------
r42116 | guy | 2012-04-17 16:08:23 -0700 (Tue, 17 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bthci_evt.c

Might as well make the loop indices just guint; the generated code's
unlikely to be worse, and could be better on the 32-bit-and-bigger
machines on which Wireshark runs.

------------------------------------------------------------------------
r42115 | guy | 2012-04-17 15:36:50 -0700 (Tue, 17 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-asf.c

Flag too-short TLVs with an expert info item - and treat any TLV length
less than 4 as "too short", as the TLV length includes the type and
length fields.

------------------------------------------------------------------------
r42114 | etxrab | 2012-04-17 14:09:10 -0700 (Tue, 17 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bthci_evt.c

From Evan Huus: We were using guint8s as loop counters based on field lengths, and they were overflowing/wrapping falsely. Making them guint16s fixes the problem. Bug 7122 -HCIEVT infinite loop https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7122
------------------------------------------------------------------------
r42113 | etxrab | 2012-04-17 14:00:56 -0700 (Tue, 17 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-asf.c

From Evan Huus: Break from the loop if the length is zero. Fix  [Bug 7120] ASF infinite loop https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7120
------------------------------------------------------------------------
r42112 | etxrab | 2012-04-17 13:49:56 -0700 (Tue, 17 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mpls.c
   M /trunk/epan/dissectors/packet-pw-eth.c

From Francesco Fondelli: fixes up issue 1) and 3) described in the bug report https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7089
------------------------------------------------------------------------
r42111 | pascal | 2012-04-17 06:17:39 -0700 (Tue, 17 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7131 :
Always store UDL/length in hash table and check pointer coming from lookup before using it

------------------------------------------------------------------------
r42110 | ruengeler | 2012-04-17 06:13:30 -0700 (Tue, 17 Apr 2012) | 2 lines
Changed paths:
   M /trunk/file.c

Fix bug #7112, where the interface ids were not saved

------------------------------------------------------------------------
r42109 | ruengeler | 2012-04-17 06:04:07 -0700 (Tue, 17 Apr 2012) | 1 line
Changed paths:
   M /trunk/AUTHORS

Fix a typo in my name
------------------------------------------------------------------------
r42108 | pascal | 2012-04-17 05:44:04 -0700 (Tue, 17 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

From Bertho Stultiens:
Use certificate values from RFC 4398
From me: rename fields according to RFC and update references to RFC
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7130

------------------------------------------------------------------------
r42105 | alagoutte | 2012-04-17 00:40:11 -0700 (Tue, 17 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From me via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7115
802.11s Decoding Bug (Mesh Control Field)

Wrong offset use to dissector Mesh Extended Address(bug from the revision 39314)

------------------------------------------------------------------------
r42104 | etxrab | 2012-04-17 00:17:37 -0700 (Tue, 17 Apr 2012) | 9 lines
Changed paths:
   M /trunk/epan/conversation.c

From Evan Huus:
Do the right thing with conversation hash chains.

Adds two new functions: conversation_insert_into_hashtable() and
conversation_remove_from_hashtable() that do the right thing with conversation
hash table chains and ordering and all that. Converts conversation_new(),
conversation_set_addr2() and conversation_set_port2() to use the new functions.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7085
------------------------------------------------------------------------
r42103 | etxrab | 2012-04-16 21:51:07 -0700 (Mon, 16 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

From Jakub Zawadzki: fix, which changes types from FT_STRING to FT_DOUBLE. Fixes GeoIP: Display Filter comparisons operators do not seem to work for negative latitude or longitude values... https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5077
------------------------------------------------------------------------
r42102 | pascal | 2012-04-16 11:36:01 -0700 (Mon, 16 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Nick Lowe:
Add a security warning if EAP-LEAP or EAP-MD5 is seen.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7020

------------------------------------------------------------------------
r42101 | pascal | 2012-04-16 11:13:34 -0700 (Mon, 16 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Remove non-ASCII character

------------------------------------------------------------------------
r42100 | cmaynard | 2012-04-16 10:17:18 -0700 (Mon, 16 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Define ISUP_ITU_STANDARD_VARIANT before using it.

------------------------------------------------------------------------
r42099 | etxrab | 2012-04-16 08:52:32 -0700 (Mon, 16 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Introduce a preference to set Standard or National ITU ISUP variant.
------------------------------------------------------------------------
r42098 | etxrab | 2012-04-16 08:28:57 -0700 (Mon, 16 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Add dissection of French national messages.
------------------------------------------------------------------------
r42097 | alagoutte | 2012-04-16 08:18:51 -0700 (Mon, 16 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hip.c

Make checkhf happy (a bad copy/paste ?)
Add Modelines information

------------------------------------------------------------------------
r42096 | alagoutte | 2012-04-16 08:17:33 -0700 (Mon, 16 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hip.c

From Paco via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7111
HIP dissector of the HIP_CIPHER parameter is wrong

From me:
Add a hf_tlv_cipher_id and use proto_tree_add_item

------------------------------------------------------------------------
r42095 | etxrab | 2012-04-16 07:11:32 -0700 (Mon, 16 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Use content_type_parameter_str in dissect_application_isup()
to determine ISUP standard and ISUP variant(French).

Also fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6258
------------------------------------------------------------------------
r42094 | etxrab | 2012-04-16 06:29:57 -0700 (Mon, 16 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-amr.c

bool value should be FALSE.
------------------------------------------------------------------------
r42093 | etxrab | 2012-04-16 06:28:41 -0700 (Mon, 16 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Separate ANSI and ITU messages.
------------------------------------------------------------------------
r42092 | etxrab | 2012-04-16 01:47:18 -0700 (Mon, 16 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Nick Lowe:
Improve names for the EAP types, add missing definition. 

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7020
------------------------------------------------------------------------
r42091 | etxrab | 2012-04-16 01:39:34 -0700 (Mon, 16 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ansi_a.c
   M /trunk/epan/dissectors/packet-asap.c
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-spice.c
   M /trunk/epan/strutil.c
   M /trunk/epan/tcap-persistentdata.c
   M /trunk/rawshark.c
   M /trunk/tshark.c

From Evan Huus:
Duplicate and misplaced 'break' statements.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7106
------------------------------------------------------------------------
r42090 | alagoutte | 2012-04-16 00:59:48 -0700 (Mon, 16 Apr 2012) | 2 lines
Changed paths:
   M /trunk/airpcap_loader.c
   M /trunk/ui/gtk/airpcap_dlg.c
   M /trunk/ui/gtk/airpcap_gui_utils.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r42089 | guy | 2012-04-15 16:03:58 -0700 (Sun, 15 Apr 2012) | 11 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h
   M /trunk/ui/gtk/main_welcome.c

Get rid of the error code argument to scan_local_interfaces(); nobody
uses it once it's filled in.

From Evan Huus: in scan_local_interfaces(), pass NULL to
capture_interface_list(), as we don't use the error string (and don't
free it, either).

In fill_capture_box(), for CANT_GET_INTERFACE_LIST, include the error
string in the report, and free it, in all cases, when we're done with
it.

------------------------------------------------------------------------
r42088 | guy | 2012-04-15 15:21:50 -0700 (Sun, 15 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

From Evan Huus: fix a memory leak.  Fixes bug 7097.

------------------------------------------------------------------------
r42087 | guy | 2012-04-15 10:37:16 -0700 (Sun, 15 Apr 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.c

checkapi said

	Error: the blurb for field "NMO I" ("gsm_a.nmo_1") has trailing
	    space in packet-gsm_a_common.c

so remove the trailing space.

------------------------------------------------------------------------
r42086 | alagoutte | 2012-04-15 10:27:50 -0700 (Sun, 15 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/ui/gtk/mac_lte_stat_dlg.c
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c
   M /trunk/ui/gtk/rpc_progs.c
   M /trunk/ui/gtk/rtp_player.c
   M /trunk/ui/gtk/sctp_assoc_analyse.c
   M /trunk/ui/gtk/sctp_byte_graph_dlg.c
   M /trunk/ui/gtk/sctp_graph_dlg.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r42083 | gerald | 2012-04-15 07:03:31 -0700 (Sun, 15 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-04-15]
------------------------------------------------------------------------
r42082 | pascal | 2012-04-15 05:07:47 -0700 (Sun, 15 Apr 2012) | 2 lines
Changed paths:
   M /trunk/asn1/rrc/rrc.cnf
   M /trunk/epan/dissectors/packet-rrc.c

Fix compilation error under Windows

------------------------------------------------------------------------
r42081 | pascal | 2012-04-15 04:51:40 -0700 (Sun, 15 Apr 2012) | 2 lines
Changed paths:
   M /trunk/asn1/rrc/Class-definitions.asn
   M /trunk/asn1/rrc/Constant-definitions.asn
   M /trunk/asn1/rrc/InformationElements.asn
   M /trunk/asn1/rrc/Internode-definitions.asn
   M /trunk/asn1/rrc/PDU-definitions.asn
   M /trunk/asn1/rrc/packet-rrc-template.c
   M /trunk/asn1/rrc/rrc.cnf
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-gsm_a_rr.c
   M /trunk/epan/dissectors/packet-rrc.c

Update RRC to V10.7.0 and add dissection of Core Network System Information IEs

------------------------------------------------------------------------
r42080 | tuexen | 2012-04-15 04:11:36 -0700 (Sun, 15 Apr 2012) | 6 lines
Changed paths:
   M /trunk/pcapio.c
   M /trunk/wiretap/pcapng.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7048

Write timetamps for the interface statistic blocks the way specified
by http://www.winpcap.org/ntar/draft/PCAP-DumpFileFormat.html


------------------------------------------------------------------------
r42079 | tuexen | 2012-04-15 04:08:40 -0700 (Sun, 15 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Whitespace cleanup (done while debugging).

------------------------------------------------------------------------
r42078 | martinm | 2012-04-14 20:41:15 -0700 (Sat, 14 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Set the extent of the tagged parameters.

------------------------------------------------------------------------
r42077 | martinm | 2012-04-14 18:38:12 -0700 (Sat, 14 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/catapult_dct2000.c

Fix a typo (just clearing my client out before I start doing diffs).

------------------------------------------------------------------------
r42076 | martinm | 2012-04-14 18:37:08 -0700 (Sat, 14 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Getting closer to deleting old ROHC from PDCP dissector.
Don't register ROHC fields there (so its easier to find real fields with
auto-completion).

------------------------------------------------------------------------
r42074 | guy | 2012-04-14 11:16:56 -0700 (Sat, 14 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

From Even Huus: free a strduped string.  Fixes bug 7094.

------------------------------------------------------------------------
r42073 | guy | 2012-04-14 11:04:12 -0700 (Sat, 14 Apr 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/main.c

From Evan Huus: free if_string when we're done with it.  Fixes bug 7093.

From me: don't bother initializing if_string in its definition, as if
it's used at all it's set to a different value before all uses.

------------------------------------------------------------------------
r42070 | guy | 2012-04-14 10:45:03 -0700 (Sat, 14 Apr 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

From Evan Huus: add a missing free.  Fixes bug 7092.

------------------------------------------------------------------------
r42067 | guy | 2012-04-14 10:20:22 -0700 (Sat, 14 Apr 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/k12.c

More double-free fixes - destroy_k12_file_data() frees its argument, so
calling g_free() on that argument after calling destroy_k12_file_data()
is always an error.

------------------------------------------------------------------------
r42066 | etxrab | 2012-04-14 05:17:06 -0700 (Sat, 14 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Cosmetic changes
------------------------------------------------------------------------
r42065 | pascal | 2012-04-14 04:59:14 -0700 (Sat, 14 Apr 2012) | 2 lines
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/epan/dissectors/packet-gsm_map.c

Set direction according to destination address field also (and not only originating address).

------------------------------------------------------------------------
r42064 | pascal | 2012-04-14 04:56:12 -0700 (Sat, 14 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6202 :
Stop applying a specific treatment when receiving a SMS-DELIVER packet with an unknown direction (no such treatment is done for SMS-SUBMIT).
Store SMS fragment length in hash table to avoid mangling the output when displaying the reassembled SMS.

------------------------------------------------------------------------
r42063 | etxrab | 2012-04-14 00:58:59 -0700 (Sat, 14 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-pn532.c

From Tyson Key: Support for PN532 InDeselect, Release, and InSelect Command and Response Packets. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7083
------------------------------------------------------------------------
r42062 | etxrab | 2012-04-14 00:53:22 -0700 (Sat, 14 Apr 2012) | 1 line
Changed paths:
   M /trunk/wiretap/k12.c

From From Evan Huus: Potential double-free while importing k12xx *.rf5 files https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7084
------------------------------------------------------------------------
r42061 | etxrab | 2012-04-14 00:44:51 -0700 (Sat, 14 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main.c

From Evan Huus: Memory leak in scan_local_interfaces. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7086
------------------------------------------------------------------------
r42060 | etxrab | 2012-04-14 00:36:47 -0700 (Sat, 14 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/graph_analysis.c

From Evan Huus: Memory leaks in graph_analysis.c https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7082 changed to not allocating time_str unless needed.
------------------------------------------------------------------------
r42059 | guy | 2012-04-13 17:36:30 -0700 (Fri, 13 Apr 2012) | 12 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

If we don't even *have* a filter combo box, there's nothing we can check
or colorize; quit before we even *try* to get the link-layer header
type.

If we don't have an active link-layer header type, that probably means
we don't know what link-layer header types the interface provides, which
would be the case if it were a named pipe or an interface we can't open.
Don't crash in that case, just leave the filter combo box uncolored, to
indicate that we have no clue whether the filter is valid or not.

Fixes bug 7049.

------------------------------------------------------------------------
r42057 | guy | 2012-04-13 15:42:19 -0700 (Fri, 13 Apr 2012) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/capture_sync.c

From Evan Huus: fix memory leak.  Fixes bug 7081.

------------------------------------------------------------------------
r42056 | guy | 2012-04-13 15:29:11 -0700 (Fri, 13 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lldp.c

"OUI", not "OID", for IEEE OUIs.

------------------------------------------------------------------------
r42055 | guy | 2012-04-13 15:26:35 -0700 (Fri, 13 Apr 2012) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ecp-oui.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-lldp.c
   M /trunk/epan/dissectors/packet-lldp.h

Patch from Alex Lindberg to update the LLDP dissector to display
registered OUIs from manuf and allow custom dissectors for
Organizationally Specific TLVs.  Fixes bug 7080.

Use uint_get_manuf_name() and uint_get_manuf_name_if_known(), rather
than tvb_get_manuf_name() and tvb_get_manuf_name_if_known(), in cases
where we've fetched the OUI.

Have the ECP/VDP dissector also display registered OUIs from manuf.

Get rid of the OUI_CISCO_2 OUI from tlv_oui_subtype_vals, as that can
come from the manuf file.  Leave in comments explaining why, for now, we
aren't using the manuf file for *all* the OUIs.

------------------------------------------------------------------------
r42054 | guy | 2012-04-13 15:23:04 -0700 (Fri, 13 Apr 2012) | 10 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/addr_resolv.h

Add uint_get_manuf_name() and uint_get_manuf_name_if_known() routines,
which take an OUI, presumably fetched with a routine such as
tvb_get_ntoh24(), as an argument and attempt to look it up in the manuf
file.

Fix up the comments for all the get_manuf_name routines.

Get rid of "extern"s in definitions of functions (definitions, not
declarations).

------------------------------------------------------------------------
r42053 | darkjames | 2012-04-13 13:22:31 -0700 (Fri, 13 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c
   M /trunk/epan/dissectors/packet-ansi_637.c
   M /trunk/epan/dissectors/packet-bacapp.c
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-bgp.h
   M /trunk/epan/dissectors/packet-cigi.c
   M /trunk/epan/dissectors/packet-dccp.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-gmr1_bcch.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-hip.c
   M /trunk/epan/dissectors/packet-icq.c
   M /trunk/epan/dissectors/packet-ieee17221.c
   M /trunk/epan/dissectors/packet-igmp.c
   M /trunk/epan/dissectors/packet-itdm.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-pptp.c
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-rlm.c
   M /trunk/epan/dissectors/packet-rtp-midi.c
   M /trunk/epan/dissectors/packet-spice.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-wlccp.c
   M /trunk/epan/uat_load.l
   M /trunk/plugins/mate/mate_setup.c
   M /trunk/print.c
   M /trunk/ui/cli/tap-comparestat.c
   M /trunk/ui/cli/tap-funnel.c
   M /trunk/ui/gtk/about_dlg.c
   M /trunk/ui/gtk/compare_stat.c
   M /trunk/ui/gtk/sctp_stat.c
   M /trunk/ui/gtk/text_import.c
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/lanalyzer.c
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/netscaler.c
   M /trunk/wsutil/crc16.c

Remove doubled semicolons and semicolons outside function.

------------------------------------------------------------------------
r42052 | pascal | 2012-04-13 13:01:16 -0700 (Fri, 13 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-pn532.c

From Tyson Key:
Additional PN532 dissector opcode descriptions
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7078

------------------------------------------------------------------------
r42051 | guy | 2012-04-13 12:40:57 -0700 (Fri, 13 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

GUINT_TO_POINTER() causes warnings when passed something *shorter* than
a guint; cast the argument to guint.

------------------------------------------------------------------------
r42050 | guy | 2012-04-13 12:36:44 -0700 (Fri, 13 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Clean up white space.

------------------------------------------------------------------------
r42049 | darkjames | 2012-04-13 11:27:51 -0700 (Fri, 13 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Try to fix OSX builds.

------------------------------------------------------------------------
r42048 | guy | 2012-04-13 09:54:24 -0700 (Fri, 13 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-irc.c

Emphasize that TAG_DELIMITER must be a null-terminated string.

------------------------------------------------------------------------
r42047 | alagoutte | 2012-04-13 07:05:52 -0700 (Fri, 13 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Update ICMPv6 to last IANA Parameters (2012-03-28) 
* RFC-ietf-roll-rpl-19 => RFC6550
* draft-ietf-csi-proxy-send-05 => RFC 6496
* Add RFC6495 : Subject Key Identifier (SKI) SEND Name Type fields
* Add RFC6554 : An IPv6 Routing Header for Source Routes with RPL

------------------------------------------------------------------------
r42046 | etxrab | 2012-04-13 06:10:38 -0700 (Fri, 13 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

From Pascal Quantin:
Ignore Content-Length if Transfer-Encoding is present

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5182
------------------------------------------------------------------------
r42045 | etxrab | 2012-04-13 06:02:57 -0700 (Fri, 13 Apr 2012) | 4 lines
Changed paths:
   M /trunk/plugins/wimaxasncp/packet-wimaxasncp.c

From Pascal Quantin:
Fix Bug 6793  Some WiMAX messages decoded incorrectly

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6793
------------------------------------------------------------------------
r42044 | etxrab | 2012-04-13 05:53:47 -0700 (Fri, 13 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/conversation.c

From Cristian Constantin:
There was something really wrong in conversation_lookup_hashtable().


https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7066
------------------------------------------------------------------------
r42043 | etxrab | 2012-04-13 05:04:25 -0700 (Fri, 13 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

gunzip gzip:ed SIP bodies.
------------------------------------------------------------------------
r42042 | darkjames | 2012-04-13 03:38:41 -0700 (Fri, 13 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-irc.c

Needle for guint8_pbrk() must be NULL terminated. Fix bug #7070

------------------------------------------------------------------------
r42041 | pascal | 2012-04-13 03:01:38 -0700 (Fri, 13 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6477:
Use T-User-Data-Length to define the string size decoded with the 7 bits alphabet

------------------------------------------------------------------------
r42040 | guy | 2012-04-12 20:34:18 -0700 (Thu, 12 Apr 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-irc.c

When skipping white space, don't skip past the end of the line.

This *might* fix bug 7070, but I can't reproduce that bug on my machine
- I'm guessing from the "out of CPU time" that there's an infinite loop
somewhere, but I'm not seeing it.  In any case, these tests *are*
necessary.

------------------------------------------------------------------------
r42039 | guy | 2012-04-12 15:13:59 -0700 (Thu, 12 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtmpt.c

Give some URLs for descriptions of RTMP.

------------------------------------------------------------------------
r42038 | darkjames | 2012-04-12 14:56:13 -0700 (Thu, 12 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_proto_draw.c

Simplify r42030 expression. Thanks!

------------------------------------------------------------------------
r42037 | grahamb | 2012-04-12 13:18:49 -0700 (Thu, 12 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/cli/tap-iousers.c

Added Rel. Start and Duration to tshark -z conv,xxx output.  Tidied up duplicated code
------------------------------------------------------------------------
r42036 | etxrab | 2012-04-12 07:34:52 -0700 (Thu, 12 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Refactor to use dissect_gsm_map_msisdn().
------------------------------------------------------------------------
r42035 | etxrab | 2012-04-12 07:07:31 -0700 (Thu, 12 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/tfs.c
   M /trunk/epan/tfs.h

Bugfix and enhancement of MM Context dissection.
------------------------------------------------------------------------
r42034 | pascal | 2012-04-12 03:08:38 -0700 (Thu, 12 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-irc.c

From Nick Lowe:
Use correct return type for tvb_get_ephemeral_string
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=1450

------------------------------------------------------------------------
r42033 | etxrab | 2012-04-11 22:46:42 -0700 (Wed, 11 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-irc.c

From Michael Mann: improved the IRC dissector to be able to pick out the CTCP protocol. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=1450
------------------------------------------------------------------------
r42032 | etxrab | 2012-04-11 22:36:26 -0700 (Wed, 11 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/tvbuff.c

From Martin Kaiser: CID 525 is about tvb_new_octet_aligned(). datalen can be negative or 0 when ep_alloc0(datalen) is called. If this happens, it's because of a dissector not checking the bit_offset, I think a DISSECTOR_ASSERT() is ok for fixing this. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7068
------------------------------------------------------------------------
r42031 | etxrab | 2012-04-11 22:32:22 -0700 (Wed, 11 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tn3270.c

From Martin Kaiser: CID 476: add missing break. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7067
------------------------------------------------------------------------
r42030 | martinm | 2012-04-11 19:14:19 -0700 (Wed, 11 Apr 2012) | 6 lines
Changed paths:
   M /trunk/ui/gtk/main_proto_draw.c

The last bit of a byte, on its own, needs a mask of 1, rather than 256.
It was not being highlighted in the bits view.

So add % 8 to avoid shifting the single mask bit right out of the byte
we're supposed to be showing...

------------------------------------------------------------------------
r42029 | gerald | 2012-04-11 18:48:44 -0700 (Wed, 11 Apr 2012) | 2 lines
Changed paths:
   M /trunk/test/test.sh

Print the TShark version information during the prerequisite phase.

------------------------------------------------------------------------
r42028 | pascal | 2012-04-11 13:45:59 -0700 (Wed, 11 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-bfcp.c

From Nitinkumar Yemul:
Binary Floor Control Protocol (BFCP) dissector
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7061

------------------------------------------------------------------------
r42027 | alagoutte | 2012-04-11 12:37:56 -0700 (Wed, 11 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

Clean up indentation (use 2 spaces)
Add Modelines info

------------------------------------------------------------------------
r42026 | alagoutte | 2012-04-11 12:36:09 -0700 (Wed, 11 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

Update Extensible Authentication Protocol (EAP) Registry (2011-02-22)

------------------------------------------------------------------------
r42025 | jmayer | 2012-04-11 12:16:04 -0700 (Wed, 11 Apr 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c

Fix:
trunk/epan/dissectors/packet-sctp.c: In function ‘dissect_add_outgoing_streams_parameter’:
trunk/epan/dissectors/packet-sctp.c:1175:9: error: variable ‘length’ set but not used [-Werror=unused-but-set-variable]
trunk/epan/dissectors/packet-sctp.c: In function ‘dissect_add_incoming_streams_parameter’:
trunk/epan/dissectors/packet-sctp.c:1195:9: error: variable ‘length’ set but not used [-Werror=unused-but-set-variable]


------------------------------------------------------------------------
r42024 | jake | 2012-04-11 10:28:06 -0700 (Wed, 11 Apr 2012) | 3 lines
Changed paths:
   M /trunk/docbook/wsug_src/WSUG_chapter_introduction.xml

From Paul-Marc Bougharios:
Corrected Users Guide reference to Red Hat and Fedora.

------------------------------------------------------------------------
r42023 | etxrab | 2012-04-11 08:52:14 -0700 (Wed, 11 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-gtpv2.c

Dissect IE Type = 106 fully.
------------------------------------------------------------------------
r42022 | pascal | 2012-04-11 05:06:15 -0700 (Wed, 11 Apr 2012) | 2 lines
Changed paths:
   M /trunk/asn1/rrc/rrc.cnf
   M /trunk/epan/dissectors/packet-rrc.c

Display Home NodeB name.

------------------------------------------------------------------------
r42021 | guy | 2012-04-11 00:56:00 -0700 (Wed, 11 Apr 2012) | 3 lines
Changed paths:
   M /trunk/asn1/Makefile.inc

Not sure why there's a \ before the EOL there, but it's causing a
warning from the source-lines-of-code script, so....

------------------------------------------------------------------------
r42020 | guy | 2012-04-10 17:35:53 -0700 (Tue, 10 Apr 2012) | 3 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c

The trial period is arguably over - no need for packet-ansi_map.c to
have its own #if 0'ed out definition of dgt_set_t.

------------------------------------------------------------------------
r42019 | guy | 2012-04-10 17:34:13 -0700 (Tue, 10 Apr 2012) | 5 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c

Get rid of redundant Dgt1_9_bcd digit set - passing NULL as the digit
set uses tvb_bcd_dig_to_ep_str()'s default digit set, which is the same.

Clean up white space (no 4-space tab characters).

------------------------------------------------------------------------
r42018 | guy | 2012-04-10 16:32:16 -0700 (Tue, 10 Apr 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/wtap.c

Call LAPD-with-Linux-pseudoheader "linux-lapd", and fix its description
to indicate the Linux pseudo-header.

Fix the description of LAPD-without-Linux-pseudoheader to be just
"LAPD".

------------------------------------------------------------------------
r42017 | guy | 2012-04-10 16:28:17 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap.c

Fix tpo.

------------------------------------------------------------------------
r42016 | guy | 2012-04-10 16:27:39 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap.c

It's "X.25", not "X25".

------------------------------------------------------------------------
r42015 | etxrab | 2012-04-10 14:27:24 -0700 (Tue, 10 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser: DVB-CI host control: dissect pmt section by calling mpeg_pmt dissector https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7052
------------------------------------------------------------------------
r42014 | martinm | 2012-04-10 14:26:55 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

For PDCP status reports, show each lost SN as a bit from the map.

------------------------------------------------------------------------
r42013 | darkjames | 2012-04-10 13:58:14 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/emem.c

Revert r42001

------------------------------------------------------------------------
r42012 | guy | 2012-04-10 12:05:20 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/text2pcap.c

There's no __solaris__ predefine for Solaris; just use __sun.

------------------------------------------------------------------------
r42011 | guy | 2012-04-10 11:36:11 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/text_import.c

There's no __solaris__ predefine for Solaris; just use __sun.

------------------------------------------------------------------------
r42010 | guy | 2012-04-10 10:56:55 -0700 (Tue, 10 Apr 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/text_import.c

OK, that doesn't work; on Solaris, try _XOPEN_SOURCE=500, to request
SUSv2, and see if *that* makes the build work.

------------------------------------------------------------------------
r42009 | pascal | 2012-04-10 09:05:52 -0700 (Tue, 10 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

From Johannes Stezenbach:
Use right value for SET_FEATURE request code
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7058

------------------------------------------------------------------------
r42008 | darkjames | 2012-04-10 08:48:26 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-ldap.c

Fix #7056 + Remove mechanism global, unused variable.

------------------------------------------------------------------------
r42007 | pascal | 2012-04-10 07:55:34 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h248_annex_e.c

Squelch a "dereferencing type-punned pointer" warning when compiling with GCC 4.1.3 (h248_pkg_sig_t and h248_pkg_evt_t structures are identical)

------------------------------------------------------------------------
r42006 | etxrab | 2012-04-10 06:21:35 -0700 (Tue, 10 Apr 2012) | 1 line
Changed paths:
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-ldap.c

Propagate http://anonsvn.wireshark.org/viewvc/viewvc.cgi?view=rev&revision=42005 to template file.
------------------------------------------------------------------------
r42005 | darkjames | 2012-04-10 05:21:15 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c

This should be enough to make buildbot happy (bug #7054)

------------------------------------------------------------------------
r42004 | darkjames | 2012-04-10 03:20:20 -0700 (Tue, 10 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dfilter/semcheck.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-uaudp.c
   M /trunk/plugins/wimax/mac_hd_type1_decoder.c
   M /trunk/plugins/wimax/mac_hd_type2_decoder.c
   M /trunk/plugins/wimax/mac_mgmt_msg_decoder.c
   M /trunk/ui/gtk/summary_dlg.c

Add missing consts.

------------------------------------------------------------------------
r42002 | darkjames | 2012-04-10 00:26:23 -0700 (Tue, 10 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-infiniband.c

Fix bug #7053, change ep_ to se_

** ERROR **: Memory corrupted (not scrubbed) dead0004

------------------------------------------------------------------------
r42001 | darkjames | 2012-04-09 15:31:41 -0700 (Mon, 09 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/emem.c

If scrubbing memory is set, during alloc we can check if memory is still scrubbed.

This should at least show problems with ep_ use in packet-infiband.c

------------------------------------------------------------------------
r42000 | darkjames | 2012-04-09 13:06:27 -0700 (Mon, 09 Apr 2012) | 2 lines
Changed paths:
   M /trunk/plugins/opcua/opcua_complextypeparser.c
   M /trunk/plugins/opcua/opcua_complextypeparser.h
   M /trunk/plugins/opcua/opcua_identifiers.h
   M /trunk/plugins/opcua/opcua_simpletypes.c
   M /trunk/plugins/opcua/opcua_simpletypes.h

Add missing consts in opcua plugin.

------------------------------------------------------------------------
r41999 | darkjames | 2012-04-09 12:43:19 -0700 (Mon, 09 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/conversation.c
   M /trunk/epan/dissectors/packet-babel.c
   M /trunk/epan/dissectors/packet-brp.c
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cipsafety.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-windows-common.c
   M /trunk/wiretap/netscaler.c

Mark some function static.

------------------------------------------------------------------------
r41998 | darkjames | 2012-04-09 12:12:17 -0700 (Mon, 09 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-adwin-config.c
   M /trunk/ui/gtk/wlan_stat_dlg.c

Fix 'overflow in implicit constant conversion', make it const.

------------------------------------------------------------------------
r41997 | pascal | 2012-04-09 11:48:52 -0700 (Mon, 09 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Fix a few calls to tvb_bcd_dig_to_ep_str and proto_tree_add_item

------------------------------------------------------------------------
r41996 | darkjames | 2012-04-09 11:44:10 -0700 (Mon, 09 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-nfs.h
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/dissectors/packet-windows-common.h
   M /trunk/epan/strutil.c
   M /trunk/rawshark.c
   M /trunk/ui/gtk/filter_autocomplete.c
   M /trunk/ui/gtk/firewall_dlg.c

Add missing const attribute to some char *

Fix some "assignment discards qualifiers from pointer target type", etc

------------------------------------------------------------------------
r41994 | cmaynard | 2012-04-09 11:17:33 -0700 (Mon, 09 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Set the minimum length of the Internet Timestamp option to 4 bytes instead of 5.  RFC 791 only states that the smallest legal value of the pointer is 5, not the smallest size for the option itself.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7043

Since backporting must be manually applied anyway, other changes include fixing the displaying of the EOOL and NOP options, as well as other options without a dissect routine associated with them.

------------------------------------------------------------------------
r41993 | darkjames | 2012-04-09 10:53:04 -0700 (Mon, 09 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-agentx.c
   M /trunk/epan/dissectors/packet-coap.c
   M /trunk/epan/dissectors/packet-dect.c
   M /trunk/epan/dissectors/packet-gopher.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-scsi-sbc.c
   M /trunk/epan/dissectors/packet-sercosiii.c
   M /trunk/epan/dissectors/packet-smb-browse.c
   M /trunk/epan/dissectors/packet-wps.c
   M /trunk/ui/gtk/prefs_capture.c
   M /trunk/ui/gtk/voip_calls.c

Add missing const attribute to some char *

Fix some "assignment discards qualifiers from pointer target type", etc

------------------------------------------------------------------------
r41992 | etxrab | 2012-04-09 08:18:04 -0700 (Mon, 09 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Nick Lowe: Minor cosmetic name changes for consistency and brevity. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7020
------------------------------------------------------------------------
r41991 | etxrab | 2012-04-09 08:00:23 -0700 (Mon, 09 Apr 2012) | 1 line
Changed paths:
   M /trunk/asn1/pkix1explicit/packet-pkix1explicit-template.c
   M /trunk/epan/dissectors/packet-pkix1explicit.c

From Martin Peylo: add string for id-dsa-with-sha1 OID to pkix1explicit https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7044
------------------------------------------------------------------------
r41990 | etxrab | 2012-04-09 07:53:42 -0700 (Mon, 09 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-dvbci.c
   A /trunk/epan/dissectors/packet-oipf.c

From Martin Kaiser: DVB-CI: register an application for the SAS resource, new OIPF dissector for application messages https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7039
------------------------------------------------------------------------
r41989 | etxrab | 2012-04-09 07:45:03 -0700 (Mon, 09 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-eapol.c

From Nick Lowe: Fix two check warnings, make consistent. (Rebased.) https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7037
------------------------------------------------------------------------
r41988 | pascal | 2012-04-09 07:43:13 -0700 (Mon, 09 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

From Michael Mann:
use suboption length instead of option length to terminate option 82 dissection in BOOTP

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7047

------------------------------------------------------------------------
r41987 | wmeier | 2012-04-09 07:17:49 -0700 (Mon, 09 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn3270.c

Read_Buffer, Read_Modified & Read_Modified_All are valid outbound commands.
(Fixes issue reported in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6854#c8)

Also: Rename 3270 "command" defines to reflect Local vs Remote.

------------------------------------------------------------------------
r41986 | martinm | 2012-04-08 18:50:26 -0700 (Sun, 08 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Obsolete a preference
------------------------------------------------------------------------
r41985 | pascal | 2012-04-08 10:17:07 -0700 (Sun, 08 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7045 :
use right bitmask to get the Z reserved bits

------------------------------------------------------------------------
r41984 | pascal | 2012-04-08 09:03:21 -0700 (Sun, 08 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

As suggested by Jakub, always update the digit value when the nibble is outside [0;9] range

------------------------------------------------------------------------
r41981 | gerald | 2012-04-08 07:03:25 -0700 (Sun, 08 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf

[Automatic manuf, services and enterprise-numbers update for 2012-04-08]
------------------------------------------------------------------------
r41980 | pascal | 2012-04-08 06:21:25 -0700 (Sun, 08 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt

Ignore automatically generated file

------------------------------------------------------------------------
r41979 | pascal | 2012-04-08 06:10:45 -0700 (Sun, 08 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7042 :
Handle properly filler and do not remove last digit

------------------------------------------------------------------------
r41978 | grahamb | 2012-04-07 13:13:27 -0700 (Sat, 07 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-eapol.c

Fixed checkAPI warnings for blurb matching field name
------------------------------------------------------------------------
r41977 | etxrab | 2012-04-07 06:07:53 -0700 (Sat, 07 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eapol.c

From Nick Lowe:
Review use of proto_tree_add_*() in packet-eapol.c

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7037
------------------------------------------------------------------------
r41971 | gerald | 2012-04-06 10:27:20 -0700 (Fri, 06 Apr 2012) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/configure.in
   M /trunk/debian/changelog
   M /trunk/debian/wireshark-common.files
   M /trunk/docbook/release-notes.xml
   M /trunk/epan/Makefile.am
   M /trunk/make-version.pl
   M /trunk/wiretap/Makefile.am

1.7.1 → 1.7.2.

------------------------------------------------------------------------
r41970 | gerald | 2012-04-06 09:28:33 -0700 (Fri, 06 Apr 2012) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Build 1.7.1.

------------------------------------------------------------------------
r41969 | guy | 2012-04-05 20:42:32 -0700 (Thu, 05 Apr 2012) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/dissectors/packet-mstp.c
   M /trunk/wiretap/eyesdn.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

Indicate where BACnet MS/TP is specified.

Add a new WTAP_ENCAP_BACNET_MS_TP_WITH_PHDR encapsulation type, for use
by the EyeSDN file reader; unlike the pcap-encapsulated MS/TP, it
includes a direction indicator.  Don't treat WTAP_ENCAP_BACNET_MS_TP as
if it has a direction indicator, as it doesn't; instead, do that for
WTAP_ENCAP_BACNET_MS_TP_WITH_PHDR.

Add some missing entries to encap_table_base for WTAP_ENCAP_ values that
didn't get entries added.

------------------------------------------------------------------------
r41968 | gerald | 2012-04-05 17:32:26 -0700 (Thu, 05 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.c

Clamp a value as suggested by Mike Morrin in bug 6878.

------------------------------------------------------------------------
r41967 | gerald | 2012-04-05 15:10:53 -0700 (Thu, 05 Apr 2012) | 7 lines
Changed paths:
   M /trunk/ipmap.html
   M /trunk/ui/gtk/hostlist_table.c

Instead of loading our coordinates from a separate text file via
OpenLayers.Layer.Text, insert them into a JSON array and load them using
OpenLayers.Layer.Vector + OpenLayers.Format.GeoJSON. This should fix the
endpoint map feature on modern browsers.

Switch OpenStreetMap to a simpler map from OSGeo.

------------------------------------------------------------------------
r41966 | guy | 2012-04-05 14:24:10 -0700 (Thu, 05 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/eyesdn.c

Use tabs more uniformly.

------------------------------------------------------------------------
r41965 | guy | 2012-04-05 14:22:09 -0700 (Thu, 05 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-v5dl.c

Clean up indentation (use 8-space tab-based indentation throughout).

------------------------------------------------------------------------
r41964 | guy | 2012-04-05 14:20:23 -0700 (Thu, 05 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-v5ef.c

Rename v52_handle to reflect that it's a handle for V5DL, not V5.2
payload.

Clean up indentation (use 8-space tab-based indentation throughout).

------------------------------------------------------------------------
r41963 | guy | 2012-04-05 14:13:37 -0700 (Thu, 05 Apr 2012) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-v5dl.c

Fix the name of the variable with the handle for the V5.2 dissector, to
make it clearer that the payload isn't being dissected as uninterpreted
data.

Whether the checksum is checked should not depend n the presence of
per-frame protocol data; make it depend on the availability of the
checksum, instead.  Then #if 0 out all that code, as, at least in the
V5.2 capture attached to bug 7027, there is no checksum in any of the
packets.

Clean up indentation a bit.

------------------------------------------------------------------------
r41962 | guy | 2012-04-05 13:25:26 -0700 (Thu, 05 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/wiretap/eyesdn.c

WTAP_ENCAP_MTP2 is for MTP2 *without* a pseudo-header giving direction
or other information; WTAP_ENCAP_MTP2_WITH_PHDR is for MTP2 *with* such
a pseudo-header.  Use WTAP_ENCAP_MTP2_WITH_PHDR for the EyeSDN captures,
and don't assume there's a pseudo-header if you have WTAP_ENCAP_MTP2.

------------------------------------------------------------------------
r41961 | darkjames | 2012-04-05 13:17:39 -0700 (Thu, 05 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

val is unitinialized when fUnsigned32 return false.

------------------------------------------------------------------------
r41960 | darkjames | 2012-04-05 13:03:49 -0700 (Thu, 05 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-infiniband.c

Fix invalid use of sizeof, it should be array length.

------------------------------------------------------------------------
r41959 | guy | 2012-04-05 12:31:39 -0700 (Thu, 05 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-v5ef.c

Put the right file name into the initial comment.

------------------------------------------------------------------------
r41958 | alagoutte | 2012-04-05 10:49:20 -0700 (Thu, 05 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Nick Lowe via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7020

Put EAP-TLS flags in to a tree to tidy the UI.

------------------------------------------------------------------------
r41957 | darkjames | 2012-04-05 10:36:32 -0700 (Thu, 05 Apr 2012) | 2 lines
Changed paths:
   M /trunk/make-version.pl

For some broken environments we need also set LC_ALL.

------------------------------------------------------------------------
r41956 | darkjames | 2012-04-05 10:08:21 -0700 (Thu, 05 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nflog.c

Some fixes for nflog. Fix bug #7036

------------------------------------------------------------------------
r41955 | etxrab | 2012-04-05 05:33:25 -0700 (Thu, 05 Apr 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c
   M /trunk/epan/eap.h

From Nick Lowe:
- Update eap header file to include MS-CHAP v2 definitions. 
- Convert EAP-MS-CHAP-V2 to use proto_tree_add_item() and make a few, hopefully final, changes. 

Fixed a couple of typos etc.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7020
------------------------------------------------------------------------
r41954 | etxrab | 2012-04-05 04:18:49 -0700 (Thu, 05 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tcp.h

From Michael Mann:
TCP picks wrong sub-dissector if both dissector choices have the same "minimum segment size"

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7008
------------------------------------------------------------------------
r41953 | etxrab | 2012-04-05 03:35:39 -0700 (Thu, 05 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ip.h
   M /trunk/epan/dissectors/packet-ipv6.c

Use common code to have the same hf field for DSCP in IPv4 and IPv6.
------------------------------------------------------------------------
r41952 | etxrab | 2012-04-05 01:38:26 -0700 (Thu, 05 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ip.h
   M /trunk/epan/dissectors/packet-ipv6.c

Use common code to add ip version to the tree.
------------------------------------------------------------------------
r41951 | etxrab | 2012-04-05 01:02:32 -0700 (Thu, 05 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Use common value string for DSCP.
------------------------------------------------------------------------
r41950 | etxrab | 2012-04-05 00:44:25 -0700 (Thu, 05 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rmt-fec.c

From Shima:
Parsing for ALC protocol, FEC header for LDPC (RFC 5170).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7034
------------------------------------------------------------------------
r41949 | etxrab | 2012-04-05 00:35:18 -0700 (Thu, 05 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Nick Lowe:
Convert EAP-LEAP to use proto_tree_add_item() and make a few fixups. 

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7020
------------------------------------------------------------------------
r41948 | martinm | 2012-04-04 17:53:01 -0700 (Wed, 04 Apr 2012) | 3 lines
Changed paths:
   M /trunk/ui/cli/tap-macltestat.c
   M /trunk/ui/gtk/mac_lte_stat_dlg.c

Fix test to avoid dividing by 0.0 (was displaying as "-nan" rather than
crashing).

------------------------------------------------------------------------
r41947 | cmaynard | 2012-04-04 16:25:00 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-v5dl.c

Fix Coverity CID 1469: UNUSED_VALUE.

------------------------------------------------------------------------
r41946 | gerald | 2012-04-04 14:55:42 -0700 (Wed, 04 Apr 2012) | 1 line
Changed paths:
   M /trunk/docbook/release-notes.xml

Add XML to the capture file list
------------------------------------------------------------------------
r41945 | gerald | 2012-04-04 14:54:22 -0700 (Wed, 04 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h
   M /trunk/epan/to_str.c
   M /trunk/epan/to_str.h
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

Make bit_offset in _tvb_get_bits64 and related functions unsigned. This
removes a potential buffer overflow and should fix a bunch of Coverity
errors mentioned in bug 6878.

We might want to do the same for no_of_bits.

------------------------------------------------------------------------
r41944 | darkjames | 2012-04-04 13:52:52 -0700 (Wed, 04 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xml.c
   M /trunk/wiretap/mime_file.c

Allow loading xml files (file MUST start with <?xml).

I needed it for testing (bug #7028)
if you feel like it's stupid idea give me nfo :)

------------------------------------------------------------------------
r41943 | morriss | 2012-04-04 13:46:49 -0700 (Wed, 04 Apr 2012) | 9 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.nmake
   M /trunk/asn1/camel/Makefile.nmake
   M /trunk/asn1/h225/Makefile.nmake
   M /trunk/asn1/h235/Makefile.nmake
   M /trunk/asn1/h450/Makefile.nmake
   M /trunk/asn1/mpeg-pes/Makefile.nmake
   M /trunk/asn1/q932/Makefile.nmake
   M /trunk/asn1/qsig/Makefile.nmake
   M /trunk/codecs/Makefile.am
   M /trunk/codecs/Makefile.nmake
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/crypt/Makefile.am
   M /trunk/epan/crypt/Makefile.nmake
   M /trunk/epan/dfilter/Makefile.am
   M /trunk/epan/dfilter/Makefile.nmake
   M /trunk/epan/dissectors/Makefile.am
   M /trunk/epan/dissectors/Makefile.nmake
   M /trunk/epan/ftypes/Makefile.am
   M /trunk/epan/ftypes/Makefile.nmake
   M /trunk/epan/wslua/Makefile.am
   M /trunk/epan/wslua/Makefile.nmake
   M /trunk/epan/wspython/Makefile.nmake
   M /trunk/plugins/asn1/Makefile.am
   M /trunk/plugins/asn1/Makefile.nmake
   M /trunk/plugins/docsis/Makefile.am
   M /trunk/plugins/docsis/Makefile.nmake
   M /trunk/plugins/easy_codec/Makefile.nmake
   M /trunk/plugins/ethercat/Makefile.am
   M /trunk/plugins/ethercat/Makefile.nmake
   M /trunk/plugins/giop/Makefile.am
   M /trunk/plugins/giop/Makefile.nmake
   M /trunk/plugins/gryphon/Makefile.am
   M /trunk/plugins/gryphon/Makefile.nmake
   M /trunk/plugins/irda/Makefile.am
   M /trunk/plugins/irda/Makefile.nmake
   M /trunk/plugins/m2m/Makefile.am
   M /trunk/plugins/m2m/Makefile.nmake
   M /trunk/plugins/mate/Makefile.am
   M /trunk/plugins/mate/Makefile.nmake
   M /trunk/plugins/opcua/Makefile.am
   M /trunk/plugins/opcua/Makefile.nmake
   M /trunk/plugins/profinet/Makefile.am
   M /trunk/plugins/profinet/Makefile.nmake
   M /trunk/plugins/stats_tree/Makefile.am
   M /trunk/plugins/stats_tree/Makefile.nmake
   M /trunk/plugins/tpg/Makefile.am
   M /trunk/plugins/tpg/Makefile.nmake
   M /trunk/plugins/unistim/Makefile.am
   M /trunk/plugins/unistim/Makefile.nmake
   M /trunk/plugins/wimax/Makefile.am
   M /trunk/plugins/wimax/Makefile.nmake
   M /trunk/plugins/wimaxasncp/Makefile.am
   M /trunk/plugins/wimaxasncp/Makefile.nmake
   M /trunk/tools/checkAPIs.pl
   M /trunk/ui/Makefile.am
   M /trunk/ui/Makefile.nmake
   M /trunk/ui/cli/Makefile.am
   M /trunk/ui/cli/Makefile.nmake
   M /trunk/ui/gtk/Makefile.am
   M /trunk/ui/gtk/Makefile.nmake
   M /trunk/ui/qt/Makefile.am
   M /trunk/ui/win32/Makefile.nmake
   M /trunk/wiretap/Makefile.am
   M /trunk/wiretap/Makefile.nmake
   M /trunk/wsutil/Makefile.am
   M /trunk/wsutil/Makefile.nmake

Add a "-build" argument to checkAPIs.pl.  Use that argument when building
from makefiles (and thus from the buildbot).

The intention is to be able to tell when a human is running the tool so we
can provide more code-review guidance.

As a starter, enable the "too many proto_tree_add_text() calls" check when
a human is running the tool.

------------------------------------------------------------------------
r41942 | morriss | 2012-04-04 13:09:21 -0700 (Wed, 04 Apr 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_abis_om2000.c

Replace a:
 
proto_tree_add_bytes_format*(tree, hf, tvb, offset, length, tvb_get_ptr(tvb, offset, length), [...])
  
with:
   
proto_tree_add_bytes_format*(tree, hf, tvb, offset, length, NULL, [...])

------------------------------------------------------------------------
r41941 | guy | 2012-04-04 12:46:45 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Fix tpo.

------------------------------------------------------------------------
r41939 | guy | 2012-04-04 12:36:24 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wsutil/wsgetopt.h

Always declare getopt() with a prototype.

------------------------------------------------------------------------
r41938 | guy | 2012-04-04 12:26:07 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Work around that WinPcap bug for another pcap_open() call.

------------------------------------------------------------------------
r41937 | guy | 2012-04-04 12:13:39 -0700 (Wed, 04 Apr 2012) | 6 lines
Changed paths:
   M /trunk/dumpcap.c

Work around WinPcap bug wherein pcap_open() returns -1 without putting
an error message into errbuf (the bug has been reported to
winpcap-bugs).

Should fix bug 6922.

------------------------------------------------------------------------
r41936 | gerald | 2012-04-04 11:43:37 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add more protocols and bug 6077 (Rearranging columns on Win64).

------------------------------------------------------------------------
r41935 | morriss | 2012-04-04 10:16:16 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/dfilter_expr_dlg.c

Fix CID 613: item_str can't be NULL here so don't check for it being NULL.

------------------------------------------------------------------------
r41934 | morriss | 2012-04-04 09:57:31 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/voip_calls.c

Fix CID 614: callsinfo can't be NULL here so don't check for it being NULL.

------------------------------------------------------------------------
r41933 | morriss | 2012-04-04 09:55:14 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/voip_calls.c

Fix CID 615: strinfo can't be NULL here so don't check for it being NULL.

------------------------------------------------------------------------
r41932 | morriss | 2012-04-04 09:52:18 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/voip_calls.c

Fix CID 616: callsinfo can't be NULL here so don't check for it being NULL.

------------------------------------------------------------------------
r41931 | morriss | 2012-04-04 09:42:48 -0700 (Wed, 04 Apr 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/wlan_stat_dlg.c

Fix CID 617: te can't be NULL here (unless si is NULL in which case we've
got bigger problems) so there's no need to check for it being NULL.

------------------------------------------------------------------------
r41930 | gerald | 2012-04-04 09:13:35 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/wsutil/wsgetopt.c

Fix compilation on Win64.

------------------------------------------------------------------------
r41929 | morriss | 2012-04-04 08:54:19 -0700 (Wed, 04 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdp.c

Fix CID 1287: rdp_info can't be NULL here so there's no need to check for it
being NULL.

------------------------------------------------------------------------
r41928 | etxrab | 2012-04-04 08:42:46 -0700 (Wed, 04 Apr 2012) | 1 line
Changed paths:
   M /trunk/config.nmake

Revert
------------------------------------------------------------------------
r41927 | etxrab | 2012-04-04 08:24:23 -0700 (Wed, 04 Apr 2012) | 1 line
Changed paths:
   A /trunk/wsutil/wsgetopt_int.h

Update to a version which have getopt_long(). + one file
------------------------------------------------------------------------
r41926 | etxrab | 2012-04-04 08:23:47 -0700 (Wed, 04 Apr 2012) | 1 line
Changed paths:
   M /trunk/config.nmake
   M /trunk/wsutil/Makefile.am
   M /trunk/wsutil/wsgetopt.c
   M /trunk/wsutil/wsgetopt.h

Update to a version which have getopt_long().
------------------------------------------------------------------------
r41925 | morriss | 2012-04-04 07:42:25 -0700 (Wed, 04 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c

Avoid false-positive CID 621: if str is non-NULL, idx should be positive
(so idx won't be negative when used in the else statement).  To avoid
this false positive, add a check if idx is negative to the if(str) check.

Also remove some trailing commas.

------------------------------------------------------------------------
r41924 | etxrab | 2012-04-04 05:49:09 -0700 (Wed, 04 Apr 2012) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

Try to fix:
packet-eap.c: At top level:
packet-eap.c:150: error: static declaration of ‘eap_sim_subtype_vals’ follows non-static declaration
../../epan/eap.h:62: note: previous declaration of ‘eap_sim_subtype_vals’ was here
packet-eap.c:159: error: static declaration of ‘eap_aka_subtype_vals’ follows non-static declaration
../../epan/eap.h:72: note: previous declaration of ‘eap_aka_subtype_vals’ was here
packet-eap.c: In function ‘dissect_eap’:
packet-eap.c:668: warning: request for implicit conversion from ‘void *’ to ‘struct conv_state_t *’ not permitted in C++
packet-eap.c:673: warning: request for implicit conversion from ‘void *’ to ‘struct conv_state_t *’ not permitted in C++
packet-eap.c:866: warning: request for implicit conversion from ‘void *’ to ‘struct frame_state_t *’ not permitted in C++
packet-eap.c:927: warning: request for implicit conversion from ‘void *’ to ‘struct frame_state_t *’ not permitted in C++
packet-eap.c:1048: warning: request for implicit conversion from ‘void *’ to ‘struct frame_state_t *’ not permitted in C++
packet-eap.c:1067: warning: request for implicit conversion from ‘void *’ to ‘struct frame_state_t *’ not permitted in C++
------------------------------------------------------------------------
r41923 | cmaynard | 2012-04-04 05:47:08 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-artnet.c
   M /trunk/epan/dissectors/packet-enttec.c

Avoid some potential divide by zero errors that Clang reports.

------------------------------------------------------------------------
r41922 | etxrab | 2012-04-04 05:32:44 -0700 (Wed, 04 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c
   M /trunk/epan/eap.h

From Nick Lowe:
- Update eap header file to include SIM and AKA definitions.
- Change the SIM and AKA EAP types to use proto_tree_add_item(). 

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7020
------------------------------------------------------------------------
r41921 | etxrab | 2012-04-04 03:35:48 -0700 (Wed, 04 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

Change to use eap. in filter names isof eap_
------------------------------------------------------------------------
r41920 | alagoutte | 2012-04-04 02:41:03 -0700 (Wed, 04 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Add Openwire dissector to CMake too...


------------------------------------------------------------------------
r41919 | alagoutte | 2012-04-04 02:37:19 -0700 (Wed, 04 Apr 2012) | 14 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-openwire.c

From Metatech via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7014

Here is a dissector for ActiveMQ OpenWire protocol.

A few words about the protocol : 
OpenWire has two wire formats :
- "loose" : more verbose, less CPU-intensive, less network-intensive (1-pass)
- "tight" : more compact, more CPU-intensive, more network-intensive (2-pass)
This dissector only supports the "loose" syntax, which is not the default.
This dissector only supports version 6 of the protocol.
It can be changed on the broker in the activemq.xml file by specifying
"tightEncodingEnabled=false" :


------------------------------------------------------------------------
r41918 | etxrab | 2012-04-04 01:04:25 -0700 (Wed, 04 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Nick Lowe:
Convert EAP-IDENTITY, EAP-NOTIFY and EAP-MD5 to use proto_tree_add_item().

From me consistently use "proto abbr"_"name".
------------------------------------------------------------------------
r41917 | etxrab | 2012-04-04 00:47:54 -0700 (Wed, 04 Apr 2012) | 4 lines
Changed paths:
   M /trunk/asn1/lte-rrc/EUTRA-InterNodeDefinitions.asn
   M /trunk/asn1/lte-rrc/EUTRA-RRC-Definitions.asn
   M /trunk/asn1/lte-rrc/EUTRA-UE-Variables.asn
   M /trunk/asn1/lte-rrc/lte-rrc.cnf
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/epan/dissectors/packet-lte-rrc.c

From Pascal Quantin:
Upgrade LTE RRC dissector to v10.5.0.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7032
------------------------------------------------------------------------
r41916 | etxrab | 2012-04-04 00:40:20 -0700 (Wed, 04 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI: check APDUs against resource id.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7031
------------------------------------------------------------------------
r41915 | etxrab | 2012-04-04 00:33:39 -0700 (Wed, 04 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-frame.c
   A /trunk/epan/dissectors/packet-v5dl.c
   A /trunk/epan/dissectors/packet-v5ef.c
   M /trunk/wiretap/eyesdn.c
   M /trunk/wiretap/eyesdn.h
   M /trunk/wiretap/wtap.h

From Rolf Fiedler:
Patch to add V5.2 tracing capability on E1 links using EyeSDN probes.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7027

Removed preference related stufff as it's not needed.
------------------------------------------------------------------------
r41914 | gerald | 2012-04-03 17:47:21 -0700 (Tue, 03 Apr 2012) | 9 lines
Changed paths:
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi

Add and update a bunch of Programs and Features-related registry
keys. Sort the keys by name. Calculate the installation size after all
of the files have been installed and add that in the "EstimatedSize"
key. Fix the display icon. Add a hint about our target platform. Add
version information.

We now look like a grown-up application in the Programs and Features
control panel.

------------------------------------------------------------------------
r41913 | morriss | 2012-04-03 14:52:03 -0700 (Tue, 03 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Nick Lowe via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7020 :

First patch to start the conversion of the EAP dissector from its use of
proto_tree_add_text() to proto_tree_add_item().

------------------------------------------------------------------------
r41912 | morriss | 2012-04-03 14:38:59 -0700 (Tue, 03 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-spoolss.c

From Martin Kaiser (on -dev): initialize an uninitialized variable.  From me: also clean up some indentation.
------------------------------------------------------------------------
r41911 | grahamb | 2012-04-03 13:05:36 -0700 (Tue, 03 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-spoolss.c

Implement spoolss function GetPrinterDriverDirectory (opnum 12).

Also renamed "Architecture" field to "Environment" as per MS docs.

Fix bug #2279
------------------------------------------------------------------------
r41910 | morriss | 2012-04-03 10:37:27 -0700 (Tue, 03 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Fix CID 620: since we're checking if the given hf index is positive (since
r15662), move the proto_tree_add_boolean() call (which uses the hf index)
inside the check.

------------------------------------------------------------------------
r41909 | gerald | 2012-04-03 10:18:34 -0700 (Tue, 03 Apr 2012) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Remove fixed or no-longer-relevant bugs.

------------------------------------------------------------------------
r41908 | gerald | 2012-04-03 09:10:55 -0700 (Tue, 03 Apr 2012) | 2 lines
Changed paths:
   M /trunk/test/suite-decryption.sh

Add a to-do list for more decryption tests.

------------------------------------------------------------------------
r41907 | gerald | 2012-04-03 09:03:42 -0700 (Tue, 03 Apr 2012) | 3 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Fill in the list of new protocols (87 of them!) and new & updated
capture file support.

------------------------------------------------------------------------
r41906 | wmeier | 2012-04-03 08:38:27 -0700 (Tue, 03 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn3270.c

Improve the text of some value_strings.

------------------------------------------------------------------------
r41905 | etxrab | 2012-04-03 07:46:02 -0700 (Tue, 03 Apr 2012) | 1 line
Changed paths:
   M /trunk/asn1/lcsap/LCS-AP-IEs.asn
   M /trunk/asn1/lcsap/lcsap.cnf
   M /trunk/epan/dissectors/packet-lcsap.c

Comment out unused define.
------------------------------------------------------------------------
r41904 | etxrab | 2012-04-03 07:12:07 -0700 (Tue, 03 Apr 2012) | 1 line
Changed paths:
   M /trunk/asn1/lcsap/LCS-AP-CommonDataTypes.asn
   M /trunk/asn1/lcsap/LCS-AP-Constants.asn
   M /trunk/asn1/lcsap/LCS-AP-Containers.asn
   M /trunk/asn1/lcsap/LCS-AP-IEs.asn
   M /trunk/asn1/lcsap/LCS-AP-PDU-Contents.asn
   M /trunk/asn1/lcsap/LCS-AP-PDU-Descriptions.asn
   M /trunk/asn1/lcsap/lcsap.cnf
   M /trunk/epan/dissectors/packet-lcsap.c

Update to V11.1.0 (2012-03)
------------------------------------------------------------------------
r41903 | darkjames | 2012-04-03 02:28:58 -0700 (Tue, 03 Apr 2012) | 4 lines
Changed paths:
   M /trunk/asn1/x509sat/x509sat.cnf
   M /trunk/epan/dissectors/packet-x509sat.c

Fix off by one shift error introduced in r39531.

In tvb_get_ephemeral_unicode_string() length is number of bytes (not characters).

------------------------------------------------------------------------
r41902 | darkjames | 2012-04-03 02:18:16 -0700 (Tue, 03 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/epan.c
   M /trunk/file.c

Fix dependent_frames memleak. 

Reviewed-By: Jeff Morriss (http://www.wireshark.org/lists/wireshark-dev/201204/msg00013.html)

------------------------------------------------------------------------
r41901 | morriss | 2012-04-02 18:52:44 -0700 (Mon, 02 Apr 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7023 :

For each message, the DVB-CI dissector checks the message size against the
buffer size negotiated at startup. If the buffer size negotation was not
captured, a warning is flagged up for each packet saying its size is too big. 

Obviously, the check only makes sense if we know the negotiated buffer size...

------------------------------------------------------------------------
r41900 | martinm | 2012-04-02 18:49:27 -0700 (Mon, 02 Apr 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/catapult_dct2000.c

Set up table to help with ascii-hex -> hex conversion in advance to
avoid testing static for every conversion.

------------------------------------------------------------------------
r41899 | morriss | 2012-04-02 18:25:24 -0700 (Mon, 02 Apr 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua3g.c

Fix a couple of CIDs related to missing breaks: both are intentional[1] so add
comments to that effect.

[1] Based on comment from Lars Roff via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6844

------------------------------------------------------------------------
r41898 | gerald | 2012-04-02 11:48:56 -0700 (Mon, 02 Apr 2012) | 2 lines
Changed paths:
   A /trunk/test/captures/sample_control4_2012-03-24.pcap
   D /trunk/test/captures/wpa-Induction.pcap
   A /trunk/test/captures/wpa-Induction.pcap.gz
   M /trunk/test/suite-decryption.sh

Add a test for Zigbee. Compress the 802.11 capture. Fix an error message.

------------------------------------------------------------------------
r41897 | tuexen | 2012-04-02 10:15:58 -0700 (Mon, 02 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/main_welcome.c

From Irene Ruengeler: Fix a warning when capturing.

------------------------------------------------------------------------
r41896 | gerald | 2012-04-02 09:37:40 -0700 (Mon, 02 Apr 2012) | 2 lines
Changed paths:
   A /trunk/test/captures/snakeoil-dtls.pcap
   A /trunk/test/config/dtlsdecrypttablefile.tmpl
   A /trunk/test/keys/snakeoil-rsa.key
   M /trunk/test/suite-decryption.sh

Add a test for DTLS decryption.

------------------------------------------------------------------------
r41895 | etxrab | 2012-04-02 08:20:54 -0700 (Mon, 02 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/new_packet_list.c

If a comment is cleared, remove it from fdata->opt_comment.
------------------------------------------------------------------------
r41894 | etxrab | 2012-04-02 05:23:33 -0700 (Mon, 02 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/gui_utils.c

Fix a couple of typos and missing return for GTK 3.
------------------------------------------------------------------------
r41893 | etxrab | 2012-04-02 04:35:53 -0700 (Mon, 02 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/about_dlg.c
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/gui_utils.h

Introduce utility function to ease GTK3 depcrecated funktion removal.
------------------------------------------------------------------------
r41892 | etxrab | 2012-04-02 01:00:43 -0700 (Mon, 02 Apr 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Nick Lowe:
Negate version bits in flags for PEAP, TTLS, FAST.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7019
------------------------------------------------------------------------
r41891 | wmeier | 2012-04-01 16:06:21 -0700 (Sun, 01 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn3270.c

Use correct values for "alt screen size" for 327x-3 and 327x-4 terminals.
Slightly improve code which tries to keep track of "screen size".
Add a comment as to what is really required to properly keep track
 of the screen size "state".


------------------------------------------------------------------------
r41890 | wmeier | 2012-04-01 14:48:17 -0700 (Sun, 01 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn3270.c

Remove a bad (unterminated) comment; Fixes Buildbot compile error.

------------------------------------------------------------------------
r41889 | wmeier | 2012-04-01 14:31:51 -0700 (Sun, 01 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn3270.c

Fix some bugs related to the use of proto_tree_add_bits_item();
Improve details pane display of a few TN3270 fields.

------------------------------------------------------------------------
r41888 | tuexen | 2012-04-01 11:16:15 -0700 (Sun, 01 Apr 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/io_stat.c

More whitespace changes...

------------------------------------------------------------------------
r41887 | tuexen | 2012-04-01 10:27:26 -0700 (Sun, 01 Apr 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/io_stat.c

Remove waring.
While there: Some whitespace cleanups.

------------------------------------------------------------------------
r41886 | etxrab | 2012-04-01 09:12:56 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Nick Lowe: Show the reserved bits if set for EAP-TLS, unify/clean up the display output. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7017
------------------------------------------------------------------------
r41885 | wmeier | 2012-04-01 09:06:39 -0700 (Sun, 01 Apr 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn3270.c

Define numerous arrays as static rather than dynamic
 so they are initialized only once rather than each time a
 function using the array is executed.
Re-arrange the code slightly so much of the dissection can be
 put under 'if (tree)'.

------------------------------------------------------------------------
r41884 | etxrab | 2012-04-01 09:05:52 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/diameter/TGPPGmb.xml

From Liangfeng: SGmb diameter AVP 'MBMS-Data-Transfer-Start' type error. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7016
------------------------------------------------------------------------
r41883 | etxrab | 2012-04-01 09:01:12 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/io_stat.c

From Cal Turney: IO Graph LOAD inaccuracy, intervals not displayed, wrong frames displayed. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6994
------------------------------------------------------------------------
r41881 | martinm | 2012-04-01 07:55:40 -0700 (Sun, 01 Apr 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Set the extent of IR, IR-DYN and feedback packet types.
Make some fields display and HEX and DEC.

------------------------------------------------------------------------
r41880 | martinm | 2012-04-01 07:52:48 -0700 (Sun, 01 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Clear info column before calling ROHC dissector.

------------------------------------------------------------------------
r41878 | gerald | 2012-04-01 07:03:31 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-04-01]
------------------------------------------------------------------------
r41877 | darkjames | 2012-04-01 02:31:02 -0700 (Sun, 01 Apr 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netmon-802_11.c

Remove return statement (part of r41314), fix bug #7015

------------------------------------------------------------------------
r41876 | etxrab | 2012-04-01 02:20:35 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h263.c

At least 4 bytes is required to check PSC, fixes bug https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6996
------------------------------------------------------------------------
r41875 | etxrab | 2012-04-01 02:19:02 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rfc2190.c

Use proto_tree_add_item() in a couple of places, show bit fields
------------------------------------------------------------------------
r41874 | tuexen | 2012-03-31 15:01:36 -0700 (Sat, 31 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c

Add support for RFC 6525.

------------------------------------------------------------------------
r41873 | darkjames | 2012-03-31 13:57:15 -0700 (Sat, 31 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_sms.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-ms-mms.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-nflog.c
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-rdp.c
   M /trunk/epan/dissectors/packet-srvloc.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-tnef.c
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-xml.c

Fix off by one shift errors introduced in r39530 where it seemed proper[1]

[1] I'm unsure of packet-dtpt, so I haven't patch it.

------------------------------------------------------------------------
r41872 | darkjames | 2012-03-31 10:29:41 -0700 (Sat, 31 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-nflog.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/wtap.h

Add initial support for dissecting packets encapsulated in Netfilter LOG (DLT_NFLOG=239).

------------------------------------------------------------------------
r41871 | cmaynard | 2012-03-31 09:25:22 -0700 (Sat, 31 Mar 2012) | 2 lines
Changed paths:
   M /trunk/help/faq.py

Update the paragraph in 7.12 describing the name of the temp file to include the name used when capturing on multiple interfaces.

------------------------------------------------------------------------
r41870 | darkjames | 2012-03-31 05:35:07 -0700 (Sat, 31 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.c

These buffers in tvb_uncompress() can't ovelaps, so use optimized memcpy().

------------------------------------------------------------------------
r41869 | darkjames | 2012-03-31 05:33:10 -0700 (Sat, 31 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/tvbuff.c

Fix for bug #6480 (https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6480)

Yay, first commit since r37883 (almost 9months).

------------------------------------------------------------------------
r41868 | etxrab | 2012-03-31 02:22:07 -0700 (Sat, 31 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

From Martin Kaiser: Fix for main_menubar.c:3874: error: set_menu_visible defined but not used
------------------------------------------------------------------------
r41867 | sahlberg | 2012-03-30 21:45:33 -0700 (Fri, 30 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

SCSI SBC: Start decoding LogicalBlockProvisioning VPD page


------------------------------------------------------------------------
r41866 | gerald | 2012-03-30 16:52:55 -0700 (Fri, 30 Mar 2012) | 2 lines
Changed paths:
   A /trunk/test/config/80211_keys.tmpl

Add a missing file.

------------------------------------------------------------------------
r41865 | gerald | 2012-03-30 16:51:48 -0700 (Fri, 30 Mar 2012) | 2 lines
Changed paths:
   A /trunk/test/captures/wpa-Induction.pcap
   M /trunk/test/suite-decryption.sh

Add a WPA PSK decryption test.

------------------------------------------------------------------------
r41864 | sahlberg | 2012-03-30 16:48:23 -0700 (Fri, 30 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi-sbc.c

SCSI SBC: Add the new fields that have been added to READ_CAPACITY16


------------------------------------------------------------------------
r41863 | morriss | 2012-03-30 16:19:49 -0700 (Fri, 30 Mar 2012) | 11 lines
Changed paths:
   M /trunk/wiretap/mp2t.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6984 :

The attached patch extends the mpeg2 ts format detection to take into account
that trailing bytes might be added to each packet.

Once it finds no sync after 188 bytes, it checks an additional 40 bytes for the
next sync byte and adjusts the packet size accordingly.

Only the 188 bytes of the actual ts packet are passed on to wiretap, the
trailer is omitted.

------------------------------------------------------------------------
r41862 | morriss | 2012-03-30 15:36:02 -0700 (Fri, 30 Mar 2012) | 36 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pcep.c

From Svetoslav Duhovnikov via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6995 :

The following patch adds decoding capabilities for RFC 5886 for PCEP protocol:

9.1. New PCEP Message


   Each PCEP message has a message type value.

   Two new PCEP (specified in [RFC5440]) messages are defined in this
   document:

   Value  Description                                      Reference
     8    Path Computation Monitoring Request (PCMonReq)   This document
     9    Path Computation Monitoring Reply (PCMonRep)     This document

9.2. New PCEP Objects


   Each PCEP object has an Object-Class and an Object-Type.  The
   following new PCEP objects are defined in this document:

   Object-Class Value Name        Object-Type             Reference

          19          MONITORING  1                       This document

          20          PCC-REQ-ID  1: IPv4 addresses       This document
                                  2: IPv6 addresses

          25          PCE-ID      1: IPv4 addresses       This document
                                  2: IPv6 addresses       This document

          26          PROC-TIME   1                       This document

          27          OVERLOAD    1: overload             This document

------------------------------------------------------------------------
r41861 | etxrab | 2012-03-30 14:45:42 -0700 (Fri, 30 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

From Claude LeFrancois: Support  2 new GTP Information Elements. The Fully Qualified Domain Name (FQDN) GTP IE and the Evolved Allocation/Retention Priority II GTP IE.
------------------------------------------------------------------------
r41860 | gerald | 2012-03-30 14:04:09 -0700 (Fri, 30 Mar 2012) | 2 lines
Changed paths:
   M /trunk/test/config.sh
   M /trunk/test/suite-decryption.sh

Clobber our personal configuration directory on Windows.

------------------------------------------------------------------------
r41859 | gerald | 2012-03-30 13:58:44 -0700 (Fri, 30 Mar 2012) | 3 lines
Changed paths:
   M /trunk/test/suite-decryption.sh

More fixes for Windows. UATs need to be created in ../wireshark-gtk2
and backslashes need to be escaped.

------------------------------------------------------------------------
r41858 | morriss | 2012-03-30 12:57:48 -0700 (Fri, 30 Mar 2012) | 1 line
Changed paths:
   D /trunk/test/captures/rsasnakeoil2.cap
   A /trunk/test/captures/rsasnakeoil2.pcap (from /trunk/test/captures/rsasnakeoil2.cap:41854)
   M /trunk/test/suite-decryption.sh

rsasnakeoil2 is a PCAP file; name it .pcap for consistency.  Set SVN properties appropriately.
------------------------------------------------------------------------
r41857 | gerald | 2012-03-30 11:19:35 -0700 (Fri, 30 Mar 2012) | 2 lines
Changed paths:
   M /trunk/test/suite-capture.sh
   M /trunk/test/suite-clopts.sh
   M /trunk/test/suite-io.sh
   M /trunk/test/test.sh

Fix the location of dhcp.pcap.

------------------------------------------------------------------------
r41856 | gerald | 2012-03-30 11:13:41 -0700 (Fri, 30 Mar 2012) | 2 lines
Changed paths:
   M /trunk/test/config/ssl_keys.tmpl
   M /trunk/test/config.sh
   M /trunk/test/suite-decryption.sh

Fix decryption test on Windows.

------------------------------------------------------------------------
r41855 | gerald | 2012-03-30 10:59:27 -0700 (Fri, 30 Mar 2012) | 2 lines
Changed paths:
   A /trunk/test/config/ssl_keys.tmpl

Add a missing file.

------------------------------------------------------------------------
r41853 | gerald | 2012-03-30 10:53:23 -0700 (Fri, 30 Mar 2012) | 3 lines
Changed paths:
   M /trunk/Makefile.am

Remove the dependency on tools/make-services.pl for the services target.
This is likely the cause of unwanted "services" file build attempts.

------------------------------------------------------------------------
r41852 | gerald | 2012-03-30 10:51:54 -0700 (Fri, 30 Mar 2012) | 3 lines
Changed paths:
   A /trunk/test/captures
   A /trunk/test/captures/dhcp-nanosecond.pcap (from /trunk/test/dhcp-nanosecond.pcap:41833)
   A /trunk/test/captures/dhcp-nanosecond.pcapng (from /trunk/test/dhcp-nanosecond.pcapng:41833)
   A /trunk/test/captures/dhcp.pcap (from /trunk/test/dhcp.pcap:41833)
   A /trunk/test/captures/dhcp.pcapng (from /trunk/test/dhcp.pcapng:41833)
   A /trunk/test/captures/rsasnakeoil2.cap
   A /trunk/test/config
   M /trunk/test/config.sh
   D /trunk/test/dhcp-nanosecond.pcap
   D /trunk/test/dhcp-nanosecond.pcapng
   D /trunk/test/dhcp.pcap
   D /trunk/test/dhcp.pcapng
   A /trunk/test/keys
   A /trunk/test/keys/rsasnakeoil2.key
   A /trunk/test/suite-decryption.sh (from /trunk/test/suite-fileformats.sh:41772)
   M /trunk/test/suite-fileformats.sh
   M /trunk/test/test-backend.sh
   M /trunk/test/test.sh

Add a decryption test suite along with an SSL decryption test. Move our
growing collection of capture files to a subdirectory.

------------------------------------------------------------------------
r41851 | morriss | 2012-03-30 10:50:08 -0700 (Fri, 30 Mar 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

From Weston Andros Adamson via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7010 :

While developing SP4_MACH_CRED support for the linux nfs client, I noticed that
wireshark was displaying these bitmasks incorrectly (as fattrs instead of NFS
operations).

I also noticed that BACKCHANNEL_CTL (a required value in the mask for
SP4_MACH_CRED) wasn't in names_nfsv4_operation[], so I added it and verified
that we're not missing any other ops.

------------------------------------------------------------------------
r41850 | morriss | 2012-03-30 10:43:45 -0700 (Fri, 30 Mar 2012) | 5 lines
Changed paths:
   M /trunk/diameter/TGPPGmb.xml
   M /trunk/diameter/dictionary.xml

From Liangfeng via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7013 :

Add the application ID for 3GPP SGmb and 2 SGmb AVPs: MBMS-Data-Transfer-Start
and MBMS-Data-Transfer-Stop.

------------------------------------------------------------------------
r41849 | morriss | 2012-03-30 10:40:01 -0700 (Fri, 30 Mar 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

From Liangfeng via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7012 :

According to 3GPP R7//R8/R9/R10/R11, AVP 'MBMS-Session-Duration' has 3 octets.
First 17 bits indicate seconds, the rest of bits(7 bits) represents days. 

However, in the source file packet-gtp.c, it parse the AVP reversely -- taking
first 7 bits as days, the rest of 17 bits as seconds.  This patch fixes that.

------------------------------------------------------------------------
r41848 | cmaynard | 2012-03-30 10:38:10 -0700 (Fri, 30 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nhrp.c

Allow unknown extension values to be filterable.

------------------------------------------------------------------------
r41847 | jmayer | 2012-03-30 07:55:00 -0700 (Fri, 30 Mar 2012) | 6 lines
Changed paths:
   M /trunk/ui/qt/main.cpp

gcc 4.7 would complain that the getopt stuff was not declared.
Looks like getopt.h was silently included somewhere in gcc-4.6's
includes. Explicitely include <getopt.h>. No idea whether this
is the correct fix.
Whitespace change: indent includes, if they are inside a conditional.

------------------------------------------------------------------------
r41846 | jmayer | 2012-03-30 07:48:37 -0700 (Fri, 30 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp-midi.c

gcc.47 would complain that rsoffset might be used uninitialized
when passed by reference. Init to 0 to silence this warning.

Some whitespace fixes.

------------------------------------------------------------------------
r41845 | jmayer | 2012-03-30 06:18:13 -0700 (Fri, 30 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

Fix compiler warnings (set but not used).
Remove whitespace at end of line.

------------------------------------------------------------------------
r41844 | stig | 2012-03-30 05:45:43 -0700 (Fri, 30 Mar 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-ldap.c

Adjusted UAT name.

------------------------------------------------------------------------
r41843 | stig | 2012-03-30 04:50:53 -0700 (Fri, 30 Mar 2012) | 1 line
Changed paths:
   M /trunk/docbook/wsug_src/WSUG_chapter_customize.xml

Added more UAT's to the list of configuration profile files.
------------------------------------------------------------------------
r41842 | stig | 2012-03-30 04:12:03 -0700 (Fri, 30 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/uat_load.l

Call uat->post_update_cb also when not having the uat file.

This is because some uat's do cleanup in the init routine, which is needed
when changing profile.
------------------------------------------------------------------------
r41841 | stig | 2012-03-30 02:08:55 -0700 (Fri, 30 Mar 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ldap/ldap.cnf
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-ldap.c

Added support for configuring custom LDAP AttributeValue types.

------------------------------------------------------------------------
r41840 | stig | 2012-03-30 01:57:57 -0700 (Fri, 30 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-imf.c
   M /trunk/epan/uat.h
   M /trunk/ui/gtk/uat_gui.c

Recreate the packet list when changing UAT for header fields.

This fixes a crash when changing settings for fields used as a custom column.
------------------------------------------------------------------------
r41839 | morriss | 2012-03-29 18:46:42 -0700 (Thu, 29 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/airpcap_dlg.c

As pointed out by Alexis: remove a bunch of set-but-unused variables.
------------------------------------------------------------------------
r41838 | morriss | 2012-03-29 18:36:05 -0700 (Thu, 29 Mar 2012) | 1 line
Changed paths:
   M /trunk/airpcap.h

Get rid of C++/C99-style comments.
------------------------------------------------------------------------
r41837 | martinm | 2012-03-29 18:18:12 -0700 (Thu, 29 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

When a capture starts with a non-zero SN, don't report 0-(SN-1) as
missing.

------------------------------------------------------------------------
r41836 | morriss | 2012-03-29 18:17:46 -0700 (Thu, 29 Mar 2012) | 7 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dvb-bat.c
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

From Guy Martin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7007 :

This patch adds support for the DVB Bouquet Association Table (BAT) from ETSI
EN 300 468.

With this last patch, the support for the DVB SI table is quite complete.

------------------------------------------------------------------------
r41835 | martinm | 2012-03-29 17:49:09 -0700 (Thu, 29 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/mac_lte_stat_dlg.c

Fix the flag used in a test.

------------------------------------------------------------------------
r41834 | martinm | 2012-03-29 16:12:07 -0700 (Thu, 29 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c

Fix a test to avoid setting an invalid display filter.
Reorder some comments to make things a little clearer.

------------------------------------------------------------------------
r41833 | sahlberg | 2012-03-29 14:13:24 -0700 (Thu, 29 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

ONC-RPC: After we have dissected the decrypted PDU, update offset to reflect that we have eaten all these bytes or rpc will think there was un-dissected data remaining and will show it as an extra "data" field.


------------------------------------------------------------------------
r41832 | gerald | 2012-03-29 13:22:50 -0700 (Thu, 29 Mar 2012) | 2 lines
Changed paths:
   M /trunk/packaging/nsis/wireshark.nsi

Update a couple of keys.

------------------------------------------------------------------------
r41829 | gerald | 2012-03-29 13:18:10 -0700 (Thu, 29 Mar 2012) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/tools/win64-setup.sh

Use the GnuTLS 2.12.18-1.2-1 bundle.

------------------------------------------------------------------------
r41828 | alagoutte | 2012-03-29 11:08:16 -0700 (Thu, 29 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls.c

Remove unused hf variable

------------------------------------------------------------------------
r41827 | alagoutte | 2012-03-29 10:41:51 -0700 (Thu, 29 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pw-satop.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41826 | alagoutte | 2012-03-29 10:40:49 -0700 (Thu, 29 Mar 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-batadv.c

From Sven Eckelmann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7009
Add support for 4addr unicast packets 

Add support for 4addr unicast packets packets that will be supported in
linux 3.5.

------------------------------------------------------------------------
r41825 | alagoutte | 2012-03-29 10:34:21 -0700 (Thu, 29 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41824 | alagoutte | 2012-03-29 10:26:56 -0700 (Thu, 29 Mar 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7003
openSAFETY - Cleanup SSDO dissection, add additional information, remove logic bug

- rename isRequest to isResponse, which is the right name for it
- clean-up elseif to a better readable stand-alone if-clause
- add sender for response package without valid scm

------------------------------------------------------------------------
r41823 | stig | 2012-03-29 05:03:49 -0700 (Thu, 29 Mar 2012) | 3 lines
Changed paths:
   M /trunk/asn1/ldap/ldap.cnf
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-ldap.c

Don't try to convert AttributeValue to string if having a ldap_name dissector.
Prefix the converted printable string correctly with 'AttributeValue: '.

------------------------------------------------------------------------
r41822 | sahlberg | 2012-03-29 00:42:47 -0700 (Thu, 29 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

ONC-RPC: Add decryption of GSSAPI protected NFS and other ONC based protocols


------------------------------------------------------------------------
r41821 | martinm | 2012-03-28 18:24:49 -0700 (Wed, 28 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

Improve support for primitives that carry NAS-EPS.
Also parse beginning of "Monitor" lines.

------------------------------------------------------------------------
r41820 | sfisher | 2012-03-28 16:54:50 -0700 (Wed, 28 Mar 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c


Add newline at end of file to fix compilation error.


------------------------------------------------------------------------
r41819 | gerald | 2012-03-28 12:36:37 -0700 (Wed, 28 Mar 2012) | 2 lines
Changed paths:
   M /trunk/tools/build-qt-sdk.bat

Improve the 64-bit check.

------------------------------------------------------------------------
r41818 | tuexen | 2012-03-28 04:54:42 -0700 (Wed, 28 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/sctp_graph_dlg.c

From Irene Ruengeler: Fix a crash.

------------------------------------------------------------------------
r41817 | sahlberg | 2012-03-28 02:42:05 -0700 (Wed, 28 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

ONC-RPC: When a GSS context is destroyed, that NULL procedure call does not carry neither a verifier nor a payload.
Stop decoding the packed immediately after the credentials so that we dont incorrectly flag these packets as malformed.


------------------------------------------------------------------------
r41816 | tuexen | 2012-03-28 02:31:04 -0700 (Wed, 28 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

From Robin Seggelmann:
Support DTLS 1.2
Fix a bug in option handling.


------------------------------------------------------------------------
r41815 | tuexen | 2012-03-28 02:26:47 -0700 (Wed, 28 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/airpcap_dlg.c

Fix compilation.

------------------------------------------------------------------------
r41814 | sahlberg | 2012-03-28 02:16:09 -0700 (Wed, 28 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

remove a header include that was used when debugging and forgotten to be removed from previous commit


------------------------------------------------------------------------
r41813 | sahlberg | 2012-03-28 02:10:41 -0700 (Wed, 28 Mar 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

ONC-RPC: add tracking of GSSAPI authentication contexts

Add traking of when GSS authentication contexts are created and when they are destroyed
so that it is easy to "click on created in link" in a SecNFS packet to get to where the kerberos blob for authentication is


Add context created in/destroyed in to the decode so you can quickly jump to where the authantiation happened to check the decrypted krb5 credentials



------------------------------------------------------------------------
r41812 | alagoutte | 2012-03-28 01:48:46 -0700 (Wed, 28 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pcp.c

From Ryan Doyle via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6874

Attached is the patch to allow PM_TYPE_AGGREGATE to fall through to PM_TYPE_AGGREGATE_STATIC.

------------------------------------------------------------------------
r41811 | alagoutte | 2012-03-28 01:46:07 -0700 (Wed, 28 Mar 2012) | 6 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-maap.c

From Jason Damori via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7002
Add MAC Address Acquisition Protocol Dissector

Add the dissector for MAAP - the MAC address acquisition protocol for 802.3
Ethernet defined in IEEE1722.

------------------------------------------------------------------------
r41810 | gerald | 2012-03-27 16:00:25 -0700 (Tue, 27 Mar 2012) | 3 lines
Changed paths:
   A /trunk/tools/build-qt-sdk.bat

Add a script for building 32 and 64 bit Qt libraries for Visual C++
2008 and 2010 from source.

------------------------------------------------------------------------
r41809 | gerald | 2012-03-27 15:57:42 -0700 (Tue, 27 Mar 2012) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/tools/win32-setup.sh
   M /trunk/tools/win64-setup.sh

Use GnuTLS 2.12.18.

------------------------------------------------------------------------
r41801 | morriss | 2012-03-27 08:17:42 -0700 (Tue, 27 Mar 2012) | 1 line
Changed paths:
   M /trunk/airpcap_loader.c

Use AIRPCAP_ERRBUF_SIZE instead of PCAP_ERRBUF_SIZE in one spot.
------------------------------------------------------------------------
r41799 | morriss | 2012-03-27 08:15:52 -0700 (Tue, 27 Mar 2012) | 1 line
Changed paths:
   M /trunk/configure.in

Don't enable airpcap if we don't HAVE_LIBPCAP.
------------------------------------------------------------------------
r41798 | alagoutte | 2012-03-27 06:53:29 -0700 (Tue, 27 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls.c

Fix indent (use space) and add Modelines info.

------------------------------------------------------------------------
r41797 | alagoutte | 2012-03-27 06:50:50 -0700 (Tue, 27 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Add IPv6 Option : RPL Option RFC-ietf-6man-rpl-option-06

------------------------------------------------------------------------
r41796 | alagoutte | 2012-03-27 06:42:54 -0700 (Tue, 27 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Add IPv6 Option :
* Tunnel Encapsulation Limit (RFC 2473)
* CALIPSO (RFC 5570)
* Experimental Option (RFC 4727)

------------------------------------------------------------------------
r41795 | sahlberg | 2012-03-27 02:22:29 -0700 (Tue, 27 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi-sbc.c
   M /trunk/epan/dissectors/packet-scsi-sbc.h

SCSI SBC : Add decode for UNMAP command


------------------------------------------------------------------------
r41794 | stig | 2012-03-26 23:57:39 -0700 (Mon, 26 Mar 2012) | 1 line
Changed paths:
   M /trunk/plugins/m2m/packet-m2m.c

Removed unused pdu_length in pdu_burst_decoder to avoid a warning from clang.
------------------------------------------------------------------------
r41793 | stig | 2012-03-26 23:57:30 -0700 (Mon, 26 Mar 2012) | 1 line
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

Added a check for a valid pointer to avoid a warning from clang.
------------------------------------------------------------------------
r41792 | stig | 2012-03-26 23:57:21 -0700 (Mon, 26 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/capture_if_dlg.c

User data is not used in capture_prepare_cb and capture_do_cb.
------------------------------------------------------------------------
r41791 | stig | 2012-03-26 23:50:09 -0700 (Mon, 26 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Check the user-provided custom header string for invalid characters before
trying to register it in an hf; registering invalid characters in an hf will
lead to an assertion.

This was fixed for the http dissector in revision 41787.
------------------------------------------------------------------------
r41790 | morriss | 2012-03-26 19:37:42 -0700 (Mon, 26 Mar 2012) | 7 lines
Changed paths:
   M /trunk/configure.in

Revert r37423: the intent of r34356 was to enable Airpcap by default, it just
didn't work as intended.

Then make it so we build with Airpcap by default.

This should hopefully be the end of https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=4879

------------------------------------------------------------------------
r41789 | morriss | 2012-03-26 19:30:51 -0700 (Mon, 26 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/main_welcome.c

Get things compiling if we HAVE_AIRPCAP.
------------------------------------------------------------------------
r41788 | martinm | 2012-03-26 19:08:48 -0700 (Mon, 26 Mar 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tcp.h

When storing sequence analysis results, add (raw) sequence number and
ack number to the lookup key (which was previously just the frame number).

This helps with situations where multiple segments of the same TCP
conversation can be found in the same frame in a capture (e.g. with LTE
user-plane traffic carried in logged MAC or RLC frames).

------------------------------------------------------------------------
r41787 | morriss | 2012-03-26 18:43:20 -0700 (Mon, 26 Mar 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6982 :

Check the user-provided custom header string for invalid characters before
trying to register it in an hf; registering invalid characters in an hf will
lead to an assertion.

------------------------------------------------------------------------
r41786 | morriss | 2012-03-26 18:17:38 -0700 (Mon, 26 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eapol.c

From Nick Lowe via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7001 :

Show EAPOL versions textually.

------------------------------------------------------------------------
r41781 | guy | 2012-03-26 15:12:03 -0700 (Mon, 26 Mar 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radiotap.c

There is no "dBm transmit attenuation" field in radiotap; there is,
however, a dBm transmit *power* field.

Fix up the capitalization of "dB" and "dBm", and improve the blurb for
attenuation fields, while we're at it.

Should fix bug 7000:

	https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=7000

------------------------------------------------------------------------
r41780 | morriss | 2012-03-26 15:11:15 -0700 (Mon, 26 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isis-lsp.c

Fix CID 1336 (new with r40139): infinite loop if length is equal to 1.
------------------------------------------------------------------------
r41779 | morriss | 2012-03-26 14:57:57 -0700 (Mon, 26 Mar 2012) | 1 line
Changed paths:
   M /trunk/pcapio.c

Fix Coverty 1392 ('name' might be NULL): don't write out the interface name when we're trying to write out the interface description.
------------------------------------------------------------------------
r41778 | morriss | 2012-03-26 14:30:16 -0700 (Mon, 26 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isis-lsp.c

Fix CID 1458 (new with r41751): infinite loop if length is equal to 1.
------------------------------------------------------------------------
r41775 | cmaynard | 2012-03-26 12:41:23 -0700 (Mon, 26 Mar 2012) | 2 lines
Changed paths:
   M /trunk/asn1/camel/camel.cnf
   M /trunk/asn1/inap/inap.cnf
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-inap.c

In dissect_invokeData(), fixup the default case of the switch statement.  Fixes 2 instances of Coverity CID 813: UNREACHABLE.

------------------------------------------------------------------------
r41773 | gerald | 2012-03-26 12:29:33 -0700 (Mon, 26 Mar 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Print the correct block size in a debug message.

------------------------------------------------------------------------
r41771 | cmaynard | 2012-03-26 10:35:13 -0700 (Mon, 26 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-lsp.c

Fix Coverity CID 1456: UNUSED_VALUE.

------------------------------------------------------------------------
r41770 | cmaynard | 2012-03-26 10:33:09 -0700 (Mon, 26 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/tvbparse.c

Wrap a couple of very long lines.

------------------------------------------------------------------------
r41767 | morriss | 2012-03-26 07:16:58 -0700 (Mon, 26 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

Line wrap a few very long lines.
------------------------------------------------------------------------
r41766 | morriss | 2012-03-26 07:08:39 -0700 (Mon, 26 Mar 2012) | 6 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-dvb-tdt.c
   A /trunk/epan/dissectors/packet-dvb-tot.c
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

From Guy Martin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6999 :

This patch adds support for the DVB Time Offset Table and the related
descriptor.
It also contains the Stuffing Descriptor as an added bonus.

------------------------------------------------------------------------
r41765 | morriss | 2012-03-26 06:56:23 -0700 (Mon, 26 Mar 2012) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dvb-tdt.c

From Guy Martin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6998 :

This add support for the very simple DVB Time and Date Table (TDT) as
defined in ESTI EN 300 468.

------------------------------------------------------------------------
r41764 | martinm | 2012-03-25 16:46:01 -0700 (Sun, 25 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Add a field for the number of SRs indicated in one frame.

------------------------------------------------------------------------
r41763 | wmeier | 2012-03-25 16:14:23 -0700 (Sun, 25 Mar 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn3270.c

Extensive rework to clean up code and to fix a number of issues with tn3270 dissection;
Also: do reformatting and symbol renaming for readability.

See Bug #6854 for several examples typical of the issues fixed:
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6854

------------------------------------------------------------------------
r41762 | gerald | 2012-03-25 14:27:49 -0700 (Sun, 25 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/ui/qt/QtShark.pro

Give qmake a VERSION it will accept.

------------------------------------------------------------------------
r41761 | gerald | 2012-03-25 12:01:58 -0700 (Sun, 25 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/ui/qt/QtShark.pro

Fix the Qt build for Win64.

------------------------------------------------------------------------
r41758 | morriss | 2012-03-25 07:03:39 -0700 (Sun, 25 Mar 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

From Guy Martin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6992 :

Use a couple of hf_ entries that were supposed to be used (reported in
comment 3).

I've also fixed two other small bugs I've found :
 - Invalid checking of mpeg1_only_flag in the video stream descriptor
 - Avoid processing descriptor data if reported length is 0

------------------------------------------------------------------------
r41757 | gerald | 2012-03-25 07:03:31 -0700 (Sun, 25 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-03-25]
------------------------------------------------------------------------
r41756 | morriss | 2012-03-24 18:49:23 -0700 (Sat, 24 Mar 2012) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dvb-sdt.c

From Guy Martin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6993 :

This patch adds support for DVB Service Description Table as documented in
ETSI EN 300 468.

------------------------------------------------------------------------
r41755 | morriss | 2012-03-24 18:41:18 -0700 (Sat, 24 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

Fix some hf encodings (courtesy of fix-encoding-args.pl).
------------------------------------------------------------------------
r41754 | morriss | 2012-03-24 18:33:35 -0700 (Sat, 24 Mar 2012) | 8 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dvb-nit.c
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

From Guy Martin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6992 :

This patch adds support for DVB Network Information Table as documented in
ETSI EN 300 468.

The patch also contains additional mpeg descriptors usually found in NIT plus
a few minor bugfix for other descriptors.

------------------------------------------------------------------------
r41752 | morriss | 2012-03-23 18:21:43 -0700 (Fri, 23 Mar 2012) | 1 line
Changed paths:
   M /trunk/AUTHORS

Add Guy Martin
------------------------------------------------------------------------
r41751 | morriss | 2012-03-23 17:07:49 -0700 (Fri, 23 Mar 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-clv.h
   M /trunk/epan/dissectors/packet-isis-lsp.c

From Nikitha Malgi via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6958 :

The Group Address (GADDR) TLV, IS-IS TLV type 142, is carried only in an LSP
PDU and carries sub-TLVs that in turn advertise multicast group listeners.  It
also contains the Group MAC address Sub TLV. The Group MAC Address (GMAC-ADDR)
sub-TLV is sub-TLV type number 1 within the GADDR TLV.  In TRILL, it is used to
advertise multicast listeners.

Reference --- http://tools.ietf.org/html/rfc6326#section-2.1

------------------------------------------------------------------------
r41750 | morriss | 2012-03-23 16:49:14 -0700 (Fri, 23 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dvb-eit.c
   M /trunk/epan/dissectors/packet-mpeg-sect.c
   M /trunk/epan/dissectors/packet-mpeg-sect.h

From Guy Martin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6989 :

Add support for DVB EIT packets from ETSI EN 300 468.

------------------------------------------------------------------------
r41748 | morriss | 2012-03-22 20:14:53 -0700 (Thu, 22 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/manual_addr_resolv.c

Only enable the OK button if we have an address and a name and name resolution
is enabled.

------------------------------------------------------------------------
r41747 | morriss | 2012-03-22 19:37:25 -0700 (Thu, 22 Mar 2012) | 12 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/ui/main-menubar-ui.xml

As I think Guy said a while back (quoting some HIG): anything you can do in a
popup should also be available through a regular menu.  So, make the
"Manually resolve address" function availble in under View->Name Resolution .
(Yes, technically this is an "Edit"-like action, but it just fits so well
under Name Resolution.)

While there, move "Resolve Name" from main_menu_bar_toggle_action_entries[]
into main_menu_bar_entries[] so it doesn't get a (useless) toggle indicator.
(At least as I understand this function, it's supposed to allow you to tell
Wireshark to go off and try to resolve the names in the current frame;
unfortunately it doesn't seem to actually work.)

------------------------------------------------------------------------
r41746 | morriss | 2012-03-22 19:00:31 -0700 (Thu, 22 Mar 2012) | 1 line
Changed paths:
   M /trunk/configure.in

Bug 6448 says Python support doesn't work at all; downgrade its status in the configure help from EXPERIMENTAL to BROKEN/UNSTABLE.
------------------------------------------------------------------------
r41745 | morriss | 2012-03-22 18:58:46 -0700 (Thu, 22 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

Add a couple casts to fix the Windows builds.
------------------------------------------------------------------------
r41744 | morriss | 2012-03-22 18:41:59 -0700 (Thu, 22 Mar 2012) | 1 line
Changed paths:
   M /trunk/file.c
   M /trunk/ui/gtk/edit_packet_comment_dlg.c
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/wiretap/wtap.c

Don't mark the file as unsaved unless the capture or packet comments actually changed.
------------------------------------------------------------------------
r41743 | morriss | 2012-03-22 18:41:24 -0700 (Thu, 22 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c

Replace some duplicate blurbs with NULL.
------------------------------------------------------------------------
r41742 | morriss | 2012-03-22 18:18:06 -0700 (Thu, 22 Mar 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

From Tom Bottom via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6887 :

Address comments in the bug: fix up some hf issues and use
proto_item_set_len() when necessary.

Added status field dissection to AEM packets.

From me: hf_aem_frequency is an FT_FLOAT and appears to have a length of 4 so
use that length (instead of 5).

------------------------------------------------------------------------
r41741 | morriss | 2012-03-22 17:53:58 -0700 (Thu, 22 Mar 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-slowprotocols.c

From Elliot Parsons via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6983 :

In the packet-slowprotocols dissector, there is a bug in the event notification
dissector. The code uses the incorrect value to skip past the data of a vendor
specific notification.

The attached patch file sets the offset to increment by raw_octet, which
corrects the issue.

------------------------------------------------------------------------
r41740 | etxrab | 2012-03-22 08:36:37 -0700 (Thu, 22 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nstrace.c
   M /trunk/wiretap/netscaler.c
   M /trunk/wiretap/netscaler.h
   M /trunk/wiretap/wtap.h

From Krishna:
Enhancement to add more trace record fields in Citrix NetScaler capture file format.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?
------------------------------------------------------------------------
r41739 | etxrab | 2012-03-22 08:10:14 -0700 (Thu, 22 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h264.c

Unescape NAL units
Bug https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6975
------------------------------------------------------------------------
r41738 | stig | 2012-03-22 05:38:18 -0700 (Thu, 22 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dmp.c

Renamed dmp_class to sec_class, as this is a more correct variable name.

------------------------------------------------------------------------
r41737 | stig | 2012-03-22 05:37:03 -0700 (Thu, 22 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hartip.c

Removed unused 'msg_type_val' argument to some functions.

------------------------------------------------------------------------
r41736 | etxrab | 2012-03-22 01:58:19 -0700 (Thu, 22 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

From Yaniv Kaul:
Enhance the SSL dissector to dissect some Hello extensions.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6979
------------------------------------------------------------------------
r41735 | etxrab | 2012-03-22 01:49:00 -0700 (Thu, 22 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-etv.c
   A /trunk/epan/dissectors/packet-mpeg-dsmcc.c
   M /trunk/epan/dissectors/packet-mpeg-pmt.c
   M /trunk/epan/dissectors/packet-mpeg-sect.c

From Weston Schmidt:
Add support for ETV Data processing & simple MPEG DSM-CC handling.
Witha a change of the name of dissect() in packet-etv.c to dissect-etv_common().

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6978
------------------------------------------------------------------------
r41734 | cmaynard | 2012-03-21 20:41:58 -0700 (Wed, 21 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-udp.c

If the checksum is 0, then only report "no checksum" for UDP/IPv4.  This patch is from Jaap Keuter via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6232

------------------------------------------------------------------------
r41731 | gerald | 2012-03-21 16:15:30 -0700 (Wed, 21 Mar 2012) | 2 lines
Changed paths:
   M /trunk/debian/copyright

Add a missing "T".

------------------------------------------------------------------------
r41728 | gerald | 2012-03-21 15:52:03 -0700 (Wed, 21 Mar 2012) | 3 lines
Changed paths:
   M /trunk/configure.in

Don't use GNUTLS 3.0, at least until we determine the impact of their
license change.

------------------------------------------------------------------------
r41727 | morriss | 2012-03-21 15:18:15 -0700 (Wed, 21 Mar 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c
   M /trunk/epan/dissectors/packet-bthci_cmd.c
   M /trunk/epan/dissectors/packet-bthci_evt.c
   M /trunk/epan/dissectors/packet-gsm_sim.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6977 :

The attached (trivial) patch adds some missing breaks in switch-case blocks.

This fixes coverity defects #445, #446, #1316 and #1380.

------------------------------------------------------------------------
r41726 | morriss | 2012-03-21 14:21:58 -0700 (Wed, 21 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

Fix fuzz failure reported in 
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6976 :

Don't assume that all responses have conversations to find.

------------------------------------------------------------------------
r41725 | wmeier | 2012-03-21 11:27:10 -0700 (Wed, 21 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dccp.h
   M /trunk/epan/geoip_db.c

'tab-width/tabstop/tabSize' in editor modelines should really always be 8.

------------------------------------------------------------------------
r41724 | wmeier | 2012-03-21 11:20:44 -0700 (Wed, 21 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-2dparityfec.c
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-dccp.c
   M /trunk/epan/dissectors/packet-dvb-ipdc.c
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-kdsp.c
   M /trunk/epan/dissectors/packet-lisp-data.c
   M /trunk/epan/dissectors/packet-lisp.c
   M /trunk/epan/dissectors/packet-mpls-pm.c
   M /trunk/epan/dissectors/packet-mpls-psc.c
   M /trunk/epan/dissectors/packet-mpls-y1711.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-sflow.c
   M /trunk/epan/dissectors/packet-spice.c
   M /trunk/epan/dissectors/packet-wol.c

'tab-width/tabstop/tabSize' in editor modelines should really always be 8;
Also: In some cases do some whitespace cleanup and some minor reformatting.

------------------------------------------------------------------------
r41723 | martinm | 2012-03-21 06:53:18 -0700 (Wed, 21 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Trivial formatting: Show segment offsets/length closer to associated sequence number
in partial NACK.

------------------------------------------------------------------------
r41722 | etxrab | 2012-03-21 06:07:23 -0700 (Wed, 21 Mar 2012) | 22 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

From Guy Martin:
Fix
Coverity has 3 complaints about this dissector, reported in CID's 1450-1451
CONSTANT_EXPRESSION_RESULT:

Event result_independent_of_operands: (crid & 3) >> 2 is 0 regardless of the
values of its operands [non-specific operand of assignment].
1385             crid_type = (crid &
MPEG_DESCR_CONTENT_IDENTIFIER_CRID_LOCATION_MASK) >> 2;


Event result_independent_of_operands: flags & 0x1000 is always 0 regardless of
the values of its operands (logical operand of if).
1512             if (flags & MPEG_DESCR_LOGON_INITIALIZE_CONNECTIVITY_MASK) {


Event result_independent_of_operands: flags & 0x1000 is always 0 regardless of
the values of its operands (logical second operand of '&&').
1544         if (offset < end && (flags &
MPEG_DESCR_LOGON_INITIALIZE_CONNECTIVITY_MASK)) {

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6960
------------------------------------------------------------------------
r41721 | martinm | 2012-03-21 05:58:50 -0700 (Wed, 21 Mar 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.h
   M /trunk/ui/gtk/tcp_graph.c

When a TCP graph is summoned, work out how many unique TCP conversations
are present. However, still only create the graph for the first/only
one.

LTE MAC or RLC frames often contain multiple SDUs that are segments of
the same TCP conversation - this avoids the need to find a frame with
only one SDU.

------------------------------------------------------------------------
r41720 | alagoutte | 2012-03-21 04:27:10 -0700 (Wed, 21 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41719 | tuexen | 2012-03-21 02:54:05 -0700 (Wed, 21 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/main_welcome.c

From Irene Ruengeler: Restore functinality of last patch.

------------------------------------------------------------------------
r41718 | alagoutte | 2012-03-21 02:49:35 -0700 (Wed, 21 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

From me via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6972
ISAKMP : VendorID CheckPoint : Malformed Packet

Wrong minimum length when there is not CheckPoint "Data" after VendorID

------------------------------------------------------------------------
r41717 | alagoutte | 2012-03-21 02:28:31 -0700 (Wed, 21 Mar 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

From me via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6206
IKE: Life-Duration wrong displayed in LTV format

The Fix commit in Revision 38387 is wrong 
Get the following error message : ISAKMP dissector bug: failed assertion proto.c:2957

use a HF by type (uint32, uint64, bytes...) for life duration

------------------------------------------------------------------------
r41716 | etxrab | 2012-03-21 01:58:27 -0700 (Wed, 21 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Disable debug.
------------------------------------------------------------------------
r41715 | etxrab | 2012-03-21 01:40:19 -0700 (Wed, 21 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb-hid.c
   M /trunk/epan/dissectors/packet-usb-hub.c
   M /trunk/epan/dissectors/packet-usb-masstorage.c
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-usb.h

From Steve Magnani:
USB: incorrect generated bInterfaceClass for composite device CONTROL transactions.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6964
------------------------------------------------------------------------
r41714 | etxrab | 2012-03-20 23:55:58 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ieee1722.c

packet-ieee1722.c:127: warning: 'ieee1722_tree' may be used uninitialized in this function
------------------------------------------------------------------------
r41713 | guy | 2012-03-20 23:37:34 -0700 (Tue, 20 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h

Make the comment I added, saying what scan_local_interfaces() does, more
accurate.

------------------------------------------------------------------------
r41712 | guy | 2012-03-20 23:31:39 -0700 (Tue, 20 Mar 2012) | 4 lines
Changed paths:
   M /trunk/capture_opts.h
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h

scan_local_interfaces() isn't in capture_opts.c; don't declare it in
capture_opts.h.  (It arguably belongs somewhere other than in a file in
ui/gtk, but, if so, move it there, e.g. to something in ui.)

------------------------------------------------------------------------
r41711 | etxrab | 2012-03-20 23:23:33 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ieee1722.c

From Jason Damori: packet-ieee1722.c calls subdissectors too late in dissection https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6974
------------------------------------------------------------------------
r41710 | guy | 2012-03-20 23:20:01 -0700 (Tue, 20 Mar 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

Handle bogus values of the error that *should* be coming from
scan_local_interfaces() (but, currently, isn't, as the code wasn't
correctly restructured).

------------------------------------------------------------------------
r41709 | guy | 2012-03-20 23:13:53 -0700 (Tue, 20 Mar 2012) | 5 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/configure.in

Automake can, at times, be a delicate fragile flower.  Apparently,
having something in wireshark_LDADD that's filled in by the configure
script means that the items referred to by that string aren't treated as
dependencies.

------------------------------------------------------------------------
r41708 | guy | 2012-03-20 23:10:17 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main.c

Fix 4-space tabs.

------------------------------------------------------------------------
r41707 | guy | 2012-03-20 22:40:22 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-lsp.c

If you're not going to use a subtree, don't create it.

------------------------------------------------------------------------
r41706 | cmaynard | 2012-03-20 20:47:48 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-lsp.c

Fix Coverity CID 1337: UNUSED_VALUE.

------------------------------------------------------------------------
r41705 | cmaynard | 2012-03-20 20:22:24 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls-y1711.c

Fix Coverity CID 1449: DEADCODE.

------------------------------------------------------------------------
r41704 | cmaynard | 2012-03-20 20:19:31 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hartip.c

Fix Coverity CID's 1452-1453: UNUSED_VALUE.

------------------------------------------------------------------------
r41703 | cmaynard | 2012-03-20 20:14:26 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-osi-options.c

Fix Coverity CID 1379: UNUSED_VALUE.

------------------------------------------------------------------------
r41702 | cmaynard | 2012-03-20 20:04:15 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Fix Coverity CID's 1439-1448 OVERRUN_STATIC introduced with r41468.  Also fix one additional dead store.

------------------------------------------------------------------------
r41701 | morriss | 2012-03-20 19:42:11 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

activate_link_cb() is only defined and used if we have GTK 2.18 or higher; only prototype it when we have GTK 2.18 or higher.
------------------------------------------------------------------------
r41700 | cmaynard | 2012-03-20 19:39:39 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/summary.c

Delete a duplicate line of code.  Fixes Coverity CID 1393: UNUSED VALUE.

------------------------------------------------------------------------
r41699 | cmaynard | 2012-03-20 18:27:22 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

Add missing break between AECP_COMMAND_SET_NAME and AECP_COMMAND_GET_NAME cases.  Fixes Coverity CID 1430: MISSING BREAK.

------------------------------------------------------------------------
r41698 | morriss | 2012-03-20 18:22:40 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

welcome_if_tree_load() is static and only called (and prototyped) if we HAVE_LIBPCAP, so don't define the function unless we HAVE_LIBPCAP.
------------------------------------------------------------------------
r41697 | cmaynard | 2012-03-20 17:47:32 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Fix a typo.

------------------------------------------------------------------------
r41696 | guy | 2012-03-20 17:44:41 -0700 (Tue, 20 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

Well, it doesn't recurse with that code there, but it doesn't fill in
the interface list box, either.  Remove the #if 0 for now.

------------------------------------------------------------------------
r41695 | guy | 2012-03-20 17:36:44 -0700 (Tue, 20 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

The chimney stuff is Windows-only (not that we shouldn't offer the
ability to turn offloading off on UN*Xes as well...).

------------------------------------------------------------------------
r41694 | guy | 2012-03-20 17:16:13 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

Recursion, n.  See "recursion".

------------------------------------------------------------------------
r41693 | guy | 2012-03-20 17:09:45 -0700 (Tue, 20 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/main_welcome.h

welcome_if_tree_load() is not used outside ui/gtk/main_welcome.c; make
it static.

------------------------------------------------------------------------
r41692 | guy | 2012-03-20 17:01:42 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

#ifdef out some variables used only if we have libpcap.

------------------------------------------------------------------------
r41691 | guy | 2012-03-20 16:37:23 -0700 (Tue, 20 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

Just put both clear_capture_box() and fill_capture_box() under one
#ifdef HAVE_LIBPCAP/#endif.

------------------------------------------------------------------------
r41690 | etxrab | 2012-03-20 16:03:48 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

See if this fixes the OSX build
------------------------------------------------------------------------
r41689 | etxrab | 2012-03-20 15:43:44 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

See if this fixes the OSX build
------------------------------------------------------------------------
r41688 | etxrab | 2012-03-20 15:40:10 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

make it compile on Windows, \main_welcome.c(1024) : warning C4700: uninitialized local variable 'error' used seems like a logical error, hidden by init to zero. Need proper fix
------------------------------------------------------------------------
r41687 | tuexen | 2012-03-20 14:13:28 -0700 (Tue, 20 Mar 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/main_welcome.c

From Irene Ruengeler: Make sure we can remove all interfaces and can
                      add local interfaces when there are none.
From me: Some whitespace cleanups.

------------------------------------------------------------------------
r41686 | etxrab | 2012-03-20 09:03:30 -0700 (Tue, 20 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

From Yaniv Kaul:
 Enhance the Spice dissector to deal with VM name and UUID messages.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6971
------------------------------------------------------------------------
r41685 | etxrab | 2012-03-20 05:32:20 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ppcap.c

On behalf of Ericsson a dissector for output from a log tool.
------------------------------------------------------------------------
r41684 | etxrab | 2012-03-20 04:58:29 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Try to make the buildbot happy.
------------------------------------------------------------------------
r41683 | etxrab | 2012-03-20 04:42:55 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Write ISB:s if we have them.
------------------------------------------------------------------------
r41682 | etxrab | 2012-03-20 04:41:58 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/pcapio.c

To be consistent with the wiretap API don't null terminate the counted strings.
------------------------------------------------------------------------
r41681 | alagoutte | 2012-03-20 01:51:05 -0700 (Tue, 20 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/ip_opts.h

Add Quick Start IPv6 Option ( And shared Quick Start option between IPv4/IPv6/TCP )

------------------------------------------------------------------------
r41680 | guy | 2012-03-19 21:06:36 -0700 (Mon, 19 Mar 2012) | 10 lines
Changed paths:
   M /trunk/packaging/macosx/Scripts/chmodbpf-postinstall.sh

Now, isn't that swell!  Leopard's dseditgroup doesn't return a failure
exit status if the group in question doesn't exist, so we can't use
dseditgroup on Leopard to check whether the access_bpf group exists.

Instead, as per Martin Williams' suggestion in bug 6526, use "dscl .
-read /groups/{group}" instead; the suggestion came from the addgroup.sh
script in

	https://developer.apple.com/library/mac/documentation/OpenSource/Conceptual/ShellScripting/ShellScripting.pdf

------------------------------------------------------------------------
r41679 | wmeier | 2012-03-19 14:12:45 -0700 (Mon, 19 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-telnet.c

Use consistent indentation & whitespace;
Reformat some lines.

------------------------------------------------------------------------
r41678 | jmayer | 2012-03-19 13:49:54 -0700 (Mon, 19 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.qt

Small update reagarding debian builds

------------------------------------------------------------------------
r41676 | gerald | 2012-03-19 10:55:22 -0700 (Mon, 19 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.qt

Add more SDK download URLs.

------------------------------------------------------------------------
r41675 | morriss | 2012-03-19 10:12:04 -0700 (Mon, 19 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Fix crash (caused by a corrupted Diameter dictionary) reported in
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6664 :

Add some sanity checks before adding types, vendors, commands, and AVPs.

------------------------------------------------------------------------
r41674 | etxrab | 2012-03-19 07:33:37 -0700 (Mon, 19 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
Guards the calledOnce boolean, against malformed traps, using register_frame_end_routine.
Fixes openSAFETY - Malformed packets disable the dissector for the WS session

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6950
------------------------------------------------------------------------
r41673 | etxrab | 2012-03-19 07:12:07 -0700 (Mon, 19 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
dvb-ci dissector: dissect descriptor loops by using mpeg-descriptor.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6965
------------------------------------------------------------------------
r41672 | etxrab | 2012-03-19 05:57:21 -0700 (Mon, 19 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-gtp.h

Update cause values and export the extended value string.
------------------------------------------------------------------------
r41671 | etxrab | 2012-03-19 04:33:05 -0700 (Mon, 19 Mar 2012) | 2 lines
Changed paths:
   M /trunk/diameter/dictionary.xml

From David wei:
Update dictionary.xml
------------------------------------------------------------------------
r41670 | alagoutte | 2012-03-19 02:53:20 -0700 (Mon, 19 Mar 2012) | 7 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-kdsp.c

From Smyle6 via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6953
Dissector for Kismet drone/server protocol

From me :
* Fix Clang Warning
* Remove if(tree)

------------------------------------------------------------------------
r41669 | guy | 2012-03-19 02:31:22 -0700 (Mon, 19 Mar 2012) | 5 lines
Changed paths:
   M /trunk/ui/qt/Makefile.am
   M /trunk/ui/qt/Makefile.common

We don't use a GENERATED_H_FILES macro anywhere else, we use
GENERATED_HEADER_FILES; get rid of GENERATED_H_FILES in favor of
GENERATED_HEADER_FILES, and make other changes to make the Makefile.am
and Makefile.common in ui/qt more like those in ui/gtk.

------------------------------------------------------------------------
r41668 | guy | 2012-03-19 02:12:17 -0700 (Mon, 19 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/qt/Makefile.am

Remove the generated-but-not-distributed source files on "make
distclean", as, after all, they're not part of the distribution.

------------------------------------------------------------------------
r41667 | guy | 2012-03-19 00:32:45 -0700 (Mon, 19 Mar 2012) | 7 lines
Changed paths:
   M /trunk/ui/qt/Makefile.am

Add main.cpp as an EXTRA_DIST file; for now, we don't build it as part
of the library, because, in order to do the top-level link of Wireshark
with a C++ compiler rather than a C compiler, at least one C++ source
file must be an input file - for now, we don't do that, as adding it as
a top-level source file for Wireshark causes other problems, but this at
least lets somebody do so as a temporary hack to build with auto*.

------------------------------------------------------------------------
r41666 | guy | 2012-03-19 00:30:38 -0700 (Mon, 19 Mar 2012) | 9 lines
Changed paths:
   M /trunk/ui/qt/Makefile.am
   M /trunk/ui/qt/Makefile.common

Don't distribute the output of various Qt preprocessing tools.  We don't
want to require the machines used to build the distribution tarballs to
have those tools installed or to require the build process to run them,
and I think if you have enough stuff installed to build Qt applications
at all you'll have those tools installed (the reason why the result of
{F}lex and YACC/BYACC/Bison are distributed with tarballs is to let
somebody who wants to or needs to build from unmodified source do so
with as few tools required as possible).

------------------------------------------------------------------------
r41665 | guy | 2012-03-19 00:24:14 -0700 (Mon, 19 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Said hack didn't work.

------------------------------------------------------------------------
r41662 | guy | 2012-03-19 00:08:15 -0700 (Mon, 19 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/Makefile.common

Another generated file.

------------------------------------------------------------------------
r41661 | guy | 2012-03-18 23:53:45 -0700 (Sun, 18 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt

Add doxygen.cfg to the list of files to ignore.

------------------------------------------------------------------------
r41660 | guy | 2012-03-18 23:31:37 -0700 (Sun, 18 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/Makefile.am

Get rid of blank line at the end.

------------------------------------------------------------------------
r41659 | guy | 2012-03-18 23:31:13 -0700 (Sun, 18 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.am

Sort the EXTRA_DIST list.

------------------------------------------------------------------------
r41658 | guy | 2012-03-18 23:29:41 -0700 (Sun, 18 Mar 2012) | 7 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/ui/qt/Makefile.am
   M /trunk/ui/qt/Makefile.common

Call the UI library in the Qt directory libqtui, not libui, to match the
UI library in the GTK+ directory.

List the moc-generated and rcc-generated files as generated files.

Add main_window.ui as an EXTRA_DIST file.  Sort the EXTRA_DIST list.

------------------------------------------------------------------------
r41657 | morriss | 2012-03-18 19:04:47 -0700 (Sun, 18 Mar 2012) | 1 line
Changed paths:
   M /trunk/doc/rawshark.pod
   M /trunk/doc/tshark.pod
   M /trunk/doc/wireshark.pod.template

Fix a typo or two
------------------------------------------------------------------------
r41656 | morriss | 2012-03-18 19:00:42 -0700 (Sun, 18 Mar 2012) | 8 lines
Changed paths:
   M /trunk/doc/rawshark.pod
   M /trunk/doc/tshark.pod
   M /trunk/doc/wireshark.pod.template
   M /trunk/epan/emem.c
   M /trunk/tools/test-fuzzed-cap.sh

Add a new environment variable (WIRESHARK_ABORT_ON_OUT_OF_MEMORY) that
prevents OutOfMemory exceptions from being thrown.  This makes it easier
to debug such conditions.

Set this variable in test-fuzzed-cap.sh but not in fuzz-test.sh; it's nice
to see the friendly out-of-memory error message in the bug reports the
latter script generates.

------------------------------------------------------------------------
r41655 | morriss | 2012-03-18 18:47:53 -0700 (Sun, 18 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/qt/Makefile.am

Until someone creates a .vcproj file for QT, don't try to distribute it.
------------------------------------------------------------------------
r41654 | morriss | 2012-03-18 18:46:24 -0700 (Sun, 18 Mar 2012) | 1 line
Changed paths:
   M /trunk/all.vcproj
   M /trunk/doc/doc.vcproj
   M /trunk/docbook/docbook.vcproj
   M /trunk/dumpcap.vcproj
   M /trunk/epan/dissectors/dissectors.vcproj
   M /trunk/epan/libwireshark.vcproj
   M /trunk/packaging.vcproj
   M /trunk/plugins/plugins.vcproj
   M /trunk/tshark.vcproj
   M /trunk/ui/gtk/libgtkui.vcproj
   M /trunk/wireshark.vcproj
   M /trunk/wiretap/libwiretap.vcproj

Set eol-style to native (just to make these files readable on *NIX).
------------------------------------------------------------------------
r41653 | morriss | 2012-03-18 18:15:26 -0700 (Sun, 18 Mar 2012) | 1 line
Changed paths:
   M /trunk/configure.in
   A /trunk/ui/qt/doxygen.cfg.in

Add ui/qt/doxygen.cfg.in (copied from ui/gtk, replacing gtk strings with qt).  The doxygen stuff doesn't work, but at least we'll be able to build the source tarball.
------------------------------------------------------------------------
r41652 | morriss | 2012-03-18 18:10:19 -0700 (Sun, 18 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/doxygen.cfg.in

Fix path to doxygen_global.cfg
------------------------------------------------------------------------
r41651 | wmeier | 2012-03-18 16:57:20 -0700 (Sun, 18 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-etsi_card_app_toolkit.c
   M /trunk/epan/dissectors/packet-gsm_sim.c

From Harald Welte: patch adding the missing hf[] entries ...

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6355#c11

------------------------------------------------------------------------
r41650 | guy | 2012-03-18 16:52:04 -0700 (Sun, 18 Mar 2012) | 3 lines
Changed paths:
   M /trunk/Makefile.common

Remove ui/qt/main.cpp from the list of source files for Wireshark, for
now.

------------------------------------------------------------------------
r41649 | guy | 2012-03-18 16:49:44 -0700 (Sun, 18 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Take the source files out of uiqt_DATA.

------------------------------------------------------------------------
r41648 | guy | 2012-03-18 16:39:23 -0700 (Sun, 18 Mar 2012) | 2 lines
Changed paths:
   A /trunk/ui/qt/Makefile_custom.common

Add in the Makefile_custom.common file.

------------------------------------------------------------------------
r41647 | guy | 2012-03-18 16:35:53 -0700 (Sun, 18 Mar 2012) | 3 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.common
   M /trunk/configure.in
   M /trunk/ui/qt
   A /trunk/ui/qt/Makefile.am
   A /trunk/ui/qt/Makefile.common

Add automake support for Qt - use --with-qt as a configure script
argument.

------------------------------------------------------------------------
r41646 | wmeier | 2012-03-18 15:52:28 -0700 (Sun, 18 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Fix a checkAPIs error: Blurb matches field name.

------------------------------------------------------------------------
r41645 | wmeier | 2012-03-18 15:24:24 -0700 (Sun, 18 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btl2cap.c
   M /trunk/epan/dissectors/packet-cigi.c
   M /trunk/epan/dissectors/packet-cipmotion.c
   M /trunk/epan/dissectors/packet-dlm3.c
   M /trunk/epan/dissectors/packet-dvbci.c
   M /trunk/epan/dissectors/packet-epl.c
   M /trunk/epan/dissectors/packet-etsi_card_app_toolkit.c
   M /trunk/epan/dissectors/packet-gsm_abis_om2000.c
   M /trunk/epan/dissectors/packet-gsm_abis_oml.c
   M /trunk/epan/dissectors/packet-gsm_cbch.c
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-homeplug-av.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-mp2t.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-noe.c
   M /trunk/epan/dissectors/packet-omron-fins.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-ppi-antenna.c
   M /trunk/epan/dissectors/packet-rsip.c
   M /trunk/epan/dissectors/packet-rtnet.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smpp.c
   M /trunk/epan/dissectors/packet-tipc.c
   M /trunk/epan/dissectors/packet-ua3g.c
   M /trunk/epan/dissectors/packet-v5ua.c
   M /trunk/epan/dissectors/packet-xtp.c
   M /trunk/plugins/asn1/packet-asn1.c
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c
   M /trunk/plugins/profinet/packet-pn-mrp.c
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/megaco_stat.c

From Reinhard Speyerer: Fix several misspellings/typos in Wireshark

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6967

------------------------------------------------------------------------
r41644 | wmeier | 2012-03-18 12:51:39 -0700 (Sun, 18 Mar 2012) | 19 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-hartip.c
   M /trunk/ui/gtk/main_menubar.c

From Bill Schiller: New dissector for the HART/IP protocol

I'm contributing a new dissector for the HART/IP protocol.  This
protocol is specified by the HART Conformance Foundation (HCF).  It is
a standard protocol used in the process control industry.  It
essential wraps the multip-drop serial HART packets in TCP or UDP
packets.  The standard has been approved by the HCF and has been
assigned UDP/TCP port 5094 by IANA.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6961
--This line, and those below,
will be ignored--

M    AUTHORS
M    epan/CMakeLists.txt
M    epan/dissectors/Makefile.common
AM   epan/dissectors/packet-hartip.c
M    ui/gtk/main_menubar.c

------------------------------------------------------------------------
r41641 | gerald | 2012-03-18 12:10:29 -0700 (Sun, 18 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-03-18]
------------------------------------------------------------------------
r41640 | wmeier | 2012-03-18 07:58:38 -0700 (Sun, 18 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ftp.c

Use a value_string_ext to reference a value_string array;
Use consistent indentation;
Reformat some lines.

------------------------------------------------------------------------
r41639 | morriss | 2012-03-18 07:05:45 -0700 (Sun, 18 Mar 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua3g.c

Fix the infinite-loop fuzz failure reported in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6962 :

Repeat r41359 in another location:

Don't try to display tone entries if there are none (but there is length for
them).  Could/should be an expert_info.

Also fix a typo: Nomber->Number.

------------------------------------------------------------------------
r41638 | morriss | 2012-03-18 07:00:02 -0700 (Sun, 18 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua3g.c

Fix one of the dissector assertions in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6962 :

Don't use a proto_item as the tree in proto_tree_add_text().  (There's code
here to hang a subtree off the item but it's commented out.)

------------------------------------------------------------------------
r41637 | morriss | 2012-03-18 06:57:30 -0700 (Sun, 18 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eigrp.c

Fix one of the dissector assertions in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6962 :

tidlist is registered as a FT_UINT16 so don't add an array of 16-bit entities
(tids) using it.  Instead add each TID individually.

------------------------------------------------------------------------
r41636 | alagoutte | 2012-03-18 04:54:23 -0700 (Sun, 18 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Fix typo (wrong proto_item is used... when there is PAD1 Option)

------------------------------------------------------------------------
r41635 | alagoutte | 2012-03-18 04:41:18 -0700 (Sun, 18 Mar 2012) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-mpls-psc.c
   M /trunk/epan/dissectors/packet-mpls.c

From Francesco Fondelli via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6966
MPLS-TP Protection State Coordination (PSC) Protocol, RFC 6378

------------------------------------------------------------------------
r41634 | morriss | 2012-03-17 16:46:39 -0700 (Sat, 17 Mar 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-usb.h

From Steve Magnani via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6963 :

Conversation address generation during processing of endpoint descriptors
is not being done in a manner consistent with that of general USB
packet dissection. I am not aware of any observable manifestation of this
bug.

------------------------------------------------------------------------
r41633 | guy | 2012-03-17 14:46:43 -0700 (Sat, 17 Mar 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radiotap.c

Mark the computed-from-the-MCS-field data rate as generated, and make it
cover the entire MCS field, in the hopes of avoiding the need to ask
questions such as

	http://ask.wireshark.org/questions/9461

------------------------------------------------------------------------
r41627 | guy | 2012-03-17 01:46:20 -0700 (Sat, 17 Mar 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/cosine.c

Fix indentation.

------------------------------------------------------------------------
r41626 | morriss | 2012-03-16 20:47:16 -0700 (Fri, 16 Mar 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua3g.c

Clean up from what appears to have been 4-space tabs.

Clean up indentation.

Leave only one statement on each line.

------------------------------------------------------------------------
r41625 | morriss | 2012-03-16 19:41:02 -0700 (Fri, 16 Mar 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua3g.c

Fix the infinite-loop fuzz failure reported in
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6949 :

Don't use a guint8 for() loop index when the end of the loop value is stored
in a guint: the loop index may never reach the end-of-loop value.

Also remove a shadow'd variable.

------------------------------------------------------------------------
r41624 | alagoutte | 2012-03-16 14:01:32 -0700 (Fri, 16 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/ip_opts.h

Remove dissect_ipv6_options function (unused from Revision 16302...)

------------------------------------------------------------------------
r41623 | alagoutte | 2012-03-16 11:54:01 -0700 (Fri, 16 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/display_filter_edit.cpp
   M /trunk/ui/qt/main_status_bar.cpp
   M /trunk/ui/qt/main_window.cpp
   M /trunk/ui/qt/qtshark_fr.qm
   M /trunk/ui/qt/qtshark_fr.ts

Fix some Gui Text not translate and update french translation

------------------------------------------------------------------------
r41622 | alagoutte | 2012-03-16 11:51:46 -0700 (Fri, 16 Mar 2012) | 2 lines
Changed paths:
   M /trunk/.gitignore

Add *Tilde file to .gitignore

------------------------------------------------------------------------
r41621 | gerald | 2012-03-16 10:36:40 -0700 (Fri, 16 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi
   M /trunk/packaging/u3/win32/Makefile.nmake

Capitalize "Wireshark" in various package names.

------------------------------------------------------------------------
r41618 | alagoutte | 2012-03-16 09:36:23 -0700 (Fri, 16 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-sect.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41617 | alagoutte | 2012-03-16 09:35:55 -0700 (Fri, 16 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eiss.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41616 | morriss | 2012-03-16 08:57:08 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan

Ignore *.exe; don't ignore x11 headers as they're not stored here any more
------------------------------------------------------------------------
r41615 | wmeier | 2012-03-16 08:43:56 -0700 (Fri, 16 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.h

Update comments about tvbuff.

------------------------------------------------------------------------
r41614 | wmeier | 2012-03-16 08:33:12 -0700 (Fri, 16 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_cbch.c

Use NULL instead of essentially duplicate text for one hf[] blurb;
Do some reformatting and do indentation & whitespace cleanup.

------------------------------------------------------------------------
r41613 | tuexen | 2012-03-16 08:09:54 -0700 (Fri, 16 Mar 2012) | 4 lines
Changed paths:
   M /trunk/recent.c

From Irene Ruengeler: Add check for reading strings from the
preferences to make sure it is printable. This avoids a crash
when reading a corrupted preferences file.

------------------------------------------------------------------------
r41612 | wmeier | 2012-03-16 07:16:20 -0700 (Fri, 16 Mar 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_abis_om2000.c

Fix some of the incorrect hf[] FT_BOOLEAN 'display' and 'bitmask' fields;
(Additional instances requiring feedback from the dissector author have
 been marked with XXX).
For 'hf_om2k_aop' use a bitmask in the hf[] entry rather than shifting & etc
 in the proto_tree_add_uint() call.
See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6792  Comment #8.

------------------------------------------------------------------------
r41611 | morriss | 2012-03-16 07:12:01 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/tools/valgrind-wireshark.sh

Make it possible to run capinfos and editcap from this script.
------------------------------------------------------------------------
r41610 | morriss | 2012-03-16 07:07:22 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/wtap.c

When we're in a for(i=0,[...]) loop, don't reuse (and thus reset) 'i' in another for(i=0,[...]) loop.  This fixes the capinfos double-free crashes that the fuzz bot has been experiencing.
------------------------------------------------------------------------
r41609 | etxrab | 2012-03-16 07:03:47 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rmt-fec.c

Show instance_id.
------------------------------------------------------------------------
r41608 | morriss | 2012-03-16 06:33:09 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

From Martin Kaiser: remove a set-but-unused variable
------------------------------------------------------------------------
r41607 | morriss | 2012-03-16 06:31:36 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-eiss.c

Make a function static
------------------------------------------------------------------------
r41606 | morriss | 2012-03-16 06:30:12 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-ca.c
   M /trunk/epan/dissectors/packet-mpeg-pat.c
   M /trunk/epan/dissectors/packet-mpeg-pmt.c
   M /trunk/epan/dissectors/packet-mpeg-sect.c

Make several functions static; remove trailing commas and white space.
------------------------------------------------------------------------
r41605 | morriss | 2012-03-16 06:24:15 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

Make most of the functions in here static
------------------------------------------------------------------------
r41604 | morriss | 2012-03-16 06:19:16 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-descriptor.c

Terminate a value_string.  Remove a couple of trailing commas.
------------------------------------------------------------------------
r41603 | etxrab | 2012-03-16 05:46:54 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Fix typo.
------------------------------------------------------------------------
r41602 | etxrab | 2012-03-16 05:43:44 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rmt-lct.h

Fix a typo
------------------------------------------------------------------------
r41601 | etxrab | 2012-03-16 05:43:12 -0700 (Fri, 16 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eiss.c

Error: the name for field "Initial Resource Locator Type " ("eiss.aid.irl.type") has trailing space in packet-eiss.c
Error: the name for field "Initial Resource Locator Length " ("eiss.aid.irl.length") has trailing space in packet-eiss.c
Error: the name for field "Initial Resource Locator String " ("eiss.aid.irl.string") has trailing space in packet-eiss.c
------------------------------------------------------------------------
r41600 | etxrab | 2012-03-16 05:25:06 -0700 (Fri, 16 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-mpeg-ca.c
   A /trunk/epan/dissectors/packet-mpeg-descriptor.c
   A /trunk/epan/dissectors/packet-mpeg-descriptor.h
   A /trunk/epan/dissectors/packet-mpeg-pmt.c

From Guy Martin:
Add packet-mpeg-pmt, packet-mpeg-ca and mpeg-descriptors.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6960
------------------------------------------------------------------------
r41599 | etxrab | 2012-03-16 05:02:56 -0700 (Fri, 16 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-eiss.c
   M /trunk/epan/dissectors/packet-mpeg-sect.c
   M /trunk/epan/dissectors/packet-mpeg-sect.h

From Weston Schmidt:
Add EISS dissector support.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6954
------------------------------------------------------------------------
r41598 | etxrab | 2012-03-16 04:51:32 -0700 (Fri, 16 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rmt-fec.c

Upadte a value string.
------------------------------------------------------------------------
r41597 | etxrab | 2012-03-16 04:51:00 -0700 (Fri, 16 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mp2t.c

From Guy Martin:
Fix a few bugs in packet-mp2t

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6959
------------------------------------------------------------------------
r41596 | guy | 2012-03-16 01:02:35 -0700 (Fri, 16 Mar 2012) | 2 lines
Changed paths:
   M /trunk/acinclude.m4

Fix some comments and some indentation.

------------------------------------------------------------------------
r41595 | guy | 2012-03-16 01:02:04 -0700 (Fri, 16 Mar 2012) | 3 lines
Changed paths:
   M /trunk/configure.in

Add some more -D flags to CPPFLAGS rather than CFLAGS, and add some
flags that aren't -D or -I flags to CXXFLAGS as well as CFLAGS.

------------------------------------------------------------------------
r41594 | guy | 2012-03-15 20:39:51 -0700 (Thu, 15 Mar 2012) | 5 lines
Changed paths:
   M /trunk/doxygen.cfg.in
   M /trunk/epan/doxygen.cfg.in
   M /trunk/packaging/macosx/Info.plist.in
   M /trunk/packaging/rpm/SPECS/wireshark.spec.in
   M /trunk/packaging/svr4/checkinstall.in
   M /trunk/packaging/svr4/pkginfo.in
   M /trunk/ui/doxygen.cfg.in
   M /trunk/ui/gtk/doxygen.cfg.in

Add @configure_input@ to a bunch of .in files that didn't have it.

Add $Id$ to those of said files that didn't have it, and fix one $Id to
be $Id$.

------------------------------------------------------------------------
r41593 | guy | 2012-03-15 20:27:45 -0700 (Thu, 15 Mar 2012) | 33 lines
Changed paths:
   M /trunk/acinclude.m4
   M /trunk/configure.in

Put -D and -I flags into CPPFLAGS rather than into CFLAGS; that should
make them apply to C++ as well as C.  That seems to be what the autoconf
documentation suggests:

- Variable: CFLAGS
  Debugging and optimization options for the C compiler. If it is not set
  in the environment when configure runs, the default value is set when
  you call AC_PROG_CC (or empty if you don't). configure uses this
  variable when compiling or linking programs to test for C features.

  If a compiler option affects only the behavior of the preprocessor
  (e.g., -Dname), it should be put into CPPFLAGS instead. If it affects
  only the linker (e.g., -Ldirectory), it should be put into LDFLAGS
  instead. If it affects only the compiler proper, CFLAGS is the natural
  home for it. If an option affects multiple phases of the compiler,
  though, matters get tricky. One approach to put such options directly
  into CC, e.g., CC='gcc -m64'. Another is to put them into both CPPFLAGS
  and LDFLAGS, but not into CFLAGS.

	...

- Variable: CPPFLAGS
  Preprocessor options for the C, C++, Objective C, and Objective C++
  preprocessors and compilers. If it is not set in the environment when
  configure runs, the default value is empty. configure uses this variable
  when preprocessing or compiling programs to test for C, C++, Objective
  C, and Objective C++ features.

  This variable's contents should contain options like -I, -D, and -U that
  affect only the behavior of the preprocessor. Please see the explanation
  of CFLAGS for what you can do if an option affects other phases of the
  compiler as well.

------------------------------------------------------------------------
r41592 | morriss | 2012-03-15 19:47:16 -0700 (Thu, 15 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/ui/main-menubar-ui.xml

Actually, the Lua-menu-items aren't necessary anyway; remove them.
------------------------------------------------------------------------
r41591 | morriss | 2012-03-15 19:36:32 -0700 (Thu, 15 Mar 2012) | 14 lines
Changed paths:
   M /trunk/ui/gtk/funnel_stat.c
   M /trunk/ui/gtk/main_menubar.c

Get the Lua menus working again: when adding UI menus, it appears that our
description of existing menus must be accurate: if a name and action are
both specified then the to-be-added-XML must include both the name and the
action.

It appears that the formats given in stat_group_name()'s value_string were
designed to take this into account, but there was no code to separate the menu
name from its action.  Adding that separation is complicated by the fact that
menus are separated by /'s and actions may also contain that character.  To
deal with that, "escape" the /'s in actions by replacing them with #'s.
make_menu_xml() then un-escapes them back into /'s.

There has to be an easier way to do all of this...

------------------------------------------------------------------------
r41590 | wmeier | 2012-03-15 19:31:42 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/asn1/tetra/packet-tetra-template.c
   M /trunk/epan/dissectors/packet-tetra.c

FT_BOOLEAN hf[] entry with a 0 'bitmask' should have 'display' = BASE_NONE;

------------------------------------------------------------------------
r41589 | wmeier | 2012-03-15 19:24:57 -0700 (Thu, 15 Mar 2012) | 5 lines
Changed paths:
   M /trunk/asn1/idmp/packet-idmp-template.c
   M /trunk/epan/dissectors/packet-idmp.c

FT_BOOLEAN hf[] entry with a 0 'bitmask' should have 'display' = BASE_NONE;
Reformat long lines;
Use consistent indentation;
Do some general whitespace changes.

------------------------------------------------------------------------
r41588 | morriss | 2012-03-15 19:24:56 -0700 (Thu, 15 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/ui/main-menubar-ui.xml

Fix menu path typos: Stataistics->Statistics, LUA->Lua
------------------------------------------------------------------------
r41587 | wmeier | 2012-03-15 19:00:29 -0700 (Thu, 15 Mar 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-erf.c
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-opensafety.c
   M /trunk/epan/dissectors/packet-rtmpt.c
   M /trunk/epan/dissectors/packet-vnc.c

FT_BOOLEAN hf[] entries with a 0 'bitmask' should have 'display' = BASE_NONE;
In some cases:
 Use val_to_str_const() instead of val_to_str();
 Reformat long lines;
 Do some general whitespace changes.


------------------------------------------------------------------------
r41586 | guy | 2012-03-15 17:49:01 -0700 (Thu, 15 Mar 2012) | 13 lines
Changed paths:
   M /trunk/acinclude.m4
   M /trunk/configure.in

Have AC_WIRESHARK_GCC_CFLAGS_CHECK take an optional second flag to
indicate whether the flag is C-only, C++-only, or for both compilers;
pass the appropriate value for C-only flags.  Have the "Checking for..."
message indicate whether we're adding to CFLAGS, CXXFLAGS, or both.

(Yes, the macro should probably be renamed.  "GCC" refers to the GNU
Compiler Collection, which includes a C++ compiler, although that's also
used for compilers that are more-or-less compatible with the ones from
the GNU Compiler Collection, such as the clang compilers.)

We set -Wformat-security whether or not --enable-extra-gcc-checks was
specified, so we don't need to do it again if it was specified.

------------------------------------------------------------------------
r41585 | wmeier | 2012-03-15 17:05:36 -0700 (Thu, 15 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

FT_BOOLEAN hf[] entries with a 0 'bitmask' should have 'display' = BASE_NONE;
Reformat long lines;
Do some general whitespace changes.

------------------------------------------------------------------------
r41584 | wmeier | 2012-03-15 17:01:50 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pnrp.c

FT_BOOLEAN hf[] entries with a 0 'bitmask' should have 'display' = BASE_NONE;

------------------------------------------------------------------------
r41582 | wmeier | 2012-03-15 16:26:40 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

FT_BOOLEAN hf[] entries with a 0 'bitmask' should have 'display' = BASE_NONE;

------------------------------------------------------------------------
r41581 | cmaynard | 2012-03-15 16:21:05 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pcli.c

Update the link to the specification.

------------------------------------------------------------------------
r41580 | wmeier | 2012-03-15 16:19:28 -0700 (Thu, 15 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.c

FT_BOOLEAN hf[] entries with a 0 'bitmask' should have 'display' = BASE_NONE;
Convert "4 space tabs" to "4 spaces";
General whitespace & formatting changes.

------------------------------------------------------------------------
r41579 | wmeier | 2012-03-15 16:16:46 -0700 (Thu, 15 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

proto_tree_add_bits_item() associated hf[] entry 'bitmask' must be 0;
FT_BOOLEAN hf[] entries with a 0 'bitmask' should have 'display' = BASE_NONE;
General whitespace & formatting changes.

------------------------------------------------------------------------
r41577 | wmeier | 2012-03-15 14:56:52 -0700 (Thu, 15 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c

Use 'display'=BASE_NONE for all FT_BOOLEAN hf[] entries with a 0 bitmask;
Do some general whitespace & long-line changes.

------------------------------------------------------------------------
r41575 | guy | 2012-03-15 14:44:54 -0700 (Thu, 15 Mar 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Initialize the new num_stat_entries and interface_statistics members of
a wtapng_if_descr_t, so that we don't crash on a close (as is happening
in the buildbot).

Fix up some 4-space tabs.

------------------------------------------------------------------------
r41574 | jmayer | 2012-03-15 14:27:04 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

Document which warnings are c++ only.

------------------------------------------------------------------------
r41573 | jmayer | 2012-03-15 14:26:16 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.qt

i18 -> i18n

------------------------------------------------------------------------
r41572 | morriss | 2012-03-15 14:04:47 -0700 (Thu, 15 Mar 2012) | 1 line
Changed paths:
   M /trunk/tools/svnadd

Handle .pcap and .pcapng files: set their mime-types appropriately.
------------------------------------------------------------------------
r41571 | morriss | 2012-03-15 14:03:15 -0700 (Thu, 15 Mar 2012) | 1 line
Changed paths:
   M /trunk/test/dhcp-nanosecond.pcap
   M /trunk/test/dhcp-nanosecond.pcapng
   M /trunk/test/dhcp.pcap
   M /trunk/test/dhcp.pcapng

Don't set svn:keywords on PCAP files
------------------------------------------------------------------------
r41570 | morriss | 2012-03-15 14:01:28 -0700 (Thu, 15 Mar 2012) | 1 line
Changed paths:
   M /trunk/test/dhcp.pcap

Set mime-type to application/vnd.tcpdump.pcap
------------------------------------------------------------------------
r41569 | wmeier | 2012-03-15 13:48:40 -0700 (Thu, 15 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pcp.c

Calls to col_add_fstr() & etc should not be under 'if (tree)';
hf[] FT_BOOLEAN entry with 0 bitmask should have BASE_NONE as 'display' (benign);
Enforce modelines (Convert '4 space tabs' to spaces);
Do general formatting and whitespace cleanup.

------------------------------------------------------------------------
r41567 | cmaynard | 2012-03-15 08:15:18 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/wireshark.pod.template

Sort the options.

------------------------------------------------------------------------
r41566 | cmaynard | 2012-03-15 08:03:08 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/text2pcap.pod

Sort the options.

------------------------------------------------------------------------
r41565 | cmaynard | 2012-03-15 07:56:06 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/capinfos.pod

Sort the options.

------------------------------------------------------------------------
r41564 | cmaynard | 2012-03-15 07:52:49 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/dumpcap.pod

Correct the sorting of the options in the synopsis.

------------------------------------------------------------------------
r41563 | cmaynard | 2012-03-15 07:50:07 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/editcap.pod

Sort the options.  Delete all the line-terminating "g's" added in 40820.

------------------------------------------------------------------------
r41562 | cmaynard | 2012-03-15 07:35:36 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/mergecap.pod

Sort the options.

------------------------------------------------------------------------
r41561 | etxrab | 2012-03-15 07:33:04 -0700 (Thu, 15 Mar 2012) | 1 line
Changed paths:
   M /trunk/summary.c
   M /trunk/summary.h
   M /trunk/wiretap/pcapng.c

If we have one ISB, display the droped count from it.
------------------------------------------------------------------------
r41560 | cmaynard | 2012-03-15 07:29:44 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/tshark.pod

Sort the -z options.

------------------------------------------------------------------------
r41559 | wmeier | 2012-03-15 07:15:48 -0700 (Thu, 15 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/proto.c

Update a comment as to the number of Wireshark protocols;
Minor whitespace and formatting changes.

------------------------------------------------------------------------
r41558 | etxrab | 2012-03-15 06:46:42 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/wtap.c

- Store ISB data.
- free IDB and ISB data when closing.
------------------------------------------------------------------------
r41557 | etxrab | 2012-03-15 01:32:49 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

From David Wei:
Fix a typo.
------------------------------------------------------------------------
r41556 | tuexen | 2012-03-15 01:23:26 -0700 (Thu, 15 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/sctpppids.h

Add support for SSH over SCTP.

------------------------------------------------------------------------
r41555 | stig | 2012-03-15 00:40:08 -0700 (Thu, 15 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mpls-echo.c

Fixed error: "/*" within comment
------------------------------------------------------------------------
r41554 | etxrab | 2012-03-14 23:23:01 -0700 (Wed, 14 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mpls-echo.c

Update MPLS return codes, https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6951
------------------------------------------------------------------------
r41553 | morriss | 2012-03-14 19:35:49 -0700 (Wed, 14 Mar 2012) | 1 line
Changed paths:
   M /trunk/file.c

Should have been part of r41542: Don't free idb_inf in wtap_dump_open_ng(): free it in the callers.
------------------------------------------------------------------------
r41552 | morriss | 2012-03-14 19:33:52 -0700 (Wed, 14 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_gui.c

Line-wrap an extremely long comment.  Remove trailing white space.
------------------------------------------------------------------------
r41551 | tuexen | 2012-03-14 12:14:29 -0700 (Wed, 14 Mar 2012) | 2 lines
Changed paths:
   M /trunk/macosx-setup.sh

Bump some version numbers.

------------------------------------------------------------------------
r41550 | wmeier | 2012-03-14 11:57:17 -0700 (Wed, 14 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.c

hg_gsm_a_vamos_level --> hf_gsm_a_vamos_level

------------------------------------------------------------------------
r41548 | jmayer | 2012-03-14 10:26:49 -0700 (Wed, 14 Mar 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/voip_calls.c

Fix:
work/wireshark/svn/trunk/ui/gtk/voip_calls.c:599:9: error: variable ‘voip_calls_graph_list’ set but not used [-Werror=unused-but-set-variable]


------------------------------------------------------------------------
r41547 | wmeier | 2012-03-14 10:11:39 -0700 (Wed, 14 Mar 2012) | 6 lines
Changed paths:
   M /trunk/epan/proto.c

Fix up a several REPORT_DISSECTOR_BUG messages to specify the correct function name;
Do general cleanup:
- Indentation & whitespace;
- Reformat long lines,
- & etc.

------------------------------------------------------------------------
r41546 | tuexen | 2012-03-14 09:56:20 -0700 (Wed, 14 Mar 2012) | 3 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/macosx-setup.sh
   D /trunk/macosx-support-lib-patches/glib-gconvert.patch

Update to glib 2.31.20.
One patch is not required anymore, since it has been included.

------------------------------------------------------------------------
r41545 | etxrab | 2012-03-14 09:46:59 -0700 (Wed, 14 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/graph_analysis.h
   M /trunk/ui/gtk/voip_calls.c

voip_calls.c Use the hastable instead, we should do away with the list.
graph_analysis.h Doxygen changes.
------------------------------------------------------------------------
r41544 | etxrab | 2012-03-14 02:53:33 -0700 (Wed, 14 Mar 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/voip_calls.c
   M /trunk/ui/gtk/voip_calls_dlg.c

VoIP Calls Graph Analysis: Elements not sorted by Time.
Sort the list based on frame number.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6926
------------------------------------------------------------------------
r41543 | morriss | 2012-03-13 18:39:24 -0700 (Tue, 13 Mar 2012) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-dccp.c
   M /trunk/epan/dissectors/packet-dccp.h

From Francesco Fondelli via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6946 :

Support for DCCP Simultaneous-Open for NAT Traversal, RFC 5596.  A new packet
format is supported.  I did a little code cleanup too.

------------------------------------------------------------------------
r41542 | morriss | 2012-03-13 18:08:09 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/editcap.c
   M /trunk/tshark.c
   M /trunk/wiretap/file_access.c

Don't free idb_inf in wtap_dump_open_ng(): free it in the callers.  This fixes the double-free editcap crashes that the buildbot's been seeing lately.
------------------------------------------------------------------------
r41541 | gerald | 2012-03-13 12:58:19 -0700 (Tue, 13 Mar 2012) | 6 lines
Changed paths:
   A /trunk/test/dhcp-nanosecond.pcap
   A /trunk/test/dhcp-nanosecond.pcapng
   M /trunk/test/dhcp.pcap
   A /trunk/test/dhcp.pcapng
   A /trunk/test/suite-fileformats.sh (from /trunk/test/suite-io.sh:41510)
   M /trunk/test/test-backend.sh
   M /trunk/test/test.sh

Add a "fileformats" suite (copied from the I/O suite) to check file
format conversion. So far we check nanosecond pcap, microsecond pcap-ng
and nanosecond pcap-ng against standard pcap.

Fix color output on OS X.

------------------------------------------------------------------------
r41540 | wmeier | 2012-03-13 11:35:09 -0700 (Tue, 13 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lwapp.c

Use tvb_new_subset_remaining(...) instead of tvb_new_subset(..., -1, -1);
Use value_string_ext to reference a value_string;
Use global tfs_set_notset instead of a local version displaying the values incorrectly;
Slightly enhance display of the LWAPP Control Message.

------------------------------------------------------------------------
r41539 | wmeier | 2012-03-13 10:21:46 -0700 (Tue, 13 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

Use tvb_new_subset_remaining(...) in place of tvb_new_subset(..., -1, -1);
Use value_string_ext to reference a few value_strings;
Use val_to_str_const() in place of val_to_str() in a few cases;
Use BASE_NONE for a few hf[] FT_BOOLEAN entries with 0x0 bitmask.

------------------------------------------------------------------------
r41538 | morriss | 2012-03-13 09:49:43 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Remove a couple trailing commas
------------------------------------------------------------------------
r41537 | morriss | 2012-03-13 09:47:11 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Fix up indentation/white space.  Use global tfs_yes_no instead of local version.
------------------------------------------------------------------------
r41536 | morriss | 2012-03-13 08:43:41 -0700 (Tue, 13 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6947 :

Don't leave a space at the end of the MSISDN string.

------------------------------------------------------------------------
r41535 | etxrab | 2012-03-13 08:27:22 -0700 (Tue, 13 Mar 2012) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

From Jose Pedro Oliveira:
dumpcap.c: code cleaning 
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6718
------------------------------------------------------------------------
r41534 | etxrab | 2012-03-13 08:26:36 -0700 (Tue, 13 Mar 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

From Jose Pedro Oliveira:
Remove a printf line in wiretap/pcapng.c
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6718
------------------------------------------------------------------------
r41533 | morriss | 2012-03-13 08:19:29 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-usb-ccid.c

Remove if(tree) to address https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6940#c3
------------------------------------------------------------------------
r41532 | morriss | 2012-03-13 08:06:40 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Add detailed decoding for Framed-IPv6-Prefix.
------------------------------------------------------------------------
r41531 | morriss | 2012-03-13 07:43:45 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Don't mark a couple of unused parameters are unused.
------------------------------------------------------------------------
r41530 | etxrab | 2012-03-13 07:11:08 -0700 (Tue, 13 Mar 2012) | 4 lines
Changed paths:
   M /trunk/editcap.c
   M /trunk/tshark.c

From Jose Pedro Oliveira:
the shb_userappl value wasn't being changed.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6937
------------------------------------------------------------------------
r41529 | morriss | 2012-03-13 06:53:01 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-pn532.c

(sigh) Take out the whole if(tree) as Chris suggested. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6903#c14
------------------------------------------------------------------------
r41528 | morriss | 2012-03-13 06:43:19 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-pn532.c

Move the col_set_str() outside the if(tree) to address https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6903#c7
------------------------------------------------------------------------
r41527 | etxrab | 2012-03-13 06:41:28 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h248_10.c
   M /trunk/epan/dissectors/packet-h248_3gpp.c
   M /trunk/epan/dissectors/packet-h248_annex_c.c
   M /trunk/epan/dissectors/packet-h248_q1950.c

H248 package updates from Alex Lindberg in bug https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6915 applied by hand.
------------------------------------------------------------------------
r41526 | etxrab | 2012-03-13 06:26:13 -0700 (Tue, 13 Mar 2012) | 6 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/h248v1support.asn
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h
   M /trunk/epan/dissectors/packet-h248_annex_e.c

H.248 Annex E dissector does not properly dissect event parameters
(Update the h.248 dissector's package registration to support v1 packets.)

Applying part of the patch from Alex Lindberg in bug https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6915 by hand.
Fixes bug
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=4842
------------------------------------------------------------------------
r41525 | etxrab | 2012-03-13 04:26:37 -0700 (Tue, 13 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-sect.c

From Weston Schmidt:
Make mpeg-sect CRC checking a preference defaulting to off.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6944
------------------------------------------------------------------------
r41524 | etxrab | 2012-03-13 02:13:27 -0700 (Tue, 13 Mar 2012) | 5 lines
Changed paths:
   M /trunk/editcap.c
   M /trunk/tshark.c

A modified version of "pcapng: shd_userappl in newly created files"
to only add the name if no name if there yet. Original patch from
Jose Pedro Oliveira. 

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6937
------------------------------------------------------------------------
r41523 | etxrab | 2012-03-13 01:57:04 -0700 (Tue, 13 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/crc32-tvb.c
   M /trunk/epan/crc32-tvb.h
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-dvb-data-mpe.c
   M /trunk/epan/dissectors/packet-mpeg-pat.c
   M /trunk/epan/dissectors/packet-mpeg-sect.c
   A /trunk/epan/dissectors/packet-mpeg-sect.h
   M /trunk/epan/libwireshark.def
   M /trunk/wsutil/crc32.c
   M /trunk/wsutil/crc32.h
   M /trunk/wsutil/libwsutil.def

From Weston Schmidt:
Update packet-mpeg-sect to support CRCs & simpler header processing for subdissectors.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6941
------------------------------------------------------------------------
r41522 | etxrab | 2012-03-13 01:36:52 -0700 (Tue, 13 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/wtap.h

Add data structure to hold information from ISB:s
------------------------------------------------------------------------
r41521 | guy | 2012-03-13 01:36:25 -0700 (Tue, 13 Mar 2012) | 14 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/file.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_statusbar.c

Add an explicit capture_cb_capture_failed indication for the case where
we weren't even able to start a capture, rather than delivering a fake
"capture start" indication and relying on a later "capture file closed"
indication - for a capture that was never opened in the first place - to
handle GUI cleanups.

Don't deliver any GUI indications in cf_close() if we didn't have a
capture file open in the first place.

Clear the status bar and welcome header if that indication is delivered.

If we start a capture from the command line with the -k flag, don't show
the captured packet information unless the capture actually starts.

------------------------------------------------------------------------
r41520 | etxrab | 2012-03-12 23:34:32 -0700 (Mon, 12 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-usb-ccid.c

From Tyson Key: Support for dissection of PN532 payloads in USB CCID packets. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6940
------------------------------------------------------------------------
r41519 | guy | 2012-03-12 22:02:48 -0700 (Mon, 12 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main.c

SystemConfiguration framework, not IOKit?

------------------------------------------------------------------------
r41518 | guy | 2012-03-12 22:02:16 -0700 (Mon, 12 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main.c

Suggest a better way of getting the interface type on OS X.

------------------------------------------------------------------------
r41517 | guy | 2012-03-12 20:48:27 -0700 (Mon, 12 Mar 2012) | 9 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/ui/gtk/main.c

Closing a capture file has nothing to do with the list of interfaces on
which to do a live capture; don't clear the latter list when closing the
capture file.

collect_ifaces() should clear out the existing list of interfaces before
filling that list up with the interfaces selected by the user.  In
addition, when it frees up interfaces in that list, it should free up
the strings attached to those interfaces.

------------------------------------------------------------------------
r41516 | morriss | 2012-03-12 18:40:18 -0700 (Mon, 12 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

From Michael Mann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6938 :

Don't limit CSeq to 2**31-1 (2147483647): use stroul() instead of atoi() in
several places.

------------------------------------------------------------------------
r41515 | morriss | 2012-03-12 18:22:36 -0700 (Mon, 12 Mar 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-erf.c

From Stephen Donnelly via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6943 :

The ERF extension header 'New BFS' is poorly named, it is not descriptive.

Rename the ERF 'New BFS' extension header to 'Signature' which is more
descriptive, more easily distinguished, and consistent with the internal
naming.

------------------------------------------------------------------------
r41514 | morriss | 2012-03-12 17:07:34 -0700 (Mon, 12 Mar 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/x11-declarations.h
   M /trunk/epan/dissectors/x11-enum.h
   M /trunk/epan/dissectors/x11-extension-errors.h
   M /trunk/epan/dissectors/x11-extension-implementation.h
   M /trunk/epan/dissectors/x11-glx-render-enum.h
   M /trunk/epan/dissectors/x11-register-info.h
   M /trunk/tools/process-x11-xcb.pl

From Peter Harris:

An enum name collision was recently added to the upstream XCB/proto.
Avoid the collision by putting enum names into their proper namespace.


After applying that, regenerate the X11 dissector.

------------------------------------------------------------------------
r41513 | alagoutte | 2012-03-12 16:13:03 -0700 (Mon, 12 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-ipv6.h

Enhance and update IPv6 Option of Extension Header

* Make field filterable...
* Display unknown option payload 

------------------------------------------------------------------------
r41512 | morriss | 2012-03-12 12:31:26 -0700 (Mon, 12 Mar 2012) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Code=100 is Framed-IPv6-Pool, not (another copy of) Framed-IPv6-Prefix
------------------------------------------------------------------------
r41511 | wmeier | 2012-03-12 12:25:20 -0700 (Mon, 12 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pw-atm.c

Use tvb_new_subset_remaining(...) instead of tvb_new_subset(..., -1, -1);
expert_add_info_format() must be called even when 'tree == NULL' so that MALDORMED
  will appear in the INFO column.
Do various whitespace & formatting changes.

------------------------------------------------------------------------
r41510 | wmeier | 2012-03-12 10:53:58 -0700 (Mon, 12 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvb-data-mpe.c

Use tvb_new_subset_remaining(...) in place of tvb_new_subset(..., -1, -1);
Remove unneeded calls to col_clear();
Define dissect_dvb_data_mpe() to be static;
Do some minor whitespace changes.

------------------------------------------------------------------------
r41509 | morriss | 2012-03-12 10:30:38 -0700 (Mon, 12 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Fix a typo in a function name and some indentation.
------------------------------------------------------------------------
r41508 | stig | 2012-03-12 10:18:54 -0700 (Mon, 12 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-imf.c

Improved a if-check to avoid a analyzis warning.
------------------------------------------------------------------------
r41507 | stig | 2012-03-12 10:18:04 -0700 (Mon, 12 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/proto.c

Value can't be negative if no_of_bits == 0
------------------------------------------------------------------------
r41506 | etxrab | 2012-03-12 08:43:59 -0700 (Mon, 12 Mar 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

From Jose Pedro Oliveira:

Enforce the modelines in wiretap/pcapng.c
------------------------------------------------------------------------
r41505 | etxrab | 2012-03-12 08:40:57 -0700 (Mon, 12 Mar 2012) | 3 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/pcapio.c

From Jose Pedro Oliveira:

Enforce the modelines in dumpcap.c and in pcapio.c
------------------------------------------------------------------------
r41504 | wmeier | 2012-03-12 08:15:39 -0700 (Mon, 12 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btamp.c

Minor reformatting, whitespace and style changes.

------------------------------------------------------------------------
r41503 | wmeier | 2012-03-12 07:40:09 -0700 (Mon, 12 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bthci_acl.c
   M /trunk/epan/dissectors/packet-bthci_acl.h
   M /trunk/epan/dissectors/packet-bthci_cmd.c
   M /trunk/epan/dissectors/packet-bthci_evt.c
   M /trunk/epan/dissectors/packet-bthci_sco.c

Use consistent indentation;
Do minor reformatting.

------------------------------------------------------------------------
r41502 | wmeier | 2012-03-12 07:38:59 -0700 (Mon, 12 Mar 2012) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btl2cap.c
   M /trunk/epan/dissectors/packet-btl2cap.h
   M /trunk/epan/dissectors/packet-btobex.c
   M /trunk/epan/dissectors/packet-btrfcomm.c
   M /trunk/epan/dissectors/packet-btrfcomm.h
   M /trunk/epan/dissectors/packet-btsdp.c
   M /trunk/epan/dissectors/packet-btsdp.h

Cleanup & minor bug fixes:
- Don't put a value_string array in a .h file (included in several .c files);
- 'if ((a!=NULL) && !b) {fail}' should be 'if ((a==NULL) || !b) {fail}' in a few cases;
- Use value_string_ext as appropriate;
- Use val_to_str_const() in place of val_to_str() as appropriate;
- Use tvb_new_subset_remaining(...) instead of tvb_new_subset(..., -1, -1);
- Use tvb_reported_length_remaining() in place of tvb_length_remaining() in some cases;
- tvb_reported_length_remaining() can return -1;
- Use of TFS(&true_false) not req'd since "True"/"False" is the default if no TFS provided;
- Reformat various (long lines, etc);
- Use consistent indentation.

------------------------------------------------------------------------
r41501 | etxrab | 2012-03-12 07:18:04 -0700 (Mon, 12 Mar 2012) | 1 line
Changed paths:
   M /trunk/editcap.c
   M /trunk/tshark.c

Free  idb_inf and shb_hdr when done.
------------------------------------------------------------------------
r41500 | martinm | 2012-03-12 06:19:28 -0700 (Mon, 12 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/mac_lte_stat_dlg.c

Add checkboxes to filter for RACH attempts and SRs.

------------------------------------------------------------------------
r41499 | martinm | 2012-03-12 06:18:56 -0700 (Mon, 12 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c

Add a checkbox to filter for RACH attempts.

------------------------------------------------------------------------
r41498 | etxrab | 2012-03-12 05:18:02 -0700 (Mon, 12 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/voip_calls.h

Add doxygen tags.
------------------------------------------------------------------------
r41497 | etxrab | 2012-03-12 01:55:14 -0700 (Mon, 12 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-rfid-pn532.c

From Tyson Key:
Dissector for the NXP PN532 protocol

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6903
------------------------------------------------------------------------
r41496 | etxrab | 2012-03-11 23:42:47 -0700 (Sun, 11 Mar 2012) | 1 line
Changed paths:
   M /trunk/pcapio.c

From Jose Pedro Oliveira: Add Modlines
------------------------------------------------------------------------
r41495 | etxrab | 2012-03-11 23:39:45 -0700 (Sun, 11 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

From Jose Pedro Oliveira: Add Modlines
------------------------------------------------------------------------
r41494 | guy | 2012-03-11 19:53:21 -0700 (Sun, 11 Mar 2012) | 3 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h

capture_opts_add_iface_opt() is not used outside capture_opts.c; make it
static.

------------------------------------------------------------------------
r41493 | martinm | 2012-03-11 16:44:03 -0700 (Sun, 11 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Within a status report, check that NACK_SNs are not 'ahead' of ACK_SN.

------------------------------------------------------------------------
r41492 | etxrab | 2012-03-11 15:31:18 -0700 (Sun, 11 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

From Steve Magnani: knock URB Setup out from under USB URB https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6934
------------------------------------------------------------------------
r41491 | guy | 2012-03-11 13:08:54 -0700 (Sun, 11 Mar 2012) | 13 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/main.c

Don't close the currently loaded capture file in capture_start(), do so
in its callers; when starting a capture with "wireshark -k", there's no
capture file to close, and closing it might be provoking some UI actions
that cause crashes on Windows.

Don't copy the list of selected interfaces to the list of capture
interfaces in capture_start(), either, do that in the callers; we were
already doing that in one place and, in one of the remaining cases,
namely "wireshark -k", we should do so only if no capture interfaces
were supplied on the command line.  (I.e., the set of interfaces on
which we want to capture depends on where in the UI the capture is being
started.)

------------------------------------------------------------------------
r41490 | guy | 2012-03-11 13:01:11 -0700 (Sun, 11 Mar 2012) | 2 lines
Changed paths:
   M /trunk/capture_opts.c

Add a comment to indicate what collect_ifaces() does.

------------------------------------------------------------------------
r41489 | guy | 2012-03-11 13:00:39 -0700 (Sun, 11 Mar 2012) | 5 lines
Changed paths:
   M /trunk/capture_sync.c

If the length is bogus in a message received from the sync pipe, dump
out all 4 bytes we read, to provide more information about the message
that was sent so it's easier to see if something was spewing extra
output to the standard output or error in the child.

------------------------------------------------------------------------
r41488 | guy | 2012-03-11 12:59:08 -0700 (Sun, 11 Mar 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Fix function name in debugging message.

------------------------------------------------------------------------
r41487 | etxrab | 2012-03-11 12:31:10 -0700 (Sun, 11 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_statusbar.c

Add a comments LED
------------------------------------------------------------------------
r41486 | alagoutte | 2012-03-11 12:05:32 -0700 (Sun, 11 Mar 2012) | 9 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-mpls-y1711.c
   M /trunk/epan/dissectors/packet-mpls.c
   M /trunk/epan/dissectors/packet-mpls.h

From Francesco Fondelli via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6787
Move Y.1711 out of MPLS dissector

ITU-T Y.1711 code was "embedded" into the MPLS dissector in 2006. 
This patch moves it into its own dissector.

From me :
Fix a Clang warning

------------------------------------------------------------------------
r41483 | gerald | 2012-03-11 07:03:34 -0700 (Sun, 11 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-03-11]
------------------------------------------------------------------------
r41482 | stig | 2012-03-11 07:03:13 -0700 (Sun, 11 Mar 2012) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c

Do not assign a value to itself.
------------------------------------------------------------------------
r41481 | stig | 2012-03-11 07:02:59 -0700 (Sun, 11 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-image-jfif.c

Return a valid offset from process_app0_segment().
The return value is not used, but this removes a warning.
------------------------------------------------------------------------
r41480 | stig | 2012-03-11 05:00:27 -0700 (Sun, 11 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_cbch.c

Remove extraneous parentheses around some comparisons to silence a warning.
------------------------------------------------------------------------
r41479 | stig | 2012-03-11 05:00:13 -0700 (Sun, 11 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

Free name string only when used.
------------------------------------------------------------------------
r41478 | stig | 2012-03-11 05:00:00 -0700 (Sun, 11 Mar 2012) | 1 line
Changed paths:
   M /trunk/asn1/c1222/packet-c1222-template.c
   M /trunk/epan/dissectors/packet-c1222.c

Use _U_ for unused arguments.
------------------------------------------------------------------------
r41477 | guy | 2012-03-10 23:10:48 -0800 (Sat, 10 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main.c

capture_opts_add_opt() does just fine at adding an interface to the
capture options, so don't special-case the -i option.

------------------------------------------------------------------------
r41476 | guy | 2012-03-10 11:05:46 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Reflect the rename of the Xylan RADIUS dictionary.

------------------------------------------------------------------------
r41475 | alagoutte | 2012-03-10 11:00:34 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro

Fix QtShark build after the move of alert_box.c in ui folder

------------------------------------------------------------------------
r41474 | alagoutte | 2012-03-10 10:30:20 -0800 (Sat, 10 Mar 2012) | 5 lines
Changed paths:
   M /trunk/packaging/nsis/wireshark.nsi
   M /trunk/radius/dictionary
   A /trunk/radius/dictionary.alcatel-lucent.xylan (from /trunk/radius/dictionary.xylan:41469)
   D /trunk/radius/dictionary.xylan

Rename the Xylan dictionnary to Alcatel-Lucent Xylan dictionnary

Alcatel (now Alcatel-Lucent) buy Xylan in 1999...
And now Attributs RADIUS is used in Alcatel-Lucent Omniswitch Product.

------------------------------------------------------------------------
r41473 | alagoutte | 2012-03-10 09:51:47 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41472 | alagoutte | 2012-03-10 09:51:32 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gmr1_dtap.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41471 | alagoutte | 2012-03-10 09:51:18 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gmr1_rr.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41470 | alagoutte | 2012-03-10 09:50:28 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41469 | alagoutte | 2012-03-10 09:49:33 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-megaco.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41468 | alagoutte | 2012-03-10 09:49:17 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41467 | alagoutte | 2012-03-10 09:49:00 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-infiniband.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41466 | alagoutte | 2012-03-10 09:48:33 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41465 | alagoutte | 2012-03-10 09:48:17 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isns.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41464 | alagoutte | 2012-03-10 09:47:28 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41463 | alagoutte | 2012-03-10 09:47:07 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_bssmap_le.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41462 | alagoutte | 2012-03-10 09:46:18 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssap.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41461 | alagoutte | 2012-03-10 09:45:17 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41460 | etxrab | 2012-03-10 09:00:30 -0800 (Sat, 10 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtp-midi.c

Don't register the payload type unless it's in the dynamic range
------------------------------------------------------------------------
r41459 | etxrab | 2012-03-10 08:16:07 -0800 (Sat, 10 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

From martijn: subdissectors for URB_INTERRUPT. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6929
------------------------------------------------------------------------
r41458 | etxrab | 2012-03-10 08:09:28 -0800 (Sat, 10 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-usb.h

From Steve Magnani: USB: centralize some common dissection code for class reuse. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6930
------------------------------------------------------------------------
r41457 | guy | 2012-03-10 01:08:03 -0800 (Sat, 10 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_statusbar.c

Replace 4-space tabs (and one 8-space tab, the only remaining tab in the
file after replacing the 4-space tabs) with spaces.

------------------------------------------------------------------------
r41456 | guy | 2012-03-10 01:01:48 -0800 (Sat, 10 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

Replace inconsistent tabs with spaces.

------------------------------------------------------------------------
r41455 | gerald | 2012-03-09 16:24:42 -0800 (Fri, 09 Mar 2012) | 5 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/pcapio.c
   M /trunk/pcapio.h
   M /trunk/wiretap/pcapng.c

In pcapng.c use the units per second value from the interface instead of
the default.

Add support for reading nseclibpcap files to dumpcap.

------------------------------------------------------------------------
r41454 | etxrab | 2012-03-09 07:29:35 -0800 (Fri, 09 Mar 2012) | 1 line
Changed paths:
   M /trunk/dumpcap.c

Forward interface_opts.descr (currently empty) when writing IDB:s
------------------------------------------------------------------------
r41453 | morriss | 2012-03-09 06:25:30 -0800 (Fri, 09 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/expert_comp_dlg.c

Fix up indentation (get rid of 4-space tabs).
------------------------------------------------------------------------
r41452 | etxrab | 2012-03-09 06:20:53 -0800 (Fri, 09 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/expert_comp_dlg.c

Mark an unused parameter as such.
------------------------------------------------------------------------
r41451 | etxrab | 2012-03-09 05:36:29 -0800 (Fri, 09 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/expert_comp_dlg.c

Make packet comments editable from the expert info tab.
------------------------------------------------------------------------
r41450 | etxrab | 2012-03-09 04:45:19 -0800 (Fri, 09 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-gmr1_dtap.c

From Sylvain Munaut:
packet-gmr1_dtap: Add dissector for GMR1 DTAP messages (Step 4(4)).
Added to Cmalelists.txt and #if 0 zero lenght hf array which windows 
build did not like.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6921
------------------------------------------------------------------------
r41449 | etxrab | 2012-03-09 04:33:16 -0800 (Fri, 09 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

From Sylvain Munaut:
packet-gsmtap: Call the GMR-1 CCCH dissector when appropriate  (Step 3).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6921
------------------------------------------------------------------------
r41448 | etxrab | 2012-03-09 04:15:08 -0800 (Fri, 09 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-gmr1_common.c
   A /trunk/epan/dissectors/packet-gmr1_rr.c
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_a_common.h

From Sylvain Munaut:
packet-gmr1_rr: Add dissector for GMR-1 RR elements and CCCH messages (Step 2).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6921
------------------------------------------------------------------------
r41447 | etxrab | 2012-03-09 03:47:55 -0800 (Fri, 09 Mar 2012) | 4 lines
Changed paths:
   M /trunk/pcapio.c

From Jose Pedro Oliveira:
pcapio.c: write IDB options in numeric order and corrects the IDB block_total_length.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6718
------------------------------------------------------------------------
r41446 | etxrab | 2012-03-09 01:38:21 -0800 (Fri, 09 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-gmr1_common.c
   A /trunk/epan/dissectors/packet-gmr1_common.h
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_a_common.h

From Sylvain Munaut:
GMR-1: Add dissections for various GMR 04.08 elements (Step1).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6921
------------------------------------------------------------------------
r41445 | etxrab | 2012-03-08 21:08:30 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Sylvain Munaut: gsm_a_common: ELEM_MAND_VV_SHORT doesn't support IEs of different types. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6924
------------------------------------------------------------------------
r41444 | etxrab | 2012-03-08 21:02:27 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/dumpcap.c

From Jose Pedro Oliveira: Make dumpcap write the if_tsresol option (using the default value) https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6718
------------------------------------------------------------------------
r41443 | etxrab | 2012-03-08 20:50:43 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

From Jose Pedro Oliveira: Corrects several 'wdh->bytes_dumped += ...' lines. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6718
------------------------------------------------------------------------
r41442 | guy | 2012-03-08 12:02:10 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/funnel_stat.c

Convert 4-space tabs to spaces.

------------------------------------------------------------------------
r41441 | guy | 2012-03-08 12:00:49 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/wslua/wslua_gui.c

Convert 4-space tabs to spaces.

------------------------------------------------------------------------
r41440 | gerald | 2012-03-08 11:07:02 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/image/capture_comment.svg
   M /trunk/image/capture_comment_add.png
   M /trunk/image/capture_comment_update.png
   M /trunk/ui/gtk/capture_comment_icons.h
   M /trunk/ui/gtk/main_statusbar.c

Update the comment icons and tooltips.

------------------------------------------------------------------------
r41439 | wmeier | 2012-03-08 10:11:35 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btsdp.h

Set svn:keywords & svn:eol-style properties

------------------------------------------------------------------------
r41438 | wmeier | 2012-03-08 09:48:46 -0800 (Thu, 08 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btsdp.h

Remove duplicate copy of contents appended to the end of the file;
Fix $Id so it works: '$ID: $' ==> '$ID$';
Convert '4-space' tabs to spaces.

------------------------------------------------------------------------
r41437 | guy | 2012-03-08 09:43:34 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

Reflect the move of alert_box.c to the ui directory.

------------------------------------------------------------------------
r41436 | guy | 2012-03-08 09:30:02 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.common
   D /trunk/alert_box.c
   M /trunk/ui/Makefile.common
   A /trunk/ui/alert_box.c (from /trunk/alert_box.c:41418)

Move alert_box.c to the ui directory.

------------------------------------------------------------------------
r41435 | martinm | 2012-03-08 08:30:39 -0800 (Thu, 08 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Want to write RRC info column info always.  Also save and restore writable
flag.

------------------------------------------------------------------------
r41434 | martinm | 2012-03-08 05:20:33 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Change the way the count of subheaders is displayed in the header.

------------------------------------------------------------------------
r41433 | martinm | 2012-03-08 05:19:41 -0800 (Thu, 08 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Add a preference to show in the info column RLC, PDCP or traffic
details.

------------------------------------------------------------------------
r41432 | etxrab | 2012-03-08 03:09:39 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.c

From Sylvain Munaut: gsm_a_common: elem_v_short doesn't create subtree for the IE https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6923
------------------------------------------------------------------------
r41431 | martinm | 2012-03-08 03:08:17 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Put UM and AM extension headers inside the header tree.

------------------------------------------------------------------------
r41430 | martinm | 2012-03-08 02:59:49 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Write UEID to info column using left-justified, fixed width.

------------------------------------------------------------------------
r41429 | etxrab | 2012-03-08 02:23:04 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c

Fix dissecton of speech codec list
------------------------------------------------------------------------
r41428 | etxrab | 2012-03-08 02:16:30 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/Makefile.common

Add capture_comment_icons.h
------------------------------------------------------------------------
r41427 | tuexen | 2012-03-08 01:25:13 -0800 (Thu, 08 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

From Robin Seggelmann: Add support for the New Session Ticket
message according to RFC 5077.

------------------------------------------------------------------------
r41426 | guy | 2012-03-08 00:46:52 -0800 (Thu, 08 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.am

And fix some other ../../image/...s for out-of-tree builds.

------------------------------------------------------------------------
r41425 | guy | 2012-03-08 00:45:20 -0800 (Thu, 08 Mar 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.am

Fix to handle out-of-tree builds - use $(top_srcdir) rather than a
string of ../ items to get to another directory in the source tree, as,
when doing an out-of-tree build, the source tree is a separate tree from
the build tree.

------------------------------------------------------------------------
r41424 | etxrab | 2012-03-08 00:07:21 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

summary_dlg.c:419: error: 'dl_description' undeclared (first use in this function)
------------------------------------------------------------------------
r41423 | etxrab | 2012-03-08 00:04:39 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_statusbar.c

Don't show expert info or comments icons unless we have a file loaded
------------------------------------------------------------------------
r41422 | etxrab | 2012-03-07 23:28:26 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

Put a frame around capture comments, don't depend on LIBPCAP to print dl_description or capture filter info
------------------------------------------------------------------------
r41421 | etxrab | 2012-03-07 22:59:38 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

Use an OK button rather than save for consistency, wouldapply be more apropriate?
------------------------------------------------------------------------
r41420 | guy | 2012-03-07 22:19:09 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Put more stuff from images into the release tarball.

------------------------------------------------------------------------
r41419 | etxrab | 2012-03-07 22:11:20 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/proto.c

From Sylvain Munaut: proto_tree_add_split_bits_item_ret_val doesn't handle signed value properly https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6920
------------------------------------------------------------------------
r41418 | martinm | 2012-03-07 20:49:59 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Include direction in some malformed expert info strings.

------------------------------------------------------------------------
r41417 | morriss | 2012-03-07 19:57:48 -0800 (Wed, 07 Mar 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

From Weston Andros Adamson via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6919 :

Both deviceid4 and sessionid4 are currently decoded as rpc_opaque_data - this
means their values are never displayed in the "Packet Detail" section and to
see them you have to select the name in the "Packet Detail" section and look at
the byte range in the "Packet Bytes" section.

The attached patch (against today's SVN) adds dissectors for both so these
values are displayed in the "Packet Detail" section.

------------------------------------------------------------------------
r41416 | morriss | 2012-03-07 18:33:14 -0800 (Wed, 07 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

Followup to r41415: don't enable *any* of the file operations during a live
capture.

------------------------------------------------------------------------
r41415 | morriss | 2012-03-07 18:18:12 -0800 (Wed, 07 Mar 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

As reported by Joerg on -dev: don't enable File->Save if we're still reading
the file (as is the case during a live capture).

Replace tabs with spaces (for consistency with the rest of the file).

------------------------------------------------------------------------
r41414 | morriss | 2012-03-07 18:06:44 -0800 (Wed, 07 Mar 2012) | 5 lines
Changed paths:
   M /trunk/tools/svnadd

Rewrite this shell script so that it sets the appropriate SVN properties based
on the file name that is being added.

Add a copyright notice.

------------------------------------------------------------------------
r41413 | morriss | 2012-03-07 17:33:47 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/image/capture_comment.svg
   M /trunk/image/capture_comment_add.png
   M /trunk/image/capture_comment_disabled.png
   M /trunk/image/capture_comment_update.png

Fix up SVN properties
------------------------------------------------------------------------
r41412 | gerald | 2012-03-07 17:24:31 -0800 (Wed, 07 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/dlg_utils.c
   M /trunk/ui/gtk/dlg_utils.h
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Create some standard definitions for dialog control spacing. Use them in
the comment dialog.

------------------------------------------------------------------------
r41411 | morriss | 2012-03-07 15:04:15 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Rename the functions and variables to go along with r41410.
------------------------------------------------------------------------
r41410 | morriss | 2012-03-07 14:38:02 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Use OK, Clear, and Cancel in the comment dialogs (instead of Save, Clear, and Close).  This makes the UI similar to our Preferences dialog.  And it avoids confusion about whether Save will save the file or not.
------------------------------------------------------------------------
r41409 | morriss | 2012-03-07 14:19:06 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/ui/gtk/summary_dlg.c

Set File->Save sensitivity after file or packet comments are changed.
------------------------------------------------------------------------
r41408 | guy | 2012-03-07 13:48:08 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.am

And one more image file.

------------------------------------------------------------------------
r41407 | guy | 2012-03-07 13:46:58 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Include the new images in the release tarball.

------------------------------------------------------------------------
r41406 | gerald | 2012-03-07 12:56:01 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/image/README.image
   A /trunk/image/capture_comment.svg
   A /trunk/image/capture_comment_add.png
   A /trunk/image/capture_comment_disabled.png
   A /trunk/image/capture_comment_update.png
   M /trunk/ui/gtk/Makefile.am
   M /trunk/ui/gtk/Makefile.common
   A /trunk/ui/gtk/capture_comment_icons.h
   M /trunk/ui/gtk/main_statusbar.c

Update and add icons for capture comments / annotations.

------------------------------------------------------------------------
r41405 | etxrab | 2012-03-07 12:09:48 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

From Sylvain Munaut: Call the new dissector from the GSMTap dissector for GMR-1 channels using LAPSat
------------------------------------------------------------------------
r41404 | etxrab | 2012-03-07 11:53:03 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-lapsat.c

From Sylvain Munaut: Add support LAPSat : GMR-1 Datalink layer https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6918
------------------------------------------------------------------------
r41403 | etxrab | 2012-03-07 10:17:07 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ptp.c

IEEE1588 PTPv2 over IPv6 -> Padding issue. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6836
------------------------------------------------------------------------
r41402 | etxrab | 2012-03-07 09:02:27 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/aethra.c

The User & Network direction is reversed https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6656
------------------------------------------------------------------------
r41401 | wmeier | 2012-03-07 08:54:12 -0800 (Wed, 07 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btobex.c
   M /trunk/epan/dissectors/packet-hdcp.c

Fix incorrect packet-details display of certain 1 bit FT_BOOLEAN fields.
 (Use a valid 'parent field width' in the hf[] 'display' field.

------------------------------------------------------------------------
r41400 | wmeier | 2012-03-07 08:38:08 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Update descriptions of hf[] FIELDDISPLAY and BITMASK fields.

------------------------------------------------------------------------
r41399 | wmeier | 2012-03-07 08:19:24 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

Revise and enable test for hf[] FT_BOOLEAN fields with a non-zero bit mask and with BASE_... in the 'display' field.

------------------------------------------------------------------------
r41398 | wmeier | 2012-03-07 08:02:48 -0800 (Wed, 07 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-enip.c

 Fix incorrect packet-details display of certain 1 bit FT_BOOLEAN fields.
 (Use a valid 'parent field width' in the hf[] 'display' field.

------------------------------------------------------------------------
r41397 | wmeier | 2012-03-07 08:01:31 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.h

Add editor modelines; Fix some indentation.

------------------------------------------------------------------------
r41396 | wmeier | 2012-03-07 07:39:39 -0800 (Wed, 07 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-homeplug-av.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-rtcp.c

Fix incorrect packet-details display of certain 1 bit FT_BOOLEAN fields.
(Use a valid 'parent field width' in the hf[] 'display' field.

------------------------------------------------------------------------
r41395 | etxrab | 2012-03-07 07:18:22 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ses.c

ISO SSAP: ActivityStart: Invalid decoding the activity parameter as a BER Integer - decode as bytes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=2873
------------------------------------------------------------------------
r41394 | etxrab | 2012-03-07 06:28:29 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-canopen.c
   M /trunk/epan/dissectors/packet-socketcan.c

From Yegor Yefremov: Add dissector for CANopen protocol https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6651 with some modifications
------------------------------------------------------------------------
r41393 | etxrab | 2012-03-07 04:06:16 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/asn1/gsm_map/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c

Location Number not decoded as per Q.763 https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6781
------------------------------------------------------------------------
r41392 | jmayer | 2012-03-07 03:58:05 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/main_window.cpp

Comment fix: i10n -> i18n

------------------------------------------------------------------------
r41391 | alagoutte | 2012-03-07 02:41:15 -0800 (Wed, 07 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.qt

Update Qt Documentation about translation/i18n

------------------------------------------------------------------------
r41390 | alagoutte | 2012-03-07 02:23:50 -0800 (Wed, 07 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/qt/CMakeLists.txt
   M /trunk/ui/qt/wireshark_application.cpp

From Joerg Mayer
Add i18n to Cmake

------------------------------------------------------------------------
r41389 | alagoutte | 2012-03-07 02:16:33 -0800 (Wed, 07 Mar 2012) | 12 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro
   M /trunk/ui/qt/byte_view_tab.cpp
   M /trunk/ui/qt/display_filter_combo.cpp
   M /trunk/ui/qt/display_filter_edit.cpp
   A /trunk/ui/qt/i18n.qrc
   M /trunk/ui/qt/interface_tree.cpp
   M /trunk/ui/qt/main.cpp
   M /trunk/ui/qt/main_status_bar.cpp
   M /trunk/ui/qt/main_welcome.cpp
   M /trunk/ui/qt/main_window.cpp
   M /trunk/ui/qt/proto_tree.cpp
   A /trunk/ui/qt/qtshark_fr.qm
   A /trunk/ui/qt/qtshark_fr.ts

Add i18n to QtShark
The goal is only to translate the Gui (Not dissector)
Actually, there is only a french translation.

To try, (if you are not French) launch qtshark with LANG=fr ./qtshark (in ui/qt folder)

Missing some feature :
* Add preference to select (force) your language
* Some Gui Text, it no available for translation
* Documentation about how to translate (Coming soon...)
* Your translation !

------------------------------------------------------------------------
r41388 | etxrab | 2012-03-07 01:35:44 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

USB: unknown GET DESCRIPTOR response triggers assert failure https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6826
------------------------------------------------------------------------
r41387 | etxrab | 2012-03-07 00:03:42 -0800 (Wed, 07 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/file_access.c

From Martin Kaiser: correct sorting for wiretap's file type list
------------------------------------------------------------------------
r41386 | wmeier | 2012-03-06 14:29:42 -0800 (Tue, 06 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Whitespace cleanup.

------------------------------------------------------------------------
r41385 | wmeier | 2012-03-06 14:12:42 -0800 (Tue, 06 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-adwin-config.c
   M /trunk/epan/dissectors/packet-ansi_801.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-batadv.c
   M /trunk/epan/dissectors/packet-bootp.c

Fix benign issue: For FT_BOOLEAN fields with a zero bitmask, use BASE_NONE for 'display'

------------------------------------------------------------------------
r41384 | wmeier | 2012-03-06 14:00:59 -0800 (Tue, 06 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipsafety.c

Reformat long lines...

------------------------------------------------------------------------
r41383 | wmeier | 2012-03-06 13:12:43 -0800 (Tue, 06 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipsafety.c

Fix incorrect packet-details display of certain 1 bit FT_BOOLEAN fields.
Also: reformat a few lines.

------------------------------------------------------------------------
r41382 | gerald | 2012-03-06 13:11:31 -0800 (Tue, 06 Mar 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/pcapio.c

Add a note about using GetSystemTimePreciseAsFileTime.

------------------------------------------------------------------------
r41381 | gerald | 2012-03-06 13:11:08 -0800 (Tue, 06 Mar 2012) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add an entry for annotations.

------------------------------------------------------------------------
r41380 | wmeier | 2012-03-06 12:56:51 -0800 (Tue, 06 Mar 2012) | 3 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

Add test for correct usage of hf[] FT_BOOLEAN 'display' field;
(Commented out until all the incorrect usages in Wireshark have been fixed).

------------------------------------------------------------------------
r41379 | wmeier | 2012-03-06 12:51:50 -0800 (Tue, 06 Mar 2012) | 8 lines
Changed paths:
   M /trunk/doc/README.developer

Emphasize corrext usage of FT_BOOLEAN 'display' field.
Specificaly:
 For a field type FT_BOOLEAN:
 - If the bitmask field is zero, then the 'display' field
   must be 'BASE_NONE';
 - If the bitmask field is non-zero, then the 'display' field
   must be the field-width of the parent bit field.

------------------------------------------------------------------------
r41378 | wmeier | 2012-03-06 12:11:43 -0800 (Tue, 06 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Fix incorrect packet-details display of a 1 bit FT_BOOLEAN field.

------------------------------------------------------------------------
r41377 | wmeier | 2012-03-06 09:33:35 -0800 (Tue, 06 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-slowprotocols.c

Use tvb_new_subset_remaining(...) rather than tvb_new_subset(...,-1,-1);
Fix up a number of the comments;
Use #if 0/#endif rather than /* */ to comment out code;
Do some minor reformatting.

------------------------------------------------------------------------
r41376 | wmeier | 2012-03-06 09:24:21 -0800 (Tue, 06 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

Use tvb_new_subset_remaining(...) rather than tvb_new_subset(...,-1,-1).

------------------------------------------------------------------------
r41375 | wmeier | 2012-03-06 09:11:01 -0800 (Tue, 06 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_mac.c
   M /trunk/epan/dissectors/packet-umts_mac.h

Use tvb_new-subset_remaining(...) rather than tvb_new_subset(...,-1,-1);
Add an additional note about duplicate filter names in the hf[] array;
Convert "4 space tabs" to 4 spaces.

------------------------------------------------------------------------
r41374 | wmeier | 2012-03-06 08:58:09 -0800 (Tue, 06 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-atmtcp.c
   M /trunk/epan/dissectors/packet-bmc.c
   M /trunk/epan/dissectors/packet-dvbci.c
   M /trunk/epan/dissectors/packet-eigrp.c
   M /trunk/epan/dissectors/packet-etherip.c
   M /trunk/epan/dissectors/packet-gmrp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-ipsec-udp.c
   M /trunk/epan/dissectors/packet-knet.c
   M /trunk/epan/dissectors/packet-lisp-data.c
   M /trunk/epan/dissectors/packet-lisp.c
   M /trunk/epan/dissectors/packet-mactelnet.c
   M /trunk/epan/dissectors/packet-mp2t.c
   M /trunk/epan/dissectors/packet-mux27010.c
   M /trunk/epan/dissectors/packet-netmon-802_11.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-scop.c
   M /trunk/epan/dissectors/packet-tdmoe.c
   M /trunk/epan/dissectors/packet-tr.c
   M /trunk/epan/dissectors/packet-trill.c

Use tvb_new_subset_remaining() rather than tvb_new_subset();
#include <styring.h> not req'd (in a few cases);
Minor reformating & whitespace cleanup.

------------------------------------------------------------------------
r41373 | martinm | 2012-03-06 05:56:02 -0800 (Tue, 06 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

Call X2AP dissector.

------------------------------------------------------------------------
r41371 | etxrab | 2012-03-06 01:25:53 -0800 (Tue, 06 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

From Steve Magnani: USB: incorrect decoding of Endpoint-targeted class-specific SETUP https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6910
------------------------------------------------------------------------
r41370 | etxrab | 2012-03-06 01:24:49 -0800 (Tue, 06 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

Try to make the buildbot happy
------------------------------------------------------------------------
r41369 | etxrab | 2012-03-06 01:16:50 -0800 (Tue, 06 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

From Martin Kaiser: capture dialogue: unitialized pointer is dereferenced, assigning an arbitrary dlt to a capture interface https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6914
------------------------------------------------------------------------
r41368 | etxrab | 2012-03-06 01:02:06 -0800 (Tue, 06 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

From Mike Wakerly: Add wiretap suport for LINKTYPE_NFC_LLCP
------------------------------------------------------------------------
r41367 | etxrab | 2012-03-06 00:45:54 -0800 (Tue, 06 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

From Cal Turney: Try to fix the remaining warnings. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6883
------------------------------------------------------------------------
r41366 | wmeier | 2012-03-05 19:20:17 -0800 (Mon, 05 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aruba-papi.c
   M /trunk/epan/dissectors/packet-atalk.c

Use tvb_new_subset_remaining() rather than tvb_new_subset();
Do minir whitespace cleanup.

------------------------------------------------------------------------
r41365 | wmeier | 2012-03-05 18:28:04 -0800 (Mon, 05 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-6lowpan.c

Use tvb_new_subset_remaining() instead of tvb_new_subset();
Reformat some long lines.

------------------------------------------------------------------------
r41364 | morriss | 2012-03-05 18:27:29 -0800 (Mon, 05 Mar 2012) | 3 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

Prohibit using anything other than FT_BOOLEANs with true_false_strings.
Prohibit using FT_BOOLEANS with value_strings.

------------------------------------------------------------------------
r41363 | morriss | 2012-03-05 18:19:23 -0800 (Mon, 05 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipsafety.c
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_abis_om2000.c

Don't use FT_BOOLEAN with value_strings: the code to generate
representations of former is expecting true_false_strings--which are quite
different than the latter.

------------------------------------------------------------------------
r41362 | morriss | 2012-03-05 18:04:10 -0800 (Mon, 05 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c
   M /trunk/epan/dissectors/packet-gsm_bsslap.c
   M /trunk/epan/dissectors/packet-ieee80211.c

Don't use FT_*INT with true_false strings: the code to generate
representations of former is expecting value_strings--which are quite
different than the latter.

------------------------------------------------------------------------
r41361 | morriss | 2012-03-05 17:55:21 -0800 (Mon, 05 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipsafety.c
   M /trunk/epan/dissectors/packet-enip.c

Don't use FT_*INT with true_false strings: the code to generate
representations of former is expecting value_strings--which are quite
different than the latter.

------------------------------------------------------------------------
r41360 | jmayer | 2012-03-05 14:13:09 -0800 (Mon, 05 Mar 2012) | 3 lines
Changed paths:
   M /trunk/CPackConfig.txt

Binary and source tarballs should be compressed with bzip2 only
(xz is not an options that cmake offers).

------------------------------------------------------------------------
r41359 | morriss | 2012-03-05 13:59:52 -0800 (Mon, 05 Mar 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua3g.c

Fix the infinite-loop fuzz failure reported in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6907 :

Don't try to display tone entries if there are none (but there is length for
them).  Could/should be an expert_info.

------------------------------------------------------------------------
r41358 | wmeier | 2012-03-05 12:50:25 -0800 (Mon, 05 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

Fix filter name: "iee17221.channels" --> "ieee17221.channels"

------------------------------------------------------------------------
r41357 | wmeier | 2012-03-05 10:57:18 -0800 (Mon, 05 Mar 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_abis_om2000.c

Various changes:
- Use proper proto_tree_add_item() 'encoding' arg (instead of TRUE/FALSE);
- Call col_append_fstr() even when 'tree==NULL';
- Use value_string_ext to access the larger value_string tables;
- Handle tvb_reported_length() can return -1;
- Remove 'set but never used' variable and associated line of code;
- Remove unneeded #include <prefs.h>;
- Remove empty proto_reg_handoff();
- Do minor whitespace cleanup.

------------------------------------------------------------------------
r41356 | etxrab | 2012-03-05 05:34:55 -0800 (Mon, 05 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/expert_comp_dlg.c

Use a dedicated treview for packet comments.
------------------------------------------------------------------------
r41355 | etxrab | 2012-03-05 04:06:26 -0800 (Mon, 05 Mar 2012) | 27 lines
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

From Cal Turney:
Bugs in the tshark '-z io,stat' output:
1: The LOAD stat in the last row of the output is inaccurate because rpc.time
is divided by the full interval rather than limiting it to the capture
duration.
2: An The empty comma field (for outputting total frames and bytes) is ignored
when it is the first field in the command.
3: Intervals at the end of capture that contain no data are not displayed. Such
intervals are as important to see as those (zero data intervals) that occur
earlier in the capture. 
4: Floating point numbers are not properly aligned under their column headers.

Enhancements to '-z io,stat' output:
1. Column widths are determined by the maximum magnitude of their values rather
than set to a fixed width of 15 chars which allows for more stats to be
displayed per row without wrapping. 
2. To improve readability, filters wrap at 102 chars or the table width,
whichever is greater, and wrap on the nearest space. An option can be added to
alter the 102-char limit. 
3. Column numbers begin at 1 instead of 0.     
4. The columns and entire output are enclosed in a border for improved
presentability in reports. The table can be imported into a spreadsheet by
specifying the vertical bar as the data delimiter.

"Fixed" compiling on Ubuntu

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6883
------------------------------------------------------------------------
r41354 | alagoutte | 2012-03-05 01:50:42 -0800 (Mon, 05 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-erf.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41353 | alagoutte | 2012-03-05 01:49:37 -0800 (Mon, 05 Mar 2012) | 10 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-pcp.c

From Ryan Doyle via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6874
New dissector: performance co-pilot protocol

Attached patch implements dissection of the Performance Co-Pilot (PCP) protocol.

From me :
* Add Wireshark Modelines
* Fix encoding args
* Fix Clang Warning

------------------------------------------------------------------------
r41352 | etxrab | 2012-03-05 01:32:21 -0800 (Mon, 05 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Use correct lenght when writing if_filter_str.
------------------------------------------------------------------------
r41351 | etxrab | 2012-03-05 01:21:36 -0800 (Mon, 05 Mar 2012) | 1 line
Changed paths:
   M /trunk/pcapio.c
   M /trunk/wiretap/pcapng.c

Fix calculation of pading for if_filter_str.
------------------------------------------------------------------------
r41350 | etxrab | 2012-03-05 00:34:36 -0800 (Mon, 05 Mar 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/mp2t.c

From Martin Kaiser:
wiretap mpeg2 ts: eof vs short read
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6909
------------------------------------------------------------------------
r41349 | etxrab | 2012-03-05 00:30:39 -0800 (Mon, 05 Mar 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/mp2t.c

From Martin Kaiser:
wiretap mpeg2 ts: more thorough check for sync byte.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6908
------------------------------------------------------------------------
r41347 | guy | 2012-03-04 22:43:44 -0800 (Sun, 04 Mar 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Fix comment.

------------------------------------------------------------------------
r41346 | wmeier | 2012-03-04 16:46:31 -0800 (Sun, 04 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t30.c

Trust but verify that there's no g_snprintf() buffer overflow.

------------------------------------------------------------------------
r41345 | wmeier | 2012-03-04 16:01:28 -0800 (Sun, 04 Mar 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-erf.c
   D /trunk/epan/dissectors/packet-erf.h

Cleanup:
- packet-erf.h not used elsewhere; move to packet-erf.c;
- reformat long lines;
- minor code re-arrangement;
- whitespace cleanup.

------------------------------------------------------------------------
r41344 | wmeier | 2012-03-04 15:34:58 -0800 (Sun, 04 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-erf.c

Fix bugs in buffer overflow checking used with calls to g_snprintf();

------------------------------------------------------------------------
r41343 | wmeier | 2012-03-04 15:01:39 -0800 (Sun, 04 Mar 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

(Trivial) Fix a typo.

------------------------------------------------------------------------
r41342 | guy | 2012-03-04 12:49:17 -0800 (Sun, 04 Mar 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Squelch a can't-really-happen uninitialized reference warning.

------------------------------------------------------------------------
r41341 | etxrab | 2012-03-04 11:31:33 -0800 (Sun, 04 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Use parentheses
------------------------------------------------------------------------
r41340 | etxrab | 2012-03-04 11:03:03 -0800 (Sun, 04 Mar 2012) | 1 line
Changed paths:
   M /trunk/doc/README.developer

forgotten update
------------------------------------------------------------------------
r41339 | etxrab | 2012-03-04 11:01:14 -0800 (Sun, 04 Mar 2012) | 1 line
Changed paths:
   M /trunk/pcapio.c
   M /trunk/summary.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/wtap.h

if_filter isn't a string per se,The first byte of the Option Data keeps a code of the filter used
------------------------------------------------------------------------
r41338 | etxrab | 2012-03-04 08:16:03 -0800 (Sun, 04 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser: DVB-CI authentication resource https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6905
------------------------------------------------------------------------
r41337 | etxrab | 2012-03-04 08:07:24 -0800 (Sun, 04 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c

"From Jan Šafránek: Add support for AES in Microsoft Network Logon Negotiation options https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6895"
------------------------------------------------------------------------
r41334 | gerald | 2012-03-04 07:03:37 -0800 (Sun, 04 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-03-04]
------------------------------------------------------------------------
r41332 | guy | 2012-03-03 18:20:25 -0800 (Sat, 03 Mar 2012) | 11 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Make sure all names in NRB records are null-terminated; report an error
if they're not.  Also report an error for zero-length names.

Handle multiple names per IP address - the pcap-NG spec says "one or
more zero-terminated strings containing the DNS entries for that
address."

Use a Buffer to hold NRB records, so there's no maximum size (well,
there is a maximum size, because the record length is 16 bits, but let's
not allocate 64KiB on the stack if we don't have to).

------------------------------------------------------------------------
r41331 | wmeier | 2012-03-03 13:58:38 -0800 (Sat, 03 Mar 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

Change all hf[] FT_UINT? fields referencing 'avp_bool_vals' to be FT_BOOLEAN fields.
#include <stdio.h> not req'd;
Add editor modelines for "3 space" indentation.

------------------------------------------------------------------------
r41330 | etxrab | 2012-03-03 08:17:20 -0800 (Sat, 03 Mar 2012) | 1 line
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/wiretap/pcapng.c

From Jose Pedro Oliveira: Fix typos
------------------------------------------------------------------------
r41329 | rbalint | 2012-03-03 07:40:38 -0800 (Sat, 03 Mar 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/gui_utils.c

Use 'wireshark' icon from theme

This makes Wireshark able to use SVG icon when it is installed
------------------------------------------------------------------------
r41328 | guy | 2012-03-02 16:14:16 -0800 (Fri, 02 Mar 2012) | 3 lines
Changed paths:
   M /trunk/editcap.c

Use wtap_dump_open_ng(), so we preserve all the interfaces in pcap-NG
files.

------------------------------------------------------------------------
r41327 | guy | 2012-03-02 16:13:25 -0800 (Fri, 02 Mar 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Don't look at the interface_id field of the packet header if
WTAP_HAS_INTERFACE_ID isn't set in the presence flags.

------------------------------------------------------------------------
r41326 | rbalint | 2012-03-02 15:31:48 -0800 (Fri, 02 Mar 2012) | 1 line
Changed paths:
   M /trunk/image/wsicon.svg
   M /trunk/image/wsiconcap.svg

Make SVG images useable as icons
------------------------------------------------------------------------
r41325 | morriss | 2012-03-02 14:24:12 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

Don't add an FT_BYTES with proto_tree_add_uint().

------------------------------------------------------------------------
r41324 | morriss | 2012-03-02 12:17:36 -0800 (Fri, 02 Mar 2012) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

Fix a few bugs found by Clang analysis:

packet-ieee17221.c:3123:10: warning: Value stored to 'mr_offset' is never read
	- Put the offset increment inside the loop

packet-ieee17221.c:2888:10: warning: Value stored to 'mr_subtree' is never read
	 - Use the newly-created subtree (instead of the parent tree)

packet-ieee17221.c:2692:13: warning: Value stored to 'next_tvb' is never read
	- Use next_tvb (instead of the main tvb which doesn't start at the
	  correct offset)

------------------------------------------------------------------------
r41323 | etxrab | 2012-03-02 05:53:30 -0800 (Fri, 02 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/expert_comp_dlg.c

Typo
------------------------------------------------------------------------
r41322 | etxrab | 2012-03-02 05:31:16 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/expert.c
   M /trunk/epan/proto.h
   M /trunk/ui/gtk/expert_comp_dlg.c
   M /trunk/ui/gtk/expert_comp_table.c
   M /trunk/ui/gtk/main_proto_draw.c
   M /trunk/ui/gtk/main_proto_draw.h

Use the expert system to show packet comments.
The packet comment widget should be replaced by a ListView with two columns,  packet no and Comment.
------------------------------------------------------------------------
r41321 | guy | 2012-03-02 03:41:50 -0800 (Fri, 02 Mar 2012) | 4 lines
Changed paths:
   M /trunk/cfile.h

Update comment - now that we support adding comments to files, a capture
that we've saved to a particular path, or that we've read in, could
still be unsaved if we add comments to it.

------------------------------------------------------------------------
r41320 | guy | 2012-03-02 03:36:44 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/file.c

Fix indentation.

------------------------------------------------------------------------
r41319 | etxrab | 2012-03-02 03:25:17 -0800 (Fri, 02 Mar 2012) | 1 line
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-ldap.c

Remove now unused variables.
------------------------------------------------------------------------
r41318 | alagoutte | 2012-03-02 03:11:59 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aruba-adp.c

Fix typo and add Modelines information

------------------------------------------------------------------------
r41317 | alagoutte | 2012-03-02 03:10:08 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41316 | alagoutte | 2012-03-02 03:09:47 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-uma.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41315 | alagoutte | 2012-03-02 03:09:34 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41314 | alagoutte | 2012-03-02 03:09:15 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netmon-802_11.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41313 | alagoutte | 2012-03-02 03:08:49 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41312 | alagoutte | 2012-03-02 03:07:50 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bittorrent.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41311 | alagoutte | 2012-03-02 03:07:36 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hsrp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41310 | alagoutte | 2012-03-02 03:06:52 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sebek.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41309 | alagoutte | 2012-03-02 03:06:37 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bjnp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41308 | alagoutte | 2012-03-02 03:06:17 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-applemidi.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41307 | alagoutte | 2012-03-02 03:05:50 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41306 | alagoutte | 2012-03-02 03:05:23 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-6lowpan.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41305 | alagoutte | 2012-03-02 03:05:08 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41304 | alagoutte | 2012-03-02 03:04:51 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipsafety.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41303 | alagoutte | 2012-03-02 03:04:31 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp-midi.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41302 | alagoutte | 2012-03-02 03:04:09 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-acn.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41301 | alagoutte | 2012-03-02 03:03:46 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-actrace.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41300 | alagoutte | 2012-03-02 03:02:46 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/asn1/pres/packet-pres-template.c
   M /trunk/epan/dissectors/packet-pres.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41299 | alagoutte | 2012-03-02 03:02:02 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/asn1/c1222/packet-c1222-template.c
   M /trunk/epan/dissectors/packet-c1222.c
   M /trunk/epan/dissectors/packet-c1222.h

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41298 | alagoutte | 2012-03-02 03:00:24 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ldap/ldap.cnf
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/epan/dissectors/packet-ldap.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41297 | alagoutte | 2012-03-02 02:58:29 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/asn1/p1/packet-p1-template.c
   M /trunk/epan/dissectors/packet-p1.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41296 | alagoutte | 2012-03-02 02:57:48 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/epan/dissectors/packet-gsm_map.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41295 | alagoutte | 2012-03-02 02:56:31 -0800 (Fri, 02 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls-pm.c

From Francesco Fondelli
Fix indent (use 80 columns) in MPLS PM dissector

------------------------------------------------------------------------
r41294 | guy | 2012-03-02 02:17:36 -0800 (Fri, 02 Mar 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/mp2t.c
   M /trunk/wiretap/mpeg.c

Flag mp2t file as really having only relative time stamps.  Put the
comment on its own line in mpeg.c as well.

------------------------------------------------------------------------
r41293 | guy | 2012-03-02 02:09:23 -0800 (Fri, 02 Mar 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/file_access.c

The additional_file_extensions member of struct file_type_info need not
and should not contain the extension in the default_file_extension
member - that's why the name starts with "additional".

------------------------------------------------------------------------
r41292 | guy | 2012-03-02 01:38:43 -0800 (Fri, 02 Mar 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Get rid of no-longer-needed argument to pcapng_write_section_header_block().

------------------------------------------------------------------------
r41291 | guy | 2012-03-02 01:30:10 -0800 (Fri, 02 Mar 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Skip an intermediating wtapng_block_t in the code path to write
Interface Description Blocks.

Fix a typo (if_fcslen was meant rather than opt_comment when writing the
FCS length).

------------------------------------------------------------------------
r41290 | etxrab | 2012-03-02 01:28:30 -0800 (Fri, 02 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/proto.c

Increase the size of the preallocated area for hf fields.
------------------------------------------------------------------------
r41289 | guy | 2012-03-02 01:03:26 -0800 (Fri, 02 Mar 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Simplify the code path for writing pcap-NG packets, and remove some
no-longer-needed elements from the wtapng_packet_t structure.

------------------------------------------------------------------------
r41286 | etxrab | 2012-03-01 22:02:28 -0800 (Thu, 01 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/CMakeLists.txt
   M /trunk/wiretap/Makefile.common
   M /trunk/wiretap/file_access.c
   A /trunk/wiretap/mp2t.c
   A /trunk/wiretap/mp2t.h
   M /trunk/wiretap/wtap.h

From Weston Schmidt: Add mpeg-ts capture file format support. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6894
------------------------------------------------------------------------
r41285 | wmeier | 2012-03-01 21:10:02 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee17221.c

Fix proto_tree_add_item() 'encoding' args.

------------------------------------------------------------------------
r41284 | guy | 2012-03-01 21:03:06 -0800 (Thu, 01 Mar 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Fill in the wtap_pkthdr fields in pcap_read_packet_block() and
pcap_read_simple_packet_block(), not in pcap_read() - the way the fields
are filled in differs between simple and non-simple packet blocks.

Clean up white space.

------------------------------------------------------------------------
r41283 | morriss | 2012-03-01 19:39:16 -0800 (Thu, 01 Mar 2012) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cip.h
   M /trunk/epan/dissectors/packet-cipmotion.c
   M /trunk/epan/dissectors/packet-cipsafety.c
   M /trunk/epan/dissectors/packet-enip.c

From Michael Mann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6893 :

The attached patches fix the following issues:

1. CIP-Motion shouldn't be a heuristic dissector.  CIP-Motion packets are
determined by specific fields in a CIP ForwardOpen.  I ran into situations
where CIP-Motion's "vague" heuristics incorrectly dissected packets meant for
CIP-Safety.  Of course this requires the ForwardOpen to be in the trace, but it
is the most deterministic way to have CIP-Motion packets.

2. Minor bugfix to the CIP-Safety dissector.  A couple of fields were
"missing", causing errant malformed packets.

------------------------------------------------------------------------
r41282 | morriss | 2012-03-01 19:30:30 -0800 (Thu, 01 Mar 2012) | 11 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-ieee1722.c
   A /trunk/epan/dissectors/packet-ieee17221.c

From Tom Bottom and Chris Pane via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6887 :

A new dissector for IEEE 1722.1.

From me: some code cleanup, including:
 - Get rid of some unnecessary local variable initializations.
 - Put all of 1722.1 under one subtree.
 - Just put if(tree)s in the top-level function rather than scattered throughout.
 - Remove a couple "set but not used" warnings (a couple are #if'd out).
 - Don't use deprecated functions.

------------------------------------------------------------------------
r41281 | wmeier | 2012-03-01 16:31:30 -0800 (Thu, 01 Mar 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/erf.c

AFAIKT there's no reason to #include <wsutil/crc32.c>; Include crc32.h like everyone else...
Also: Do some whitespace and indentation cleanup.

------------------------------------------------------------------------
r41280 | morriss | 2012-03-01 14:00:33 -0800 (Thu, 01 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/proto.c

(After a couple of years of warning about this), assert out if someone tries
to register an hf with an empty-string abbreviation.

------------------------------------------------------------------------
r41279 | wmeier | 2012-03-01 13:04:04 -0800 (Thu, 01 Mar 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ehdlc.c

Various Changes:
- Use proper 'encoding' arg (iso TRUE/FALSE) for proto_tree_add_item();
- Use correct value for tvb_new_subset() 'reported_length' arg;
- For proto_tree_add_protocol_format(): Use a length no greater than
    that actually available in the tvb. This allows dissection to attempt to
    proceed even if the length as obtained from the packet is too large.
- Remove 'set not not used' variable;
- Do minor reformatting and whitespace changes.

------------------------------------------------------------------------
r41278 | wmeier | 2012-03-01 09:39:22 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/gpl-template.txt

set 'svn:eol-style native' property

------------------------------------------------------------------------
r41277 | wmeier | 2012-03-01 09:35:16 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/display_filter_16.svg
   M /trunk/ui/qt/progress_overlay.svg
   M /trunk/ui/qt/toolbar_24.svg

Set svn:mime-type to image/svg+xml; delete svn:keywords

------------------------------------------------------------------------
r41276 | etxrab | 2012-03-01 09:19:57 -0800 (Thu, 01 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-noe.c

From Michael.
------------------------------------------------------------------------
r41275 | wmeier | 2012-03-01 09:19:38 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/color_dialog.cpp
   M /trunk/ui/qt/color_dialog.h
   M /trunk/ui/qt/color_utils.cpp
   M /trunk/ui/qt/color_utils.h
   M /trunk/ui/qt/display_filter_combo.cpp
   M /trunk/ui/qt/display_filter_combo.h
   M /trunk/ui/qt/display_filter_edit.cpp
   M /trunk/ui/qt/display_filter_edit.h
   M /trunk/ui/qt/fileset_dialog.cpp
   M /trunk/ui/qt/fileset_dialog.h
   M /trunk/ui/qt/interface_tree.cpp
   M /trunk/ui/qt/interface_tree.h
   M /trunk/ui/qt/main.cpp
   M /trunk/ui/qt/main_status_bar.cpp
   M /trunk/ui/qt/main_status_bar.h
   M /trunk/ui/qt/main_welcome.cpp
   M /trunk/ui/qt/main_welcome.h
   M /trunk/ui/qt/main_window.cpp
   M /trunk/ui/qt/main_window.h
   M /trunk/ui/qt/monospace_font.cpp
   M /trunk/ui/qt/monospace_font.h
   M /trunk/ui/qt/packet_list.cpp
   M /trunk/ui/qt/packet_list.h
   M /trunk/ui/qt/packet_list_model.cpp
   M /trunk/ui/qt/packet_list_model.h
   M /trunk/ui/qt/packet_list_record.cpp
   M /trunk/ui/qt/packet_list_record.h
   M /trunk/ui/qt/progress_dialog.cpp
   M /trunk/ui/qt/progress_dialog.h
   M /trunk/ui/qt/proto_tree.cpp
   M /trunk/ui/qt/proto_tree.h
   M /trunk/ui/qt/qt_ui_utils.cpp
   M /trunk/ui/qt/qt_ui_utils.h
   M /trunk/ui/qt/recent_file_status.cpp
   M /trunk/ui/qt/recent_file_status.h
   M /trunk/ui/qt/simple_dialog_qt.cpp
   M /trunk/ui/qt/simple_dialog_qt.h
   M /trunk/ui/qt/wireshark_application.cpp
   M /trunk/ui/qt/wireshark_application.h

Set svn:eol-style property to native

------------------------------------------------------------------------
r41274 | wmeier | 2012-03-01 09:12:18 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/capture_start_24.png
   M /trunk/ui/qt/capture_start_active_24.png
   M /trunk/ui/qt/capture_stop_24.png
   M /trunk/ui/qt/dfilter_apply_hover.png
   M /trunk/ui/qt/dfilter_apply_normal.png
   M /trunk/ui/qt/dfilter_apply_pressed.png
   M /trunk/ui/qt/dfilter_bookmark_hover.png
   M /trunk/ui/qt/dfilter_bookmark_normal.png
   M /trunk/ui/qt/dfilter_bookmark_pressed.png
   M /trunk/ui/qt/dfilter_dropdown.png
   M /trunk/ui/qt/dfilter_erase_active.png
   M /trunk/ui/qt/dfilter_erase_normal.png
   M /trunk/ui/qt/dfilter_erase_selected.png
   M /trunk/ui/qt/dfilter_refresh_active.png
   M /trunk/ui/qt/dfilter_refresh_normal.png
   M /trunk/ui/qt/progress_overlay.png

Set svn:mime-type to image/png iso application/octet-stream; remove svn:keywords

------------------------------------------------------------------------
r41273 | wmeier | 2012-03-01 08:45:33 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces-local.png
   M /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces-pipes.png
   M /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces-remote-plus.png
   M /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces-remote.png
   M /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces.png
   M /trunk/docbook/wsug_graphics/ws-capture-options-settings.png

Set property svn:mime-type to 'image/png' instead of 'application/octet-stream'

------------------------------------------------------------------------
r41272 | morriss | 2012-03-01 08:42:49 -0800 (Thu, 01 Mar 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/dfilter_expr_dlg.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6891 :

Handle generating selected values for hf's with BASE_DEC_HEX and BASE_HEX_DEC.

------------------------------------------------------------------------
r41271 | etxrab | 2012-03-01 08:32:24 -0800 (Thu, 01 Mar 2012) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-noe.c

See if this solves:
> packet-noe.c: In function 'decode_utf8':
> packet-noe.c:805: warning: integer constant is too large for 'long' 
> type
> packet-noe.c:808: warning: integer constant is too large for 'long' 
> type
> packet-noe.c:814: warning: integer constant is too large for 'long' 
> type
> packet-noe.c:817: warning: integer constant is too large for 'long' 
> type
> packet-noe.c:818: warning: integer constant is too large for 'long' 
> type
------------------------------------------------------------------------
r41270 | morriss | 2012-03-01 08:09:12 -0800 (Thu, 01 Mar 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Add packet-uaudp.h to list of header files (and thus to the source distribution)
------------------------------------------------------------------------
r41269 | morriss | 2012-03-01 08:03:42 -0800 (Thu, 01 Mar 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

#if out setting the help buttons' callbacks to NULL to avoid GLib-Object-CRITICAL warnings.
------------------------------------------------------------------------
r41268 | morriss | 2012-03-01 07:57:39 -0800 (Thu, 01 Mar 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Keep track of whether we have a "Edit Capture Comment" dialog open.  If we do,
don't open another one.

Make a couple globals static.

------------------------------------------------------------------------
r41267 | tuexen | 2012-03-01 07:50:43 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c

Fix CID 473 and 474.

------------------------------------------------------------------------
r41266 | etxrab | 2012-03-01 07:23:05 -0800 (Thu, 01 Mar 2012) | 14 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-noe.c
   M /trunk/epan/dissectors/packet-ua.c
   A /trunk/epan/dissectors/packet-ua3g.c
   A /trunk/epan/dissectors/packet-uasip.c
   M /trunk/epan/dissectors/packet-uaudp.c
   A /trunk/epan/dissectors/packet-uaudp.h

From Lars Ruoff:
Dissector for Alcatel-Lucent Enterprise Universal Alcatel- and NOE protocol, take II.
families.
Meant as a replacement for existing UA-dissector in trunk because of better
feature set:
- latest protocol specifiaction
- more detailed dissection and filtering possibilities on subprotocols
- RTP stream setup
- NOE over SIP

Lars Ruoff
On behalf of Alcatel-Lucent Enterprise

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6844
------------------------------------------------------------------------
r41265 | tuexen | 2012-03-01 07:10:45 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

Fix CID 1373.

------------------------------------------------------------------------
r41264 | tuexen | 2012-03-01 06:57:14 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Fix CID 1385.

------------------------------------------------------------------------
r41263 | tuexen | 2012-03-01 06:51:26 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Fix CID 354.

------------------------------------------------------------------------
r41262 | etxrab | 2012-03-01 06:25:03 -0800 (Thu, 01 Mar 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls-pm.c

packet-mpls-pm.c(616) : error C2220: warning treated as error - no 'object' file generated
packet-mpls-pm.c(616) : warning C4098: 'dissect_mpls_pm_dlm' : 'void' function returning a value
packet-mpls-pm.c(623) : warning C4098: 'dissect_mpls_pm_ilm' : 'void' function returning a value
------------------------------------------------------------------------
r41261 | alagoutte | 2012-03-01 05:41:02 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-9p.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41260 | alagoutte | 2012-03-01 05:36:18 -0800 (Thu, 01 Mar 2012) | 10 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-mpls-pm.c
   M /trunk/epan/dissectors/packet-mpls.c

From Francesco Fondelli via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6881
Support for MPLS Packet Loss and Delay Measurement, RFC 6374

Support for MPLS Packet Loss and Delay Measurement, RFC 6374.
Any packetformat is supported: DLM, ILM, DM, DLM+DM and ILM+DM.

From me :
* Prefer proto_tree_add_item when it is possible
* add Modelines information

------------------------------------------------------------------------
r41259 | etxrab | 2012-03-01 05:31:40 -0800 (Thu, 01 Mar 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Read the complete NRB.
#Backport
------------------------------------------------------------------------
r41258 | etxrab | 2012-03-01 02:13:02 -0800 (Thu, 01 Mar 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Add debuginfo
------------------------------------------------------------------------
r41257 | alagoutte | 2012-03-01 01:11:08 -0800 (Thu, 01 Mar 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipmotion.c

From Don Westman via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6889
CIP Motion parsing of set axis attribute list request is messing up attr data

parsing a CIP Motion 'Set Axis Attribute List' Request returns correct data for attribute ID, dimension and element size but 'attribute data' field retrieves the same data for each attribute in the list rather than the real data sent in the request.

From me :
Fix the typo error (use the wrong offset variable, need to use local_offset variable)



------------------------------------------------------------------------
r41256 | etxrab | 2012-02-29 23:39:54 -0800 (Wed, 29 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-pppoe.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

From Reinhard Speyerer: Adding support for LINKTYPE_PPP_ETHER/DLT_PPP_ETHER
------------------------------------------------------------------------
r41255 | etxrab | 2012-02-29 23:01:15 -0800 (Wed, 29 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h

From Mike Morrin: A small patch to correct the name of the function proto_tree_add_split_bits_item_ret_val()
------------------------------------------------------------------------
r41254 | wmeier | 2012-02-29 18:53:38 -0800 (Wed, 29 Feb 2012) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake

CVARSDLL hasn't been used (is undefined) for a while....
(This commit should have been part of SVNB #41180).

------------------------------------------------------------------------
r41253 | morriss | 2012-02-29 18:50:16 -0800 (Wed, 29 Feb 2012) | 17 lines
Changed paths:
   M /trunk/epan/address.h
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6890 :

The attached patch for the DVB-CI dissector creates a circuit for each DVB-CI
session, using the session number as circuit id.

The DVB-CI session commands are:

- open_session_request(resource_id)
- session_opened(resource_id, newly assigned session number)
- payload transfer(session_number, payload data)
- close session(session_number)

For now, the circuit will store the resource id and make it available (as a
generated item) to subsequent packets that contain only the session number.
Doing this, the resource id (which is like a tcp/udp port) can be used for
filtering.

------------------------------------------------------------------------
r41252 | wmeier | 2012-02-29 18:43:07 -0800 (Wed, 29 Feb 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

Update clean_setup list of win32-libs to be deleted.

------------------------------------------------------------------------
r41251 | gerald | 2012-02-29 18:18:35 -0800 (Wed, 29 Feb 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Another small commit to test migration.

------------------------------------------------------------------------
r41250 | martinm | 2012-02-29 15:05:27 -0800 (Wed, 29 Feb 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c

Add a checkbox to allow MAC SRs to be included in generated filter
expressions.

------------------------------------------------------------------------
r41249 | etxrab | 2012-02-29 12:38:39 -0800 (Wed, 29 Feb 2012) | 6 lines
Changed paths:
   M /trunk/doc/README.developer
   M /trunk/epan/dissectors/packet-csn1.c
   M /trunk/epan/dissectors/packet-csn1.h

From Mike Morrin:
The attached patches add the uses
proto_tree_add_split_bits_ret_val()
proto_tree_add_split_bits_crumb()

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6885
------------------------------------------------------------------------
r41248 | gerald | 2012-02-29 12:32:12 -0800 (Wed, 29 Feb 2012) | 4 lines
Changed paths:
   M /trunk/dumpcap.c

Add a comment noting that we need to add support for files with
nanosecond timestamps. (Also test the recent anonymous repository
migration.)

------------------------------------------------------------------------
r41247 | tuexen | 2012-02-29 10:04:23 -0800 (Wed, 29 Feb 2012) | 4 lines
Changed paths:
   M /trunk/dumpcap.c

Don't use deprecated API on glib 2.31.18 and higher.
This should fix
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6884

------------------------------------------------------------------------
r41246 | etxrab | 2012-02-29 09:13:43 -0800 (Wed, 29 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h

From Mike Morrin:
The attached patches add the ability to dissect split bit-strings as discussed under bug 6797.
proto_tree_add_split_bits_ret_val()
proto_tree_add_split_bits_crumb()
------------------------------------------------------------------------
r41245 | etxrab | 2012-02-29 09:01:57 -0800 (Wed, 29 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

From Pascal Quantin:
[NAS EPS] Fix description of EPS Attach information element.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6886
------------------------------------------------------------------------
r41244 | alagoutte | 2012-02-29 08:55:08 -0800 (Wed, 29 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41243 | alagoutte | 2012-02-29 08:54:29 -0800 (Wed, 29 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro

Fix compile for QtShark (../../util.c => ../../ui/util.c)

------------------------------------------------------------------------
r41242 | etxrab | 2012-02-29 08:51:32 -0800 (Wed, 29 Feb 2012) | 6 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/summary.c
   M /trunk/ui/gtk/edit_packet_comment_dlg.c
   M /trunk/ui/gtk/edit_packet_comment_dlg.h
   M /trunk/ui/gtk/main_statusbar.c
   M /trunk/wiretap/wtap.c

- Add a LED in the statusbar to indicate that capture comments exists,
 clickable to open an edit window.
- Add checks for NULL pointers.

Help with a different color LED possibly with Jeff's (c) in it apreceated.
Should the LED be placed elsewhere or the whole thing done differently?
------------------------------------------------------------------------
r41241 | morriss | 2012-02-29 07:28:20 -0800 (Wed, 29 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

Revert 41240, 41239, 41234, 41233, and (finally) 41231.  Every time I fix a warning, 3 more pop up.  Some of the uninitialized-variable ones look genuine and figuring them out would take a while.
------------------------------------------------------------------------
r41240 | etxrab | 2012-02-29 07:22:33 -0800 (Wed, 29 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

Remove the offending %s for now.
------------------------------------------------------------------------
r41239 | morriss | 2012-02-29 07:04:06 -0800 (Wed, 29 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

Don't use itoa().  It still doesn't compile due to a format warning on line 760; like Martin, I'm not sure what is supposed to be there.
------------------------------------------------------------------------
r41238 | etxrab | 2012-02-29 06:50:02 -0800 (Wed, 29 Feb 2012) | 1 line
Changed paths:
   M /trunk/config.nmake

Revert the change of MSVC_VARIANT made by misstake.
------------------------------------------------------------------------
r41237 | etxrab | 2012-02-29 06:44:08 -0800 (Wed, 29 Feb 2012) | 1 line
Changed paths:
   M /trunk/config.nmake
   M /trunk/tools/win32-setup.sh

Use GTK 2.24.10 for win32.
------------------------------------------------------------------------
r41236 | etxrab | 2012-02-29 04:03:51 -0800 (Wed, 29 Feb 2012) | 1 line
Changed paths:
   M /trunk/config.nmake

Add the package version of GTK 2.24.10(commented out).
------------------------------------------------------------------------
r41235 | etxrab | 2012-02-29 03:56:36 -0800 (Wed, 29 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

Use GTK_COMBO_BOX_TEXT, compile failed when using GTK 2.24.10.
------------------------------------------------------------------------
r41234 | martinm | 2012-02-29 02:25:44 -0800 (Wed, 29 Feb 2012) | 13 lines
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

Fix another couple of warnings, but not sure what to do about the rest:

tap-iostat.c: In function ‘iostat_draw’:
tap-iostat.c:542:5: error: implicit declaration of function ‘itoa’
tap-iostat.c:756:9: error: too few arguments for format
tap-iostat.c:756:9: error: too few arguments for format

itoa() could be converted into a g_snprintf(), but the buffer used is only
one character long.  Is that right?

For the printf() format one, I'm not sure what was intended.


------------------------------------------------------------------------
r41233 | martinm | 2012-02-29 02:19:32 -0800 (Wed, 29 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

Fix several compiler warnings (a few more remain though).

------------------------------------------------------------------------
r41232 | etxrab | 2012-02-28 21:58:45 -0800 (Tue, 28 Feb 2012) | 1 line
Changed paths:
   M /trunk/doc/wireshark-filter.pod
   M /trunk/epan/dfilter/dfilter.c
   M /trunk/epan/dfilter/dfvm.c
   M /trunk/epan/dfilter/dfvm.h
   M /trunk/epan/dfilter/semcheck.c
   M /trunk/tools/dfilter-test.py

From Gilbert Ramirez: When filtering on a single-byte byte-array-slice, using a normal hex string would be nice
------------------------------------------------------------------------
r41231 | etxrab | 2012-02-28 21:49:18 -0800 (Tue, 28 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/cli/tap-iostat.c

From Cal Turney:io,stat LOAD error, comma field ignored, zero data intervals not displayed, enhanced output https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6883
------------------------------------------------------------------------
r41230 | wmeier | 2012-02-28 12:32:42 -0800 (Tue, 28 Feb 2012) | 7 lines
Changed paths:
   M /trunk/epan/tvbuff.c

From Mike Morrin: Fix for "The previous patch had an error and was returning too many bits."

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6878

From me: Correct the indentation to match the rest of the file.


------------------------------------------------------------------------
r41229 | martinm | 2012-02-28 11:01:24 -0800 (Tue, 28 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Show number of extensions in header root.

------------------------------------------------------------------------
r41228 | guy | 2012-02-28 10:31:19 -0800 (Tue, 28 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.c

Initialize "value" in _tvb_get_bits64().  Clean up indentation.

------------------------------------------------------------------------
r41227 | jmayer | 2012-02-28 09:44:49 -0800 (Tue, 28 Feb 2012) | 9 lines
Changed paths:
   M /trunk/epan/tvbuff.c

Fix several messages of type:
epan/tvbuff.c: In function ‘tvb_get_bits16’:
epan/tvbuff.c:1736:82: error: unused parameter ‘encoding’ [-Werror=unused-parameter]

Compilation still fails with:
epan/tvbuff.c: In function ‘_tvb_get_bits64’:
epan/tvbuff.c:1829:19: error: ‘value’ may be used uninitialized in this function [-Werror=uninitialized


------------------------------------------------------------------------
r41226 | etxrab | 2012-02-28 08:29:07 -0800 (Tue, 28 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

From Mike Morrin:
Overhaul of tvb_get_bitsxx() functions.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6878
------------------------------------------------------------------------
r41225 | morriss | 2012-02-28 08:08:47 -0800 (Tue, 28 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/Makefile.nmake

Another try: we're in epan here so getting to libwsutil and wiretap requires going up a directory; getting to epan things does not require 'epan' in the path.
------------------------------------------------------------------------
r41224 | morriss | 2012-02-28 07:04:45 -0800 (Tue, 28 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/Makefile.nmake

Remove an extraneous backslash
------------------------------------------------------------------------
r41223 | guy | 2012-02-28 01:00:05 -0800 (Tue, 28 Feb 2012) | 10 lines
Changed paths:
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/libwireshark.def
   M /trunk/epan/reassemble_test.c

OK, to heck with it - link reassemble_test with libwireshark.  Trying to
selectively pick up particular object files is just too much of a mess.

Alas, this requires that we add some additional symbols to the list
exported by libwireshark; the DCE RPC ones shouldn't be global, but
reassemble_test uses them, so....

Get rid of stubs in reassemble_test.c - they just stub out routines from
libwireshark, but that's not necessary any more.

------------------------------------------------------------------------
r41222 | etxrab | 2012-02-28 00:45:03 -0800 (Tue, 28 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ecp-oui.c

Removed one variable to much.
------------------------------------------------------------------------
r41221 | etxrab | 2012-02-28 00:04:24 -0800 (Tue, 28 Feb 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ecp-oui.c
   M /trunk/epan/dissectors/packet-llc.c
   M /trunk/epan/dissectors/packet-lldp.c
   A /trunk/epan/dissectors/packet-lldp.h

From Mijo Safradin:
Add ECP VDP TLV dissector.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6849

Fixed encoding arguments, removed unused variables checkapi errors
etc.
------------------------------------------------------------------------
r41220 | etxrab | 2012-02-27 23:32:19 -0800 (Mon, 27 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iax2.c

From Sean Bright:
IAX2 trunk packets display misleading call information.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6818
------------------------------------------------------------------------
r41219 | guy | 2012-02-27 23:06:59 -0800 (Mon, 27 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.nmake

reassemble_test now requires mark_frame_as_depended_upon(), so it
requires packet.c.  (If it requires any more, we should just make it
link with libwireshark in its entirety.)

------------------------------------------------------------------------
r41218 | etxrab | 2012-02-27 22:05:32 -0800 (Mon, 27 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Packet comments are working
------------------------------------------------------------------------
r41217 | etxrab | 2012-02-27 22:04:02 -0800 (Mon, 27 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From Josip Medved: EAP-SIM and EAP-AKA are missing some attributes. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6877
------------------------------------------------------------------------
r41216 | morriss | 2012-02-27 19:19:49 -0800 (Mon, 27 Feb 2012) | 34 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/epan.c
   M /trunk/epan/frame_data.c
   M /trunk/epan/frame_data.h
   M /trunk/epan/libwireshark.def
   M /trunk/epan/packet.c
   M /trunk/epan/packet.h
   M /trunk/epan/packet_info.h
   M /trunk/epan/reassemble.c
   M /trunk/file.c
   M /trunk/packet-range.c
   M /trunk/packet-range.h
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/print_dlg.c
   M /trunk/ui/gtk/range_utils.c
   M /trunk/ui/gtk/range_utils.h
   M /trunk/ui/win32/file_dlg_win32.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3315 -
make Save-As/Displayed/All-Packets save not only the displayed packets but
also any other packets needed (e.g., for reassembly) to fully dissect the
displayed packets.

This works only for the "All packets" case; choosing only the Selected packet,
the Marked packets, or a range of packets would require actually storing which
packets depend on which (too much memory) or going through the packet list many
times (too slow).  Also, this behavior is always the case: you can't save the
displayed packets without their dependencies (I don't see why this would be
desirable).

So far this is done for SCTP and things using the reassembly routines (TCP has
been tested).

The Win32 dialog was modified but hasn't been tested yet.

One confusing aspect of the UI is that the Displayed count in the Save-As
dialog does not match the number of displayed packets.  (I tried renaming the
button "Displayed + Dependencies" but it looked too big.)  The tooltip tries
to explain this and the fact that this works only in the All-Packets case;
suggestions for improvement are welcome.


Implementation details:

Dissectors (or the reassembly code) can list frames which were needed to
build the current frame's tree.  If the current frame passes the display
filter then each listed frame is marked as "depended upon" (this takes up the
last free frame_data flag).

When performing a Save-As/Displayed/All-Packets then choose packets which
passed the dfilter _or_ are depended upon.

------------------------------------------------------------------------
r41215 | guy | 2012-02-27 17:11:11 -0800 (Mon, 27 Feb 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/ngsniffer.c

Some more details about REC_HEADER1 and REC_V2DESC; REC_HEADER1 doesn't
appear to contain anything of use to us - too random - but REC_V2DESC
might be worth converting into a comment.

------------------------------------------------------------------------
r41214 | guy | 2012-02-27 13:34:59 -0800 (Mon, 27 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_ipa.c

And more details.

------------------------------------------------------------------------
r41213 | guy | 2012-02-27 13:33:53 -0800 (Mon, 27 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_ipa.c

Give more details in comments.

------------------------------------------------------------------------
r41212 | morriss | 2012-02-27 11:05:55 -0800 (Mon, 27 Feb 2012) | 3 lines
Changed paths:
   M /trunk/doc/tshark.pod

Add documentation for the the tshark follow tcp/udp streams feature added
with https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6684

------------------------------------------------------------------------
r41211 | alagoutte | 2012-02-27 08:50:27 -0800 (Mon, 27 Feb 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.cnf
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41210 | alagoutte | 2012-02-27 08:48:29 -0800 (Mon, 27 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

From Steve Magnani via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6873
USB: SETUP information can be added to incorrect tree

------------------------------------------------------------------------
r41209 | alagoutte | 2012-02-27 08:43:18 -0800 (Mon, 27 Feb 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tpncp.c

From Alex Rodikov via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6871
TPNCP (proprietary Audiocodes) protocol dessector - wrong guint8 value presentation

The presentation of unsigned 8-bit integer is wrong. The (signed) gint8 is used which is displayed as unsigned integer (by proto_tree_add_uint) afterwards.
That causes wrong presentation of valus which bigger than 127.
Solution: New guint8 is introduced to present unsigned 8 bit integer value.

------------------------------------------------------------------------
r41208 | etxrab | 2012-02-27 07:38:34 -0800 (Mon, 27 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/new_packet_list.c

Mark the file as unsaved when updating packet comments.
------------------------------------------------------------------------
r41207 | etxrab | 2012-02-27 04:48:08 -0800 (Mon, 27 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtp-midi.c

More Warning fixes.
------------------------------------------------------------------------
r41206 | etxrab | 2012-02-27 04:13:06 -0800 (Mon, 27 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtp-midi.c

More warning fixes.
------------------------------------------------------------------------
r41205 | etxrab | 2012-02-27 03:48:38 -0800 (Mon, 27 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtp-midi.c

Try to fix warning: comparison between signed and unsigned.
------------------------------------------------------------------------
r41204 | etxrab | 2012-02-27 03:44:19 -0800 (Mon, 27 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtp-midi.c

Fix some unused parameter warnings etc.
------------------------------------------------------------------------
r41203 | etxrab | 2012-02-27 02:05:22 -0800 (Mon, 27 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

Error: Found deprecated APIs in packet-ssl-utils.c: dissector_add
------------------------------------------------------------------------
r41202 | etxrab | 2012-02-27 01:49:20 -0800 (Mon, 27 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-applemidi.c

packet-applemidi.c:296:33: error: unused variable ‘p_conv_data’
------------------------------------------------------------------------
r41201 | etxrab | 2012-02-27 01:30:26 -0800 (Mon, 27 Feb 2012) | 7 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cip.h
   A /trunk/epan/dissectors/packet-cipsafety.c
   A /trunk/epan/dissectors/packet-cipsafety.h
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-enip.h

From Michael Mann:
a dissector for the ODVA protocol: CIP Safety. More information
about the protocol can be found here: 

http://www.odva.org/Home/ODVATECHNOLOGIES/CIP/CIPTechnologyOverview/CIPSafety/CIPSafetyOverview/tabid/131/lng/en-US/Default.aspx

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6862
------------------------------------------------------------------------
r41200 | etxrab | 2012-02-27 01:18:53 -0800 (Mon, 27 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-applemidi.c
   A /trunk/epan/dissectors/packet-rtp-midi.c

From Tobias Erichsen:
RTP-MIDI - dissector for transmission of MIDI-commands via RTP (RFC 4695).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5451
------------------------------------------------------------------------
r41199 | cmaynard | 2012-02-26 16:25:41 -0800 (Sun, 26 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

Re-apply r40728 and fix Coverity CID 1371 UNINIT again.

------------------------------------------------------------------------
r41198 | etxrab | 2012-02-26 11:54:58 -0800 (Sun, 26 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

Mark the gile as unsaved if comments are edited
------------------------------------------------------------------------
r41197 | tuexen | 2012-02-26 09:54:32 -0800 (Sun, 26 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssh.c

Dissect SSH over SCTP when using the IANA assigned SCTP port 22.

------------------------------------------------------------------------
r41196 | jmayer | 2012-02-26 09:51:40 -0800 (Sun, 26 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Move the new files to the same places as in automake.

------------------------------------------------------------------------
r41195 | jmayer | 2012-02-26 09:30:38 -0800 (Sun, 26 Feb 2012) | 11 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ehdlc.c
   A /trunk/epan/dissectors/packet-gsm_abis_om2000.c
   M /trunk/epan/dissectors/packet-gsm_abis_oml.c
   M /trunk/epan/dissectors/packet-l2tp.c

Harald Welte <laforge@gnumonks.org>
via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6792

This is a new dissector for the non-standard Ericsson OM2000 protocol, as it is
used for the OML on A-bis of Ericsson RBS 2xxx BTSs.

It also includes a dissector for a shim-layer protocol that Ericsson uses for
IP-based A-bis like the RBS 2409.  As the protocol is not publicly documented,
I have invented the name "EHDLC" (Ericsson HLDC) for it.


------------------------------------------------------------------------
r41194 | etxrab | 2012-02-26 09:10:40 -0800 (Sun, 26 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Add entry for TPDU in the tree
------------------------------------------------------------------------
r41193 | etxrab | 2012-02-26 09:04:28 -0800 (Sun, 26 Feb 2012) | 1 line
Changed paths:
   M /trunk/summary.c
   M /trunk/summary.h
   M /trunk/ui/gtk/summary_dlg.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.def
   M /trunk/wiretap/wtap.h

Make it possible to edit capture comments
------------------------------------------------------------------------
r41190 | gerald | 2012-02-26 07:03:43 -0800 (Sun, 26 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-02-26]
------------------------------------------------------------------------
r41189 | tuexen | 2012-02-26 05:50:52 -0800 (Sun, 26 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

From Robin Seggelmann: Add support for RFC 6520.
From me: Some cleanup
Initial work was done by Denis Jaeger and
Lukas Scharlau, but the code got rewritten by Robin.

------------------------------------------------------------------------
r41188 | guy | 2012-02-26 02:20:40 -0800 (Sun, 26 Feb 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c
   M /trunk/wiretap/lanalyzer.c

For LANalyzer files, make the "File type name" be the file comment.

Display the file comment in the Summary dialog.

------------------------------------------------------------------------
r41187 | guy | 2012-02-26 00:02:02 -0800 (Sun, 26 Feb 2012) | 6 lines
Changed paths:
   M /trunk/summary.c
   M /trunk/summary.h
   M /trunk/ui/gtk/gsm_map_summary.c
   M /trunk/ui/gtk/mtp3_summary.c
   M /trunk/ui/gtk/summary_dlg.c

Suppress invalid or non-meaningful statistics - for example, without
time stamps on all packets in a set, you can't determine the start and
end time of the packets in the set (even one timestampless packet throws
the determination off - was that packet before the first time-stamped or
after the last time-stamped packet, or between them?).

------------------------------------------------------------------------
r41186 | guy | 2012-02-25 21:51:54 -0800 (Sat, 25 Feb 2012) | 7 lines
Changed paths:
   M /trunk/capinfos.c

Don't show time stamp-based information if we don't have it (now that we
know whether packets - or "packets" - have time stamps).

Show the time stamp order as "Unknown" if we don't have enough
information to determine whether it's certainly in order or out of order
(XXX - we should do that if we have only one packet that has a time stamp).

------------------------------------------------------------------------
r41185 | guy | 2012-02-25 15:24:34 -0800 (Sat, 25 Feb 2012) | 19 lines
Changed paths:
   M /trunk/epan/column-utils.c
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/frame_data.c
   M /trunk/epan/frame_data.h
   M /trunk/wiretap/5views.c
   M /trunk/wiretap/aethra.c
   M /trunk/wiretap/airopeek9.c
   M /trunk/wiretap/ascendtext.c
   M /trunk/wiretap/ber.c
   M /trunk/wiretap/btsnoop.c
   M /trunk/wiretap/catapult_dct2000.c
   M /trunk/wiretap/commview.c
   M /trunk/wiretap/cosine.c
   M /trunk/wiretap/csids.c
   M /trunk/wiretap/daintree-sna.c
   M /trunk/wiretap/dbs-etherwatch.c
   M /trunk/wiretap/dct3trace.c
   M /trunk/wiretap/erf.c
   M /trunk/wiretap/etherpeek.c
   M /trunk/wiretap/eyesdn.c
   M /trunk/wiretap/hcidump.c
   M /trunk/wiretap/i4btrace.c
   M /trunk/wiretap/ipfix.c
   M /trunk/wiretap/iptrace.c
   M /trunk/wiretap/iseries.c
   M /trunk/wiretap/k12.c
   M /trunk/wiretap/k12text.l
   M /trunk/wiretap/lanalyzer.c
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/mime_file.c
   M /trunk/wiretap/mpeg.c
   M /trunk/wiretap/netmon.c
   M /trunk/wiretap/netscaler.c
   M /trunk/wiretap/netscreen.c
   M /trunk/wiretap/nettl.c
   M /trunk/wiretap/network_instruments.c
   M /trunk/wiretap/netxray.c
   M /trunk/wiretap/ngsniffer.c
   M /trunk/wiretap/packetlogger.c
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/pppdump.c
   M /trunk/wiretap/radcom.c
   M /trunk/wiretap/snoop.c
   M /trunk/wiretap/tnef.c
   M /trunk/wiretap/toshiba.c
   M /trunk/wiretap/visual.c
   M /trunk/wiretap/vms.c
   M /trunk/wiretap/wtap.h

Add a presence flag field to the packet information structure filled in
by Wiretap, to indicate whether certain fields in that structure
actually have data in them.

Use the "time stamp present" flag to omit showing time stamp information
for packets (and "packets") that don't have time stamps; don't bother
working very hard to "fake" a time stamp for data files.

Use the "interface ID present" flag to omit the interface ID for packets
that don't have an interface ID.

We don't use the "captured length, separate from packet length, present"
flag to omit the captured length; that flag might be present but equal
to the packet length, and if you want to know if a packet was cut short
by a snapshot length, comparing the values would be the way to do that.

More work is needed to have wiretap/pcapng.c properly report the flags,
e.g. reporting no time stamp being present for a Simple Packet Block.

------------------------------------------------------------------------
r41184 | etxrab | 2012-02-25 00:20:50 -0800 (Sat, 25 Feb 2012) | 1 line
Changed paths:
   M /trunk/pcapio.c

From Jose Pedro Oliveira: pcapio is writing the if_speed value in the IDB_TSRESOL optiones
------------------------------------------------------------------------
r41183 | morriss | 2012-02-24 13:43:48 -0800 (Fri, 24 Feb 2012) | 4 lines
Changed paths:
   M /trunk/help/faq.py

As suggested by multipleinterfaces in http://ask.wireshark.org/questions/9194/can-i-recover-a-discarded-capture :

Add the location of the temporary file on Windows 7.

------------------------------------------------------------------------
r41182 | morriss | 2012-02-24 12:33:19 -0800 (Fri, 24 Feb 2012) | 13 lines
Changed paths:
   M /trunk/text2pcap.c
   M /trunk/ui/gtk/text_import.c

Revisit https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3161
and r39501:

Setting _XOPEN_SOURCE to 600 is only allowed on Solaris 10 if the compiler is
set to C99 mode.  Conversely (and as reported in the bug), simply defining it
(but with no value) is not allowed if the compiler *is* compiling to C99.

So, don't define _XOPEN_SOURCE at all on Solaris.  Keep defining it as 600 on
other OS's as (also) requested in that bug.

Maybe there's a cleaner way to do this but all of this is a "trickery" mess
anyway...

------------------------------------------------------------------------
r41181 | wmeier | 2012-02-24 11:02:28 -0800 (Fri, 24 Feb 2012) | 2 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

g_fprintf() & g_vfprintf() should not be used....

------------------------------------------------------------------------
r41180 | wmeier | 2012-02-24 08:23:38 -0800 (Fri, 24 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/dfilter/Makefile.nmake
   M /trunk/epan/dissectors/Makefile.nmake
   M /trunk/epan/ftypes/Makefile.nmake
   M /trunk/epan/wslua/Makefile.nmake
   M /trunk/epan/wspython/Makefile.nmake
   M /trunk/packaging/u3/tools/Makefile.nmake
   M /trunk/plugins/mate/Makefile.nmake
   M /trunk/plugins/wimaxasncp/Makefile.nmake
   M /trunk/ui/Makefile.nmake
   M /trunk/ui/cli/Makefile.nmake
   M /trunk/ui/gtk/Makefile.nmake
   M /trunk/ui/win32/Makefile.nmake
   M /trunk/wiretap/Makefile.nmake
   M /trunk/wsutil/Makefile.nmake

CVARSDLL hasn't been used (is undefined) for a while....

------------------------------------------------------------------------
r41179 | etxrab | 2012-02-24 07:57:56 -0800 (Fri, 24 Feb 2012) | 1 line
Changed paths:
   M /trunk/pcapio.c
   M /trunk/wiretap/pcapng.c

Fix a typo and revert previous.
------------------------------------------------------------------------
r41178 | etxrab | 2012-02-24 07:53:00 -0800 (Fri, 24 Feb 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Fix a typo.
------------------------------------------------------------------------
r41177 | etxrab | 2012-02-24 06:40:31 -0800 (Fri, 24 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip.c

From Martin Kaiser:
Get rid of an unused variable.
------------------------------------------------------------------------
r41176 | tuexen | 2012-02-24 05:13:21 -0800 (Fri, 24 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/summary_dlg.c

From Irene Ruengeler: Always show snaplen.

------------------------------------------------------------------------
r41175 | tuexen | 2012-02-24 05:05:33 -0800 (Fri, 24 Feb 2012) | 3 lines
Changed paths:
   M /trunk/summary.c

From Irene Ruengeler: Fix a bug where the interface
names are not shown during capturing.

------------------------------------------------------------------------
r41174 | tuexen | 2012-02-24 04:54:15 -0800 (Fri, 24 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main.c

From Irene Ruengeler: Whitespace changes.

------------------------------------------------------------------------
r41173 | alagoutte | 2012-02-24 00:18:30 -0800 (Fri, 24 Feb 2012) | 5 lines
Changed paths:
   A /trunk/epan/dissectors/packet-hdcp.h

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6838
Support HDCP version 1 over I2c

the attached patch adds support for HDCP version 1. This is the authentication that runs between your DVD/Bluray player and your TV when they're connected via an HDMI cable.

------------------------------------------------------------------------
r41172 | alagoutte | 2012-02-23 23:57:48 -0800 (Thu, 23 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-hdcp.c
   M /trunk/epan/dissectors/packet-i2c.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6838
Support HDCP version 1 over I2c

the attached patch adds support for HDCP version 1. This is the authentication that runs between your DVD/Bluray player and your TV when they're connected via an HDMI cable.

------------------------------------------------------------------------
r41171 | etxrab | 2012-02-23 21:50:47 -0800 (Thu, 23 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mip.c

From Robert Shade: Mobile IP NVSE (RFC3115) Decoding https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6868
------------------------------------------------------------------------
r41170 | etxrab | 2012-02-23 21:42:40 -0800 (Thu, 23 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/rtp_analysis.c

From Mark Cottrell: Attempting to view an RTP stream analysis graph causes program exit. https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6866
------------------------------------------------------------------------
r41169 | etxrab | 2012-02-23 21:39:13 -0800 (Thu, 23 Feb 2012) | 1 line
Changed paths:
   M /trunk/diameter/TGPPRx.xml
   M /trunk/diameter/dictionary.xml
   M /trunk/diameter/mobileipv4.xml

From Josip Medved: Diameter dictionary has few invalid gavp definitions https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6867
------------------------------------------------------------------------
r41168 | wmeier | 2012-02-23 21:17:46 -0800 (Thu, 23 Feb 2012) | 12 lines
Changed paths:
   M /trunk/editcap.c

Revert SVN #40866 (which used g_fprintf() in place of fprintf()).

Using g_fprintf() fails (crashes) on Windows because the Windows GLib DLL
is linked with (depends upon) MSVCRT while editcap is linked with
(depends upon) MSVCR90.

IOW: "You can't do that ... (on Windows)"

See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6695 (Comment 2)
for some additional information.


------------------------------------------------------------------------
r41167 | etxrab | 2012-02-23 13:29:13 -0800 (Thu, 23 Feb 2012) | 1 line
Changed paths:
   M /trunk/summary.c
   M /trunk/summary.h
   M /trunk/ui/gtk/summary_dlg.c

Add SHB info to Summary
------------------------------------------------------------------------
r41166 | etxrab | 2012-02-23 12:24:40 -0800 (Thu, 23 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

From Pascal Quantin [NAS EPS] Update Configuration Protocol description in PCO IE https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6865
------------------------------------------------------------------------
r41165 | tuexen | 2012-02-23 11:14:58 -0800 (Thu, 23 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

No debug output, please.

------------------------------------------------------------------------
r41164 | tuexen | 2012-02-23 11:14:14 -0800 (Thu, 23 Feb 2012) | 3 lines
Changed paths:
   M /trunk/summary.c

Fix the handling of snaplen.
While there fix some whitespace issues.

------------------------------------------------------------------------
r41163 | etxrab | 2012-02-23 07:40:31 -0800 (Thu, 23 Feb 2012) | 2 lines
Changed paths:
   M /trunk/summary.c
   M /trunk/summary.h
   M /trunk/ui/gtk/summary_dlg.c

Have the used interfaces show up if number of interfaces > 0.
(pcapng file).
------------------------------------------------------------------------
r41162 | etxrab | 2012-02-23 05:24:54 -0800 (Thu, 23 Feb 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/follow_tcp.c

From Dirk Leinenbach:
Follow TCP IPv6 - wrong hostname.

#BACKPORT
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6861
------------------------------------------------------------------------
r41161 | etxrab | 2012-02-23 05:10:59 -0800 (Thu, 23 Feb 2012) | 1 line
Changed paths:
   M /trunk/asn1/m3ap/M3AP-IEs.asn
   M /trunk/epan/dissectors/packet-m3ap.c

Fix a 3GPP specification error.
------------------------------------------------------------------------
r41160 | tuexen | 2012-02-23 04:57:17 -0800 (Thu, 23 Feb 2012) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

As discussed with Anders: Only write a single ISB at the end. Proivde
start/end time in the ISBs.

------------------------------------------------------------------------
r41159 | tuexen | 2012-02-23 03:55:24 -0800 (Thu, 23 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

interface id is 32-bit, not 64-bit.

------------------------------------------------------------------------
r41158 | etxrab | 2012-02-23 03:29:24 -0800 (Thu, 23 Feb 2012) | 13 lines
Changed paths:
   M /trunk/ui/gtk/main_proto_draw.c

From Kundok Park:
new_packet_list: crash in add_byte_views from decrypted zigbee data


The cause of the crash I saw was that the add_byte_views() function in
main_proto_draw.c relies on output from previous dissector run while the
function may eventually trigger dissector to run again which wipes out the
previous output.
The patch copies the output of the dissector before calling add_byte_tab() so
that even when add_byte_tab() updates the dissector output, the loop continues
with previous dissector output.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5130
------------------------------------------------------------------------
r41157 | etxrab | 2012-02-23 03:20:52 -0800 (Thu, 23 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

From Steve Magnani:
USB: Add dissection for Interface Association descriptor.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6842
------------------------------------------------------------------------
r41156 | etxrab | 2012-02-23 03:14:57 -0800 (Thu, 23 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb-ccid.c

From Tyson Key:
Clean up redundant Data handlers in the CCID dissector.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6860
------------------------------------------------------------------------
r41155 | martinm | 2012-02-23 03:03:30 -0800 (Thu, 23 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c

Move 'static' qualifier before 'const' in a couple of places. I didn't
know it mattered, but gcc warns.

------------------------------------------------------------------------
r41154 | martinm | 2012-02-23 02:55:57 -0800 (Thu, 23 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c

Mark some unused parameters. Still getting other warnings...

------------------------------------------------------------------------
r41152 | guy | 2012-02-23 02:03:16 -0800 (Thu, 23 Feb 2012) | 10 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Do a check of the block total length in pcapng_read_unknown_block().

That means we don't need to do the block length check in
pcapng_read_block(); each block type reader, including the one for
unknown block types, does a check that's as stringent as that block
length check or more stringent, which means any block whose length is
less than the minimum will fail with the same error in both cases.

Fix the message for a too-short NRB.

------------------------------------------------------------------------
r41151 | etxrab | 2012-02-23 01:12:30 -0800 (Thu, 23 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb-ccid.c

From Tyson Key:
Support for switching USB CCID PC_to_RDR_XfrBlock payload dissectors

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6853
------------------------------------------------------------------------
r41150 | etxrab | 2012-02-23 01:06:33 -0800 (Thu, 23 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

From Yaniv Kaul:
Enhance the Spice dissector - small additional dissections.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6857
------------------------------------------------------------------------
r41149 | etxrab | 2012-02-23 00:57:40 -0800 (Thu, 23 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c
   M /trunk/epan/dissectors/packet-csn1.h
   M /trunk/epan/dissectors/packet-gsm_a_rr.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

From Lei Chen:
a patch to support decode FDD_CELL_INFORMATION of "UTRAN FDD Description" in packet-gsm_rlcmac.c

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6856
------------------------------------------------------------------------
r41148 | etxrab | 2012-02-23 00:40:23 -0800 (Thu, 23 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h223.c

From Jeff Morriss:
H223: Buildbot crash output: fuzz-2012-01-25-22599.pcap

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6768
------------------------------------------------------------------------
r41146 | etxrab | 2012-02-22 21:29:28 -0800 (Wed, 22 Feb 2012) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

From Josip Medved: Add 3GPP AVP 1506 and 1507
------------------------------------------------------------------------
r41145 | guy | 2012-02-22 15:44:25 -0800 (Wed, 22 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Fix typo introduced by previous checkin.

------------------------------------------------------------------------
r41144 | etxrab | 2012-02-22 15:01:28 -0800 (Wed, 22 Feb 2012) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Added aplications and one AVP from Josip Medved
------------------------------------------------------------------------
r41143 | guy | 2012-02-22 10:32:43 -0800 (Wed, 22 Feb 2012) | 16 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Add sanity checks to make sure the claimed block size is big enough to:

	1) contain the block length fields and block type field;

	2) contain that plus the fixed-length portion of the block;

	3) for blocks that have a variable-length portion other than the
	   options, contain that variable-length portion.

Fixes a crash we're seeing with a bad pcap-NG file in the Wireshark
menagerie (7799-lastPacketWithoutComment.pcapng - the last packet's
block length is 128, but it claims to have 98 bytes of packet data,
which requires a 132-byte block).

Clean up white space (use 8-space tabs).

------------------------------------------------------------------------
r41141 | etxrab | 2012-02-22 08:06:02 -0800 (Wed, 22 Feb 2012) | 8 lines
Changed paths:
   M /trunk/diameter/dictionary.xml

From Josip Medved:
In line 4722 of dictionary.xml file there is comment:
<-- Requesting-Node-Type is from old (v8.1.0 - v8.2.0) versions of 29.272. -->

This is not a valid XML comment and that line should read:
<!-- Requesting-Node-Type is from old (v8.1.0 - v8.2.0) versions of 29.272. -->

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6858
------------------------------------------------------------------------
r41140 | etxrab | 2012-02-22 08:02:38 -0800 (Wed, 22 Feb 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Grr forgot debug flag  - again.
------------------------------------------------------------------------
r41139 | wmeier | 2012-02-22 07:47:30 -0800 (Wed, 22 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-e212.c

Whitespace cleanup: Convert 4 space tabs to spaces ...

------------------------------------------------------------------------
r41138 | wmeier | 2012-02-22 07:42:50 -0800 (Wed, 22 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvb-ipdc.c

Rename some enumeration constants; Do some minor code simplification & reformatting.

------------------------------------------------------------------------
r41137 | etxrab | 2012-02-22 06:41:02 -0800 (Wed, 22 Feb 2012) | 3 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/pcapio.c
   M /trunk/pcapio.h
   M /trunk/wiretap/pcapng.c

- Write ISB(s) at start and end of capture.
- Read all options.
- Prepare to write ISB.
------------------------------------------------------------------------
r41136 | etxrab | 2012-02-22 02:01:16 -0800 (Wed, 22 Feb 2012) | 1 line
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/pcapio.c
   M /trunk/pcapio.h

Expand the API for ISB:s
------------------------------------------------------------------------
r41135 | alagoutte | 2012-02-22 01:18:30 -0800 (Wed, 22 Feb 2012) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   D /trunk/epan/dissectors/packet-noe.c
   M /trunk/epan/dissectors/packet-ua.c
   D /trunk/epan/dissectors/packet-ua3g.c
   D /trunk/epan/dissectors/packet-uasip.c
   M /trunk/epan/dissectors/packet-uaudp.c
   D /trunk/epan/dissectors/packet-uaudp.h

Reverse Revision 41134 (Need to fix error/warning before...)

------------------------------------------------------------------------
r41134 | etxrab | 2012-02-22 00:37:46 -0800 (Wed, 22 Feb 2012) | 14 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-noe.c
   M /trunk/epan/dissectors/packet-ua.c
   A /trunk/epan/dissectors/packet-ua3g.c
   A /trunk/epan/dissectors/packet-uasip.c
   M /trunk/epan/dissectors/packet-uaudp.c
   A /trunk/epan/dissectors/packet-uaudp.h

From Lars Ruoff:
Dissector for Alcatel-Lucent Enterprise Universal Alcatel- and NOE protocol
families.
Meant as a replacement for existing UA-dissector in trunk because of better
feature set:
- latest protocol specifiaction
- more detailed dissection and filtering possibilities on subprotocols
- RTP stream setup
- NOE over SIP

Lars Ruoff
On behalf of Alcatel-Lucent Enterprise

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6844
------------------------------------------------------------------------
r41133 | guy | 2012-02-21 19:13:38 -0800 (Tue, 21 Feb 2012) | 7 lines
Changed paths:
   M /trunk/tools/runlex.sh

More debugging information - in at least one of the failures, neither of
the "Wrote xxx" messages was printed, although the compiler appeared to
have been run on the .c file that was never claimed to have been
written, but got an error because it couldn't find the .h file (also
never claimed to have been written), and in one of the successes on the
same buildbot, they were both printed for the same file.

------------------------------------------------------------------------
r41132 | guy | 2012-02-21 19:03:34 -0800 (Tue, 21 Feb 2012) | 10 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Handle the case where there are no IDBs before the first non-SHB/non-IDB
block, which could be the case even in a *valid* file (consider a file
with an SHB, an NRB, an IDB, and a packet block, in that order); even if
there's no IDB before the first packet block, that should be reported to
the user as "interface N not less than interface count M", to more
precisely indicate the problem.

(Yes, the loop should probably keep going until it finds a packet block,
not just a non-IDB block.)

------------------------------------------------------------------------
r41131 | guy | 2012-02-21 18:15:23 -0800 (Tue, 21 Feb 2012) | 3 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/configure.in

We need to build libui even if we're only building TShark.  Fixes bug
6855.

------------------------------------------------------------------------
r41129 | tuexen | 2012-02-21 13:50:08 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/docbook/wsug_src/WSUG_chapter_capture.xml

Small fix.

------------------------------------------------------------------------
r41128 | tuexen | 2012-02-21 13:46:06 -0800 (Tue, 21 Feb 2012) | 4 lines
Changed paths:
   M /trunk/docbook/user-guide.xml
   M /trunk/docbook/wsug_src/WSUG_chapter_capture.xml

From Irene Ruengeler: Describe what we currently have in trunk/
                      related to capturing from multiple
                      interfaces.

------------------------------------------------------------------------
r41127 | tuexen | 2012-02-21 13:27:02 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/docbook/wsug_graphics/ws-capture-interfaces-win32.png
   M /trunk/docbook/wsug_graphics/ws-capture-interfaces.png
   A /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces-local.png
   A /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces-pipes.png
   A /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces-remote-plus.png
   A /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces-remote.png
   A /trunk/docbook/wsug_graphics/ws-capture-options-manage-interfaces.png
   M /trunk/docbook/wsug_graphics/ws-capture-options-remote-settings.png
   A /trunk/docbook/wsug_graphics/ws-capture-options-settings.png
   M /trunk/docbook/wsug_graphics/ws-capture-options.png

From Irene Ruengeler: Updated screenshots.

------------------------------------------------------------------------
r41126 | tuexen | 2012-02-21 12:37:22 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Fix bugs which resulted in the buildbot errors.

------------------------------------------------------------------------
r41125 | tuexen | 2012-02-21 10:01:44 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/pcapio.c

Correctly write os string...

------------------------------------------------------------------------
r41124 | tuexen | 2012-02-21 10:01:01 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Whitespace changes.

------------------------------------------------------------------------
r41123 | tuexen | 2012-02-21 09:19:45 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/tshark.c
   M /trunk/wiretap/file_access.c

Use wtap_dump_open_ng() in tshark.

------------------------------------------------------------------------
r41122 | tuexen | 2012-02-21 09:07:57 -0800 (Tue, 21 Feb 2012) | 8 lines
Changed paths:
   M /trunk/tshark.c

This should fix the buildbots...

The problem was that when reading a .pcap file, we don't have any IDBs.
If reqested to write out an pcapng file, we (now) build a dummy IDB which
uses the file's encapsulation as the interface encapsulation. Therefore
it can't be per=packet.
We need to fix this by using wtap_dump_open_ng()...

------------------------------------------------------------------------
r41121 | tuexen | 2012-02-21 08:51:23 -0800 (Tue, 21 Feb 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/file_access.c

When saving a file and the are no IDBs, create a default one.
This seems right, but doesn't make the buildbots happy, because
a read pcap file is reported a per packet encaps...

------------------------------------------------------------------------
r41120 | etxrab | 2012-02-21 08:43:20 -0800 (Tue, 21 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacnet.c

From Lori Tribble:
 BACnet: Allow vendor specified network layer messages.'

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6852
------------------------------------------------------------------------
r41119 | tuexen | 2012-02-21 08:33:33 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Disable debug output...

------------------------------------------------------------------------
r41118 | tuexen | 2012-02-21 08:32:25 -0800 (Tue, 21 Feb 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

When writing an option in an IDB, also write an endofoption option.
Use (consistently) 0 as the default for the interface speed.
While there, do some whitespace cleanups.

------------------------------------------------------------------------
r41117 | tuexen | 2012-02-21 08:30:22 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/pcapio.c

Whitespace changes.

------------------------------------------------------------------------
r41116 | tuexen | 2012-02-21 08:29:29 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/file.c

Whitespace changes.

------------------------------------------------------------------------
r41115 | tuexen | 2012-02-21 08:28:42 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Whitespace changes.

------------------------------------------------------------------------
r41114 | etxrab | 2012-02-21 08:14:57 -0800 (Tue, 21 Feb 2012) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

From Jose Pedro Oliveira:
dumpcap: only free os_version_str after the
libpcap_write_interface_description_block() calls.
------------------------------------------------------------------------
r41113 | tuexen | 2012-02-21 07:38:30 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/pcapio.c

Whitespace changes.

------------------------------------------------------------------------
r41112 | tuexen | 2012-02-21 07:36:08 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Improve the error handling.

------------------------------------------------------------------------
r41111 | tuexen | 2012-02-21 07:21:01 -0800 (Tue, 21 Feb 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/file_access.c

Don't dereference idb_inf in wtap_dump_open_ng() when
you provide NULL when you call it via wtap_dump_open.

This does not make the buildbots happy, but at least
tshark doesn't crash anymore.

------------------------------------------------------------------------
r41110 | tuexen | 2012-02-21 07:16:45 -0800 (Tue, 21 Feb 2012) | 3 lines
Changed paths:
   M /trunk/pcapio.c
   M /trunk/pcapio.h

Use tab indentation as elsewhere in the files.
Only whitespace changes.

------------------------------------------------------------------------
r41109 | etxrab | 2012-02-21 05:59:08 -0800 (Tue, 21 Feb 2012) | 1 line
Changed paths:
   M /trunk/pcapio.c

Check if the string exists first.
------------------------------------------------------------------------
r41108 | etxrab | 2012-02-21 05:35:04 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/pcapio.c
   M /trunk/pcapio.h

Extend libpcap_write_interface_description_block() wiyh more options
all exept os curently unused.
------------------------------------------------------------------------
r41107 | tuexen | 2012-02-21 04:56:52 -0800 (Tue, 21 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

Fix compilation (hopefully).

------------------------------------------------------------------------
r41106 | tuexen | 2012-02-21 04:24:42 -0800 (Tue, 21 Feb 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Improve peeking for IDBs.
While there, cleanup some whitespaces.

------------------------------------------------------------------------
r41105 | tuexen | 2012-02-21 03:59:41 -0800 (Tue, 21 Feb 2012) | 6 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_dlg.h
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/capture_if_dlg.h
   M /trunk/ui/gtk/dlg_utils.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/main_welcome.h

From Irene Ruengeler:
* Add support in the GUI for pipes.
* Allow the local interfaces to be rescanned via the GUI.
* Allow remote interfaces to be added and deleted.
The GUI can be extended to support other ways of capturing.

------------------------------------------------------------------------
r41104 | etxrab | 2012-02-21 01:25:41 -0800 (Tue, 21 Feb 2012) | 1 line
Changed paths:
   M /trunk/asn1/ranap/RANAP-CommonDataTypes.asn
   M /trunk/asn1/ranap/RANAP-Constants.asn
   M /trunk/asn1/ranap/RANAP-Containers.asn
   M /trunk/asn1/ranap/RANAP-IEs.asn
   M /trunk/asn1/ranap/RANAP-PDU-Contents.asn
   M /trunk/asn1/ranap/RANAP-PDU-Descriptions.asn
   M /trunk/asn1/ranap/packet-ranap-template.c
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-ranap.c

From David Wei and me, update to 3GPP TS 25.413 V10.4.0 (2011-12).
------------------------------------------------------------------------
r41103 | etxrab | 2012-02-21 00:58:05 -0800 (Tue, 21 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/sminmpec.h

Add VENDOR_ERICSSON_PKT_CORE
------------------------------------------------------------------------
r41102 | guy | 2012-02-21 00:27:41 -0800 (Tue, 21 Feb 2012) | 5 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Once we've read a valid SHB, we've concluded the file is a pcap-NG file,
so if we later get a short read, we have to return -1 and set *err to
WTAP_ERR_SHORT_READ.  Otherwise, we'll try other file types and, if none
of them match, we'll try to close the wtap structure, which crashes.

------------------------------------------------------------------------
r41101 | etxrab | 2012-02-20 23:25:22 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Declare opt_cont_buf_len
------------------------------------------------------------------------
r41099 | etxrab | 2012-02-20 22:57:14 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Free the buffer
------------------------------------------------------------------------
r41096 | etxrab | 2012-02-20 21:58:40 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Change comment to Loop ower all IDB:s that appear before any packets sugested by Guy, there can be more IDBs in a cpture file
------------------------------------------------------------------------
r41095 | etxrab | 2012-02-20 21:52:50 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/dumpcap.c

From Jose Pedro Oliveira shb_os value: get_os_version_info() instead of get_runtime_version_info()
------------------------------------------------------------------------
r41094 | wmeier | 2012-02-20 18:02:11 -0800 (Mon, 20 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Always test tvb_reported_length_remaining() return val for '> 0' instead of '!=0'
Also: Whitespace cleanup.

------------------------------------------------------------------------
r41093 | wmeier | 2012-02-20 15:28:23 -0800 (Mon, 20 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ansi_801.c

Indentation & whitespace cleanup....

------------------------------------------------------------------------
r41092 | wmeier | 2012-02-20 14:46:24 -0800 (Mon, 20 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

(Trivial) Fix a typo in a comment; Do some whitespace changes.

------------------------------------------------------------------------
r41091 | etxrab | 2012-02-20 14:40:17 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/file.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

From Jose Pedro Oliveira  fix a typo
------------------------------------------------------------------------
r41090 | wmeier | 2012-02-20 14:22:48 -0800 (Mon, 20 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bzr.c

Use tvb_reported_length_remaining() iso tvb_length_remaining().

------------------------------------------------------------------------
r41089 | wmeier | 2012-02-20 14:20:30 -0800 (Mon, 20 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bzr.c

Fix 'variable set but then unused'; Do some whitespace cleanup.

------------------------------------------------------------------------
r41088 | wmeier | 2012-02-20 14:00:50 -0800 (Mon, 20 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

proto_reg_handoff...() doesn't need 'if(!Initialized)';
Also: Do some whitespace cleanup.

------------------------------------------------------------------------
r41087 | wmeier | 2012-02-20 13:39:19 -0800 (Mon, 20 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipoib.c

(Trivial) Whitespace changes

------------------------------------------------------------------------
r41086 | etxrab | 2012-02-20 13:17:43 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/version_info.c
   M /trunk/version_info.h

Jose Pedro Oliveira: get_os_version_info() is more apropriate for shb_os
------------------------------------------------------------------------
r41085 | etxrab | 2012-02-20 12:32:53 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/asn1/ulp/packet-ulp-template.c
   M /trunk/asn1/ulp/ulp.cnf
   M /trunk/epan/dissectors/packet-ulp.c

From e.yimjia Add LPP decoding support in ULP protocol dissector \n https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6851
------------------------------------------------------------------------
r41084 | etxrab | 2012-02-20 12:25:20 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-s1ap.c

From David Wei more containers not to dissect if pref is set
------------------------------------------------------------------------
r41083 | wmeier | 2012-02-20 12:23:56 -0800 (Mon, 20 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-elcom.c

Thou shalt not stop dissecting after doing processing for COL_INFO ....

------------------------------------------------------------------------
r41082 | etxrab | 2012-02-20 12:15:51 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/file.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/wtap-int.h
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.def
   M /trunk/wiretap/wtap.h

Handle reading and writing of multiple IDB:s, write IDB options and use correct lengt for strings, handle more than 100 char comment
------------------------------------------------------------------------
r41081 | alagoutte | 2012-02-20 09:28:28 -0800 (Mon, 20 Feb 2012) | 10 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-hazelcast.c

From Paul Erkkila  via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6835
Patch to add Hazelcast dissector

From me :
* Fix indent (use tab)
* Fix a Clang Warning (about unused offset)
* Reorder function
* Add Paul in Authors file
* Add CmakeFile modification

------------------------------------------------------------------------
r41080 | guy | 2012-02-19 16:01:21 -0800 (Sun, 19 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.am

Fix tpo.

------------------------------------------------------------------------
r41079 | guy | 2012-02-19 15:35:19 -0800 (Sun, 19 Feb 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.am
   M /trunk/ui/gtk/Makefile.nmake

Don't run Flex-generated files through checkapi - they use forbidden
APIs such as malloc and free.

------------------------------------------------------------------------
r41078 | wmeier | 2012-02-19 15:30:03 -0800 (Sun, 19 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/cli/Makefile.nmake

(Minor): use GLIB_CFLAGS instead of GTK_CFLAGS; also put libcliui: as first target

------------------------------------------------------------------------
r41077 | wmeier | 2012-02-19 15:28:31 -0800 (Sun, 19 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/Makefile.nmake

(Minor): Use GLIB_CFLAGS instead of GTK_CFLAGS when compiling in ui directory.

------------------------------------------------------------------------
r41076 | wmeier | 2012-02-19 15:26:29 -0800 (Sun, 19 Feb 2012) | 2 lines
Changed paths:
   M /trunk/config.nmake

(Minor): Add -DG_DISABLE_SINGLE_INCLUDES to GLIB_CFLAGS

------------------------------------------------------------------------
r41075 | guy | 2012-02-19 14:41:53 -0800 (Sun, 19 Feb 2012) | 9 lines
Changed paths:
   M /trunk/ui/cli/Makefile.am
   M /trunk/ui/cli/Makefile.common
   M /trunk/ui/gtk/Makefile.am
   M /trunk/ui/gtk/Makefile.common
   M /trunk/ui/gtk/Makefile.nmake

We already have GENERATED_HEADER_FILES; use that instead of
GENERATED_H_FILES.

If we have DIRTY_GENERATED_C_FILES, use it the same way we use
GENERATED_C_FILES.

GENERATED_FILES is "everything to nuke on a "make maintainer-clean"",
not "everything to put into the distribution".

------------------------------------------------------------------------
r41074 | guy | 2012-02-19 14:25:54 -0800 (Sun, 19 Feb 2012) | 7 lines
Changed paths:
   M /trunk/ui/Makefile.am
   M /trunk/ui/Makefile.common
   M /trunk/ui/Makefile.nmake

We already have GENERATED_HEADER_FILES; no need for GENERATED_H_FILES.

Remove a bunch of stuff copied over from ui/gtk/Makefile.am that doesn't
apply here.

There's no DIRTY_GENERATED_C_FILES.

------------------------------------------------------------------------
r41073 | wmeier | 2012-02-19 13:38:48 -0800 (Sun, 19 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/cli/Makefile.nmake

A few more changes to fix the Windows build: Fix building tshark-tap-register.c

------------------------------------------------------------------------
r41072 | guy | 2012-02-19 11:30:45 -0800 (Sun, 19 Feb 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.am

ui/cli now needs to be a distribution directory.

------------------------------------------------------------------------
r41071 | guy | 2012-02-19 11:28:31 -0800 (Sun, 19 Feb 2012) | 3 lines
Changed paths:
   M /trunk/ui/cli/Makefile.nmake

This is 2 levels down, unlike the 1-level-down ui/Makefile.nmake I
copied as an initial contents of this.

------------------------------------------------------------------------
r41070 | guy | 2012-02-19 11:01:01 -0800 (Sun, 19 Feb 2012) | 4 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.common
   M /trunk/Makefile.nmake
   M /trunk/configure.in
   M /trunk/ui/cli
   A /trunk/ui/cli/Makefile.am
   A /trunk/ui/cli/Makefile.common
   A /trunk/ui/cli/Makefile.nmake

Build the TShark taps into a static libcliui library in the ui/cli
directory, and link TShark with that; let's see if this fixes the
Windows buildbots.

------------------------------------------------------------------------
r41069 | guy | 2012-02-19 10:59:08 -0800 (Sun, 19 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.am

Put back the comment for the rule to generate wireshark-tap-register.c.

------------------------------------------------------------------------
r41066 | gerald | 2012-02-19 07:03:32 -0800 (Sun, 19 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-02-19]
------------------------------------------------------------------------
r41065 | guy | 2012-02-19 00:59:17 -0800 (Sun, 19 Feb 2012) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

Reflect the move of dftest.c back to the top-level directory.

------------------------------------------------------------------------
r41064 | guy | 2012-02-18 21:57:14 -0800 (Sat, 18 Feb 2012) | 6 lines
Changed paths:
   M /trunk/Makefile.common
   A /trunk/dftest.c (from /trunk/ui/cli/dftest.c:41061)
   D /trunk/ui/cli/dftest.c

Move dftest.c back to the top-level directory; that way, all of the
stuff in ui/cli can be stuffed into a libcliui library to link with
TShark, and all of the source files containing main() (except for
Wireshark) are in the top-level directory (dftest isn't any more special
than TShark or capinfos or mergecap or editcap or...).

------------------------------------------------------------------------
r41063 | guy | 2012-02-18 16:19:35 -0800 (Sat, 18 Feb 2012) | 4 lines
Changed paths:
   M /trunk/Makefile.am

ui/gtk/main.c calls get_conn_cfilter(), which is defined in ui/util.c,
so we need to link libui *after* libgtkui.  (It worked on Mac OS X, but
the OS X linker might do things differently from the GNU linker.)

------------------------------------------------------------------------
r41062 | guy | 2012-02-18 16:13:33 -0800 (Sat, 18 Feb 2012) | 3 lines
Changed paths:
   M /trunk/ui/win32/Makefile.nmake

We renamed "libui_win32.lib" to "libgtkui_win32.lib" elsewhere; fix it
here.

------------------------------------------------------------------------
r41061 | guy | 2012-02-18 15:55:41 -0800 (Sat, 18 Feb 2012) | 6 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.common
   M /trunk/Makefile.nmake
   M /trunk/configure.in
   M /trunk/ui
   A /trunk/ui/Makefile.am
   A /trunk/ui/Makefile.common
   A /trunk/ui/Makefile.nmake
   A /trunk/ui/doxygen.cfg.in

Create a libui (static) library in the ui directory, which contains the
object files from all the source files in the ui directory (but not in
its subdirectories), and link the programs that need it with them.

This cleans things up a little bit, and may also fix the Windows build.

------------------------------------------------------------------------
r41060 | guy | 2012-02-18 12:25:15 -0800 (Sat, 18 Feb 2012) | 2 lines
Changed paths:
   M /trunk/README.aix

Update.

------------------------------------------------------------------------
r41059 | guy | 2012-02-18 12:24:54 -0800 (Sat, 18 Feb 2012) | 5 lines
Changed paths:
   M /trunk/Makefile.nmake

Rename the (static) library built from stuff in ui/gtk to "libgtkui" in
automake/autoconf and nmake builds, to match the name in CMake builds.

(Forgot Makefile.nmake.)

------------------------------------------------------------------------
r41058 | guy | 2012-02-18 12:21:30 -0800 (Sat, 18 Feb 2012) | 3 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/ui/gtk/Makefile.am
   M /trunk/ui/gtk/Makefile.nmake
   A /trunk/ui/gtk/libgtkui.vcproj (from /trunk/ui/gtk/libui.vcproj:41057)
   D /trunk/ui/gtk/libui.vcproj
   M /trunk/wireshark.sln

Rename the (static) library built from stuff in ui/gtk to "libgtkui" in
automake/autoconf and nmake builds, to match the name in CMake builds.

------------------------------------------------------------------------
r41056 | sfisher | 2012-02-17 10:28:07 -0800 (Fri, 17 Feb 2012) | 5 lines
Changed paths:
   R /trunk/epan/dissectors/packet-rsh.c (from /trunk/epan/dissectors/packet-exec.c:41053)


Replace the old very simple (line based) RSH dissector with a slightly
modified version of the EXEC since the protocols are nearly identical. 


------------------------------------------------------------------------
r41055 | jmayer | 2012-02-17 10:23:48 -0800 (Fri, 17 Feb 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.common

Fix a typo that broke compilation on all platforms

------------------------------------------------------------------------
r41054 | sfisher | 2012-02-17 10:20:28 -0800 (Fri, 17 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-exec.c


Fix an old copy and paste mistake in a C comment.


------------------------------------------------------------------------
r41053 | sfisher | 2012-02-17 09:22:12 -0800 (Fri, 17 Feb 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-exec.c
   M /trunk/wsutil/libwsutil.def
   M /trunk/wsutil/str_util.c
   M /trunk/wsutil/str_util.h


Move exec_isdigit_string() and exec_isprint_string() functions out of
the exec dissector and into wsutil/str_util.c.  Rename them to
isdigit_string() and isprint_string().  Also rename the variables they use
for consistency: string -> str and position -> pos.


------------------------------------------------------------------------
r41052 | jmayer | 2012-02-17 08:59:14 -0800 (Fri, 17 Feb 2012) | 4 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.common

Trying to fix the compile of ui/util.c on Windows by moving the
source file directly into the sources variable - there seems to
be a subtle difference between ui/util.c and epan/crypt/md5.c

------------------------------------------------------------------------
r41051 | tuexen | 2012-02-17 08:48:55 -0800 (Fri, 17 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

Fix tooltips (There is a hidden column).

------------------------------------------------------------------------
r41050 | morriss | 2012-02-17 07:38:36 -0800 (Fri, 17 Feb 2012) | 4 lines
Changed paths:
   M /trunk/asn1/lcsap/lcsap.cnf
   M /trunk/epan/dissectors/packet-lcsap.c

From Anders: fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6839 :

A patch to set for PayloadType = 1 for Connectionless-Information

------------------------------------------------------------------------
r41049 | alagoutte | 2012-02-17 05:33:53 -0800 (Fri, 17 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bgp.h

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r41048 | jmayer | 2012-02-17 04:46:50 -0800 (Fri, 17 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/drag_and_drop.c
   M /trunk/ui/gtk/follow_ssl.c
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/ui/gtk/iax2_analysis.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/prefs_print.c
   M /trunk/ui/gtk/print_dlg.c
   M /trunk/ui/gtk/proto_dlg.c
   M /trunk/ui/gtk/rtp_analysis.c

include "../util.h" -> include "ui/util.h"

------------------------------------------------------------------------
r41047 | jmayer | 2012-02-17 04:30:27 -0800 (Fri, 17 Feb 2012) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.common
   M /trunk/capture.c
   D /trunk/dftest.c
   M /trunk/rawshark.c
   D /trunk/tap-afpstat.c
   D /trunk/tap-ansi_astat.c
   D /trunk/tap-bootpstat.c
   D /trunk/tap-camelcounter.c
   D /trunk/tap-camelsrt.c
   D /trunk/tap-comparestat.c
   D /trunk/tap-dcerpcstat.c
   D /trunk/tap-diameter-avp.c
   D /trunk/tap-expert.c
   D /trunk/tap-follow.c
   D /trunk/tap-funnel.c
   D /trunk/tap-gsm_astat.c
   D /trunk/tap-h225counter.c
   D /trunk/tap-h225rassrt.c
   D /trunk/tap-hosts.c
   D /trunk/tap-httpstat.c
   D /trunk/tap-icmpstat.c
   D /trunk/tap-icmpv6stat.c
   D /trunk/tap-iostat.c
   D /trunk/tap-iousers.c
   D /trunk/tap-macltestat.c
   D /trunk/tap-megacostat.c
   D /trunk/tap-mgcpstat.c
   D /trunk/tap-protocolinfo.c
   D /trunk/tap-protohierstat.c
   D /trunk/tap-radiusstat.c
   D /trunk/tap-rlcltestat.c
   D /trunk/tap-rpcprogs.c
   D /trunk/tap-rpcstat.c
   D /trunk/tap-rtp.c
   D /trunk/tap-rtspstat.c
   D /trunk/tap-scsistat.c
   D /trunk/tap-sctpchunkstat.c
   D /trunk/tap-sipstat.c
   D /trunk/tap-smbsids.c
   D /trunk/tap-smbstat.c
   D /trunk/tap-stats_tree.c
   D /trunk/tap-sv.c
   D /trunk/tap-wspstat.c
   M /trunk/tshark.c
   A /trunk/ui/cli
   A /trunk/ui/cli/dftest.c (from /trunk/dftest.c:41046)
   A /trunk/ui/cli/tap-afpstat.c (from /trunk/tap-afpstat.c:41046)
   A /trunk/ui/cli/tap-ansi_astat.c (from /trunk/tap-ansi_astat.c:41046)
   A /trunk/ui/cli/tap-bootpstat.c (from /trunk/tap-bootpstat.c:41046)
   A /trunk/ui/cli/tap-camelcounter.c (from /trunk/tap-camelcounter.c:41046)
   A /trunk/ui/cli/tap-camelsrt.c (from /trunk/tap-camelsrt.c:41046)
   A /trunk/ui/cli/tap-comparestat.c (from /trunk/tap-comparestat.c:41046)
   A /trunk/ui/cli/tap-dcerpcstat.c (from /trunk/tap-dcerpcstat.c:41046)
   A /trunk/ui/cli/tap-diameter-avp.c (from /trunk/tap-diameter-avp.c:41046)
   A /trunk/ui/cli/tap-expert.c (from /trunk/tap-expert.c:41046)
   A /trunk/ui/cli/tap-follow.c (from /trunk/tap-follow.c:41046)
   A /trunk/ui/cli/tap-funnel.c (from /trunk/tap-funnel.c:41046)
   A /trunk/ui/cli/tap-gsm_astat.c (from /trunk/tap-gsm_astat.c:41046)
   A /trunk/ui/cli/tap-h225counter.c (from /trunk/tap-h225counter.c:41046)
   A /trunk/ui/cli/tap-h225rassrt.c (from /trunk/tap-h225rassrt.c:41046)
   A /trunk/ui/cli/tap-hosts.c (from /trunk/tap-hosts.c:41046)
   A /trunk/ui/cli/tap-httpstat.c (from /trunk/tap-httpstat.c:41046)
   A /trunk/ui/cli/tap-icmpstat.c (from /trunk/tap-icmpstat.c:41046)
   A /trunk/ui/cli/tap-icmpv6stat.c (from /trunk/tap-icmpv6stat.c:41046)
   A /trunk/ui/cli/tap-iostat.c (from /trunk/tap-iostat.c:41046)
   A /trunk/ui/cli/tap-iousers.c (from /trunk/tap-iousers.c:41046)
   A /trunk/ui/cli/tap-macltestat.c (from /trunk/tap-macltestat.c:41046)
   A /trunk/ui/cli/tap-megacostat.c (from /trunk/tap-megacostat.c:41046)
   A /trunk/ui/cli/tap-mgcpstat.c (from /trunk/tap-mgcpstat.c:41046)
   A /trunk/ui/cli/tap-protocolinfo.c (from /trunk/tap-protocolinfo.c:41046)
   A /trunk/ui/cli/tap-protohierstat.c (from /trunk/tap-protohierstat.c:41046)
   A /trunk/ui/cli/tap-radiusstat.c (from /trunk/tap-radiusstat.c:41046)
   A /trunk/ui/cli/tap-rlcltestat.c (from /trunk/tap-rlcltestat.c:41046)
   A /trunk/ui/cli/tap-rpcprogs.c (from /trunk/tap-rpcprogs.c:41046)
   A /trunk/ui/cli/tap-rpcstat.c (from /trunk/tap-rpcstat.c:41046)
   A /trunk/ui/cli/tap-rtp.c (from /trunk/tap-rtp.c:41046)
   A /trunk/ui/cli/tap-rtspstat.c (from /trunk/tap-rtspstat.c:41046)
   A /trunk/ui/cli/tap-scsistat.c (from /trunk/tap-scsistat.c:41046)
   A /trunk/ui/cli/tap-sctpchunkstat.c (from /trunk/tap-sctpchunkstat.c:41046)
   A /trunk/ui/cli/tap-sipstat.c (from /trunk/tap-sipstat.c:41046)
   A /trunk/ui/cli/tap-smbsids.c (from /trunk/tap-smbsids.c:41046)
   A /trunk/ui/cli/tap-smbstat.c (from /trunk/tap-smbstat.c:41046)
   A /trunk/ui/cli/tap-stats_tree.c (from /trunk/tap-stats_tree.c:41046)
   A /trunk/ui/cli/tap-sv.c (from /trunk/tap-sv.c:41046)
   A /trunk/ui/cli/tap-wspstat.c (from /trunk/tap-wspstat.c:41046)
   M /trunk/ui/qt/main.cpp
   A /trunk/ui/util.c (from /trunk/util.c:41046)
   A /trunk/ui/util.h (from /trunk/util.h:41046)
   D /trunk/util.c
   D /trunk/util.h

Start moving files to ui/ and ui/cli/

------------------------------------------------------------------------
r41046 | morriss | 2012-02-16 19:17:34 -0800 (Thu, 16 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-zep.c

time_t and nstime.nsecs are both signed so don't cast them to unsigned to display them.
------------------------------------------------------------------------
r41045 | morriss | 2012-02-16 19:02:32 -0800 (Thu, 16 Feb 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntp.c

Fix part of https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6703 :

r35887 added ntp_to_nstime() to packet-ntp since a couple of dissectors had
their own versions.  The version used was from packet-netflow; switch to the
version from packet-zep because that one's math works better: the fractional
time is actually shown.

------------------------------------------------------------------------
r41044 | morriss | 2012-02-16 18:53:02 -0800 (Thu, 16 Feb 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smpp.c

(Re)fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6712 :

The change made in r40742 turned out to not be portable (FreeBSD doesn't have
the timezone global variable), so use another method to determine the current
timezone.

Also fix a bug introduced by r40742's change to display this timestamp in UTC:
if the reported (by the message) time zone has a negative offset to UTC, shift
it forward (not backward) to get UTC (and the opposite for positive offsets).

------------------------------------------------------------------------
r41043 | etxrab | 2012-02-16 12:23:16 -0800 (Thu, 16 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c

Use tce correct IE id
------------------------------------------------------------------------
r41042 | tuexen | 2012-02-16 12:22:34 -0800 (Thu, 16 Feb 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/capture_if_dlg.c

Fix from Irene Ruengeler: Show correct details in the interface dialog on
Windows.

------------------------------------------------------------------------
r41041 | guy | 2012-02-16 10:58:40 -0800 (Thu, 16 Feb 2012) | 16 lines
Changed paths:
   M /trunk/file.c
   M /trunk/tshark.c
   M /trunk/wiretap/pcapng.c

With the WTAP_ERR_UNSUPPORTED error, Wiretap supplies a string giving
the details of what in particular is unsupported; report it in TShark
and Wireshark.

Handle WTAP_ERR_RANDOM_OPEN_PIPE in TShark.

Handle WTAP_ERR_COMPRESSION_NOT_SUPPORTED in TShark, and have its error
message in Wireshark not speak of gzip, in case we support compressed
output in other formats in the future.

If we see a second section header block in a pcap-NG file, don't report
it as "the file is corrupted", report it as "the file uses a feature we
don't support", as that's the case - and don't free up the interface
data array, as the file remains open, and Wireshark might still try to
access the packets we were able to read.

------------------------------------------------------------------------
r41040 | morriss | 2012-02-16 08:31:09 -0800 (Thu, 16 Feb 2012) | 6 lines
Changed paths:
   M /trunk/packaging/macosx/Makefile.am
   D /trunk/packaging/macosx/Wireshark package.pmdoc
   A /trunk/packaging/macosx/Wireshark_package.pmdoc (from /trunk/packaging/macosx/Wireshark package.pmdoc:41039)
   M /trunk/packaging/macosx/osx-dmg.sh

As suggested on the -dev list today, add Wireshark_package.pmdoc to the source
distribution.

To do this, however, requires renaming that directory because automake can't
handle files with spaces in their names.

------------------------------------------------------------------------
r41039 | stig | 2012-02-16 01:18:33 -0800 (Thu, 16 Feb 2012) | 1 line
Changed paths:
   M /trunk/asn1/p772/packet-p772-template.c
   M /trunk/epan/dissectors/packet-p772.c

Register the p772 dissector.
------------------------------------------------------------------------
r41038 | jmayer | 2012-02-16 00:31:19 -0800 (Thu, 16 Feb 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Let part of the patch speak for itself:

     { &hf_ieee80211_addr,
-      {"Source or Destination address", "wlan.addr", FT_ETHER, BASE_NONE, NULL, 0,
-       "Source or Destination Hardware Address", HFILL }},
+      {"Hardware address", "wlan.addr", FT_ETHER, BASE_NONE, NULL, 0,
+       "SA, DA, BSSID, RA or TA Hardware Address", HFILL }},
 

------------------------------------------------------------------------
r41036 | etxrab | 2012-02-15 21:21:09 -0800 (Wed, 15 Feb 2012) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl-utils.c

From Naoyoshi Ueda:
Patch to fix DTLS decryption.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6847
------------------------------------------------------------------------
r41035 | morriss | 2012-02-15 19:00:52 -0800 (Wed, 15 Feb 2012) | 6 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Fix the rest of of https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6764 :

The Lua API does not have FT_*, it has ftypes.*, so use that in the
documentation.  Also, list out each ft so the user knows what the available
options are.

------------------------------------------------------------------------
r41034 | guy | 2012-02-15 18:06:48 -0800 (Wed, 15 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Again, turn off the debug logging; it messes up the fuzz-testing bot.

------------------------------------------------------------------------
r41033 | etxrab | 2012-02-15 14:56:20 -0800 (Wed, 15 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

From Pascal Quantin:
[NAS EPS] PDN Connectivity Request message dissection fixes.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6845
------------------------------------------------------------------------
r41032 | etxrab | 2012-02-15 11:44:16 -0800 (Wed, 15 Feb 2012) | 1 line
Changed paths:
   M /trunk/file.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/wtap-int.h
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.def
   M /trunk/wiretap/wtap.h

Make it possible to get inforamtion from the read SHB to the one to write out.
------------------------------------------------------------------------
r41031 | etxrab | 2012-02-14 22:01:01 -0800 (Tue, 14 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-l2tp.c

From Andy Karch:
Enhance L2TP filters to include assigned IDs.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6841
------------------------------------------------------------------------
r41030 | guy | 2012-02-14 14:31:33 -0800 (Tue, 14 Feb 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/erf.c

TYPE_PAD records can have zero bytes of payload; don't treat them as
errors.

------------------------------------------------------------------------
r41029 | etxrab | 2012-02-14 12:23:02 -0800 (Tue, 14 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

From David Wei:
Fix handling of piggybacked messages.
------------------------------------------------------------------------
r41028 | morriss | 2012-02-14 12:06:48 -0800 (Tue, 14 Feb 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipp.c

As Guy suggested in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6765 :

Since his r41025 change to the HTTP dissector fixes the problem reported in
the subject bug, revert r41018 (whose check-in comment, BTW, should have
referenced this bug instead of 6817).

------------------------------------------------------------------------
r41027 | jmayer | 2012-02-14 10:34:59 -0800 (Tue, 14 Feb 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

- dissect_vendor_ie_atheros:
  Remove tag_len parameter - it was redundant.
  The length passed no longer contains the vendor id.
- add_tagged_field / TAG_VENDOR_SPECIFIC_IE:
  Reorder so that the ieee "standard" vendor ids come fist,
  after that the really vendor specific stuff.

------------------------------------------------------------------------
r41026 | tuexen | 2012-02-14 09:07:52 -0800 (Tue, 14 Feb 2012) | 3 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/pcapio.c
   M /trunk/pcapio.h
   M /trunk/wiretap/pcapng.c

From Anders: Add support for options in the SHB.
From me: Some whitespace changes.

------------------------------------------------------------------------
r41025 | guy | 2012-02-13 22:00:14 -0800 (Mon, 13 Feb 2012) | 49 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

To quote section "7.2.1 Type" of RFC 2068, "Hypertext Transfer Protocol
-- HTTP/1.1":

   Any HTTP/1.1 message containing an entity-body SHOULD include a
   Content-Type header field defining the media type of that body. If
   and only if the media type is not given by a Content-Type field, the
   recipient MAY attempt to guess the media type via inspection of its
   content and/or the name extension(s) of the URL used to identify the
   resource. If the media type remains unknown, the recipient SHOULD
   treat it as type "application/octet-stream".

To quote section "4. Encoding of Transport Layer" of RFC 2565, "Internet
Printing Protocol/1.0: Encoding and Transport":

   HTTP/1.1 [RFC2068] is the transport layer for this protocol.

	...

   Note: even though port 631 is the IPP default, port 80 remains the
   default for an HTTP URI.  Thus a URI for a printer using port 631
   MUST contain an explicit port, e.g. "http://forest:631/pinetree".  An
   HTTP URI for IPP with no explicit port implicitly reference port 80,
   which is consistent with the rules for HTTP/1.1. Each HTTP operation
   MUST use the POST method where the request-URI is the object target
   of the operation, and where the "Content-Type" of the message-body in
   each request and response MUST be "application/ipp". The message-body
   MUST contain the operation layer and MUST have the syntax described
   in section 3.2 "Syntax of Encoding". A client implementation MUST
   adhere to the rules for a client described for HTTP1.1 [RFC2068]. A
   printer (server) implementation MUST adhere the rules for an origin
   server described for HTTP1.1 [RFC2068].

So, when choosing a subdissector for HTTP request bodies, search based
on the media type first, and only if we *don't* find a dissector for the
media type, do other stuff such as heuristics or choosing a subdissector
based on the port number.

This fixes a number of problems; in particular, it fixes bug 6765
"non-IPP packets to or from port 631 are dissected as IPP" without
requiring the IPP dissector to attempt to determine whether an entity
body looks like IPP.  It also ensures that the default dissector for
HTTP entity bodies, the "media" dissector, will get the media type
passed to it in pinfo->match_string.

Don't use "!str*cmp()" while we're at it - it's valid C, but the "!" can
make it look as if it's checking for something not being the case when,
in fact, you're checking for equality rather than inequality.  (The
str*cmp() routines don't return Boolean results.)

------------------------------------------------------------------------
r41024 | morriss | 2012-02-13 19:37:19 -0800 (Mon, 13 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Fix part of https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6764 :

The Lua API does not have BASE_*, it has base.*, so use that.  Also, list out
each base so the user knows what the available options are.

------------------------------------------------------------------------
r41023 | morriss | 2012-02-13 19:24:19 -0800 (Mon, 13 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

As suggested in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6763 :

Give an example of a Pref.range's default value.

------------------------------------------------------------------------
r41022 | morriss | 2012-02-13 18:57:48 -0800 (Mon, 13 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

This dissector calls process_reassembled_data() so there's no need for it to
manually insert the fragment data to the tree (by calling show_fragment_tree());
doing both just means the fragments get added to the tree twice.

------------------------------------------------------------------------
r41021 | morriss | 2012-02-13 18:43:58 -0800 (Mon, 13 Feb 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-rtp.c

There's no need to get the parent of an item we're passing into
proto_tree_move_item(): that function will expects the item, not its parent.

This avoids dissector bugs such as the one reported in
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6768 :

** (process:745): WARNING **: Dissector bug, protocol RTP, in packet 82:
proto.c:4273: failed assertion "fixed_item->parent == tree"

------------------------------------------------------------------------
r41020 | etxrab | 2012-02-13 14:46:12 -0800 (Mon, 13 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

From Pascal Quantin:
fixes for dissection of Traffic Flow Template IE.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6840
------------------------------------------------------------------------
r41019 | etxrab | 2012-02-13 14:22:29 -0800 (Mon, 13 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Handle piggybacked messages.
------------------------------------------------------------------------
r41018 | morriss | 2012-02-13 12:56:40 -0800 (Mon, 13 Feb 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipp.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6817 :

Make the IPP dissector a 'new-style' dissector that does not accept packets
which are clearly not IPP.

This is useful when a user points their web browser at a CUPS server--which
causes the CUPS server to spit out a nice looking web page from which you can
administer the server and/or printers but which up until this fix caused the
IPP dissector to mark the packet as malformed.

------------------------------------------------------------------------
r41017 | etxrab | 2012-02-13 10:58:14 -0800 (Mon, 13 Feb 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

From Sean Bright:
Wireshark crashes after editing interface settings from capture options dialog.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6788
------------------------------------------------------------------------
r41016 | etxrab | 2012-02-13 10:50:31 -0800 (Mon, 13 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Mark an unused parameter.
------------------------------------------------------------------------
r41015 | etxrab | 2012-02-13 09:34:56 -0800 (Mon, 13 Feb 2012) | 1 line
Changed paths:
   M /trunk/wiretap/wtap-int.h

White space changes.
------------------------------------------------------------------------
r41014 | etxrab | 2012-02-13 09:34:15 -0800 (Mon, 13 Feb 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Drop count is 64 bits
------------------------------------------------------------------------
r41013 | etxrab | 2012-02-13 09:33:05 -0800 (Mon, 13 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c
   M /trunk/ui/gtk/new_packet_list.h

Edit packet comments
------------------------------------------------------------------------
r41012 | etxrab | 2012-02-13 09:31:54 -0800 (Mon, 13 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/new_packet_list.c

Drop count is 64 bits
------------------------------------------------------------------------
r41011 | jmayer | 2012-02-13 01:13:37 -0800 (Mon, 13 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-vines.c

Start itemizing.

------------------------------------------------------------------------
r41010 | guy | 2012-02-12 21:35:20 -0800 (Sun, 12 Feb 2012) | 17 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

In a loop of the form

	for (i = 1; i <= N; i++)
		...

the type of "i" must have, as its maximum value, a value >= the maximum
value of N; otherwise, if N is equal to the maximum value that fits in
"i", the loop willnever terminate.  (If that requires "i" to be larger
than you'd like, do the loop as

	for (i = 0; i < N; i++)
		...

which doesn't have that problem.)

Clean up the "i = 1" clause's white space in those for loops.

------------------------------------------------------------------------
r41009 | morriss | 2012-02-12 19:14:46 -0800 (Sun, 12 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/proto.c

If WIRESHARK_ABORT_ON_DISSECTOR_BUG is set (in the environment) and we put more
than MAX_TREE_ITEMS in the tree, abort() out rather than throwing an exception.

------------------------------------------------------------------------
r41008 | morriss | 2012-02-12 19:03:03 -0800 (Sun, 12 Feb 2012) | 7 lines
Changed paths:
   M /trunk/wiretap/pcap-common.c

Fix the crash reported in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6804

For WTAP_ENCAP_ERF files if we find an Extension and/or Multi-Channel header,
ensure that the size of the full pseudoheader is smaller than the packet size
to avoid an underflow and subsequent attempt to allocate a rather large amount
of memory.

------------------------------------------------------------------------
r41007 | guy | 2012-02-12 15:50:13 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/network_instruments.c
   M /trunk/wiretap/network_instruments.h

Do not assume tab stops are set every 4 spaces.

------------------------------------------------------------------------
r41006 | morriss | 2012-02-12 15:17:01 -0800 (Sun, 12 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/Makefile.common

Add edit_packet_comment_dlg.h to the source distribution
------------------------------------------------------------------------
r41005 | guy | 2012-02-12 15:09:14 -0800 (Sun, 12 Feb 2012) | 6 lines
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/ui/gtk/new_packet_list.h

Capitalize the "P" in "Packet" in "Add or Edit Packet Comment".  Add
"..." after it, as it pops up a dialog box to let you actually type in a
comment.

Add "Add or Edit Packet Comment" to the menubar's Edit menu.

------------------------------------------------------------------------
r41004 | tuexen | 2012-02-12 13:56:00 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Fix debug output.

------------------------------------------------------------------------
r41003 | etxrab | 2012-02-12 13:15:11 -0800 (Sun, 12 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Add a button row.
------------------------------------------------------------------------
r41002 | guy | 2012-02-12 12:44:51 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mp2t.c

Close parentheses in expert info.

------------------------------------------------------------------------
r41001 | guy | 2012-02-12 12:03:37 -0800 (Sun, 12 Feb 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mp2t.c

Don't trust the pointer value in a packet; it could be invalid, and this
could cause an unsigned length value to be reduced by more than its
value, turning it into a very large value.

I couldn't exactly reproduce bug 6833, but it was due to an attempt to
allocate 4294967110 bytes, and this bug caused remaining_len to equal
4294967110, and it would try to create a reassembled packet tvbuff of
that size, so I'm guessing this fixes 6833.

------------------------------------------------------------------------
r41000 | alagoutte | 2012-02-12 11:30:57 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-infiniband_sdp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40999 | alagoutte | 2012-02-12 11:26:53 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ismacryp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40998 | alagoutte | 2012-02-12 11:24:38 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40997 | alagoutte | 2012-02-12 10:06:37 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcdns.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40996 | alagoutte | 2012-02-12 10:05:50 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-image-jfif.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40995 | alagoutte | 2012-02-12 10:05:22 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icep.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40994 | alagoutte | 2012-02-12 10:05:02 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee802154.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40993 | alagoutte | 2012-02-12 10:04:26 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40992 | alagoutte | 2012-02-12 10:03:17 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcswils.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40991 | alagoutte | 2012-02-12 10:02:58 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-flip.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40990 | alagoutte | 2012-02-12 10:02:39 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_abis_oml.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40989 | alagoutte | 2012-02-12 09:47:11 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-extreme.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40988 | alagoutte | 2012-02-12 09:46:57 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40987 | alagoutte | 2012-02-12 09:41:57 -0800 (Sun, 12 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bgp.h

Enhance BGP Notification message
* Make field filterable (3 proto_tree_add_text less ! but there are still 147 proto_tree_add_text...)
* Remove bgp_notify struct
* Use expert info to display a unknown error type

------------------------------------------------------------------------
r40986 | tuexen | 2012-02-12 08:38:47 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Get it compiling.

------------------------------------------------------------------------
r40985 | etxrab | 2012-02-12 08:18:25 -0800 (Sun, 12 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h

Get the comment and put it in the textview.
------------------------------------------------------------------------
r40983 | etxrab | 2012-02-12 07:48:57 -0800 (Sun, 12 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/edit_packet_comment_dlg.c

Try to make the buildbot happy.
------------------------------------------------------------------------
r40981 | gerald | 2012-02-12 07:03:25 -0800 (Sun, 12 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-02-12]
------------------------------------------------------------------------
r40980 | etxrab | 2012-02-12 06:56:06 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/CMakeLists.txt
   M /trunk/ui/gtk/Makefile.common
   A /trunk/ui/gtk/edit_packet_comment_dlg.c
   A /trunk/ui/gtk/edit_packet_comment_dlg.h
   M /trunk/ui/gtk/main_menubar.c

Add the edit packet comment menu entry and the empty files
to actually handel the menu to edit the comments.
------------------------------------------------------------------------
r40979 | etxrab | 2012-02-11 23:18:05 -0800 (Sat, 11 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-usb.h

From Steve Magnani:
USB: add infrastructure for dissecting class-specific descriptors.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6825
------------------------------------------------------------------------
r40978 | guy | 2012-02-11 12:57:26 -0800 (Sat, 11 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-pat.c

Use the length-on-the-network, not the captured length, when deciding
how far to dissect.

------------------------------------------------------------------------
r40977 | guy | 2012-02-11 12:37:54 -0800 (Sat, 11 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-sect.c

Don't bail out of a non-heuristic dissector routine just because there's
not enough captured data in the tvbuff.

------------------------------------------------------------------------
r40976 | guy | 2012-02-11 12:36:35 -0800 (Sat, 11 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-sect.c

Get rid of checkapi warning about %hh.

------------------------------------------------------------------------
r40975 | guy | 2012-02-11 12:35:03 -0800 (Sat, 11 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpeg-pat.c

mpeg_pat.cur_next_ind looks like a Boolean; make it one.  That also
fixes checkapi warnings about its value_string not being properly
terminated (by replacing it with a true_false_string).

------------------------------------------------------------------------
r40974 | etxrab | 2012-02-11 09:31:13 -0800 (Sat, 11 Feb 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c

Store drop count if present.
------------------------------------------------------------------------
r40973 | etxrab | 2012-02-11 08:59:38 -0800 (Sat, 11 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

From Steve Magnani:
USB: support filtering of isochronous packets via usb.bInterfaceClass.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6824
------------------------------------------------------------------------
r40972 | etxrab | 2012-02-11 08:52:32 -0800 (Sat, 11 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dvb-data-mpe.c

From Guy Martin:
Dissector for DVB MultiProtocol Encapsulation (DVB-MPE)

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6822
------------------------------------------------------------------------
r40971 | etxrab | 2012-02-11 08:44:45 -0800 (Sat, 11 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-mpeg-pat.c

From Guy Martin:
Dissector for MPEG Program Association Table (PAT)

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6821
------------------------------------------------------------------------
r40970 | etxrab | 2012-02-11 08:38:01 -0800 (Sat, 11 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-mpeg-sect.c

From Guy Martin:
Dissector for MPEG section packets.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6820
------------------------------------------------------------------------
r40969 | etxrab | 2012-02-11 04:34:39 -0800 (Sat, 11 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/frame_data.c
   M /trunk/epan/frame_data.h
   M /trunk/file.c
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/wtap-int.h
   M /trunk/wiretap/wtap.h

Add the abillity to read and write option comments unedited.
This is POC we may want to have more efficient use of the frame data
structure etc. But this allows for work to be done on the GUI to actually add comments.
------------------------------------------------------------------------
r40968 | etxrab | 2012-02-11 01:09:27 -0800 (Sat, 11 Feb 2012) | 2 lines
Changed paths:
   M /trunk/diameter/TGPPGmb.xml
   M /trunk/diameter/dictionary.xml

From David Wei:
Udate AVP:s
------------------------------------------------------------------------
r40967 | guy | 2012-02-10 23:12:34 -0800 (Fri, 10 Feb 2012) | 37 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Don't use 16-bit integers as counters.  The code won't be any faster on
anything that can run Wireshark (it might be slower), and if the maximum
count value is 16-bit, you can loop forever if the maximum count value
happens to be 65535.

(Yes, this means that

	guint i, j;

		...

	for (i = 0; i < j; i++)
		...

risks looping forever if j is 2^32-1, and the same applies to 64-bit
counters.  There are probably fewer protocols with 32-bit counts, and
probably even fewer with 64-bit counts, but the way it should be done in
those cases, for safety, is

	i = 0;
	for (;;) {
		if (i >= j)
			break;

		...

		if (i == j - 1)
			break;
	}

or something such as that.)

Fixes bug 6809.

#BACKPORT
Will schedule for 1.6.x.

------------------------------------------------------------------------
r40966 | guy | 2012-02-10 19:57:49 -0800 (Fri, 10 Feb 2012) | 6 lines
Changed paths:
   M /trunk/tshark.c

It is a complete mistake to have *ANY* messages during packet capture
sent to the standard output if "-w" is specified because, when you
capture, you can capture with the output directed to the standard
output, and dumping some text crap to the standard output will corrupt
your capture file.

------------------------------------------------------------------------
r40965 | guy | 2012-02-10 18:45:58 -0800 (Fri, 10 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

Use C89-style comment rather than C++/C99-style comment.

------------------------------------------------------------------------
r40964 | guy | 2012-02-10 18:45:16 -0800 (Fri, 10 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c

Get rid of C++/C99-style comment; use #if 0/#endif instead.

------------------------------------------------------------------------
r40963 | guy | 2012-02-10 18:41:04 -0800 (Fri, 10 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Revert presumably-unintentional turning on of debug messages.

------------------------------------------------------------------------
r40962 | guy | 2012-02-10 18:31:52 -0800 (Fri, 10 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ansi_a.c

Global variables considered harmful.  Pass pinfo along as a parameter;
this appears to fix bug 6823 (the actual crash was a null pinfo being
passed to call_dissector()).

------------------------------------------------------------------------
r40961 | sahlberg | 2012-02-10 18:10:32 -0800 (Fri, 10 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c

NETLOGON handle different schannel with the same source
 ip and dest i

from Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r40960 | sahlberg | 2012-02-10 18:09:20 -0800 (Fri, 10 Feb 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c

NETLOGON: Fix bugs with netlogon decryption not working in some cases

If there is only one Authenticatex in the file, decryption is not
working.

from Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r40959 | sahlberg | 2012-02-10 18:08:02 -0800 (Fri, 10 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c

NETLOGON: improve debugging messages

from Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r40958 | sahlberg | 2012-02-10 18:06:45 -0800 (Fri, 10 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

NTLM show the decrypted data buffer in a separate tab

from Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r40957 | sahlberg | 2012-02-10 18:05:57 -0800 (Fri, 10 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

NTLM  print the whole string, not just half the string

from Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r40956 | sahlberg | 2012-02-10 18:04:36 -0800 (Fri, 10 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

NTLM: clear the nt_password_unicode buffer.

from Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r40955 | sahlberg | 2012-02-10 18:03:20 -0800 (Fri, 10 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

NTLM make it easier to activate/deactivate debugging code in NTLM

from Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r40954 | sahlberg | 2012-02-10 18:01:47 -0800 (Fri, 10 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

NTLM: If we encounter an NTLM blob that is bigger than out fixed maxbuffer,
log a warning to the user.

from Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r40953 | sahlberg | 2012-02-10 17:59:55 -0800 (Fri, 10 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

NTLMv2 blobs can be bigger than 256 bytes. Set the limite to 10k for now.

From Matthieu Patou <mat@matws.net>

------------------------------------------------------------------------
r40952 | morriss | 2012-02-10 15:08:46 -0800 (Fri, 10 Feb 2012) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl.c

Fix via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6817 :

r40200 made ssl_parse()/dtls_parse() post-update-callbacks for those
dissector's UATs so that the dissector would be updated when the user changed
the UAT.  (This allows SSL/DTLS keys to be taken into account without requiring
Wireshark to be restarted.)

But, those functions also update the UAT themselves if the old-style keys_list
preference is used, creating an infinite recursion.

Fix this by splitting the *_parse() functions into two: one for the UAT and one
for the old-style keys list.

------------------------------------------------------------------------
r40951 | jmayer | 2012-02-09 23:16:27 -0800 (Thu, 09 Feb 2012) | 22 lines
Changed paths:
   M /trunk/ui/gtk/rtp_player.c

Sean Bright <sean.bright@gmail.com>:

In r37159, the following change was made to ui/gtk/rtp_player.c:

@@ -1654,9 +1636,7 @@
        GtkWidget *dialog;

        /* we should never be here if we are in PLAY and !PAUSE */
-       if(!rtp_channels->stop&&  !rtp_channels->pause){
-               exit(10);
-       }
+       g_assert(!rtp_channels->stop&&  !rtp_channels->pause);


The logic, however, was not negated properly.  The correct assertion should be:

        g_assert(rtp_channels->stop || rtp_channels->pause);

With the current code, the RTP player causes a crash for me when pressing the
'Play' button.


------------------------------------------------------------------------
r40950 | cmaynard | 2012-02-09 21:05:17 -0800 (Thu, 09 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/tcp_graph.c

Delete the TH_* defines and use those from epan/dissectors/packet-tcp.h.

------------------------------------------------------------------------
r40949 | cmaynard | 2012-02-09 19:37:28 -0800 (Thu, 09 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tcp.h

Since the nonce and reserved bits were added in r34084, tcp.flags is now 12 bits, so its type needs to be changed from an FT_UINT8 to an FT_UINT16.  This should avoid the crash experienced by Lanell Allen as reported on -dev: http://article.gmane.org/gmane.network.wireshark.devel/24846 (although in my testing on Windows XP SP3 (32-bit), Wireshark did not crash).

------------------------------------------------------------------------
r40948 | cmaynard | 2012-02-09 19:30:28 -0800 (Thu, 09 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvb-ipdc.c

Make proper use of esg_tree.

------------------------------------------------------------------------
r40947 | etxrab | 2012-02-09 14:24:00 -0800 (Thu, 09 Feb 2012) | 1 line
Changed paths:
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/wtap-int.h
   M /trunk/wiretap/wtap.h

Add pcapng variables to wtap_pkthdr.
------------------------------------------------------------------------
r40946 | etxrab | 2012-02-09 14:17:42 -0800 (Thu, 09 Feb 2012) | 2 lines
Changed paths:
   M /trunk/asn1/s1ap/packet-s1ap-template.c
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-s1ap.c

From David Wei:
Add a preference to not dissect containers,
------------------------------------------------------------------------
r40945 | etxrab | 2012-02-09 14:14:58 -0800 (Thu, 09 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Add comments about new IEs
------------------------------------------------------------------------
r40944 | morriss | 2012-02-09 11:17:28 -0800 (Thu, 09 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iax2.c

From Sean Bright via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6815 :

Don't use tvb_get_ptr() to retrieve a string being sent into
proto_tree_add_string_format(): use tvb_get_ephemeral_string() instead.

------------------------------------------------------------------------
r40943 | morriss | 2012-02-09 11:02:28 -0800 (Thu, 09 Feb 2012) | 4 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

From Wido Kelling via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6819 :

Patch to fix channelproperty Maintanance decode.

------------------------------------------------------------------------
r40942 | morriss | 2012-02-09 10:59:16 -0800 (Thu, 09 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Eliminate a C++/C99-style comment.
------------------------------------------------------------------------
r40941 | alagoutte | 2012-02-09 09:41:22 -0800 (Thu, 09 Feb 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Add tvb_ip_to_str and tvb_ip6_to_str to the Dev Guide

------------------------------------------------------------------------
r40940 | alagoutte | 2012-02-09 09:35:05 -0800 (Thu, 09 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40939 | etxrab | 2012-02-08 12:21:44 -0800 (Wed, 08 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

From Steve Magnani:
USB: Endpoint bmAttributes not decoded correctly.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6814
------------------------------------------------------------------------
r40938 | etxrab | 2012-02-08 12:15:59 -0800 (Wed, 08 Feb 2012) | 1 line
Changed paths:
   M /trunk/file.c

Write address resolution block.
------------------------------------------------------------------------
r40937 | etxrab | 2012-02-08 11:56:48 -0800 (Wed, 08 Feb 2012) | 8 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

From a.piesk:
no menu item Fle->Export->SSL Session Keys in GTK
Ported to 1.7 by me.

#BACKPORT
Use the patch in the bug report.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6813
------------------------------------------------------------------------
r40936 | etxrab | 2012-02-08 11:38:58 -0800 (Wed, 08 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

From Harald Welte:
GSMTAP: add new GPRS/EGPRS RLC related sub-types

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6812
------------------------------------------------------------------------
r40935 | etxrab | 2012-02-08 11:34:53 -0800 (Wed, 08 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

From Harald Welte:
GSMTAP: whitespace / indent cleanup

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6811
------------------------------------------------------------------------
r40934 | etxrab | 2012-02-08 11:31:23 -0800 (Wed, 08 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sim.c
   M /trunk/epan/dissectors/packet-gsmtap.c

From Harald Welte:
GSMTAP dissector: introduce a dissector table.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6810
------------------------------------------------------------------------
r40933 | wmeier | 2012-02-08 10:51:01 -0800 (Wed, 08 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro

When building QtShark on Windows: Don't (re)compile Wireshark .c files

------------------------------------------------------------------------
r40932 | etxrab | 2012-02-08 09:01:09 -0800 (Wed, 08 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gmr1_bcch.c
   M /trunk/epan/dissectors/packet-gsmtap.c

From Sylvain Munaut:
Fix the windows build by filling up stuct with dummy member

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6798
------------------------------------------------------------------------
r40931 | jmayer | 2012-02-08 06:57:16 -0800 (Wed, 08 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gmr1_bcch.c

Fix set-but-not-used warnings turned errors.

------------------------------------------------------------------------
r40930 | morriss | 2012-02-08 06:15:01 -0800 (Wed, 08 Feb 2012) | 14 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

As suggested by Joerg on the -dev list yesterday: count up the number of
proto_tree_add_text() calls and compare that to the number of
proto_tree_add_<something else>() calls and complain if more than 50%
of the calls are add_text()'s.

proto_tree_add_text() calls whose returned proto_item is used are not counted
as hanging a subtree off a text item is an appropriate use for text items.

I chose 50% because even at that level there are many dissectors with "too many"
proto_tree_add_text()'s.

The function to do all of this is commented out for now for the same reason
plus the fact that it's pretty slow.

------------------------------------------------------------------------
r40929 | grahamb | 2012-02-08 03:52:35 -0800 (Wed, 08 Feb 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Fixed bug with calculation of bytes in flight.

A corner case was posted to the Q&A site showing incorrect calculation of bytes in flight (http://ask.wireshark.org/questions/8843/bytes-in-flight-problems-with-retransmissions)

The capture in question has a tcp segment (frame 12) that is a retransmission of unacked earlier data (frames 4, 9, 10) and also contains some new data.  Eventually an ACK is received for the earlier segments (frame 16) but the code doesn't remove frame 12 from the linked list of unacked segments because it extends past the received ACK.  When more data is received in frame 17, the bytes in flight is calculated from the start of frame 12 rather than from the unacked portion of it, leading to a larger incorrect value.

The change simply updates the starting sequence number in the unacked segment list for any partially acked segment to be the start of unacked data.

The capture in question now shows correct information for bytes in flight, and hopefully the nature of the change won't cause issues elsewhere.
------------------------------------------------------------------------
r40928 | martinm | 2012-02-08 03:48:02 -0800 (Wed, 08 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-arp.c

Fix reporting of duplicate IP addresses by creating a hash table of
results when first visited.

------------------------------------------------------------------------
r40927 | stig | 2012-02-08 03:16:30 -0800 (Wed, 08 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

Disable the File->Merge... menu item if we cannot save-as,
because this will assert.
------------------------------------------------------------------------
r40926 | jmayer | 2012-02-07 23:43:33 -0800 (Tue, 07 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sim.c

Small whitespace fix.

------------------------------------------------------------------------
r40925 | jmayer | 2012-02-07 23:39:51 -0800 (Tue, 07 Feb 2012) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

Last fix to the wrong approach.

------------------------------------------------------------------------
r40924 | etxrab | 2012-02-07 23:26:05 -0800 (Tue, 07 Feb 2012) | 6 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-gmr1_bcch.c

From Sylvain Munaut:
Add support for GMR-1 BCCH dissection.

I #if 0'd out incomplete code.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6798
------------------------------------------------------------------------
r40923 | morriss | 2012-02-07 19:18:04 -0800 (Tue, 07 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Heuristic standard detection:
 - Grab optional parameters for LUDT/LUDTS
 - Fix processing of the 2-octet pointers

------------------------------------------------------------------------
r40922 | morriss | 2012-02-07 11:14:45 -0800 (Tue, 07 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mp2t.c

From Guy Martin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6795 :

Remove some duplicate checks.

------------------------------------------------------------------------
r40921 | cmaynard | 2012-02-07 09:36:08 -0800 (Tue, 07 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-felica.c

Initialize felica_tree to NULL to avoid a false warning.

------------------------------------------------------------------------
r40920 | cmaynard | 2012-02-07 09:01:01 -0800 (Tue, 07 Feb 2012) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-felica.c

Make some minimally required changes as pointed out in bug6758[1].

In addition:
-> I didn't think using tvb_new_subset_remaining() in order to iterate through the blocks was the best way to implement this, so I changed it to the method I had proposed earlier[2].

-> Some whitespace cleanup.
-> Noted some "TODO"'s for potential further improvements.

[1]: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6758#c9
[2]: http://article.gmane.org/gmane.network.wireshark.devel/24721

------------------------------------------------------------------------
r40919 | morriss | 2012-02-07 08:53:22 -0800 (Tue, 07 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mp2t.c

Fix the fuzz failure reported in in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6799 :

Ensure that the payload length handed to the reassembly routines doesn't go
negative/very-large-positive.

------------------------------------------------------------------------
r40918 | jmayer | 2012-02-07 06:01:24 -0800 (Tue, 07 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

small whitespace fix

------------------------------------------------------------------------
r40917 | martinm | 2012-02-07 03:15:22 -0800 (Tue, 07 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_proto_draw.c

Initiliase another variable.

------------------------------------------------------------------------
r40916 | martinm | 2012-02-07 03:12:17 -0800 (Tue, 07 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main.c

Initialise a variable to avoid warning.

------------------------------------------------------------------------
r40915 | jmayer | 2012-02-07 01:06:44 -0800 (Tue, 07 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sim.c
   M /trunk/ui/gtk/voip_calls_dlg.c

packet-gsm_sim.c was the wrong file to check in.
I meant ui/gtk/voip_calls_dlg.c.

------------------------------------------------------------------------
r40914 | jmayer | 2012-02-07 01:03:14 -0800 (Tue, 07 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sim.c
   M /trunk/epan/dissectors/packet-mp2t.c

Fix "variable set but not used" warnings turned error. In at least
one case this looks like a logic bug and should be investigated.

------------------------------------------------------------------------
r40913 | jmayer | 2012-02-07 00:05:11 -0800 (Tue, 07 Feb 2012) | 7 lines
Changed paths:
   M /trunk/CMakeLists.txt

Make sure that we only have to set (or pick up) the docdir environment
variable on the initial cmake run and not on later re-runs (like when some
cmakelists.txt file changed and we call make).
Of course this value should really be passed as an option instead of an
environment variable but I want to document how to get the current approach
working properly before switching to the proper approach.

------------------------------------------------------------------------
r40912 | etxrab | 2012-02-06 22:56:45 -0800 (Mon, 06 Feb 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/voip_calls.c

Allways use g_list_prepend().
------------------------------------------------------------------------
r40911 | cmaynard | 2012-02-06 19:20:33 -0800 (Mon, 06 Feb 2012) | 5 lines
Changed paths:
   M /trunk/doc/tshark.pod

Update the documentation to match the sort order.  This documentation error was pointed out by Markus Amend on -users.
Reference: http://article.gmane.org/gmane.network.wireshark.user/14477

(BTW, I quickly scanned through tap-iousers.c:iousers_draw() and the sorting seems to be very inefficient.)

------------------------------------------------------------------------
r40910 | morriss | 2012-02-06 18:19:11 -0800 (Mon, 06 Feb 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-mtp3.h

Export the mtp3_heuristic_standard preference and mtp3_standard_vals[].

Set mtp3_standard back to the preference value after each packet (in addition
to in the frame-end function) in case there are multiple packets of different
standards in the same frame.

------------------------------------------------------------------------
r40909 | alagoutte | 2012-02-06 14:20:29 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/iseries.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40908 | alagoutte | 2012-02-06 14:19:07 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/k12text.l

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40907 | alagoutte | 2012-02-06 14:18:45 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/iseries.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40906 | alagoutte | 2012-02-06 14:16:52 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-e212.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40905 | alagoutte | 2012-02-06 14:16:22 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-atalk.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40904 | alagoutte | 2012-02-06 14:15:53 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40903 | alagoutte | 2012-02-06 14:15:24 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40902 | alagoutte | 2012-02-06 14:14:30 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40901 | alagoutte | 2012-02-06 14:13:52 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eigrp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40900 | alagoutte | 2012-02-06 14:13:32 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btl2cap.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40899 | alagoutte | 2012-02-06 14:12:59 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sim.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40898 | alagoutte | 2012-02-06 14:12:32 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtn.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40897 | alagoutte | 2012-02-06 14:12:11 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40896 | alagoutte | 2012-02-06 14:06:28 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-epl.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40895 | alagoutte | 2012-02-06 14:05:47 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-enttec.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40894 | alagoutte | 2012-02-06 14:05:10 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40893 | alagoutte | 2012-02-06 14:04:46 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-epl_v1.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40892 | alagoutte | 2012-02-06 14:04:24 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dpnss.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40891 | alagoutte | 2012-02-06 14:03:02 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacnet.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40890 | alagoutte | 2012-02-06 14:02:36 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40889 | alagoutte | 2012-02-06 14:02:03 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40888 | alagoutte | 2012-02-06 14:01:37 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_proto_draw.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40887 | alagoutte | 2012-02-06 14:01:04 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40886 | alagoutte | 2012-02-06 13:59:53 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

Enhance DNS Dissector (use WS function...)

------------------------------------------------------------------------
r40885 | etxrab | 2012-02-06 11:21:11 -0800 (Mon, 06 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mp2t.c

From Guy Martin:
Updated MP2T (MPEG2-TS) dissector

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6795
------------------------------------------------------------------------
r40884 | etxrab | 2012-02-06 11:15:07 -0800 (Mon, 06 Feb 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

From Guy Martin:
Add new linktype 243 for MPEG2-TS.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6796
------------------------------------------------------------------------
r40883 | etxrab | 2012-02-06 11:05:30 -0800 (Mon, 06 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

packet-netflow.c:4407: warning: integer constant is too large for 'long' type
------------------------------------------------------------------------
r40882 | etxrab | 2012-02-06 09:37:29 -0800 (Mon, 06 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

From Aamer Akhter:
performance monitor 2.0 metric additions.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6780
------------------------------------------------------------------------
r40881 | etxrab | 2012-02-06 09:32:37 -0800 (Mon, 06 Feb 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/graph_analysis.h

From Cristian Constantin:
slow voip/sip call flow for large captures.
Add missing update.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6794
------------------------------------------------------------------------
r40880 | etxrab | 2012-02-06 09:29:29 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

From David Wei:
Update the latest IE's
------------------------------------------------------------------------
r40879 | etxrab | 2012-02-06 09:27:36 -0800 (Mon, 06 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-amqp.c

From Matt Dainty:
Add array datatype parsing to AMQP dissector.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6791
------------------------------------------------------------------------
r40878 | etxrab | 2012-02-06 09:23:04 -0800 (Mon, 06 Feb 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/voip_calls.c
   M /trunk/ui/gtk/voip_calls.h
   M /trunk/ui/gtk/voip_calls_dlg.c

From Cristian Constantin:
slow voip/sip call flow for large captures.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6794
------------------------------------------------------------------------
r40877 | alagoutte | 2012-02-06 08:36:20 -0800 (Mon, 06 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

From https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6704
DNS KEY RDATA contains an extra "Key id" field

Set Key Id is a generated item (in KEY and DNSKEY dns types)

------------------------------------------------------------------------
r40876 | martinm | 2012-02-06 05:56:55 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-felica.c

Add a newline at the end of the file to avoid warning.

------------------------------------------------------------------------
r40875 | jmayer | 2012-02-06 03:22:21 -0800 (Mon, 06 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/ui/main-menubar-ui.xml

Copy over rev 40874 to gtk3

------------------------------------------------------------------------
r40874 | sahlberg | 2012-02-06 01:39:00 -0800 (Mon, 06 Feb 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

SMB response time stats dissapeared a while ago. 
This adds it back.


------------------------------------------------------------------------
r40873 | etxrab | 2012-02-05 10:25:01 -0800 (Sun, 05 Feb 2012) | 5 lines
Changed paths:
   M /trunk/asn1/goose/packet-goose-template.c
   M /trunk/epan/dissectors/packet-goose.c

GOOSE Messages don't use the length field to perform the dissection.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6734

 #BACKPORT:YES
------------------------------------------------------------------------
r40872 | etxrab | 2012-02-05 08:19:21 -0800 (Sun, 05 Feb 2012) | 4 lines
Changed paths:
   M /trunk/asn1/t38/packet-t38-template.c
   M /trunk/asn1/t38/packet-t38-template.h
   M /trunk/asn1/t38/t38.cnf
   M /trunk/epan/dissectors/packet-t38.c
   M /trunk/epan/dissectors/packet-t38.h

From walter schmid:
wrong reassemble of T30 msg if more data fields in T38 packet.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6790
------------------------------------------------------------------------
r40869 | gerald | 2012-02-05 07:03:28 -0800 (Sun, 05 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-02-05]
------------------------------------------------------------------------
r40868 | etxrab | 2012-02-05 05:51:50 -0800 (Sun, 05 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bt-utp.c

From Xiao Xiangquan:
bt-dht and bt-utp should also be common dissectors while not only heuristic
ones. So we can use them with "Decode As..." command.

Applying the missing part as this seems to be an owerlapping patch.
------------------------------------------------------------------------
r40867 | etxrab | 2012-02-05 05:30:27 -0800 (Sun, 05 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-pcre.c

From Tony Trinh:
"matches" operator fails to match hex.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6613
------------------------------------------------------------------------
r40866 | etxrab | 2012-02-05 05:25:36 -0800 (Sun, 05 Feb 2012) | 4 lines
Changed paths:
   M /trunk/editcap.c

From Alexander Koeppe:
Eliminate Mixture of libc and glibc in editcap.c

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6695
------------------------------------------------------------------------
r40865 | etxrab | 2012-02-05 05:24:04 -0800 (Sun, 05 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-aastra-aasp.c

Fix comments.
------------------------------------------------------------------------
r40864 | jmayer | 2012-02-05 05:17:39 -0800 (Sun, 05 Feb 2012) | 18 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aastra-aasp.c

Try to fix the compile errors on  OS X:

cc1: warnings being treated as errors
packet-aastra-aasp.c: In function 'dissect_a_binary_command':
packet-aastra-aasp.c:142: warning: unused parameter 'pinfo'
packet-aastra-aasp.c:428:25: error: "/*" within comment
packet-aastra-aasp.c:429:25: error: "/*" within comment
packet-aastra-aasp.c:430:25: error: "/*" within comment
packet-aastra-aasp.c:431:25: error: "/*" within comment
packet-aastra-aasp.c:432:25: error: "/*" within comment
packet-aastra-aasp.c:433:25: error: "/*" within comment
packet-aastra-aasp.c:434:25: error: "/*" within comment
packet-aastra-aasp.c:435:25: error: "/*" within comment
packet-aastra-aasp.c:436:25: error: "/*" within comment
packet-aastra-aasp.c:437:25: error: "/*" within comment
packet-aastra-aasp.c:438:25: error: "/*" within comment


------------------------------------------------------------------------
r40863 | etxrab | 2012-02-05 05:09:10 -0800 (Sun, 05 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eap.c

From billyjeans:
EAP-TLS cannot re-initialize properly if previous EAP-TLS conversation is not properly finished.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5633
------------------------------------------------------------------------
r40862 | etxrab | 2012-02-05 05:05:15 -0800 (Sun, 05 Feb 2012) | 6 lines
Changed paths:
   M /trunk/tshark.c

From Michael Mann:
Went through all stderr cases within tshark trying to make tshark "quieter".  I
basically ended up agreeing with the submitted in terms of what should be
switched to stdout from stderr.  The attached patch does that.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=2881
------------------------------------------------------------------------
r40861 | jmayer | 2012-02-05 04:55:30 -0800 (Sun, 05 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt

Forgot to commit the CMakeList.txt changes
------------------------------------------------------------------------
r40860 | etxrab | 2012-02-05 04:54:21 -0800 (Sun, 05 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-aastra-aasp.c

From Marek Tews:
Aastra Signalling Protocol (AASP).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6600
------------------------------------------------------------------------
r40859 | etxrab | 2012-02-05 04:47:43 -0800 (Sun, 05 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-felica.c

Try to get rid of non-ASCII characters.
------------------------------------------------------------------------
r40858 | etxrab | 2012-02-05 04:15:12 -0800 (Sun, 05 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-gadu-gadu.c

From Jakub Zawadzki:
Minimal version of Gadu-Gadu dissector (header only).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3256
------------------------------------------------------------------------
r40857 | etxrab | 2012-02-05 04:02:27 -0800 (Sun, 05 Feb 2012) | 8 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-rfid-felica.c

From Tyson Key:
I've just finished writing a dissector for parts of the Sony FeliCa smartcard
application layer protocol, as documented in JIS X 6319-4, (partially in) ISO
18092, and in various documents made publicly available at
http://www.sony.net/Products/felica/business/tech-support/index.html.


https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6758
------------------------------------------------------------------------
r40856 | etxrab | 2012-02-05 03:46:52 -0800 (Sun, 05 Feb 2012) | 1 line
Changed paths:
   M /trunk/tap-follow.c

Cast it away.
------------------------------------------------------------------------
r40855 | etxrab | 2012-02-05 03:41:43 -0800 (Sun, 05 Feb 2012) | 14 lines
Changed paths:
   M /trunk/tap-follow.c

Try to fix some of the build problems, it still bumms out on:
tap-follow.c
tshark-tap-register.c
tap-follow.c(464) : error C2220: warning treated as error - no 'object' file gen
erated
tap-follow.c(464) : warning C4267: '=' : conversion from 'size_t' to 'guint32',
possible loss of data
tap-follow.c(610) : warning C4267: '=' : conversion from 'size_t' to 'guint32',
possible loss of data
tap-follow.c(639) : warning C4267: 'initializing' : conversion from 'size_t' to
'int', possible loss of data
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0
\VC\BIN\x86_amd64\cl.EXE"' : return code '0x2'
Stop.
------------------------------------------------------------------------
r40854 | jmayer | 2012-02-05 03:34:04 -0800 (Sun, 05 Feb 2012) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-etsi_card_app_toolkit.c
   A /trunk/epan/dissectors/packet-gsm_sim.c
   M /trunk/epan/dissectors/packet-gsmtap.c

Checked in, with the following changes:

- Adapted packet-gsm_sim.c and CmakeLists.txt to match current content (trivial)
- Fixed warnings about //-style comments that were found running
   ../../tools/checkAPIs.pl -g deprecated -g prohibited -g abort -g termoutput packet-gsm_sim.c packet-etsi_card_app_toolkit.c
    Error: Found C++ style comments in packet-gsm_sim.c
- Not fixed (will lead to dissector abort if in a packet):
   ../../tools/checkhf.pl packet-gsm_sim.c packet-etsi_card_app_toolkit.c
    ERROR: NO ARRAY: packet-gsm_sim.c, hf_tprof_b19
    ERROR: NO ARRAY: packet-gsm_sim.c, hf_tprof_b18
    ERROR: NO ARRAY: packet-etsi_card_app_toolkit.c, hf_ctlv_bearer_descr
  Please provide the necessary element entries for the hf[] array in a
  followup patch.

------------------------------------------------------------------------
r40853 | jmayer | 2012-02-05 03:24:06 -0800 (Sun, 05 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvb-ipdc.c

There is a logic bug in this dissector that is exposed
by a set but unused warning. Hack around this for now.
Someone who knows the protocol should fix this.

------------------------------------------------------------------------
r40852 | etxrab | 2012-02-05 02:39:12 -0800 (Sun, 05 Feb 2012) | 6 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.common
   M /trunk/epan/follow.c
   M /trunk/epan/follow.h
   M /trunk/epan/libwireshark.def
   A /trunk/tap-follow.c

From QA Cafe:
Add support to follow UDP and TCP streams like wireshark does. UDP streams are
selected with IP address/port pairs. TCP stream are selected with either the
stream index or IP address/port pairs.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6684
------------------------------------------------------------------------
r40851 | etxrab | 2012-02-05 02:23:56 -0800 (Sun, 05 Feb 2012) | 12 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-gsm_abis_oml.c

From Harald Welte:
TThis is a new dissector for the GSM A-bis OML protocol as specified in TS
12.21,
including some Siemens and ip.access vendor-specific extensions.

The protocol is called from both classic ISDN (LAPD) based A-bis as well as the
gsm_ipa dissector.

- Fixed the encoding argument to proto_add_item()
- Removed Attribute as that does not compile on windows.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5784
------------------------------------------------------------------------
r40850 | etxrab | 2012-02-05 02:03:05 -0800 (Sun, 05 Feb 2012) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c

From Harald Welte:
This is an enhancement for the existing A-bis RSL protocol dissector for GSM
networks (as specified in Technical Specification 12.21 of the 3GPP).
Basically, 
this patch adds ip.access vendor-specific RSL extensions.

- Fixed the encoding argument to proto_add_item()
- Do not default to ip.accsess RSL.
- u_int8_t -> guint8

https://bugs.wireshark.org/bugzilla/attachment.cgi?id=7549
------------------------------------------------------------------------
r40849 | etxrab | 2012-02-05 01:09:51 -0800 (Sun, 05 Feb 2012) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dvb-ipdc.c
   M /trunk/epan/dissectors/packet-rmt-alc.c

From Holger Hans Peter Freyther:
Begin new dissector for DVB/ETSI IP Data Cast (IPDC) Electronic Service Guide (ESG) dissector.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=4178
------------------------------------------------------------------------
r40848 | etxrab | 2012-02-05 00:56:27 -0800 (Sun, 05 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smpp.c

From Stipe Tolj:
Ensure that ALL response PDUs are displayed, and the corresponding description text for the reserved or vendor-specific error code is displayed.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6108
------------------------------------------------------------------------
r40847 | etxrab | 2012-02-05 00:14:09 -0800 (Sun, 05 Feb 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c
   M /trunk/epan/dissectors/packet-csn1.h
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c

From Sylvain Munaut:
0001-packet-csn1-Fix-indenting-of-the-CSN_UINT-subsection.patch
0002-packet-csn1-Add-new-maro-M_TYPE_LABEL-to-customize-n.patch
0003-packet-csn1-New-macro-M_FIXED_LABEL-to-customize-str.patch
0004-packet-csn1-Allow-CHOICE-elements-to-re-process-the-.patch
0005-packet-csn1-Make-new-M_CHOICE_IL-option-that-doesn-t.patch
0006-packet-csn-Extend-CSN_SERIALIZE-to-allow-0-bit-of-le.patch

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6789
------------------------------------------------------------------------
r40846 | jmayer | 2012-02-04 23:41:53 -0800 (Sat, 04 Feb 2012) | 4 lines
Changed paths:
   M /trunk/CMakeLists.txt

Fix long standing but that prevented installation to
work at all.
Next step ist to move docbook installation back into docbook/

------------------------------------------------------------------------
r40845 | jmayer | 2012-02-04 23:37:32 -0800 (Sat, 04 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/README.X11

Document which external files are used by the packet-x11.c generator
scripts.

------------------------------------------------------------------------
r40844 | jmayer | 2012-02-04 15:30:38 -0800 (Sat, 04 Feb 2012) | 2 lines
Changed paths:
   M /trunk/docbook/CMakeLists.txt

Add note about unifying a4 and letter format builds.

------------------------------------------------------------------------
r40843 | alagoutte | 2012-02-04 09:36:10 -0800 (Sat, 04 Feb 2012) | 2 lines
Changed paths:
   M /trunk/.gitignore

Update .gitignore with the last change in svn:ignore for Qt

------------------------------------------------------------------------
r40842 | etxrab | 2012-02-04 07:44:10 -0800 (Sat, 04 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c
   M /trunk/epan/dissectors/packet-lapdm.c

From Harald Welte:
lapdm dissector tries to defragment segment of different streams.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6659
------------------------------------------------------------------------
r40841 | jmayer | 2012-02-04 06:27:14 -0800 (Sat, 04 Feb 2012) | 10 lines
Changed paths:
   M /trunk/ui/qt/wireshark_application.cpp

Add the magic incantation to get icons into the cmake build.
No idea why the qtcreate build worked without this.
See http://developer.qt.nokia.com/doc/qt-4.8/resources.html

@Gerald: I've most likely put this into the wrong place, please
  verify/fix.

Thanks to Alexander Neundorf for spotting this and proposing a
fix.

------------------------------------------------------------------------
r40840 | jmayer | 2012-02-04 06:19:38 -0800 (Sat, 04 Feb 2012) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/docbook/CMakeLists.txt

- Add a comment how to improve the output of supported features later on.
- Move docbook pdf installation to toplevel.

------------------------------------------------------------------------
r40839 | etxrab | 2012-02-04 06:01:46 -0800 (Sat, 04 Feb 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dccp.c
   M /trunk/epan/dissectors/packet-dccp.h

From Francesco Fondelli:
Fix indentation.
(I restored "lost code")

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5924
------------------------------------------------------------------------
r40838 | etxrab | 2012-02-04 05:43:58 -0800 (Sat, 04 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee802154.c

From Colin O'Flynn:
Fix name of wpan (IEEE 802.15.4) fields to be more consistent, add in generic wpan.length field.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5952
------------------------------------------------------------------------
r40837 | etxrab | 2012-02-04 04:23:51 -0800 (Sat, 04 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/conversation.c
   M /trunk/epan/conversation.h

From Cristian Constantin:
Slow loading/processing of conversations with over 500k frames.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6755
------------------------------------------------------------------------
r40836 | etxrab | 2012-02-04 04:22:06 -0800 (Sat, 04 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/voip_calls_dlg.c

From Cristian Constantin:
Dissable sorting while storing the data.
------------------------------------------------------------------------
r40835 | etxrab | 2012-02-04 04:13:59 -0800 (Sat, 04 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-meta.c

From Tobias Witek:
Improved filtering for TBCD values (IMSI and IMEI) in packet-meta.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6782
------------------------------------------------------------------------
r40834 | etxrab | 2012-02-04 03:59:37 -0800 (Sat, 04 Feb 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

From mdesharnais:
RTP header extensions not correctly implement.

From me remove the old table based on payload type, this
implementation is more in line with RFC 3551.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6783
------------------------------------------------------------------------
r40833 | jmayer | 2012-02-04 02:04:04 -0800 (Sat, 04 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt

Update ignore list for in-tree builds with qtcreate

------------------------------------------------------------------------
r40832 | jmayer | 2012-02-04 02:02:40 -0800 (Sat, 04 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro

Rename the binary Wireshark -> qtshark

------------------------------------------------------------------------
r40831 | etxrab | 2012-02-04 01:41:21 -0800 (Sat, 04 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

From David Wei:
Update the latest IE's
------------------------------------------------------------------------
r40830 | jmayer | 2012-02-04 00:07:00 -0800 (Sat, 04 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt

Ignore some more build-files

------------------------------------------------------------------------
r40829 | morriss | 2012-02-03 14:12:04 -0800 (Fri, 03 Feb 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6786 :

Rare messages can be malformed as such, that the first part is valid, the
second part fails. For SNMT messages, this patch fixes the problem as such that
it displays a correct column header and adds an expert info explaining the
issue.

------------------------------------------------------------------------
r40828 | morriss | 2012-02-03 10:26:37 -0800 (Fri, 03 Feb 2012) | 2 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-alcap.c
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-mtp3.h
   M /trunk/epan/dissectors/packet-mtp3mg.c
   M /trunk/epan/dissectors/packet-sccp.c

Create a list of MTP Service Indicator macros and use them.

------------------------------------------------------------------------
r40827 | morriss | 2012-02-03 10:16:21 -0800 (Fri, 03 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c

Register a frame-end routine to reset mtp3_standard back to the preference
value even if an exception was thrown.

------------------------------------------------------------------------
r40826 | jmayer | 2012-02-03 09:40:55 -0800 (Fri, 03 Feb 2012) | 3 lines
Changed paths:
   M /trunk/ui/qt/CMakeLists.txt

Don't forget about the .qrc files.
There is nothing to install for the qt gui right now.

------------------------------------------------------------------------
r40825 | sake | 2012-02-03 09:30:55 -0800 (Fri, 03 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-i2c.c

From Martin Kaiser.. FIX subdissector selection

#BACKPORT:YES

------------------------------------------------------------------------
r40824 | morriss | 2012-02-03 08:55:27 -0800 (Fri, 03 Feb 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Finish the heuristic standard detection logic by adding support (untested)
for LUDT and LUDTS messages.

------------------------------------------------------------------------
r40823 | martinm | 2012-02-03 08:44:56 -0800 (Fri, 03 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Dissect and check reserved bits at start of signalling format.

------------------------------------------------------------------------
r40822 | martinm | 2012-02-03 02:42:01 -0800 (Fri, 03 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c

Add a link back to previous frame for UM sequence number analysis.
Change a couple of filter names to use "-" rather than "_".  Update
stats window to use changed filter name.

------------------------------------------------------------------------
r40821 | jmayer | 2012-02-03 02:27:26 -0800 (Fri, 03 Feb 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/STATUS.gtk3

Update the list of problems with gtk3 and where to find
win32 builds of gtk3

------------------------------------------------------------------------
r40820 | jmayer | 2012-02-03 01:07:24 -0800 (Fri, 03 Feb 2012) | 3 lines
Changed paths:
   M /trunk/doc/capinfos.pod
   M /trunk/doc/dumpcap.pod
   M /trunk/doc/editcap.pod
   M /trunk/doc/mergecap.pod
   M /trunk/doc/rawshark.pod
   M /trunk/doc/text2pcap.pod
   M /trunk/doc/tshark.pod
   M /trunk/doc/wireshark-filter.pod
   M /trunk/doc/wireshark.pod.template

The libpcap puts pcap-filter into the misc section (which seems to be 7).
Refer to pcap-filter and mention tcpdump only as a fallback.

------------------------------------------------------------------------
r40819 | morriss | 2012-02-02 20:09:10 -0800 (Thu, 02 Feb 2012) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-sccp.h

Improve heuristic standard detection:
 - Fix various bugs.
 - Add some optional debug.
 - Enable checking of the Calling address.
 - Check that the Called/Calling address has at least a minimum number of
   octets.
 - Handle XUDTS.
 - Reject messages whose mandatory variable pointers are 0 (meaning not
   present).
 - Reject Class-2 messages whose Class-spare bits are non-zero.
 - For (Class-2) messages that have no variable parameters but an optional
   pointer, only accept messages whose optional pointer is 0 (no optional
   parameters) or 1 (optional parameter immediately follows the pointer).
 - (For some of those Class-2 messages) if there are no optional parameters,
   reject messages if we didn't reach the end of the message.

------------------------------------------------------------------------
r40818 | etxrab | 2012-02-02 13:39:33 -0800 (Thu, 02 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-osi.c

From guettler:
Apply part  of https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5622 to see OSI over IP.
------------------------------------------------------------------------
r40817 | morriss | 2012-02-02 13:35:51 -0800 (Thu, 02 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

dissect_gtpv2_mbms_session_duration(): 'tree' is unused but 'item' is.  Mark them as such.
------------------------------------------------------------------------
r40816 | etxrab | 2012-02-02 13:34:23 -0800 (Thu, 02 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-osi-options.c

From keysandwood:
osi-options dissector : dissect_option_route wrong parsing of NET

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5583
------------------------------------------------------------------------
r40815 | jmayer | 2012-02-02 13:33:37 -0800 (Thu, 02 Feb 2012) | 3 lines
Changed paths:
   M /trunk/ui/qt/CMakeLists.txt

Add a comment about automoc (but don't use it as this would
force everyone to use a rather recent cmake).

------------------------------------------------------------------------
r40814 | jmayer | 2012-02-02 13:21:04 -0800 (Thu, 02 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/CMakeLists.txt

Fix make install for qtshark.

------------------------------------------------------------------------
r40813 | etxrab | 2012-02-02 13:10:13 -0800 (Thu, 02 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis.c

From keysandwood:
register by name protocol isis (to be callable from LUA).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5612
------------------------------------------------------------------------
r40812 | etxrab | 2012-02-02 12:56:20 -0800 (Thu, 02 Feb 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

From David Wei:
Start update with the latest signals and IE's
------------------------------------------------------------------------
r40811 | morriss | 2012-02-02 12:35:48 -0800 (Thu, 02 Feb 2012) | 1 line
Changed paths:
   M /trunk/asn1/HI2Operations/Makefile.common
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-HI2Operations.c (from /trunk/epan/dissectors/packet-HI2Operations.c:40800)
   D /trunk/epan/dissectors/packet-hi2operations.c

Rather than rename the remaining HI2Operations source files in asn1/ (to fix building of the dissector and make distcheck), revert 40803 and 40801.
------------------------------------------------------------------------
r40810 | jmayer | 2012-02-02 04:38:41 -0800 (Thu, 02 Feb 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.qt

Update documentatin for the qt build to reflect the cmake work.

------------------------------------------------------------------------
r40809 | jmayer | 2012-02-02 04:38:04 -0800 (Thu, 02 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/CMakeLists.txt

Make out-of-tree builds work.

------------------------------------------------------------------------
r40808 | jmayer | 2012-02-02 04:05:44 -0800 (Thu, 02 Feb 2012) | 2 lines
Changed paths:
   M /trunk
   M /trunk/ui/qt

Update svn:ignore for the qtshark build case.

------------------------------------------------------------------------
r40807 | jmayer | 2012-02-02 04:04:22 -0800 (Thu, 02 Feb 2012) | 11 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/cmakeconfig.h.in
   M /trunk/ui/qt/CMakeLists.txt

- Move setting _U_ into config.h, because
  a) C++ has a standardized way of marking parameters as unused
  b) cmakes autoquoting magic failed when the compiler wasn't gcc
     but moc instead.
- qtshark: Don't try to compile the c source files inside ui/qt/
- qtshark: Only run moc on the files that need it.
- qtshark: It's too early to try any of the new qtshark files
  as clean.
- Make Qt detection actually work
- Add C++ to the list of languages for this project

------------------------------------------------------------------------
r40806 | jmayer | 2012-02-02 03:54:33 -0800 (Thu, 02 Feb 2012) | 3 lines
Changed paths:
   M /trunk/capture_stop_conditions.c
   M /trunk/conditions.c
   M /trunk/epan/asm_utils.c
   M /trunk/epan/dfilter/drange.c
   M /trunk/epan/dtd_grammar.lemon
   M /trunk/epan/dtd_preparse.l
   M /trunk/tools/lemon/lemon.c

Include config.h in preparation of moving the definition
of _U_ from the compiler command line into config.h

------------------------------------------------------------------------
r40805 | jmayer | 2012-02-02 00:55:00 -0800 (Thu, 02 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui
   M /trunk/ui/qt
   A /trunk/ui/qt/CMakeLists.txt

Update svn:ignore for existing qtshark build process

------------------------------------------------------------------------
r40804 | etxrab | 2012-02-01 22:54:33 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/Makefile.nmake

Revert file commited by mistake.
------------------------------------------------------------------------
r40803 | etxrab | 2012-02-01 22:51:37 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/asn1/HI2Operations/Makefile.common

Update the protocol name as per commit rev 40801.
------------------------------------------------------------------------
r40802 | etxrab | 2012-02-01 22:50:51 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/Makefile.nmake

Update the protocol name as per commit rev 40801.
------------------------------------------------------------------------
r40801 | jmayer | 2012-02-01 17:08:02 -0800 (Wed, 01 Feb 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   D /trunk/epan/dissectors/packet-HI2Operations.c
   A /trunk/epan/dissectors/packet-hi2operations.c (from /trunk/epan/dissectors/packet-HI2Operations.c:40799)

packet-HI2Operations.c was sorted into the file list as if it were
spelled packet-hi2operations.c. Rename the file to represent this.


------------------------------------------------------------------------
r40800 | jmayer | 2012-02-01 17:03:50 -0800 (Wed, 01 Feb 2012) | 3 lines
Changed paths:
   M /trunk
   M /trunk/docbook
   M /trunk/epan
   M /trunk/epan/dissectors
   M /trunk/epan/dissectors/dcerpc

- Add generated files and stuff from cmake build to svn:ignore
- Run resulting list of ignored files through sort

------------------------------------------------------------------------
r40799 | jmayer | 2012-02-01 16:46:02 -0800 (Wed, 01 Feb 2012) | 4 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt
   M /trunk/ui/gtk/CMakeLists.txt

Prepare the cmake infrastucture for eventually building
wireshark and qtshark simultanously.
The "only" missing thing for this is now ui/qt/CMakeLists.txt ;)

------------------------------------------------------------------------
r40798 | morriss | 2012-02-01 14:43:27 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt

Move m3ap from clean-asn1-dissector list to dirty-asn1-dissector list.
------------------------------------------------------------------------
r40797 | wmeier | 2012-02-01 13:47:31 -0800 (Wed, 01 Feb 2012) | 7 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/ui/qt/QtShark.pro

Fix some Windows qmake and Qt Wireshark build issues:
If 'MANIFEST_INFO_REQUIRED' not defined in config.nmake, don't do 'mt ...' for Wireshark Qt;
Add '*.pdb' to QMAKE_CLEAN;
Fix 'Unescaped backslashes are deprecated' qmake warnings;
Remove "debug" message() statements from QtShark.pro.


------------------------------------------------------------------------
r40796 | morriss | 2012-02-01 13:42:07 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Move m3ap from clean-asn1-dissector list to dirty-asn1-dissector list.
------------------------------------------------------------------------
r40795 | wmeier | 2012-02-01 13:24:08 -0800 (Wed, 01 Feb 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/wireshark_application.cpp

Fix a typo

------------------------------------------------------------------------
r40794 | etxrab | 2012-02-01 12:33:33 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-rtp.h
   M /trunk/epan/dissectors/packet-sdp.c

Collect and use some SRTP information.
------------------------------------------------------------------------
r40793 | etxrab | 2012-02-01 12:20:03 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/asn1/m3ap/m3ap.cnf
   M /trunk/epan/dissectors/packet-m3ap.c

See if this makes it build cleanly.
------------------------------------------------------------------------
r40792 | etxrab | 2012-02-01 11:36:57 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/configure.in

Add M3AP to the build.
------------------------------------------------------------------------
r40791 | etxrab | 2012-02-01 11:36:16 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.am
   M /trunk/asn1/Makefile.nmake
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common

Add M3AP to the build.
------------------------------------------------------------------------
r40790 | etxrab | 2012-02-01 11:27:08 -0800 (Wed, 01 Feb 2012) | 2 lines
Changed paths:
   A /trunk/asn1/m3ap
   A /trunk/asn1/m3ap/M3AP-CommonDataTypes.asn
   A /trunk/asn1/m3ap/M3AP-Constants.asn
   A /trunk/asn1/m3ap/M3AP-Containers.asn
   A /trunk/asn1/m3ap/M3AP-IEs.asn
   A /trunk/asn1/m3ap/M3AP-PDU-Contents.asn
   A /trunk/asn1/m3ap/M3AP-PDU-Descriptions.asn
   A /trunk/asn1/m3ap/Makefile.am
   A /trunk/asn1/m3ap/Makefile.common
   A /trunk/asn1/m3ap/Makefile.nmake
   A /trunk/asn1/m3ap/m3ap.cnf
   A /trunk/asn1/m3ap/packet-m3ap-template.c
   A /trunk/epan/dissectors/packet-m3ap.c

From David Wei:
Add a dissector for 3GPP TS 36.444 V11.0.0 (2011-12) M3AP
------------------------------------------------------------------------
r40789 | jmayer | 2012-02-01 02:02:01 -0800 (Wed, 01 Feb 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Fix warning: pci set but not used warning
------------------------------------------------------------------------
r40788 | cmaynard | 2012-01-31 18:23:51 -0800 (Tue, 31 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-dns.c

Fix some typos.

------------------------------------------------------------------------
r40787 | cmaynard | 2012-01-31 18:05:19 -0800 (Tue, 31 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-icmp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-ipv6.c

Fix some typos.

------------------------------------------------------------------------
r40786 | cmaynard | 2012-01-31 17:41:11 -0800 (Tue, 31 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-tcp.c

Fix some typos.

------------------------------------------------------------------------
r40785 | guy | 2012-01-31 15:36:52 -0800 (Tue, 31 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Let's make all offsets within the packet guints.  (In most of the API,
they're signed, but that's only to handle "offset from the end" - we
should probably get rid of that and make them unsigned.)

------------------------------------------------------------------------
r40784 | morriss | 2012-01-31 15:06:27 -0800 (Tue, 31 Jan 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Heuristic standard tuning:
 - Handle ERR and IT messages.
 - When checking variable parameter lengths, check that we have enough data
   remaining (by adding the current offset to the retrieved length).
 - Check the lengths of several more messages.
 - When checking the length, add up the values of the parameter length macros
   to make it obvious how we came to use that value.

------------------------------------------------------------------------
r40783 | morriss | 2012-01-31 12:40:29 -0800 (Tue, 31 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Use PINFO_FD_NUM and PINFO_FD_VISITED
------------------------------------------------------------------------
r40782 | morriss | 2012-01-30 20:02:08 -0800 (Mon, 30 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Improve heuristic standard detection:
 - Make sccp_called_calling_looks_valid() static.
 - Reject GT-routed Class-2 (it's not used).
 - Handle UDTS.
 - Handle optional pointer on several messages.

------------------------------------------------------------------------
r40781 | wmeier | 2012-01-30 15:55:34 -0800 (Mon, 30 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro

Compile .cpp files with CXXFLAGS the same as CFLAGS used for compiling .c files.

------------------------------------------------------------------------
r40780 | morriss | 2012-01-30 15:15:07 -0800 (Mon, 30 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Heuristic standard tuning:
 - Reject all Class-3 messages (it's never used)
 - Group Class-2 and Class-1 messages closer together
 - Some code cleanup (use macros where we have them)

------------------------------------------------------------------------
r40779 | wmeier | 2012-01-30 14:57:09 -0800 (Mon, 30 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake

Rework optional generation of .sbr & .bsc files.

------------------------------------------------------------------------
r40778 | etxrab | 2012-01-30 12:03:29 -0800 (Mon, 30 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c

Remove an unused parameter.
------------------------------------------------------------------------
r40777 | etxrab | 2012-01-30 11:54:39 -0800 (Mon, 30 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Reformat a section.
------------------------------------------------------------------------
r40776 | etxrab | 2012-01-30 11:47:35 -0800 (Mon, 30 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-sccp.h

Try to determine MTP3 Standard heuristically, original code
from Jeff Morris refactored a bit by me.
------------------------------------------------------------------------
r40775 | etxrab | 2012-01-30 11:42:21 -0800 (Mon, 30 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c

Minor updates to debug output.
------------------------------------------------------------------------
r40774 | etxrab | 2012-01-30 11:41:29 -0800 (Mon, 30 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

From Andreas Heise:
Remove a debug line.
------------------------------------------------------------------------
r40773 | morriss | 2012-01-30 11:23:25 -0800 (Mon, 30 Jan 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

Revert 40772: the abort() needs to be pushed higher (into packet.c?) so
checkapi remains happy; thus far my attempts at that aren't working.

------------------------------------------------------------------------
r40772 | morriss | 2012-01-30 09:51:22 -0800 (Mon, 30 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

If WIRESHARK_ABORT_ON_DISSECTOR_BUG is set, abort() out if we happened to
catch a DissectorError exception.

(I found this useful when debugging a "More than 1000000 items in the tree"
DissectorError.)

------------------------------------------------------------------------
r40771 | morriss | 2012-01-30 09:39:15 -0800 (Mon, 30 Jan 2012) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c

Fix infinite loop reported in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6778 :

SDP_CRYPTO: Give up (and display an expert info) if we don't find the colon
separating the key-method and the key-info.

Reindent this area of code a bit.

Remove tabs in some places for consistency.

------------------------------------------------------------------------
r40770 | stig | 2012-01-30 05:51:04 -0800 (Mon, 30 Jan 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_toolbar.c

No need to set new save icon if equal to previous icon.
------------------------------------------------------------------------
r40769 | stig | 2012-01-30 05:05:27 -0800 (Mon, 30 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/main_toolbar.c
   M /trunk/ui/gtk/main_toolbar.h

Disable the save-as button in the toolbar if we cannot save-as,
because this will assert.
------------------------------------------------------------------------
r40768 | wmeier | 2012-01-29 20:37:12 -0800 (Sun, 29 Jan 2012) | 16 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/doc/README.qt
   M /trunk/ui/qt/QtShark.pro

Rework Windows Wireshark Qt build configuration a bit:
1. Compile and link with (almost exactly) the same options as used
   when building Windows Wireshark Gtk.
   The options used allow debugging of the exe using Visual Studio exactly
   as is done for Wireshark Gtk.
   Essentially: configure the "release" version to compile and link with
   symbols.  (See ui\qt\QtShark for the details).

2. Update QtShark.pro to create a Makefile only for 1 version of Wireshark Qt
   which is linked against the "release" Qt libraries.
   (IOW: don't create a "debug" Makefile).

3. Remove unused variable assignments from config.pri.
   (They can be added back if needed in the future).


------------------------------------------------------------------------
r40767 | wmeier | 2012-01-29 16:57:44 -0800 (Sun, 29 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

(Trivial) use same "Directory Separator" for dependency and target.

------------------------------------------------------------------------
r40766 | wmeier | 2012-01-29 16:44:11 -0800 (Sun, 29 Jan 2012) | 3 lines
Changed paths:
   M /trunk/capture-wpcap.c
   M /trunk/config.nmake

Fix QtShark compile error.
(Quoting can be tricky ...)

------------------------------------------------------------------------
r40765 | etxrab | 2012-01-29 13:56:35 -0800 (Sun, 29 Jan 2012) | 5 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake

Part of "Build Browse Information File per default" from
Kovarththanan Rajaratnam applied.

It's still not the default but easier to make it so.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3480
------------------------------------------------------------------------
r40764 | etxrab | 2012-01-29 12:55:21 -0800 (Sun, 29 Jan 2012) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Add dummy application for Ericsson Sy
------------------------------------------------------------------------
r40763 | etxrab | 2012-01-29 12:33:58 -0800 (Sun, 29 Jan 2012) | 1 line
Changed paths:
   M /trunk/codecs/Makefile.nmake
   M /trunk/tools/lemon/Makefile.nmake
   M /trunk/wiretap/Makefile.nmake
   M /trunk/wsutil/Makefile.nmake

Add *.sbr files to the clean target.
------------------------------------------------------------------------
r40762 | etxrab | 2012-01-29 12:21:30 -0800 (Sun, 29 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/crypt/Makefile.nmake
   M /trunk/epan/dfilter/Makefile.nmake
   M /trunk/epan/dissectors/Makefile.nmake
   M /trunk/epan/ftypes/Makefile.nmake
   M /trunk/epan/wslua/Makefile.nmake
   M /trunk/epan/wspython/Makefile.nmake

Add *.sbr files to the clean target.
------------------------------------------------------------------------
r40761 | etxrab | 2012-01-29 12:03:39 -0800 (Sun, 29 Jan 2012) | 1 line
Changed paths:
   M /trunk/plugins/asn1/Makefile.nmake
   M /trunk/plugins/docsis/Makefile.nmake
   M /trunk/plugins/easy_codec/Makefile.nmake
   M /trunk/plugins/ethercat/Makefile.nmake
   M /trunk/plugins/giop/Makefile.nmake
   M /trunk/plugins/gryphon/Makefile.nmake
   M /trunk/plugins/irda/Makefile.nmake
   M /trunk/plugins/m2m/Makefile.nmake
   M /trunk/plugins/mate/Makefile.nmake
   M /trunk/plugins/opcua/Makefile.nmake
   M /trunk/plugins/profinet/Makefile.nmake
   M /trunk/plugins/stats_tree/Makefile.nmake
   M /trunk/plugins/tpg/Makefile.nmake
   M /trunk/plugins/unistim/Makefile.nmake
   M /trunk/plugins/wimax/Makefile.nmake
   M /trunk/plugins/wimaxasncp/Makefile.nmake

Add *.sbr files to the clean target.
------------------------------------------------------------------------
r40759 | cmaynard | 2012-01-29 07:51:21 -0800 (Sun, 29 Jan 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Fix some typos.

------------------------------------------------------------------------
r40757 | gerald | 2012-01-29 07:03:23 -0800 (Sun, 29 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf

[Automatic manuf, services and enterprise-numbers update for 2012-01-29]
------------------------------------------------------------------------
r40756 | tuexen | 2012-01-28 14:22:01 -0800 (Sat, 28 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c

Don't register ett_ssl_keyex_params twice.
This bug was introduced in
http://anonsvn.wireshark.org/viewvc/viewvc.cgi?view=rev&revision=40748

------------------------------------------------------------------------
r40755 | etxrab | 2012-01-28 09:19:25 -0800 (Sat, 28 Jan 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb-ccid.c

From Tyson Key:
Update the CCID dissector's filter/handler names.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6752
------------------------------------------------------------------------
r40754 | etxrab | 2012-01-28 09:10:50 -0800 (Sat, 28 Jan 2012) | 4 lines
Changed paths:
   M /trunk/wiretap/network_instruments.c
   M /trunk/wiretap/network_instruments.h

From Tom Brezinski:
includes radio data from the capture.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6746
------------------------------------------------------------------------
r40753 | etxrab | 2012-01-28 09:04:48 -0800 (Sat, 28 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

From Claudio:
linear white space (LWS) not ignored after HTTP header field content.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6591
------------------------------------------------------------------------
r40752 | etxrab | 2012-01-28 08:48:06 -0800 (Sat, 28 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-ssl.h

From Andreas Heise:
option ssl_ignore_mac_failed.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6748
------------------------------------------------------------------------
r40751 | etxrab | 2012-01-28 08:37:50 -0800 (Sat, 28 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-meta.c

From Tobias Witek:
Add support for a new dissector (MTP2) to the 'meta' dissector.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6717
------------------------------------------------------------------------
r40750 | etxrab | 2012-01-28 08:34:22 -0800 (Sat, 28 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-atm.c
   M /trunk/epan/dissectors/packet-meta.c
   M /trunk/wiretap/wtap.h

From Tobias Witek:
Allow dissectors to indicate that an ATM AAL5 frame contains SSCOP.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6717
------------------------------------------------------------------------
r40749 | etxrab | 2012-01-28 08:24:12 -0800 (Sat, 28 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btl2cap.c

From Michal Labedzki:

Fix:Wrong bluetooth PSM detected when parse the L2CAP packet.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6619
------------------------------------------------------------------------
r40748 | etxrab | 2012-01-28 07:50:59 -0800 (Sat, 28 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

From Michael:
Enhance SSL Key Exchange dissection.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6716
------------------------------------------------------------------------
r40747 | etxrab | 2012-01-28 07:13:28 -0800 (Sat, 28 Jan 2012) | 4 lines
Changed paths:
   M /trunk/ui/gtk/rtp_analysis.c

From Martin Kaiser:
Unused variable in rtp_analysis.c

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6776
------------------------------------------------------------------------
r40746 | alagoutte | 2012-01-28 03:24:37 -0800 (Sat, 28 Jan 2012) | 2 lines
Changed paths:
   M /trunk

Add CMakeCache.txt, CPackSourceConfig.cmake and CPackConfig.cmake to svn:ignore (when build with Cmake)

------------------------------------------------------------------------
r40745 | etxrab | 2012-01-28 01:18:26 -0800 (Sat, 28 Jan 2012) | 1 line
Changed paths:
   M /trunk/Makefile.am

Add the Qt files to the tarball.
------------------------------------------------------------------------
r40744 | alagoutte | 2012-01-27 19:22:34 -0800 (Fri, 27 Jan 2012) | 2 lines
Changed paths:
   M /trunk
   M /trunk/codecs
   M /trunk/epan
   M /trunk/epan/dissectors
   M /trunk/epan/dissectors/dcerpc
   M /trunk/plugins/asn1
   M /trunk/plugins/docsis
   M /trunk/plugins/ethercat
   M /trunk/plugins/giop
   M /trunk/plugins/gryphon
   M /trunk/plugins/irda
   M /trunk/plugins/m2m
   M /trunk/plugins/mate
   M /trunk/plugins/opcua
   M /trunk/plugins/profinet
   M /trunk/plugins/stats_tree
   M /trunk/plugins/unistim
   M /trunk/plugins/wimax
   M /trunk/plugins/wimaxasncp
   M /trunk/tools/lemon
   M /trunk/ui/gtk
   M /trunk/wiretap
   M /trunk/wsutil

Add CMakeFiles and cmake_install.cmake to svn:ignore (when build with Cmake)

------------------------------------------------------------------------
r40743 | guy | 2012-01-27 18:21:03 -0800 (Fri, 27 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/column-utils.c
   M /trunk/epan/column-utils.h
   M /trunk/epan/libwireshark.def

Well, we *did* go to a widget that invokes callback to get the text for
the columns, so we *can* clean up the exporting of col_set_fmt_time() by
not exporting it any more.

------------------------------------------------------------------------
r40742 | morriss | 2012-01-27 14:59:25 -0800 (Fri, 27 Jan 2012) | 15 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smpp.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6712 :

Since SMPP knows the time zone of its (absolute) times and since we don't
have access to a mktime() routine that doesn't take into account the local
time zone (and since I don't think repeatedly setting the TZ environment
variable is a healthy choice):

1) subtract the 'timezone' (or '_timezone' on Windows) back out after calling
   mktime()
2) then adjust the time to take into the protocol-specified time zone
3) and (finally) display the time in UTC (since we don't have the
   infrastructure to display it in the protocol-specified time zone).

(I *think* (1) is portable: POSIX says that variable should exist...)

------------------------------------------------------------------------
r40741 | alagoutte | 2012-01-27 08:49:54 -0800 (Fri, 27 Jan 2012) | 6 lines
Changed paths:
   M /trunk/ui/qt/main_window.cpp

Fix
main_window.cpp: In function ‘QStringList build_file_open_type_list()’:
main_window.cpp:249:50: error: cannot call constructor ‘QString::QString’ directly [-fpermissive]
main_window.cpp:249:50: error:   for a function-style cast, remove the redundant ‘::QString’ [-fpermissive]


------------------------------------------------------------------------
r40740 | cmaynard | 2012-01-26 19:41:20 -0800 (Thu, 26 Jan 2012) | 2 lines
Changed paths:
   M /trunk/capture-wpcap.c
   M /trunk/config.nmake

Since we know the version of WinPcap we're compiling against, go ahead and display it instead of displaying "version unknown".

------------------------------------------------------------------------
r40739 | cmaynard | 2012-01-26 19:00:47 -0800 (Thu, 26 Jan 2012) | 2 lines
Changed paths:
   M /trunk/capture-pcap-util-unix.c

Per https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6765#c3, don't display "(version unknown)" anymore.

------------------------------------------------------------------------
r40738 | etxrab | 2012-01-26 15:13:31 -0800 (Thu, 26 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

From Mike Morrin:
The gsmtap patch related to
Add dissectors for GSM and UMTS Cell Broadcast protocols.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6770
------------------------------------------------------------------------
r40737 | gerald | 2012-01-26 14:14:19 -0800 (Thu, 26 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cell_broadcast.c

Add a format string and remove a couple of unused variables.

------------------------------------------------------------------------
r40736 | gerald | 2012-01-26 13:38:53 -0800 (Thu, 26 Jan 2012) | 2 lines
Changed paths:
   M /trunk/tools/make-dissector-reg.py

make-dissector-reg.py doesn't always open its cache file.

------------------------------------------------------------------------
r40735 | etxrab | 2012-01-26 11:51:48 -0800 (Thu, 26 Jan 2012) | 5 lines
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/asn1/gsm_map/packet-gsm_map-template.c
   M /trunk/asn1/gsm_map/packet-gsm_map-template.h
   M /trunk/asn1/sabp/packet-sabp-template.c
   M /trunk/asn1/sabp/sabp.cnf
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-bmc.c
   A /trunk/epan/dissectors/packet-cell_broadcast.c
   A /trunk/epan/dissectors/packet-cell_broadcast.h
   A /trunk/epan/dissectors/packet-gsm_cbch.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h
   M /trunk/epan/dissectors/packet-rsl.c
   M /trunk/epan/dissectors/packet-sabp.c

From Mike Morrin:
Add dissectors for GSM and UMTS Cell Broadcast protocols.
( - the patch for gsmtap )

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6770
------------------------------------------------------------------------
r40734 | gerald | 2012-01-26 11:38:27 -0800 (Thu, 26 Jan 2012) | 2 lines
Changed paths:
   M /trunk/tools/make-dissector-reg.py

Apply changes from the "2to3" conversion utility. Print cache information.

------------------------------------------------------------------------
r40733 | martinm | 2012-01-26 11:25:08 -0800 (Thu, 26 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Oh dear, had that test the wrong way around...

------------------------------------------------------------------------
r40732 | etxrab | 2012-01-26 09:52:13 -0800 (Thu, 26 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c

Dissect the crypto attribute.
------------------------------------------------------------------------
r40731 | etxrab | 2012-01-26 09:51:19 -0800 (Thu, 26 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-xml.c

Add an 3gpp xml entry.
------------------------------------------------------------------------
r40730 | cmaynard | 2012-01-26 07:51:05 -0800 (Thu, 26 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wsp.c

Fix memory leaks involving tvb_get_stringz() by replacing it with tvb_get_ephemeral_stringz().

------------------------------------------------------------------------
r40729 | martinm | 2012-01-26 07:19:32 -0800 (Thu, 26 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

When telling RLC whether a frame is a retx, use direct setting if set
for DL.
Also, check limits during subheader loop.

------------------------------------------------------------------------
r40728 | cmaynard | 2012-01-26 07:11:20 -0800 (Thu, 26 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

Fix Coverity CID 1371: UNINIT.

------------------------------------------------------------------------
r40727 | guy | 2012-01-25 15:03:33 -0800 (Wed, 25 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/uat.h
   M /trunk/epan/wslua/wslua_proto.c

Fix usage of g_ascii_strdown() and g_ascii_strup() - they do *not*
modify the string in place, they return a g_mallocated modified version
of the string passed into them.

------------------------------------------------------------------------
r40726 | tuexen | 2012-01-25 12:26:34 -0800 (Wed, 25 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main.c

Try to make the buildbots happy.

------------------------------------------------------------------------
r40725 | guy | 2012-01-25 11:40:22 -0800 (Wed, 25 Jan 2012) | 4 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h

Actually, you only have monitor mode support if you have pcap_create() -
without pcap_create() and pcap_activate() you don't have any API to turn
it on.

------------------------------------------------------------------------
r40724 | gerald | 2012-01-25 10:06:25 -0800 (Wed, 25 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro

The proper scope / spec name for OS X is "macx".

------------------------------------------------------------------------
r40723 | wmeier | 2012-01-25 10:03:50 -0800 (Wed, 25 Jan 2012) | 5 lines
Changed paths:
   M /trunk/capture_opts.h
   M /trunk/ui/gtk/capture_dlg.c

Fix error when building QtShark:

...\capture_opts.h(94) : error C2461: 'remote_host' : constructor syntax missing formal parameters


------------------------------------------------------------------------
r40722 | cmaynard | 2012-01-25 09:10:57 -0800 (Wed, 25 Jan 2012) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Added billyjeans [AT] gmail.com to the authors list.  (No known real name.)

------------------------------------------------------------------------
r40721 | cmaynard | 2012-01-25 09:05:22 -0800 (Wed, 25 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-s1ap.c

From billyjeans [AT] gmail.com via bug 6184: "S1AP dissector COL_INFO should display different message status?", with changes from me to use col_append_str() and comma-separate the strings instead of using col_append_fstr() and pipe-separate them.

------------------------------------------------------------------------
r40720 | tuexen | 2012-01-25 08:45:22 -0800 (Wed, 25 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

Use a bitwise & when checking with a mask.

------------------------------------------------------------------------
r40719 | tuexen | 2012-01-25 08:43:04 -0800 (Wed, 25 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Remove redundant ().

------------------------------------------------------------------------
r40718 | tuexen | 2012-01-25 08:32:51 -0800 (Wed, 25 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_if_dlg.c

Address warnings reported by Bill.

------------------------------------------------------------------------
r40717 | morriss | 2012-01-25 06:29:09 -0800 (Wed, 25 Jan 2012) | 1 line
Changed paths:
   M /trunk/capture_opts.c

monitor_mode_enabled is only available on WIN32 or if we HAVE_PCAP_CREATE.
------------------------------------------------------------------------
r40716 | morriss | 2012-01-25 06:26:09 -0800 (Wed, 25 Jan 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_welcome.c

'error' is only used when we HAVE_LIBPCAP so only define it when that is the case.
------------------------------------------------------------------------
r40715 | tuexen | 2012-01-25 05:04:32 -0800 (Wed, 25 Jan 2012) | 15 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/capture_sync.c
   M /trunk/capture_ui_utils.c
   M /trunk/tshark.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_dlg.h
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/capture_if_dlg.h
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/main_welcome.h
   M /trunk/ui/gtk/prefs_capture.c
   M /trunk/ui/gtk/prefs_taps.c

Third try. This time pipes and stdin are supported and the
test scripts are passed.

Use a global list containing all interfaces and only change
properties of the entries when changes are made in the GUI.
Do not misuse the list of interfaces specified on the command
line anymore.

This patch does not provide any new functionality, it just
provides the base for future extensions like removing
remote interface, mulitple airpcap devices and multiple
pipes.

This patch was provided by Irene Ruengeler.

------------------------------------------------------------------------
r40714 | martinm | 2012-01-24 20:01:33 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c

Use sizeof(buff) as length argument when calling g_snprintf().

------------------------------------------------------------------------
r40713 | martinm | 2012-01-24 20:00:25 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/mac_lte_stat_dlg.c

Delete a TODO comment (now that there is an equivalent tshark tap).

------------------------------------------------------------------------
r40712 | martinm | 2012-01-24 19:40:07 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte-framed.c

Tidy up comments / deleted commented-out code.

------------------------------------------------------------------------
r40711 | morriss | 2012-01-24 17:24:25 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/proto.c

Fix a couple of cut-n-pasteos.
------------------------------------------------------------------------
r40710 | gerald | 2012-01-24 17:16:36 -0800 (Tue, 24 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/qt/capture_file_dialog.h

Put back an "explicit" for now. I'm not sure it's necessary but Qt
Creator put it there as I recall.

------------------------------------------------------------------------
r40709 | gerald | 2012-01-24 17:13:04 -0800 (Tue, 24 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/qt/capture_file_dialog.h

Add a comment discussing what it will take to have native file dialogs
on Windows and OS X.

------------------------------------------------------------------------
r40708 | gerald | 2012-01-24 13:26:22 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/ui/qt/QtShark.pro

Compile PortAudio if it's available.
------------------------------------------------------------------------
r40707 | guy | 2012-01-24 12:49:52 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-e212.c

Fix typo.

------------------------------------------------------------------------
r40706 | morriss | 2012-01-24 12:44:49 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-e212.c

Get rid of a non-ASCII char
------------------------------------------------------------------------
r40705 | guy | 2012-01-24 12:32:01 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/progress_dlg.c

Note that INIT_DELAY is .1 second.

------------------------------------------------------------------------
r40704 | cmaynard | 2012-01-24 12:31:35 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Mention the other integer accessors.

------------------------------------------------------------------------
r40703 | cmaynard | 2012-01-24 12:29:32 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-at.c (from /trunk/epan/dissectors/packet-usb-at.c:40697)
   D /trunk/epan/dissectors/packet-usb-at.c

The AT dissector is not really USB-specific, so rename it from packet-usb-at.c to packet-at.c.

------------------------------------------------------------------------
r40702 | etxrab | 2012-01-24 11:23:05 -0800 (Tue, 24 Jan 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

max_ul_ext isn't printed/decoded to the packet details log in GTP protocol packet.(Wrong length check)

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6761
------------------------------------------------------------------------
r40701 | etxrab | 2012-01-24 11:17:44 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-e212.c

Upate a few more entries and add links to where the information can be found.
------------------------------------------------------------------------
r40700 | etxrab | 2012-01-24 11:16:32 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Restructure the code abit.
------------------------------------------------------------------------
r40699 | etxrab | 2012-01-24 11:09:12 -0800 (Tue, 24 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

From Pascal Quantin:
Dissect operator-specific QCI values in EPS quality of service IE

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6760
------------------------------------------------------------------------
r40698 | guy | 2012-01-24 11:04:05 -0800 (Tue, 24 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/qt/main_window.cpp

Use wtap_get_file_extensions_list(), and prepare to use
wtap_get_savable_file_types(), in the Qt file dialogs.

------------------------------------------------------------------------
r40697 | tuexen | 2012-01-24 10:34:26 -0800 (Tue, 24 Jan 2012) | 3 lines
Changed paths:
   M /trunk/test/config.sh
   M /trunk/test/suite-capture.sh
   M /trunk/test/suite-clopts.sh
   M /trunk/test/suite-io.sh
   M /trunk/test/suite-unittests.sh
   M /trunk/test/test-backend.sh
   M /trunk/test/test.sh

It seems that we need Unix line endings also on Windows for these
files.

------------------------------------------------------------------------
r40696 | cmaynard | 2012-01-24 10:19:35 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssap.c

Fix a duplicate display filter name.

------------------------------------------------------------------------
r40695 | tuexen | 2012-01-24 09:12:56 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/capture_sync.c
   M /trunk/capture_ui_utils.c
   M /trunk/tshark.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_dlg.h
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/capture_if_dlg.h
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/main_welcome.h
   M /trunk/ui/gtk/prefs_capture.c
   M /trunk/ui/gtk/prefs_taps.c

We need a 3rd try. (After learning how to run the testuite on Windows locally).

------------------------------------------------------------------------
r40694 | tuexen | 2012-01-24 08:40:16 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main.c

(Try to) make the buildbot happy.

------------------------------------------------------------------------
r40693 | tuexen | 2012-01-24 08:05:26 -0800 (Tue, 24 Jan 2012) | 15 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/capture_sync.c
   M /trunk/capture_ui_utils.c
   M /trunk/tshark.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_dlg.h
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/capture_if_dlg.h
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/main_welcome.h
   M /trunk/ui/gtk/prefs_capture.c
   M /trunk/ui/gtk/prefs_taps.c

Second try. This time pipes and stdin are supported.

Use a global list containing all interfaces and only change
properties of the entries when changes are made in the GUI.
Do not misuse the list of interfaces specified on the command
line anymore.

This patch does not provide any new functionality, it just
provides the base for future extensions like removing
remote interface, mulitple airpcap devices and multiple
pipes.

This patch was provided by Irene Ruengeler.


------------------------------------------------------------------------
r40692 | alagoutte | 2012-01-24 05:30:20 -0800 (Tue, 24 Jan 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-e212.c

Add Free Mobile (Iliad) Mobile Network Code (the French Mobile Revolution...)
http://www.arcep.fr/uploads/tx_gsavis/10-0264.pdf

------------------------------------------------------------------------
r40691 | alagoutte | 2012-01-24 05:08:07 -0800 (Tue, 24 Jan 2012) | 23 lines
Changed paths:
   M /trunk/epan/dissectors/packet-e212.c

Fix -v for QtShark

./Wireshark -v
wireshark 1.7.1 (SVN Rev Unknown from unknown)

Copyright 1998-2012 Gerald Combs <gerald@wireshark.org> and contributors.
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Compiled (64-bit) with Qt 4.7.4 with GLib 2.30.0, with libpcap (version
unknown), with libz 1.2.3.4, with POSIX capabilities (Linux), with SMI 0.4.8,
with c-ares 1.7.4, with Lua 5.1, without Python, with GnuTLS 2.10.5, with Gcrypt
1.5.0, with MIT Kerberos, with GeoIP, with PortAudio V19-devel (built Jul 27
2011 11:52:20), without AirPcap.

Running on Linux 3.0.0-13-generic, with locale fr_FR.UTF-8, with libpcap version
1.1.1, with libz 1.2.3.4, GnuTLS 2.10.5, Gcrypt 1.5.0.

Built using gcc 4.6.1.

get_gui_compiled_info & get_gui_runtime_info copied from ../gtk/main.c 
the function is common to GTK and Qt need to put in version_info.[ch] ?

------------------------------------------------------------------------
r40690 | guy | 2012-01-24 01:29:02 -0800 (Tue, 24 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

build_file_save_type_list() isn't called if there are no savable file
types.

------------------------------------------------------------------------
r40689 | guy | 2012-01-24 01:18:06 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Only free the file extensions list if there is one to free.

------------------------------------------------------------------------
r40688 | guy | 2012-01-24 00:20:37 -0800 (Tue, 24 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Don't free the list of savable file types in build_file_save_type_list()
- we use it later, and we're freeing it later.

------------------------------------------------------------------------
r40687 | guy | 2012-01-24 00:09:33 -0800 (Tue, 24 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Fix warnings.

------------------------------------------------------------------------
r40686 | guy | 2012-01-23 21:55:00 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Use wtap_get_savable_file_types() for the Win32 file save dialog.

------------------------------------------------------------------------
r40685 | guy | 2012-01-23 20:33:23 -0800 (Mon, 23 Jan 2012) | 10 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.def
   M /trunk/wiretap/wtap.h

Add a routine to Wiretap that takes a file type value and an
encapsulation value and returns a GArray containing all the file types
that could be used to save a file of that file type and that
encapsulation value (which could be WTAP_ENCAP_PER_PACKET), with the
input file type first if that can be used and pcap or pcap-ng first if
not and if one of them can be used, and with pcap and pcap-ng clustered
together if they're among the file types that can be used.

Use that routine for the GTK+ file save dialog.

------------------------------------------------------------------------
r40684 | morriss | 2012-01-23 19:16:33 -0800 (Mon, 23 Jan 2012) | 7 lines
Changed paths:
   M /trunk/aclocal-fallback/gtk-2.0.m4
   M /trunk/aclocal-fallback/gtk-3.0.m4
   M /trunk/configure.in

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6737

As suggested by njtaylor0101 [AT] gmail.com: we (always) check for the gthread
module when checking glib so there's no need to check for it when checking GTK.
This prevents us, when configuring with gtk3, for checking for gthread-2.0
version 3.0.0 or later.

------------------------------------------------------------------------
r40683 | martinm | 2012-01-23 19:05:21 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Use bitfields to make channel_hash_key struct fit into one word.

------------------------------------------------------------------------
r40682 | morriss | 2012-01-23 18:42:01 -0800 (Mon, 23 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/wslua/wslua_pinfo.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6738 :

size_t is sometimes an integer and sometimes a long.  To avoid compiler
warnings when formatting it, cast it to a long.

------------------------------------------------------------------------
r40681 | morriss | 2012-01-23 18:30:57 -0800 (Mon, 23 Jan 2012) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bthci_evt.c

From Michal Labedzki via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6739 :

Update company ids and HCI/LMP versions to the latest Assigned Numbers

I made the cosmetic changes:
- simplify version description
- I updated all company ids from Assigned Numbers, so there are some very small
differences with old version (inadvertently)

Based on:
https://www.bluetooth.org/Technical/AssignedNumbers/hci.htm
https://www.bluetooth.org/Technical/AssignedNumbers/link_manager.htm
https://www.bluetooth.org/technical/assignednumbers/identifiers.htm

From me: list the above URLs in comments in the code.

------------------------------------------------------------------------
r40680 | morriss | 2012-01-23 18:20:46 -0800 (Mon, 23 Jan 2012) | 7 lines
Changed paths:
   M /trunk/wiretap/netscaler.c

From njtaylor0101 [AT] gmail.com via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6740 :

Fix an out-of-array-bounds warning from OpenBSD's compiler.  (Note: this is
actually a false positive since adequate memory is allocated.)

From me: some additional code simplification.

------------------------------------------------------------------------
r40679 | guy | 2012-01-23 16:48:48 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Don't treate WTAP_FILE_UNKNOWN as a real file type.

------------------------------------------------------------------------
r40678 | guy | 2012-01-23 15:17:03 -0800 (Mon, 23 Jan 2012) | 15 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.def
   M /trunk/wiretap/wtap.h

In the table of capture file types, have:

	a field that gives the default extension for the file type,
	*without* a leading "." (i.e., just the extension, not the "."
	that separates it from the rest of the file name), which is NULL
	if there are no known extensions;

	a field that gives a semicolon-separated list of *other*
	extensions, without "*." or ".", which is NULL if there are no
	known extensions or there are no known extensions other than the
	default.

Rename wtap_file_extension_default_string() to
wtap_default_file_extension() (matches the name of the field).

------------------------------------------------------------------------
r40677 | morriss | 2012-01-23 14:37:53 -0800 (Mon, 23 Jan 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Revert 40675 and set 'protocol' appropriately when IPv6 is used.
Initialize it to something other than UDP if we can't determine the protocol.

Reindent parts of the subject function.
Replace tabs with spaces (for consistency).
Remove trailing white space.

------------------------------------------------------------------------
r40676 | guy | 2012-01-23 14:23:37 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

g_string_append_printf() returns nothing.

------------------------------------------------------------------------
r40675 | morriss | 2012-01-23 14:20:15 -0800 (Mon, 23 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Initialize 'protocol' to something, at least until it can be properly assigned in the IPv6 and default cases.
------------------------------------------------------------------------
r40674 | guy | 2012-01-23 13:57:45 -0800 (Mon, 23 Jan 2012) | 4 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c
   M /trunk/wiretap/file_access.c

Have wtap_file_extension_default_string() return the extension in the
sense of "what follows the last . in the file name", i.e. not including
the ".".

------------------------------------------------------------------------
r40673 | etxrab | 2012-01-23 13:13:10 -0800 (Mon, 23 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Only continue dissection if protocol is UDP.
------------------------------------------------------------------------
r40672 | cmaynard | 2012-01-23 12:42:54 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t30.c
   M /trunk/epan/dissectors/packet-tdmoe.c
   M /trunk/epan/dissectors/packet-tn3270.c
   M /trunk/epan/dissectors/packet-tn5250.c
   M /trunk/epan/dissectors/packet-uma.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40671 | morriss | 2012-01-23 12:40:16 -0800 (Mon, 23 Jan 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/proto_dlg.c

Finish wrapping heuristic dissector functions in #if conditionals; change the condition to check if HEUR_DISSECTOR_LIST is defined.
------------------------------------------------------------------------
r40670 | guy | 2012-01-23 12:31:42 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/proto_dlg.c

Put back the #include changes from a previous commit.

------------------------------------------------------------------------
r40669 | cmaynard | 2012-01-23 12:14:37 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-rtmpt.c
   M /trunk/epan/dissectors/packet-sbus.c
   M /trunk/epan/dissectors/packet-sgsap.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smpp.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40668 | etxrab | 2012-01-23 11:48:05 -0800 (Mon, 23 Jan 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

Remove a debug statement.
------------------------------------------------------------------------
r40667 | etxrab | 2012-01-23 11:47:13 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/proto_dlg.c

Add the code to add a Heuristics protocol page.
#if 0:d out for now.
------------------------------------------------------------------------
r40666 | morriss | 2012-01-23 11:41:35 -0800 (Mon, 23 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

From Yaniv Kaul via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6743 :

The dissection [added with the previous patch on this bug] was not complete.
Attaching a diff on top of the existing SVN to properly dissect small
packets with mini header.

------------------------------------------------------------------------
r40665 | gerald | 2012-01-23 11:18:50 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Roman Donchenko → Роман Донченко

------------------------------------------------------------------------
r40664 | cmaynard | 2012-01-23 11:17:42 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mq.c
   M /trunk/epan/dissectors/packet-mux27010.c
   M /trunk/epan/dissectors/packet-nas_eps.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-olsr.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40663 | etxrab | 2012-01-23 11:10:50 -0800 (Mon, 23 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

From Pascal Quantin:
Use the private data if available, call the data dissector for data.
------------------------------------------------------------------------
r40662 | morriss | 2012-01-23 10:54:02 -0800 (Mon, 23 Jan 2012) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

From Mike Morrin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6754 :

Due to the variable remaining_bits_len getting out of sync with bit_offset (in
one case due to a mistake in the patch for bug 6375, and in another case
pre-existing).

I have shuffled the decrements of remaining_bits_len so that they always occur
next to an increment of bit_offset, so that this type of problem is easier to
spot.

From me: convert tabs to spaces to match the rest of the file.

------------------------------------------------------------------------
r40661 | etxrab | 2012-01-23 09:55:52 -0800 (Mon, 23 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/main_menubar.c

Not working Conversation Filter in (analyse menu)
(Fix the path to the fileter menu.)
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6751
------------------------------------------------------------------------
r40660 | etxrab | 2012-01-23 09:52:12 -0800 (Mon, 23 Jan 2012) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Update command codes.
------------------------------------------------------------------------
r40659 | martinm | 2012-01-23 06:39:38 -0800 (Mon, 23 Jan 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Use plane rather than channelType as part of key for looking up channel
state for sequence analysis.

------------------------------------------------------------------------
r40658 | etxrab | 2012-01-22 23:48:53 -0800 (Sun, 22 Jan 2012) | 4 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/editcap.c
   M /trunk/mergecap.c
   M /trunk/tshark.c

From Michael Mann:
help page update (pcapng is now the default file format).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6551
------------------------------------------------------------------------
r40657 | guy | 2012-01-22 18:38:56 -0800 (Sun, 22 Jan 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/file_access.c

Add default extension names for all file types for which we have
extensions at all.

For file types that are plain text and that don't already have
extensions, add "txt" as the extension.

------------------------------------------------------------------------
r40656 | martinm | 2012-01-22 18:36:46 -0800 (Sun, 22 Jan 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pdcp-lte.h
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-rlc-lte.h

PDCP:
- Pass is_retx flag to PDCP from RLC in struct instead of calling function
RLC:
- use full key to look up sequence analysis results
    - avoids overwriting and attaching result details to wrong PDU
- add links to previous and next 'OK' PDUs in channel
- shorten some long variable and type names.

------------------------------------------------------------------------
r40655 | martinm | 2012-01-22 12:31:09 -0800 (Sun, 22 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Use detailed key for sequence analysis results to avoid overwriting with
other PDUs info from same frame.  Also:
- initialise next-frame value to 0
- don't show expected-SN when analysis result is 'ok'

------------------------------------------------------------------------
r40654 | wmeier | 2012-01-22 11:52:40 -0800 (Sun, 22 Jan 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.qt

Add a note as to how I was able to build & successfully use a Debug Qt Wireshark.

------------------------------------------------------------------------
r40651 | gerald | 2012-01-22 07:03:30 -0800 (Sun, 22 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-01-22]
------------------------------------------------------------------------
r40650 | guy | 2012-01-22 03:37:33 -0800 (Sun, 22 Jan 2012) | 14 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

All valid file types should have file type strings (and, currently, they
all do); get rid of the test for a null return from
wtap_file_type_string().)

If wtap_get_file_extensions_list() returns NULL, include the file type
in the list of filters, and use "*.*" as the filter.  That way the list
of filters will include all file types, even if you can't really ask
only for files of that type (actually, you can't really ask only for
files of *any* type unless you're running under a desktop environment
where file types are specified by, for example, looking for magic
numbers, as there's no guarantee that, for example, a pcap file will
have an extension at all, given that it might come from a command-line
tool that doesn't default to any extension).

------------------------------------------------------------------------
r40649 | martinm | 2012-01-21 19:02:10 -0800 (Sat, 21 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Allow sequence analysis to be done either for PDCP frames found in RLC
frames, or logged at the PDCP level.  Provide a forward link to the next
SN frame for a channel.

------------------------------------------------------------------------
r40648 | martinm | 2012-01-21 18:55:47 -0800 (Sat, 21 Jan 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-rlc-lte.h

Various small tweaks to sequence analysis/re-assembly, plus implement
function to check for a frame being a retx as used by pdcp.

------------------------------------------------------------------------
r40647 | martinm | 2012-01-21 18:52:50 -0800 (Sat, 21 Jan 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Check for DL HARQ retx before calling RLC dissector to avoid sequence
number analysis problems.

------------------------------------------------------------------------
r40646 | cmaynard | 2012-01-21 18:14:55 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Google translate suggested a different spelling for Roman's name, so use it instead.

------------------------------------------------------------------------
r40645 | cmaynard | 2012-01-21 18:11:54 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Added Roman Dontsenko to the authors list for his contribution to fixing bug 5687.  I did my best with the Cyrillic translation, but for the actual Cyrillic spelling of his name, refer to bug 5687.

------------------------------------------------------------------------
r40644 | cmaynard | 2012-01-21 17:59:00 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pgm.c

Patch from DXDragon [AT] yandex.ru (using e-mail address instead of name because I don't know how to enter Cyrillic letters) to fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5687 - Some PGM options are not parsed correctly.

------------------------------------------------------------------------
r40643 | guy | 2012-01-21 15:50:06 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

We already added the separator *if* we needed it; don't add it again.

------------------------------------------------------------------------
r40642 | guy | 2012-01-21 15:48:03 -0800 (Sat, 21 Jan 2012) | 5 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Well, yeah, you can leave the list of patterns out, but then they don't
show up in the UI, and they appear to show up in the UI in the Windows
apps I've seen, so I guess Windows apps put the list of patterns into
the description.

------------------------------------------------------------------------
r40641 | guy | 2012-01-21 15:45:15 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Fix calls to g_string_free() (added so as not to leak memory).

------------------------------------------------------------------------
r40640 | guy | 2012-01-21 15:44:19 -0800 (Sat, 21 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

At least according to the Microsoft documentation, you don't duplicate
the list of patterns; see what happens.

------------------------------------------------------------------------
r40639 | guy | 2012-01-21 15:23:18 -0800 (Sat, 21 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

What you get from wtap_get_file_extensions_list() are extensions, not
patterns; add the "*.".

------------------------------------------------------------------------
r40638 | guy | 2012-01-21 15:09:40 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Fix print call.

------------------------------------------------------------------------
r40637 | guy | 2012-01-21 14:07:49 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Append the trailing ), don't overwrite the string.

------------------------------------------------------------------------
r40636 | etxrab | 2012-01-21 13:59:37 -0800 (Sat, 21 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/sminmpec.h

#define VENDOR_AT_AND_T				74
------------------------------------------------------------------------
r40635 | etxrab | 2012-01-21 13:45:33 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

Try to fix
packet-csn1.c:179: warning: 'pui8' may be used uninitialized in this function
------------------------------------------------------------------------
r40634 | etxrab | 2012-01-21 12:26:46 -0800 (Sat, 21 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

Add the missing file from
http://anonsvn.wireshark.org/viewvc/viewvc.cgi?view=rev&revision=40627

Patch was whining about csn1.h fixing that i must have missed that csn1.c did not get patched.
------------------------------------------------------------------------
r40633 | alagoutte | 2012-01-21 10:56:01 -0800 (Sat, 21 Jan 2012) | 23 lines
Changed paths:
   M /trunk/u3.h
   M /trunk/ui/qt/QtShark.pro
   M /trunk/ui/qt/main.cpp

Fix -v for QtShark

./Wireshark -v
wireshark 1.7.1 (SVN Rev Unknown from unknown)

Copyright 1998-2012 Gerald Combs <gerald@wireshark.org> and contributors.
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Compiled (64-bit) with Qt 4.7.4 with GLib 2.30.0, with libpcap (version
unknown), with libz 1.2.3.4, with POSIX capabilities (Linux), with SMI 0.4.8,
with c-ares 1.7.4, with Lua 5.1, without Python, with GnuTLS 2.10.5, with Gcrypt
1.5.0, with MIT Kerberos, with GeoIP, with PortAudio V19-devel (built Jul 27
2011 11:52:20), without AirPcap.

Running on Linux 3.0.0-13-generic, with locale fr_FR.UTF-8, with libpcap version
1.1.1, with libz 1.2.3.4, GnuTLS 2.10.5, Gcrypt 1.5.0.

Built using gcc 4.6.1.

get_gui_compiled_info & get_gui_runtime_info copied from ../gtk/main.c 
the function is common to GTK and Qt need to put in version_info.[ch] ?

------------------------------------------------------------------------
r40632 | alagoutte | 2012-01-21 08:59:11 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/.gitignore

Update gitignore after the change of gtk directory

------------------------------------------------------------------------
r40631 | cmaynard | 2012-01-21 08:09:08 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Revert a recent spelling change back to its UK variant.

------------------------------------------------------------------------
r40630 | tuexen | 2012-01-21 04:29:05 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Sync checkapi target with Makefile.common.

------------------------------------------------------------------------
r40629 | tuexen | 2012-01-21 04:22:01 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dfilter/Makefile.am

Sync checkapi target with Makefile.nmake.

------------------------------------------------------------------------
r40628 | etxrab | 2012-01-21 04:21:29 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/goose/goose.asn
   M /trunk/epan/dissectors/packet-goose.c

From Martin Lutz:
Updated the GOOSE dissector ASN.1 file to be able to display data for UTC timestamps.
------------------------------------------------------------------------
r40627 | etxrab | 2012-01-21 04:08:14 -0800 (Sat, 21 Jan 2012) | 34 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.h
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

From Mike Morrin:
a patch which improves several aspects of GSM RLS/MAC
dissection.

Generic improvements to the csn.1 dissector include:
•    Added a flag to the type descriptor structure so that any type can
(potentially) flagged as xxx_OR_NULL.  This was specifically needed for
UINT_OR_NULL for the ms capabilities struct.
•    Corrected the octet calculation in app of the proto_tree_add_text() and
proto_item_set_len() calls.
•    Changed the CSN_SERIALIZE so that the length of the length field can be
specified.
•    For CSN_NEXT_EXIST removed the requirement that the next type be CSN_END,
to allow truncation of multiple IEs.
•    For CSN_LEFT_ALIGNED_VAR_BITMAP corrected the handling of bit_offset.
•    Added a new type CSN_PADDING_BITS to make inspection of padding bits more
convenient.
•    Improved the CSN_RECURSIVE_TARRAY_1 to show the array index.

Improvements to the gsm_rlcmac dissector include:
•    Comment out a couple of unused hf variables.
•    Rework the definition of EGPRS Ack/Nack Description so that the length IE
(and absence thereof) is handled correctly.  This is the original issue for
which the bug was raised.
•    Added Padding Bits definitions to all PDUs
•    Change the Multislot_capability_t and Content_t definitions to allow
truncation at any IE
•    Added proto_tree_add_protocol_format() calls so that the protocol can be
added to a display filter
•    Append Protocol to the PROTOCOL column and PDU type to the INFO column.

From me get rid of C++ style comments.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6375
------------------------------------------------------------------------
r40626 | tuexen | 2012-01-21 04:06:31 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/wsutil/Makefile.am

Sync checkapi target with Makefile.nmake.

------------------------------------------------------------------------
r40625 | tuexen | 2012-01-21 03:45:57 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.am

Get make checkapi working again.

------------------------------------------------------------------------
r40624 | guy | 2012-01-21 03:27:59 -0800 (Sat, 21 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Add missing variable.

------------------------------------------------------------------------
r40623 | guy | 2012-01-21 00:59:21 -0800 (Sat, 21 Jan 2012) | 4 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/wtap-int.h
   M /trunk/wiretap/wtap.def
   M /trunk/wiretap/wtap.h

Replace wtap_file_extensions_string() with a routine that returns a
GSList of extensions for a file type, including extensions for the
compressed versions of those file types that we can read.

------------------------------------------------------------------------
r40622 | guy | 2012-01-20 20:00:43 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap.h

It's the Xoraya file type, not the Xoraya encapsulation, that was bogus.

------------------------------------------------------------------------
r40621 | guy | 2012-01-20 19:55:40 -0800 (Fri, 20 Jan 2012) | 10 lines
Changed paths:
   M /trunk/wiretap/file_access.c

"*.*" as a pattern for a given file type is pointless, as it doesn't
select only files of that type; you might as well use "All Files (*.*)"
for that.

The default suffix is a suffix, not a pattern, so it shouldn't be
"*.{something}".

We only use the patterns on Windows, where file names are
case-insensitive, so there's no point in capital letters in suffixes.

------------------------------------------------------------------------
r40620 | guy | 2012-01-20 19:52:19 -0800 (Fri, 20 Jan 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.h

Get rid of an unused file type.  If somebody wants it in the official
Wireshark distribution, give us code to read it.  If somebody wants it
in their private version of Wireshark, they can manage that themselves. 
(We should support plugins for file types at some point; I think we
already have support for Lua file readers.)

------------------------------------------------------------------------
r40619 | cmaynard | 2012-01-20 18:39:59 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Fix a comment and some typos.

------------------------------------------------------------------------
r40618 | guy | 2012-01-20 17:52:11 -0800 (Fri, 20 Jan 2012) | 4 lines
Changed paths:
   M /trunk/doc/README.qt

Or maybe we should just act as if QMake didn't exist and just try
letting Boring Old Make do it; I have that autotools+make working with a
--with-qt option, albeit in a not-yet-ready-for-prime-time state.

------------------------------------------------------------------------
r40617 | martinm | 2012-01-20 17:38:04 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/tap-rlcltestat.c

Set next pointer to NULL to avoid chasing non-existent UEs in list.

------------------------------------------------------------------------
r40616 | cmaynard | 2012-01-20 14:03:52 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-packetbb.c

Avoid a potential infinite loop by stopping dissection when a message has no tlvblock.  Patch from Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6687

------------------------------------------------------------------------
r40615 | cmaynard | 2012-01-20 13:20:53 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/drag_and_drop.c

Convert forward slashes in URI to backslashes if WIN32.  Patch from Cal Turney via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5237

------------------------------------------------------------------------
r40614 | cmaynard | 2012-01-20 12:20:40 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lisp.c
   M /trunk/epan/dissectors/packet-ltp.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40613 | cmaynard | 2012-01-20 12:12:44 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldp.c

Change display filter name from "ldp.tlv...." to "ldp.msg.tlv...." to be like the rest.

------------------------------------------------------------------------
r40612 | cmaynard | 2012-01-20 11:40:13 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iuup.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40611 | cmaynard | 2012-01-20 11:18:41 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ismp.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40610 | cmaynard | 2012-01-20 10:53:06 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Fix Coverity CID 1366: MISSING BREAK

------------------------------------------------------------------------
r40609 | cmaynard | 2012-01-20 10:41:10 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sua.c

Fix Coverity CID 1369: UNUSED_VALUE by deleting duplicate and unecessary line of code.

------------------------------------------------------------------------
r40608 | cmaynard | 2012-01-20 10:35:56 -0800 (Fri, 20 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Fix Coverity CID 1370: UNREACHABLE by deleting erroneous break;

------------------------------------------------------------------------
r40607 | gerald | 2012-01-20 10:30:44 -0800 (Fri, 20 Jan 2012) | 8 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/doc/README.qt
   M /trunk/ui/qt/QtShark.pro

Add more configuration information to config.pri which lets us remove
more hard-coded definitions from QtShark.pro. Quote an error message to
fix a Qt Creator complaint.

Add ui\qt\config.pri to the top-level "all" nmake target.

Update README.qt.

------------------------------------------------------------------------
r40606 | jmayer | 2012-01-20 08:12:24 -0800 (Fri, 20 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

As reported by hyphenated on #wireshark:
don't increase offset by 4 after two add_item(...,2 ,...) commands.
Increase by 2 after each add_item instead.

------------------------------------------------------------------------
r40605 | jmayer | 2012-01-20 03:02:15 -0800 (Fri, 20 Jan 2012) | 1 line
Changed paths:
   M /trunk/CMakeLists.txt

Manually revert the changes to CMakeLists.txt from commit 40602 - they should not be necessary/are wrong
------------------------------------------------------------------------
r40604 | jake | 2012-01-19 23:49:12 -0800 (Thu, 19 Jan 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

From Pascal Quantin:
Some test equipments can send weird Protocol Configuration Options IE in the
Attach Accept message with an empty protocol identifier content. Wireshark 
will trigger an assert when dissecting those messages because it does not 
check the tvb length before calling the sub dissector.
With checking the protocol identifier length before calling the sub dissector,
the PCO is decoded correctly.
------------------------------------------------------------------------
r40603 | wmeier | 2012-01-19 19:24:05 -0800 (Thu, 19 Jan 2012) | 26 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bt-dht.c

Fix Fix "bt-dht [..] NOT registered properly" as reported in Bug #6571.

"bt-dht [...] should also be common dissectors while not only heuristic
ones. So we can use them with 'Decode As...' command."

Essentially:
 -Register dissector handle so the dissector can be accessed via "decode-as".

From me:
   1. Given that the current heuristic is much too weak and
      causes 'false positives':
        Add a preference to allow enabling/disabling of heuristic dissection.

      The default is 'disabled' since the current heuristic is quite weak.
      (For example: The heuristic incorrectly dissects about 40
       files in menagerie/public as being the BT-DHT protocol).
      Note: only heuristic dissection is disabled; 'decode-as' remains
            enabled.

Also:

1. Fix some bugs wherein bytes in the hex pane were not highlighted
   when a field was selected in the details pane.
2. Do some minor re-formatting of the source code.


------------------------------------------------------------------------
r40602 | morriss | 2012-01-19 19:20:35 -0800 (Thu, 19 Jan 2012) | 5 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt
   M /trunk/configure.in

Bug 6448 says the embedded Python stuff does not really work.
And if I run Valgrind with Python enabled, I get pages of errors related to it.

So: disable Python by default.

------------------------------------------------------------------------
r40601 | wmeier | 2012-01-19 18:43:37 -0800 (Thu, 19 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/packet.c
   M /trunk/epan/packet.h

Add 'heur_dissector_set_enabled()' to allow a dissector to enable/disable heuristic dissection;
Rename some vars;
Do some minor re-indentation and whitespace changes.

------------------------------------------------------------------------
r40600 | gerald | 2012-01-19 17:10:40 -0800 (Thu, 19 Jan 2012) | 5 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/ui/qt/QtShark.pro

Try copying our plugins to an accessible directory. This assumes you've set
WIRESHARK_RUN_FROM_BUILD_DIRECTORY in your run environment.

On Windows, generate a QMake include file (config.pri) from config.nmake.

------------------------------------------------------------------------
r40599 | gerald | 2012-01-19 16:01:53 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/byte_view_text.cpp
   M /trunk/ui/qt/main.cpp
   M /trunk/ui/qt/packet_list_model.cpp

Remove or mark unused variables.

------------------------------------------------------------------------
r40598 | jmayer | 2012-01-19 15:58:25 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/doc/README.qt

Slightly more details on building the qt version on Linux.

------------------------------------------------------------------------
r40597 | rbalint | 2012-01-19 14:55:52 -0800 (Thu, 19 Jan 2012) | 1 line
Changed paths:
   M /trunk/tools/compare-abis.sh

Update abi-compliance-checker options to be compatible with 1.96.1
------------------------------------------------------------------------
r40596 | rbalint | 2012-01-19 14:55:46 -0800 (Thu, 19 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-acse.h
   M /trunk/epan/dissectors/packet-iax2.h
   M /trunk/epan/dissectors/packet-idmp.h

Update generated headers changed by last commit
------------------------------------------------------------------------
r40595 | rbalint | 2012-01-19 14:55:37 -0800 (Thu, 19 Jan 2012) | 1 line
Changed paths:
   M /trunk/asn1/acse/packet-acse-template.h
   M /trunk/asn1/idmp/packet-idmp-template.h
   M /trunk/epan/Makefile.am
   M /trunk/epan/crypt/airpdcap_int.h
   M /trunk/epan/dissectors/packet-alcap.h
   M /trunk/epan/dissectors/packet-fc.h
   M /trunk/epan/dissectors/packet-fix.c
   M /trunk/epan/dissectors/packet-fix.h
   M /trunk/epan/dissectors/packet-iax2.h
   M /trunk/epan/dissectors/packet-ses.h
   M /trunk/epan/dissectors/packet-xmpp-conference.h
   M /trunk/epan/dissectors/packet-xmpp-core.h
   M /trunk/epan/dissectors/packet-xmpp-gtalk.h
   M /trunk/epan/dissectors/packet-xmpp-jingle.h
   M /trunk/epan/dissectors/packet-xmpp-other.h
   M /trunk/epan/dissectors/rpc_defrag.h
   M /trunk/epan/reassemble.h
   M /trunk/fix/README
   M /trunk/fix/Values.xsl
   M /trunk/wsutil/Makefile.am

fix compile errors found by dumpabi target
------------------------------------------------------------------------
r40594 | jmayer | 2012-01-19 14:32:22 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/wireshark.sln

gtk moved to ui/ missed this file on checkin

------------------------------------------------------------------------
r40593 | jmayer | 2012-01-19 14:18:06 -0800 (Thu, 19 Jan 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Fix:

/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-rohc.c: In function ‘dissect_rohc_ir_rtp_profile_dynamic’:
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-rohc.c:775:21: error: variable ‘cc’ set but not used [-Werror=unused-but-set-variable]
cc1: all warnings being treated as errors



------------------------------------------------------------------------
r40592 | cmaynard | 2012-01-19 13:57:24 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-hdfs.c
   M /trunk/epan/dissectors/packet-homeplug.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-isns.c
   M /trunk/epan/dissectors/packet-isup.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40591 | cmaynard | 2012-01-19 13:01:52 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-egd.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-ff.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-gtp.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40590 | cmaynard | 2012-01-19 12:19:28 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cpha.c
   M /trunk/epan/dissectors/packet-dplay.c
   M /trunk/epan/dissectors/packet-dpnss.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-dtpt.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40589 | etxrab | 2012-01-19 11:43:02 -0800 (Thu, 19 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Update comments and dissection of comptessed lists
------------------------------------------------------------------------
r40588 | cmaynard | 2012-01-19 11:33:21 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-disp.c
   M /trunk/epan/dissectors/packet-mms.c

Update a couple of asn1-generated dissectors.

------------------------------------------------------------------------
r40587 | cmaynard | 2012-01-19 11:25:33 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xtp.c

Fix a duplicate display filter name.

------------------------------------------------------------------------
r40586 | cmaynard | 2012-01-19 11:15:13 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bssap.c
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-cast.c
   M /trunk/epan/dissectors/packet-cfm.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40585 | wmeier | 2012-01-19 09:42:28 -0800 (Thu, 19 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hdcp.c
   M /trunk/epan/dissectors/packet-mim.c
   M /trunk/epan/dissectors/packet-prp.c

Localize a global variable; Do minor reformatting.

------------------------------------------------------------------------
r40584 | wmeier | 2012-01-19 06:22:46 -0800 (Thu, 19 Jan 2012) | 3 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

Update list of deprecated GLib fcns;
Add comment about Wireshark build defines G_DISABLE_DEPRECATED.

------------------------------------------------------------------------
r40583 | tuexen | 2012-01-19 05:02:32 -0800 (Thu, 19 Jan 2012) | 5 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.am
   M /trunk/ui/gtk/Makefile.common
   A /trunk/ui/gtk/pipe_icon.h

Add icons for pipe interfaces. This allows for easier
testing the upcoming patch, which improves the
infrastructure to handle interfaces for capturing.
Obtained from Irene Ruengeler.

------------------------------------------------------------------------
r40582 | martinm | 2012-01-18 19:45:11 -0800 (Wed, 18 Jan 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte-framed.c

Comment out hf and ett - there is no need to register them while they
are empty.

------------------------------------------------------------------------
r40581 | martinm | 2012-01-18 19:27:41 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte-framed.c

Add casts and don't initialise empty hf array.

------------------------------------------------------------------------
r40580 | martinm | 2012-01-18 18:58:53 -0800 (Wed, 18 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-mac-lte-framed.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-mac-lte.h

Add a dissector "mac-lte-framed" that uses the same framing format as
the existing "mac-lte" UDP heuristic dissector. It is hoped that it will be
possible to register a DLT for use with this format.

------------------------------------------------------------------------
r40579 | guy | 2012-01-18 15:41:07 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/qt_ui_utils.h

Get rid of no-longer-applicable comments.

------------------------------------------------------------------------
r40578 | guy | 2012-01-18 15:40:04 -0800 (Wed, 18 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/qt/capture_interface_dialog.cpp
   M /trunk/ui/qt/qt_ui_utils.h

Get rid of some redeclarations, include "ui/recent_utils.h" to get those
declarations.

------------------------------------------------------------------------
r40577 | guy | 2012-01-18 15:37:50 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/capture_interface_dialog.cpp

Another fix for the move of recent.h.

------------------------------------------------------------------------
r40576 | guy | 2012-01-18 14:05:47 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/network_instruments.h

Line up #define values.

------------------------------------------------------------------------
r40575 | guy | 2012-01-18 14:05:01 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/network_instruments.c

Tabs are not *ipso facto* 4 spaces.

------------------------------------------------------------------------
r40574 | alagoutte | 2012-01-18 14:00:18 -0800 (Wed, 18 Jan 2012) | 6 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro

Following the move of recent.*

Fix : No rule to make target « ../gtk/recent.c », needed for « recent.c ». Stop.

Not need to copy recent.c in qt working directory and use the common recent.c file.

------------------------------------------------------------------------
r40573 | alagoutte | 2012-01-18 13:44:21 -0800 (Wed, 18 Jan 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

From Yaniv Kaul via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6743
[PATCH] Enhance the Spice dissector to deal with mini headers

Spice recently gained the ability to use smaller packet headers.
This patch adds support to it, along with small other fixes/enhancements - none of which really interesting.

From me :
Fix a Clang Warning :
packet-spice.c:1303:5: warning: Value stored to 'offset' is never read

------------------------------------------------------------------------
r40572 | wmeier | 2012-01-18 13:37:55 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

Fix a typo; Remove a dup.

------------------------------------------------------------------------
r40571 | alagoutte | 2012-01-18 13:23:30 -0800 (Wed, 18 Jan 2012) | 5 lines
Changed paths:
   M /trunk/wiretap/network_instruments.c
   M /trunk/wiretap/network_instruments.h

From Tom Brezinski via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6746
Adding support for Network Instruments 802.11 wireless captures

Attaching very simple change to allow reading of Network Instruments Observer 802.11 wireless capture files.

------------------------------------------------------------------------
r40570 | cmaynard | 2012-01-18 13:20:50 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/cms/packet-cms-template.c
   M /trunk/asn1/kerberos/packet-kerberos-template.c
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/asn1/spnego/packet-spnego-template.c

#include <epan/crypt/crypt-*.h> => #include <epan/crypt/*.h>

------------------------------------------------------------------------
r40569 | wmeier | 2012-01-18 13:08:18 -0800 (Wed, 18 Jan 2012) | 7 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

Update:
 - Mark GDK functions which aren't used as 'E'
 - Add GTK functions deprecated after GTK 2.20
 - Add some comments about use of GTK_DISABLE_DEPRECATED
 - reformat
   ...

------------------------------------------------------------------------
r40568 | cmaynard | 2012-01-18 13:07:53 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/epan/dissectors/packet-9p.c
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-aoe.c
   M /trunk/epan/dissectors/packet-babel.c

Fix some duplicate display filter names.

------------------------------------------------------------------------
r40567 | guy | 2012-01-18 12:55:55 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

New include file needs to be included.

------------------------------------------------------------------------
r40566 | guy | 2012-01-18 12:38:51 -0800 (Wed, 18 Jan 2012) | 3 lines
Changed paths:
   M /trunk/ui/gtk/capture_dlg.c

Another change for the recent changes (in both senses of "recent
changes" :-)).

------------------------------------------------------------------------
r40565 | guy | 2012-01-18 12:23:30 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/ui/gtk/CMakeLists.txt

Reflect the move of recent.c from ui/gtk to the top-level directory.

------------------------------------------------------------------------
r40564 | guy | 2012-01-18 12:11:06 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_airpcap_toolbar.c

Another fix for the move of recent.h to the ui directory.

------------------------------------------------------------------------
r40563 | guy | 2012-01-18 11:59:13 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/display_filter_combo.cpp
   M /trunk/ui/qt/main.cpp
   M /trunk/ui/qt/packet_list.cpp
   M /trunk/ui/qt/qt_ui_utils.cpp
   M /trunk/ui/qt/wireshark_application.cpp

Reflect the changes to make the recent-file code GUI-independent.

------------------------------------------------------------------------
r40562 | guy | 2012-01-18 11:47:44 -0800 (Wed, 18 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.common
   A /trunk/ui/last_open_dir.h
   A /trunk/ui/recent_utils.h

Add some files that didn't get checked in.

------------------------------------------------------------------------
r40561 | guy | 2012-01-18 11:38:34 -0800 (Wed, 18 Jan 2012) | 4 lines
Changed paths:
   M /trunk/Makefile.common
   A /trunk/recent.c (from /trunk/ui/gtk/recent.c:40560)
   M /trunk/ui/gtk/Makefile.common
   M /trunk/ui/gtk/about_dlg.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_dlg.h
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/cfilter_combo_utils.c
   M /trunk/ui/gtk/cfilter_combo_utils.h
   M /trunk/ui/gtk/drag_and_drop.c
   M /trunk/ui/gtk/export_sslkeys.c
   M /trunk/ui/gtk/file_dlg.h
   M /trunk/ui/gtk/firewall_dlg.c
   M /trunk/ui/gtk/follow_stream.c
   M /trunk/ui/gtk/font_utils.c
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/gui_utils.h
   M /trunk/ui/gtk/iax2_analysis.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main.h
   M /trunk/ui/gtk/main_filter_toolbar.c
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/main_proto_draw.c
   M /trunk/ui/gtk/main_statusbar.c
   M /trunk/ui/gtk/main_toolbar.c
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/menus.h
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/ui/gtk/new_packet_list.h
   M /trunk/ui/gtk/packet_win.c
   M /trunk/ui/gtk/pixmap_save.c
   M /trunk/ui/gtk/prefs_gui.c
   M /trunk/ui/gtk/profile_dlg.c
   D /trunk/ui/gtk/recent.c
   D /trunk/ui/gtk/recent.h
   M /trunk/ui/gtk/rtp_analysis.c
   M /trunk/ui/gtk/rtp_stream_dlg.c
   M /trunk/ui/gtk/wlan_stat_dlg.c
   M /trunk/ui/qt/qt_ui_utils.h
   A /trunk/ui/recent.h (from /trunk/ui/gtk/recent.h:40560)
   M /trunk/ui/ui_util.h

Restructure the recent file code so that recent.c is GUI-independent;
move it to the top-level source directory for now, and move
ui/gtk/recent.h to the ui directory.

------------------------------------------------------------------------
r40560 | etxrab | 2012-01-17 13:27:48 -0800 (Tue, 17 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Add more to dissect_compressed_list()
------------------------------------------------------------------------
r40559 | jmayer | 2012-01-17 10:27:01 -0800 (Tue, 17 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Fix warning about a variable that is written to only.

------------------------------------------------------------------------
r40558 | martinm | 2012-01-17 10:23:11 -0800 (Tue, 17 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Mark a couple of unused parameters as such.

------------------------------------------------------------------------
r40557 | etxrab | 2012-01-17 09:57:52 -0800 (Tue, 17 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Enhance dissection of compressed lists.
------------------------------------------------------------------------
r40556 | guy | 2012-01-16 21:22:56 -0800 (Mon, 16 Jan 2012) | 3 lines
Changed paths:
   M /trunk/configure.in

Indicate which version of GTK+ is being used to build Wireshark, and
also indicate if we're including the Mac OS X integration library.

------------------------------------------------------------------------
r40555 | guy | 2012-01-16 20:50:56 -0800 (Mon, 16 Jan 2012) | 2 lines
Changed paths:
   M /trunk/configure.in

Fix typo.

------------------------------------------------------------------------
r40554 | guy | 2012-01-16 20:48:13 -0800 (Mon, 16 Jan 2012) | 4 lines
Changed paths:
   M /trunk/configure.in

Fix test (equality in the test command is =, not ==).

Split lines.

------------------------------------------------------------------------
r40553 | guy | 2012-01-16 20:45:12 -0800 (Mon, 16 Jan 2012) | 7 lines
Changed paths:
   M /trunk/configure.in

Rename the GTK_OK variable to have_gtk; make sure it's always set.  Test
it, instead of no_gtk, to see whether we should check for the OS X
integration functions; I think no_gtk is an internal detail of the
autoconf macros for GTK+, so let's not depend on it.

Clean up indentation.

------------------------------------------------------------------------
r40552 | etxrab | 2012-01-16 13:45:02 -0800 (Mon, 16 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Add packet-lpp.h
------------------------------------------------------------------------
r40551 | etxrab | 2012-01-16 13:41:54 -0800 (Mon, 16 Jan 2012) | 6 lines
Changed paths:
   A /trunk/asn1/lpp/packet-lpp-template.h

From Pascal Quantin:
Upgrade LTE RRC dissector to v10.4.0

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6742

Add missing file
------------------------------------------------------------------------
r40550 | etxrab | 2012-01-16 13:38:32 -0800 (Mon, 16 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-lpp.h

From Pascal Quantin:
Upgrade LTE RRC dissector to v10.4.0

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6742

Add missing files
------------------------------------------------------------------------
r40549 | etxrab | 2012-01-16 13:25:20 -0800 (Mon, 16 Jan 2012) | 4 lines
Changed paths:
   M /trunk/asn1/lpp/lpp.cnf
   M /trunk/asn1/lte-rrc/EUTRA-InterNodeDefinitions.asn
   M /trunk/asn1/lte-rrc/EUTRA-RRC-Definitions.asn
   M /trunk/asn1/lte-rrc/EUTRA-UE-Variables.asn
   M /trunk/asn1/lte-rrc/lte-rrc.cnf
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/packet-lpp.c
   M /trunk/epan/dissectors/packet-lte-rrc.c

From Pascal Quantin:
Upgrade LTE RRC dissector to v10.4.0

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6742
------------------------------------------------------------------------
r40548 | wmeier | 2012-01-16 11:31:44 -0800 (Mon, 16 Jan 2012) | 2 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

The last GMemChunk usage in Wireshark has been replaced; Error out for any such usage.

------------------------------------------------------------------------
r40547 | wmeier | 2012-01-16 11:05:32 -0800 (Mon, 16 Jan 2012) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_runtime.c
   M /trunk/plugins/mate/mate_util.c
   M /trunk/plugins/mate/mate_util.h

Use GSlice API instead of GMemChunk API for some memory allocation.

------------------------------------------------------------------------
r40546 | wmeier | 2012-01-16 10:12:18 -0800 (Mon, 16 Jan 2012) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate_parser.l

Fix a typo in an error message.

------------------------------------------------------------------------
r40545 | guy | 2012-01-16 00:16:50 -0800 (Mon, 16 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-drda.c

The frame number is an unsigned integer, so there's no guarantee that it
won't equal (guint32)-1.

Fortunately, frame numbers are 1-based, so there *is* a guarantee that
it won't equal 0.

------------------------------------------------------------------------
r40544 | guy | 2012-01-16 00:10:49 -0800 (Mon, 16 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtmpt.c

The frame number is an unsigned integer, so there's no guarantee that it
won't equal (guint32)-1.

Fortunately, frame numbers are 1-based, so there *is* a guarantee that
it won't equal 0.

------------------------------------------------------------------------
r40543 | guy | 2012-01-16 00:01:58 -0800 (Mon, 16 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mq.c

The frame number is an unsigned integer, so there's no guarantee that it
won't equal (guint32)-1.

Fortunately, frame numbers are 1-based, so there *is* a guarantee that
it won't equal 0.

------------------------------------------------------------------------
r40542 | jmayer | 2012-01-15 19:25:55 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

move alert box for cmake builds as well

------------------------------------------------------------------------
r40541 | guy | 2012-01-15 19:23:22 -0800 (Sun, 15 Jan 2012) | 5 lines
Changed paths:
   M /trunk/Makefile.common
   A /trunk/alert_box.c (from /trunk/ui/alert_box.c:40530)
   D /trunk/ui/alert_box.c

Move alert_box.c back up to the top-level directory for now, to fix the
Windows build.  We probably want to construct a "ui" (static) library
the same way we construct the libwireshark (dynamic) library, out of
stuff in the ui directory and the relevant subdirectories.

------------------------------------------------------------------------
r40540 | wmeier | 2012-01-15 18:56:00 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/airpcap_loader.c

#include "simple_dialog.h" ==> #include "ui/simple-dislog.h"

------------------------------------------------------------------------
r40539 | guy | 2012-01-15 18:37:06 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

Another fixup for the move of win32 to ui\win32.

------------------------------------------------------------------------
r40538 | jmayer | 2012-01-15 18:28:38 -0800 (Sun, 15 Jan 2012) | 1 line
Changed paths:
   M /trunk/CMakeLists.txt

alert_box.c moved to ui/
------------------------------------------------------------------------
r40537 | guy | 2012-01-15 18:17:03 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Just include it from the current directory.

------------------------------------------------------------------------
r40536 | guy | 2012-01-15 18:16:30 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/file_dlg_win32.c

Another fix for the move of the win32 directory.

------------------------------------------------------------------------
r40535 | guy | 2012-01-15 17:56:18 -0800 (Sun, 15 Jan 2012) | 3 lines
Changed paths:
   M /trunk/image/file_dlg_win32.rc

Another change for the move of the top-level win32 directory into the ui
directory.

------------------------------------------------------------------------
r40534 | guy | 2012-01-15 17:45:26 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/win32/Makefile.nmake

Fix up for the move from the top-level directory to the ui directory.

------------------------------------------------------------------------
r40533 | guy | 2012-01-15 17:31:08 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/main_airpcap_toolbar.c

Reflect the move of simple_dialog.h to the ui directory.

------------------------------------------------------------------------
r40532 | guy | 2012-01-15 17:29:08 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/export_sslkeys.c
   M /trunk/ui/gtk/follow_stream.c
   M /trunk/ui/gtk/follow_tcp.c
   M /trunk/ui/gtk/main_proto_draw.c
   M /trunk/ui/gtk/print_dlg.c

Reflect the move of the top-level win32 directory into the ui directory.

------------------------------------------------------------------------
r40531 | guy | 2012-01-15 17:26:46 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.nmake
   A /trunk/ui/win32 (from /trunk/win32:40525)
   D /trunk/win32

Make the win32 directory a subdirectory of the ui directory.

------------------------------------------------------------------------
r40530 | guy | 2012-01-15 17:18:56 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/main.cpp
   M /trunk/ui/qt/main_status_bar.cpp
   M /trunk/ui/qt/main_window.cpp
   M /trunk/ui/qt/packet_list.cpp
   M /trunk/ui/qt/progress_dialog.cpp
   M /trunk/ui/qt/simple_dialog_qt.cpp

Reflect the move of some header files to the ui directory.

------------------------------------------------------------------------
r40529 | guy | 2012-01-15 17:07:52 -0800 (Sun, 15 Jan 2012) | 8 lines
Changed paths:
   M /trunk/Makefile.common
   D /trunk/alert_box.c
   D /trunk/alert_box.h
   M /trunk/capture.c
   M /trunk/capture_sync.c
   M /trunk/color_filters.c
   M /trunk/file.c
   D /trunk/main_statusbar.h
   D /trunk/progress_dlg.h
   M /trunk/proto_hier_stats.c
   D /trunk/simple_dialog.h
   A /trunk/ui/alert_box.c (from /trunk/alert_box.c:40525)
   A /trunk/ui/alert_box.h (from /trunk/alert_box.h:40525)
   M /trunk/ui/gtk/afp_stat.c
   M /trunk/ui/gtk/airpcap_dlg.c
   M /trunk/ui/gtk/airpcap_gui_utils.c
   M /trunk/ui/gtk/ansi_a_stat.c
   M /trunk/ui/gtk/ansi_map_stat.c
   M /trunk/ui/gtk/bootp_stat.c
   M /trunk/ui/gtk/camel_counter.c
   M /trunk/ui/gtk/camel_srt.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/capture_if_details_dlg_win32.c
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/color_dlg.c
   M /trunk/ui/gtk/color_edit_dlg.c
   M /trunk/ui/gtk/color_utils.c
   M /trunk/ui/gtk/compare_stat.c
   M /trunk/ui/gtk/conversations_table.c
   M /trunk/ui/gtk/dcerpc_stat.c
   M /trunk/ui/gtk/decode_as_ber.c
   M /trunk/ui/gtk/decode_as_dcerpc.c
   M /trunk/ui/gtk/decode_as_dlg.c
   M /trunk/ui/gtk/dfilter_expr_dlg.c
   M /trunk/ui/gtk/diameter_stat.c
   M /trunk/ui/gtk/drag_and_drop.c
   M /trunk/ui/gtk/expert_comp_dlg.c
   M /trunk/ui/gtk/expert_comp_table.c
   M /trunk/ui/gtk/export_object.c
   M /trunk/ui/gtk/export_sslkeys.c
   M /trunk/ui/gtk/fc_stat.c
   M /trunk/ui/gtk/file_import_dlg.c
   M /trunk/ui/gtk/fileset_dlg.c
   M /trunk/ui/gtk/filter_dlg.c
   M /trunk/ui/gtk/filter_expression_save_dlg.c
   M /trunk/ui/gtk/find_dlg.c
   M /trunk/ui/gtk/firewall_dlg.c
   M /trunk/ui/gtk/flow_graph.c
   M /trunk/ui/gtk/follow_ssl.c
   M /trunk/ui/gtk/follow_stream.c
   M /trunk/ui/gtk/follow_tcp.c
   M /trunk/ui/gtk/follow_udp.c
   M /trunk/ui/gtk/font_utils.c
   M /trunk/ui/gtk/funnel_stat.c
   M /trunk/ui/gtk/goto_dlg.c
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/ui/gtk/gsm_a_stat.c
   M /trunk/ui/gtk/gsm_map_stat.c
   M /trunk/ui/gtk/gtp_stat.c
   M /trunk/ui/gtk/gui_stat_util.c
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/h225_counter.c
   M /trunk/ui/gtk/h225_ras_srt.c
   M /trunk/ui/gtk/help_dlg.c
   M /trunk/ui/gtk/hostlist_table.c
   M /trunk/ui/gtk/iax2_analysis.c
   M /trunk/ui/gtk/io_stat.c
   M /trunk/ui/gtk/ldap_stat.c
   M /trunk/ui/gtk/mac_lte_stat_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/main_proto_draw.c
   M /trunk/ui/gtk/main_statusbar.c
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/manual_addr_resolv.c
   M /trunk/ui/gtk/mcast_stream.c
   M /trunk/ui/gtk/mcast_stream_dlg.c
   M /trunk/ui/gtk/megaco_stat.c
   M /trunk/ui/gtk/mgcp_stat.c
   M /trunk/ui/gtk/mtp3_stat.c
   M /trunk/ui/gtk/ncp_stat.c
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/ui/gtk/packet_list_store.c
   M /trunk/ui/gtk/packet_win.c
   M /trunk/ui/gtk/pixmap_save.c
   M /trunk/ui/gtk/prefs_capture.c
   M /trunk/ui/gtk/prefs_dlg.c
   M /trunk/ui/gtk/prefs_gui.c
   M /trunk/ui/gtk/prefs_layout.c
   M /trunk/ui/gtk/print_dlg.c
   M /trunk/ui/gtk/profile_dlg.c
   M /trunk/ui/gtk/progress_dlg.c
   M /trunk/ui/gtk/proto_dlg.c
   M /trunk/ui/gtk/proto_hier_stats_dlg.c
   M /trunk/ui/gtk/radius_stat.c
   M /trunk/ui/gtk/range_utils.c
   M /trunk/ui/gtk/recent.c
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c
   M /trunk/ui/gtk/rpc_stat.c
   M /trunk/ui/gtk/rtp_analysis.c
   M /trunk/ui/gtk/rtp_player.c
   M /trunk/ui/gtk/rtp_stream.c
   M /trunk/ui/gtk/rtp_stream_dlg.c
   M /trunk/ui/gtk/scsi_stat.c
   M /trunk/ui/gtk/sctp_assoc_analyse.c
   M /trunk/ui/gtk/sctp_byte_graph_dlg.c
   M /trunk/ui/gtk/sctp_chunk_stat.c
   M /trunk/ui/gtk/sctp_error_dlg.c
   M /trunk/ui/gtk/sctp_graph_dlg.c
   M /trunk/ui/gtk/sctp_stat.c
   M /trunk/ui/gtk/service_response_time_table.c
   M /trunk/ui/gtk/simple_dialog.c
   M /trunk/ui/gtk/sip_stat.c
   M /trunk/ui/gtk/smb2_stat.c
   M /trunk/ui/gtk/smb_stat.c
   M /trunk/ui/gtk/stats_tree_stat.c
   M /trunk/ui/gtk/tap_param_dlg.c
   M /trunk/ui/gtk/tcp_graph.c
   M /trunk/ui/gtk/text_page_utils.c
   M /trunk/ui/gtk/time_shift_dlg.c
   M /trunk/ui/gtk/voip_calls.c
   M /trunk/ui/gtk/voip_calls_dlg.c
   M /trunk/ui/gtk/webbrowser.c
   M /trunk/ui/gtk/wlan_stat_dlg.c
   M /trunk/ui/gtk/wsp_stat.c
   A /trunk/ui/main_statusbar.h (from /trunk/main_statusbar.h:40525)
   A /trunk/ui/progress_dlg.h (from /trunk/progress_dlg.h:40525)
   A /trunk/ui/simple_dialog.h (from /trunk/simple_dialog.h:40525)
   A /trunk/ui/ui_util.h (from /trunk/ui_util.h:40525)
   D /trunk/ui_util.h

Move some headers for UI stuff, and the alert_box.c UI-specific file, to
the ui directory.  (Perhaps some other files that would be used by all
flavors of Wireshark, for any GUI toolkit or for someting such as
ncurses, and not for any command-line tool such as TShark, should be
moved there as well.)

Shuffle some #includes to put the "ui/XXX.h" includes together.

------------------------------------------------------------------------
r40528 | jmayer | 2012-01-15 16:05:14 -0800 (Sun, 15 Jan 2012) | 3 lines
Changed paths:
   M /trunk/macosx-setup.sh

Fix bootstrap parameters for cmake
Conditionally display build instructions for the cmake case

------------------------------------------------------------------------
r40527 | wmeier | 2012-01-15 15:26:23 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/prefs_filter_expressions.c

Fix a typo in a comment ....

------------------------------------------------------------------------
r40526 | guy | 2012-01-15 15:23:40 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

The name of the target for ui/gtk/libui.lib is "gtk", not "ui\gtk".

------------------------------------------------------------------------
r40525 | wmeier | 2012-01-15 15:13:01 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

cd ../gtk ==> cd ../ui/gtk

------------------------------------------------------------------------
r40524 | jmayer | 2012-01-15 15:07:44 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.common

Missed another .. -> ../.. case

------------------------------------------------------------------------
r40523 | jmayer | 2012-01-15 14:40:03 -0800 (Sun, 15 Jan 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/Makefile.am
   M /trunk/ui/gtk/Makefile.common
   M /trunk/ui/gtk/about_dlg.c
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/prefs_layout.c
   M /trunk/ui/gtk/stock_icons.c

More .. -> ../.. changes after gtk/ move
------------------------------------------------------------------------
r40522 | jmayer | 2012-01-15 14:22:28 -0800 (Sun, 15 Jan 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/Makefile.nmake

More .. -> ../.. changes after gtk/ move
------------------------------------------------------------------------
r40521 | jmayer | 2012-01-15 14:12:28 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/gtk/Makefile.am

Clean up after gtk/ move: Makefile.am.inc is now at ../..

------------------------------------------------------------------------
r40520 | jmayer | 2012-01-15 14:09:43 -0800 (Sun, 15 Jan 2012) | 1 line
Changed paths:
   M /trunk/ui/gtk/graph_analysis.c

Add back revision 40517 which got lost during gtk/ move
------------------------------------------------------------------------
r40519 | jmayer | 2012-01-15 14:05:02 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   D /trunk/gtk

Remove gtk-dir

------------------------------------------------------------------------
r40518 | jmayer | 2012-01-15 13:59:11 -0800 (Sun, 15 Jan 2012) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.am
   M /trunk/Makefile.nmake
   M /trunk/configure.in
   M /trunk/epan/plugins.c
   M /trunk/epan/timestamp.c
   M /trunk/file.c
   D /trunk/gtk/CMakeLists.txt
   D /trunk/gtk/Makefile.am
   D /trunk/gtk/Makefile.common
   D /trunk/gtk/Makefile.nmake
   D /trunk/gtk/Makefile_custom.common
   D /trunk/gtk/STATUS.gtk3
   D /trunk/gtk/about_dlg.c
   D /trunk/gtk/about_dlg.h
   D /trunk/gtk/afp_stat.c
   D /trunk/gtk/airpcap_dlg.c
   D /trunk/gtk/airpcap_dlg.h
   D /trunk/gtk/airpcap_gui_utils.c
   D /trunk/gtk/airpcap_gui_utils.h
   D /trunk/gtk/ansi_a_stat.c
   D /trunk/gtk/ansi_map_stat.c
   D /trunk/gtk/bootp_stat.c
   D /trunk/gtk/camel_counter.c
   D /trunk/gtk/camel_srt.c
   D /trunk/gtk/capture_dlg.c
   D /trunk/gtk/capture_dlg.h
   D /trunk/gtk/capture_file_dlg.c
   D /trunk/gtk/capture_file_dlg.h
   D /trunk/gtk/capture_globals.h
   D /trunk/gtk/capture_if_details_dlg_win32.c
   D /trunk/gtk/capture_if_details_dlg_win32.h
   D /trunk/gtk/capture_if_dlg.c
   D /trunk/gtk/capture_if_dlg.h
   D /trunk/gtk/capture_info_dlg.c
   D /trunk/gtk/cfilter_combo_utils.c
   D /trunk/gtk/cfilter_combo_utils.h
   D /trunk/gtk/color_dlg.c
   D /trunk/gtk/color_dlg.h
   D /trunk/gtk/color_edit_dlg.c
   D /trunk/gtk/color_edit_dlg.h
   D /trunk/gtk/color_utils.c
   D /trunk/gtk/color_utils.h
   D /trunk/gtk/compare_stat.c
   D /trunk/gtk/conversations_eth.c
   D /trunk/gtk/conversations_fc.c
   D /trunk/gtk/conversations_fddi.c
   D /trunk/gtk/conversations_ip.c
   D /trunk/gtk/conversations_ipv6.c
   D /trunk/gtk/conversations_ipx.c
   D /trunk/gtk/conversations_jxta.c
   D /trunk/gtk/conversations_ncp.c
   D /trunk/gtk/conversations_rsvp.c
   D /trunk/gtk/conversations_sctp.c
   D /trunk/gtk/conversations_table.c
   D /trunk/gtk/conversations_table.h
   D /trunk/gtk/conversations_tcpip.c
   D /trunk/gtk/conversations_tr.c
   D /trunk/gtk/conversations_udpip.c
   D /trunk/gtk/conversations_usb.c
   D /trunk/gtk/conversations_wlan.c
   D /trunk/gtk/dcerpc_stat.c
   D /trunk/gtk/decode_as_ber.c
   D /trunk/gtk/decode_as_ber.h
   D /trunk/gtk/decode_as_dcerpc.c
   D /trunk/gtk/decode_as_dcerpc.h
   D /trunk/gtk/decode_as_dlg.c
   D /trunk/gtk/decode_as_dlg.h
   D /trunk/gtk/dfilter_expr_dlg.c
   D /trunk/gtk/dfilter_expr_dlg.h
   D /trunk/gtk/diameter_stat.c
   D /trunk/gtk/dissector_tables_dlg.c
   D /trunk/gtk/dissector_tables_dlg.h
   D /trunk/gtk/dlg_utils.c
   D /trunk/gtk/dlg_utils.h
   D /trunk/gtk/doxygen.cfg.in
   D /trunk/gtk/drag_and_drop.c
   D /trunk/gtk/drag_and_drop.h
   D /trunk/gtk/expert_comp_dlg.c
   D /trunk/gtk/expert_comp_dlg.h
   D /trunk/gtk/expert_comp_table.c
   D /trunk/gtk/expert_comp_table.h
   D /trunk/gtk/expert_indicators.h
   D /trunk/gtk/export_object.c
   D /trunk/gtk/export_object.h
   D /trunk/gtk/export_object_dicom.c
   D /trunk/gtk/export_object_http.c
   D /trunk/gtk/export_object_smb.c
   D /trunk/gtk/export_sslkeys.c
   D /trunk/gtk/export_sslkeys.h
   D /trunk/gtk/fc_stat.c
   D /trunk/gtk/file_dlg.c
   D /trunk/gtk/file_dlg.h
   D /trunk/gtk/file_import_dlg.c
   D /trunk/gtk/file_import_dlg.h
   D /trunk/gtk/fileset_dlg.c
   D /trunk/gtk/fileset_dlg.h
   D /trunk/gtk/filter_autocomplete.c
   D /trunk/gtk/filter_autocomplete.h
   D /trunk/gtk/filter_dlg.c
   D /trunk/gtk/filter_dlg.h
   D /trunk/gtk/filter_expression_save_dlg.c
   D /trunk/gtk/filter_expression_save_dlg.h
   D /trunk/gtk/filter_utils.c
   D /trunk/gtk/filter_utils.h
   D /trunk/gtk/find_dlg.c
   D /trunk/gtk/find_dlg.h
   D /trunk/gtk/firewall_dlg.c
   D /trunk/gtk/firewall_dlg.h
   D /trunk/gtk/flow_graph.c
   D /trunk/gtk/follow_ssl.c
   D /trunk/gtk/follow_ssl.h
   D /trunk/gtk/follow_stream.c
   D /trunk/gtk/follow_stream.h
   D /trunk/gtk/follow_tcp.c
   D /trunk/gtk/follow_tcp.h
   D /trunk/gtk/follow_udp.c
   D /trunk/gtk/follow_udp.h
   D /trunk/gtk/font_utils.c
   D /trunk/gtk/font_utils.h
   D /trunk/gtk/funnel_stat.c
   D /trunk/gtk/goto_dlg.c
   D /trunk/gtk/goto_dlg.h
   D /trunk/gtk/graph_analysis.c
   D /trunk/gtk/graph_analysis.h
   D /trunk/gtk/gsm_a_stat.c
   D /trunk/gtk/gsm_map_stat.c
   D /trunk/gtk/gsm_map_stat.h
   D /trunk/gtk/gsm_map_summary.c
   D /trunk/gtk/gtkglobals.h
   D /trunk/gtk/gtp_stat.c
   D /trunk/gtk/gui_stat_menu.h
   D /trunk/gtk/gui_stat_util.c
   D /trunk/gtk/gui_stat_util.h
   D /trunk/gtk/gui_utils.c
   D /trunk/gtk/gui_utils.h
   D /trunk/gtk/h225_counter.c
   D /trunk/gtk/h225_ras_srt.c
   D /trunk/gtk/help_dlg.c
   D /trunk/gtk/help_dlg.h
   D /trunk/gtk/hostlist_eth.c
   D /trunk/gtk/hostlist_fc.c
   D /trunk/gtk/hostlist_fddi.c
   D /trunk/gtk/hostlist_ip.c
   D /trunk/gtk/hostlist_ipv6.c
   D /trunk/gtk/hostlist_ipx.c
   D /trunk/gtk/hostlist_jxta.c
   D /trunk/gtk/hostlist_ncp.c
   D /trunk/gtk/hostlist_rsvp.c
   D /trunk/gtk/hostlist_sctp.c
   D /trunk/gtk/hostlist_table.c
   D /trunk/gtk/hostlist_table.h
   D /trunk/gtk/hostlist_tcpip.c
   D /trunk/gtk/hostlist_tr.c
   D /trunk/gtk/hostlist_udpip.c
   D /trunk/gtk/hostlist_usb.c
   D /trunk/gtk/hostlist_wlan.c
   D /trunk/gtk/iax2_analysis.c
   D /trunk/gtk/iax2_analysis.h
   D /trunk/gtk/io_stat.c
   D /trunk/gtk/keys.h
   D /trunk/gtk/ldap_stat.c
   D /trunk/gtk/libui.vcproj
   D /trunk/gtk/mac_lte_stat_dlg.c
   D /trunk/gtk/macros_dlg.c
   D /trunk/gtk/macros_dlg.h
   D /trunk/gtk/main.c
   D /trunk/gtk/main.h
   D /trunk/gtk/main_airpcap_toolbar.c
   D /trunk/gtk/main_airpcap_toolbar.h
   D /trunk/gtk/main_filter_toolbar.c
   D /trunk/gtk/main_filter_toolbar.h
   D /trunk/gtk/main_menubar.c
   D /trunk/gtk/main_proto_draw.c
   D /trunk/gtk/main_proto_draw.h
   D /trunk/gtk/main_statusbar.c
   D /trunk/gtk/main_statusbar_private.h
   D /trunk/gtk/main_toolbar.c
   D /trunk/gtk/main_toolbar.h
   D /trunk/gtk/main_welcome.c
   D /trunk/gtk/main_welcome.h
   D /trunk/gtk/manual_addr_resolv.c
   D /trunk/gtk/manual_addr_resolv.h
   D /trunk/gtk/mcast_stream.c
   D /trunk/gtk/mcast_stream.h
   D /trunk/gtk/mcast_stream_dlg.c
   D /trunk/gtk/mcast_stream_dlg.h
   D /trunk/gtk/megaco_stat.c
   D /trunk/gtk/menus.h
   D /trunk/gtk/mgcp_stat.c
   D /trunk/gtk/mtp3_stat.c
   D /trunk/gtk/mtp3_stat.h
   D /trunk/gtk/mtp3_summary.c
   D /trunk/gtk/ncp_stat.c
   D /trunk/gtk/network_icons.h
   D /trunk/gtk/new_packet_list.c
   D /trunk/gtk/new_packet_list.h
   D /trunk/gtk/old-gtk-compat.h
   D /trunk/gtk/packet_history.c
   D /trunk/gtk/packet_history.h
   D /trunk/gtk/packet_list_store.c
   D /trunk/gtk/packet_list_store.h
   D /trunk/gtk/packet_win.c
   D /trunk/gtk/packet_win.h
   D /trunk/gtk/pixmap_save.c
   D /trunk/gtk/pixmap_save.h
   D /trunk/gtk/plugins_dlg.c
   D /trunk/gtk/plugins_dlg.h
   D /trunk/gtk/prefs_capture.c
   D /trunk/gtk/prefs_capture.h
   D /trunk/gtk/prefs_column.c
   D /trunk/gtk/prefs_column.h
   D /trunk/gtk/prefs_dlg.c
   D /trunk/gtk/prefs_dlg.h
   D /trunk/gtk/prefs_filter_expressions.c
   D /trunk/gtk/prefs_filter_expressions.h
   D /trunk/gtk/prefs_gui.c
   D /trunk/gtk/prefs_gui.h
   D /trunk/gtk/prefs_layout.c
   D /trunk/gtk/prefs_layout.h
   D /trunk/gtk/prefs_nameres.c
   D /trunk/gtk/prefs_nameres.h
   D /trunk/gtk/prefs_print.c
   D /trunk/gtk/prefs_print.h
   D /trunk/gtk/prefs_protocols.c
   D /trunk/gtk/prefs_protocols.h
   D /trunk/gtk/prefs_stream.c
   D /trunk/gtk/prefs_stream.h
   D /trunk/gtk/prefs_taps.c
   D /trunk/gtk/prefs_taps.h
   D /trunk/gtk/print_dlg.c
   D /trunk/gtk/profile_dlg.c
   D /trunk/gtk/profile_dlg.h
   D /trunk/gtk/progress_dlg.c
   D /trunk/gtk/proto_dlg.c
   D /trunk/gtk/proto_dlg.h
   D /trunk/gtk/proto_help.c
   D /trunk/gtk/proto_help.h
   D /trunk/gtk/proto_hier_stats_dlg.c
   D /trunk/gtk/proto_hier_stats_dlg.h
   D /trunk/gtk/radius_stat.c
   D /trunk/gtk/range_utils.c
   D /trunk/gtk/range_utils.h
   D /trunk/gtk/recent.c
   D /trunk/gtk/recent.h
   D /trunk/gtk/remote_icons.h
   D /trunk/gtk/rlc_lte_stat_dlg.c
   D /trunk/gtk/rpc_progs.c
   D /trunk/gtk/rpc_stat.c
   D /trunk/gtk/rtp_analysis.c
   D /trunk/gtk/rtp_analysis.h
   D /trunk/gtk/rtp_player.c
   D /trunk/gtk/rtp_player.h
   D /trunk/gtk/rtp_stream.c
   D /trunk/gtk/rtp_stream.h
   D /trunk/gtk/rtp_stream_dlg.c
   D /trunk/gtk/rtp_stream_dlg.h
   D /trunk/gtk/sat.h
   D /trunk/gtk/scsi_stat.c
   D /trunk/gtk/sctp_assoc_analyse.c
   D /trunk/gtk/sctp_byte_graph_dlg.c
   D /trunk/gtk/sctp_chunk_stat.c
   D /trunk/gtk/sctp_chunk_stat_dlg.c
   D /trunk/gtk/sctp_error_dlg.c
   D /trunk/gtk/sctp_graph_dlg.c
   D /trunk/gtk/sctp_stat.c
   D /trunk/gtk/sctp_stat.h
   D /trunk/gtk/sctp_stat_dlg.c
   D /trunk/gtk/service_response_time_table.c
   D /trunk/gtk/service_response_time_table.h
   D /trunk/gtk/simple_dialog.c
   D /trunk/gtk/sip_stat.c
   D /trunk/gtk/smb2_stat.c
   D /trunk/gtk/smb_stat.c
   D /trunk/gtk/stats_tree_stat.c
   D /trunk/gtk/stock_icons.c
   D /trunk/gtk/stock_icons.h
   D /trunk/gtk/summary_dlg.c
   D /trunk/gtk/summary_dlg.h
   D /trunk/gtk/supported_protos_dlg.c
   D /trunk/gtk/supported_protos_dlg.h
   D /trunk/gtk/tap_param_dlg.c
   D /trunk/gtk/tap_param_dlg.h
   D /trunk/gtk/tcp_graph.c
   D /trunk/gtk/text_import.c
   D /trunk/gtk/text_import.h
   D /trunk/gtk/text_import_scanner.h
   D /trunk/gtk/text_import_scanner.l
   D /trunk/gtk/text_page_utils.c
   D /trunk/gtk/text_page_utils.h
   D /trunk/gtk/time_shift_dlg.c
   D /trunk/gtk/time_shift_dlg.h
   D /trunk/gtk/uat_gui.c
   D /trunk/gtk/uat_gui.h
   D /trunk/gtk/ui
   D /trunk/gtk/utf8_entities.h
   D /trunk/gtk/voip_calls.c
   D /trunk/gtk/voip_calls.h
   D /trunk/gtk/voip_calls_dlg.c
   D /trunk/gtk/voip_calls_dlg.h
   D /trunk/gtk/webbrowser.c
   D /trunk/gtk/webbrowser.h
   D /trunk/gtk/wlan_stat_dlg.c
   D /trunk/gtk/wsp_stat.c
   M /trunk/packaging/nsis/wireshark.nsi
   M /trunk/tap-megaco-common.h
   M /trunk/tap-rtp-common.c
   M /trunk/tap-rtp-common.h
   M /trunk/tap-rtp.c
   M /trunk/tap-sipstat.c
   A /trunk/ui/gtk (from /trunk/gtk:40516)
   M /trunk/ui/gtk/STATUS.gtk3
   M /trunk/ui/gtk/about_dlg.c
   M /trunk/ui/gtk/afp_stat.c
   M /trunk/ui/gtk/airpcap_dlg.c
   M /trunk/ui/gtk/airpcap_gui_utils.c
   M /trunk/ui/gtk/ansi_a_stat.c
   M /trunk/ui/gtk/ansi_map_stat.c
   M /trunk/ui/gtk/bootp_stat.c
   M /trunk/ui/gtk/camel_counter.c
   M /trunk/ui/gtk/camel_srt.c
   M /trunk/ui/gtk/capture_dlg.c
   M /trunk/ui/gtk/capture_file_dlg.c
   M /trunk/ui/gtk/capture_if_details_dlg_win32.c
   M /trunk/ui/gtk/capture_if_dlg.c
   M /trunk/ui/gtk/capture_info_dlg.c
   M /trunk/ui/gtk/cfilter_combo_utils.c
   M /trunk/ui/gtk/color_dlg.c
   M /trunk/ui/gtk/color_edit_dlg.c
   M /trunk/ui/gtk/color_utils.c
   M /trunk/ui/gtk/compare_stat.c
   M /trunk/ui/gtk/conversations_eth.c
   M /trunk/ui/gtk/conversations_fc.c
   M /trunk/ui/gtk/conversations_fddi.c
   M /trunk/ui/gtk/conversations_ip.c
   M /trunk/ui/gtk/conversations_ipv6.c
   M /trunk/ui/gtk/conversations_ipx.c
   M /trunk/ui/gtk/conversations_jxta.c
   M /trunk/ui/gtk/conversations_ncp.c
   M /trunk/ui/gtk/conversations_rsvp.c
   M /trunk/ui/gtk/conversations_sctp.c
   M /trunk/ui/gtk/conversations_table.c
   M /trunk/ui/gtk/conversations_tcpip.c
   M /trunk/ui/gtk/conversations_tr.c
   M /trunk/ui/gtk/conversations_udpip.c
   M /trunk/ui/gtk/conversations_usb.c
   M /trunk/ui/gtk/conversations_wlan.c
   M /trunk/ui/gtk/dcerpc_stat.c
   M /trunk/ui/gtk/decode_as_ber.c
   M /trunk/ui/gtk/decode_as_dcerpc.c
   M /trunk/ui/gtk/decode_as_dlg.c
   M /trunk/ui/gtk/dfilter_expr_dlg.c
   M /trunk/ui/gtk/diameter_stat.c
   M /trunk/ui/gtk/dissector_tables_dlg.c
   M /trunk/ui/gtk/dlg_utils.c
   M /trunk/ui/gtk/drag_and_drop.c
   M /trunk/ui/gtk/expert_comp_dlg.c
   M /trunk/ui/gtk/expert_comp_table.c
   M /trunk/ui/gtk/export_object.c
   M /trunk/ui/gtk/export_object_dicom.c
   M /trunk/ui/gtk/export_object_http.c
   M /trunk/ui/gtk/export_object_smb.c
   M /trunk/ui/gtk/export_sslkeys.c
   M /trunk/ui/gtk/fc_stat.c
   M /trunk/ui/gtk/file_dlg.c
   M /trunk/ui/gtk/file_import_dlg.c
   M /trunk/ui/gtk/fileset_dlg.c
   M /trunk/ui/gtk/filter_autocomplete.c
   M /trunk/ui/gtk/filter_dlg.c
   M /trunk/ui/gtk/filter_expression_save_dlg.c
   M /trunk/ui/gtk/filter_utils.c
   M /trunk/ui/gtk/find_dlg.c
   M /trunk/ui/gtk/firewall_dlg.c
   M /trunk/ui/gtk/flow_graph.c
   M /trunk/ui/gtk/follow_ssl.c
   M /trunk/ui/gtk/follow_stream.c
   M /trunk/ui/gtk/follow_tcp.c
   M /trunk/ui/gtk/follow_udp.c
   M /trunk/ui/gtk/font_utils.c
   M /trunk/ui/gtk/funnel_stat.c
   M /trunk/ui/gtk/goto_dlg.c
   M /trunk/ui/gtk/graph_analysis.c
   M /trunk/ui/gtk/gsm_a_stat.c
   M /trunk/ui/gtk/gsm_map_stat.c
   M /trunk/ui/gtk/gsm_map_summary.c
   M /trunk/ui/gtk/gtp_stat.c
   M /trunk/ui/gtk/gui_stat_util.c
   M /trunk/ui/gtk/gui_utils.c
   M /trunk/ui/gtk/h225_counter.c
   M /trunk/ui/gtk/h225_ras_srt.c
   M /trunk/ui/gtk/help_dlg.c
   M /trunk/ui/gtk/hostlist_eth.c
   M /trunk/ui/gtk/hostlist_fc.c
   M /trunk/ui/gtk/hostlist_fddi.c
   M /trunk/ui/gtk/hostlist_ip.c
   M /trunk/ui/gtk/hostlist_ipv6.c
   M /trunk/ui/gtk/hostlist_ipx.c
   M /trunk/ui/gtk/hostlist_jxta.c
   M /trunk/ui/gtk/hostlist_ncp.c
   M /trunk/ui/gtk/hostlist_rsvp.c
   M /trunk/ui/gtk/hostlist_sctp.c
   M /trunk/ui/gtk/hostlist_table.c
   M /trunk/ui/gtk/hostlist_tcpip.c
   M /trunk/ui/gtk/hostlist_tr.c
   M /trunk/ui/gtk/hostlist_udpip.c
   M /trunk/ui/gtk/hostlist_usb.c
   M /trunk/ui/gtk/hostlist_wlan.c
   M /trunk/ui/gtk/iax2_analysis.c
   M /trunk/ui/gtk/io_stat.c
   M /trunk/ui/gtk/ldap_stat.c
   M /trunk/ui/gtk/mac_lte_stat_dlg.c
   M /trunk/ui/gtk/macros_dlg.c
   M /trunk/ui/gtk/main.c
   M /trunk/ui/gtk/main_airpcap_toolbar.c
   M /trunk/ui/gtk/main_filter_toolbar.c
   M /trunk/ui/gtk/main_menubar.c
   M /trunk/ui/gtk/main_proto_draw.c
   M /trunk/ui/gtk/main_statusbar.c
   M /trunk/ui/gtk/main_toolbar.c
   M /trunk/ui/gtk/main_welcome.c
   M /trunk/ui/gtk/main_welcome.h
   M /trunk/ui/gtk/manual_addr_resolv.c
   M /trunk/ui/gtk/mcast_stream.c
   M /trunk/ui/gtk/mcast_stream_dlg.c
   M /trunk/ui/gtk/megaco_stat.c
   M /trunk/ui/gtk/mgcp_stat.c
   M /trunk/ui/gtk/mtp3_stat.c
   M /trunk/ui/gtk/mtp3_summary.c
   M /trunk/ui/gtk/ncp_stat.c
   M /trunk/ui/gtk/new_packet_list.c
   M /trunk/ui/gtk/packet_history.c
   M /trunk/ui/gtk/packet_win.c
   M /trunk/ui/gtk/pixmap_save.c
   M /trunk/ui/gtk/plugins_dlg.c
   M /trunk/ui/gtk/prefs_capture.c
   M /trunk/ui/gtk/prefs_column.c
   M /trunk/ui/gtk/prefs_dlg.c
   M /trunk/ui/gtk/prefs_filter_expressions.c
   M /trunk/ui/gtk/prefs_gui.c
   M /trunk/ui/gtk/prefs_layout.c
   M /trunk/ui/gtk/prefs_nameres.c
   M /trunk/ui/gtk/prefs_print.c
   M /trunk/ui/gtk/prefs_protocols.c
   M /trunk/ui/gtk/prefs_stream.c
   M /trunk/ui/gtk/prefs_taps.c
   M /trunk/ui/gtk/print_dlg.c
   M /trunk/ui/gtk/profile_dlg.c
   M /trunk/ui/gtk/progress_dlg.c
   M /trunk/ui/gtk/proto_dlg.c
   M /trunk/ui/gtk/proto_help.c
   M /trunk/ui/gtk/proto_hier_stats_dlg.c
   M /trunk/ui/gtk/radius_stat.c
   M /trunk/ui/gtk/range_utils.c
   M /trunk/ui/gtk/recent.c
   M /trunk/ui/gtk/rlc_lte_stat_dlg.c
   M /trunk/ui/gtk/rpc_progs.c
   M /trunk/ui/gtk/rpc_stat.c
   M /trunk/ui/gtk/rtp_analysis.c
   M /trunk/ui/gtk/rtp_player.c
   M /trunk/ui/gtk/rtp_stream.c
   M /trunk/ui/gtk/rtp_stream_dlg.c
   M /trunk/ui/gtk/scsi_stat.c
   M /trunk/ui/gtk/sctp_assoc_analyse.c
   M /trunk/ui/gtk/sctp_byte_graph_dlg.c
   M /trunk/ui/gtk/sctp_chunk_stat.c
   M /trunk/ui/gtk/sctp_chunk_stat_dlg.c
   M /trunk/ui/gtk/sctp_error_dlg.c
   M /trunk/ui/gtk/sctp_graph_dlg.c
   M /trunk/ui/gtk/sctp_stat.c
   M /trunk/ui/gtk/sctp_stat_dlg.c
   M /trunk/ui/gtk/service_response_time_table.c
   M /trunk/ui/gtk/simple_dialog.c
   M /trunk/ui/gtk/sip_stat.c
   M /trunk/ui/gtk/smb2_stat.c
   M /trunk/ui/gtk/smb_stat.c
   M /trunk/ui/gtk/stats_tree_stat.c
   M /trunk/ui/gtk/stock_icons.c
   M /trunk/ui/gtk/summary_dlg.c
   M /trunk/ui/gtk/supported_protos_dlg.c
   M /trunk/ui/gtk/tap_param_dlg.c
   M /trunk/ui/gtk/tcp_graph.c
   M /trunk/ui/gtk/text_page_utils.c
   M /trunk/ui/gtk/time_shift_dlg.c
   M /trunk/ui/gtk/uat_gui.c
   M /trunk/ui/gtk/voip_calls.c
   M /trunk/ui/gtk/voip_calls_dlg.c
   M /trunk/ui/gtk/webbrowser.c
   M /trunk/ui/gtk/wlan_stat_dlg.c
   M /trunk/ui/gtk/wsp_stat.c
   M /trunk/ui/qt/QtShark.pro
   M /trunk/ui/qt/capture_interface_dialog.cpp
   M /trunk/ui/qt/display_filter_combo.cpp
   M /trunk/ui/qt/display_filter_edit.cpp
   M /trunk/ui/qt/interface_tree.cpp
   M /trunk/ui/qt/main.cpp
   M /trunk/ui/qt/main_window.cpp
   M /trunk/ui/qt/packet_list.cpp
   M /trunk/ui/qt/qt_ui_utils.cpp
   M /trunk/ui/qt/qt_ui_utils.h
   M /trunk/ui/qt/wireshark_application.cpp
   M /trunk/win32/file_dlg_win32.c

Move gtk to ui/gtk.
This looses the last checkin to gtk, will add this manually back.

------------------------------------------------------------------------
r40517 | etxrab | 2012-01-15 12:14:22 -0800 (Sun, 15 Jan 2012) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Have the time field in the Graph Analyzis windos use the same time format as used to view the trace.
------------------------------------------------------------------------
r40516 | jmayer | 2012-01-15 09:07:55 -0800 (Sun, 15 Jan 2012) | 3 lines
Changed paths:
   M /trunk/asn1/c1222/packet-c1222-template.c
   M /trunk/epan/dissectors/packet-c1222.c

The warning fix overdid things: It removed functionality.
Now I only remove the variable ft and everything looks good.

------------------------------------------------------------------------
r40513 | gerald | 2012-01-15 07:03:26 -0800 (Sun, 15 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-01-15]
------------------------------------------------------------------------
r40512 | jmayer | 2012-01-15 04:30:52 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   D /trunk/epan/crypt/crypt-aes.c
   D /trunk/epan/crypt/crypt-aes.h
   D /trunk/epan/crypt/crypt-des.c
   D /trunk/epan/crypt/crypt-des.h
   D /trunk/epan/crypt/crypt-md4.c
   D /trunk/epan/crypt/crypt-md4.h
   D /trunk/epan/crypt/crypt-md5.c
   D /trunk/epan/crypt/crypt-md5.h
   D /trunk/epan/crypt/crypt-rc4.c
   D /trunk/epan/crypt/crypt-rc4.h
   D /trunk/epan/crypt/crypt-sha1.c
   D /trunk/epan/crypt/crypt-sha1.h

The last commit failed to check in the deleted files

------------------------------------------------------------------------
r40511 | jmayer | 2012-01-15 04:29:44 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.common
   M /trunk/editcap.c
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/crypt/Makefile.common
   A /trunk/epan/crypt/aes.c (from /trunk/epan/crypt/crypt-aes.c:40509)
   A /trunk/epan/crypt/aes.h (from /trunk/epan/crypt/crypt-aes.h:40509)
   M /trunk/epan/crypt/airpdcap.c
   M /trunk/epan/crypt/airpdcap_ccmp.c
   M /trunk/epan/crypt/airpdcap_rijndael.c
   A /trunk/epan/crypt/des.c (from /trunk/epan/crypt/crypt-des.c:40509)
   A /trunk/epan/crypt/des.h (from /trunk/epan/crypt/crypt-des.h:40509)
   A /trunk/epan/crypt/md4.c (from /trunk/epan/crypt/crypt-md4.c:40509)
   A /trunk/epan/crypt/md4.h (from /trunk/epan/crypt/crypt-md4.h:40509)
   A /trunk/epan/crypt/md5.c (from /trunk/epan/crypt/crypt-md5.c:40509)
   A /trunk/epan/crypt/md5.h (from /trunk/epan/crypt/crypt-md5.h:40509)
   A /trunk/epan/crypt/rc4.c (from /trunk/epan/crypt/crypt-rc4.c:40509)
   A /trunk/epan/crypt/rc4.h (from /trunk/epan/crypt/crypt-rc4.h:40509)
   A /trunk/epan/crypt/sha1.c (from /trunk/epan/crypt/crypt-sha1.c:40509)
   A /trunk/epan/crypt/sha1.h (from /trunk/epan/crypt/crypt-sha1.h:40509)
   M /trunk/epan/dissectors/packet-3com-njack.c
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-data.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-snmp.c
   M /trunk/epan/dissectors/packet-spnego.c
   M /trunk/epan/dissectors/packet-tacacs.c
   M /trunk/epan/sigcomp-udvm.c

Rename crypt-xxx to xxx

------------------------------------------------------------------------
r40510 | jmayer | 2012-01-15 04:28:01 -0800 (Sun, 15 Jan 2012) | 2 lines
Changed paths:
   D /trunk/asn1/c1222/Makefile.in

Accidentally checked in Makefile.in

------------------------------------------------------------------------
r40509 | guy | 2012-01-15 01:07:54 -0800 (Sun, 15 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-homeplug-av.c

Shuffle the ett[] array elements around a bit, and add blank lines, to
match their definitions; add two missing elements that turned up.  That
should fix bug 6736.

------------------------------------------------------------------------
r40508 | guy | 2012-01-14 12:58:41 -0800 (Sat, 14 Jan 2012) | 6 lines
Changed paths:
   M /trunk/wiretap/k12text.l

wth->phdr.pkt_encap isn't set on a seek-and-read; pass the encapsulation
directly to k12text_set_pseudo_header(), so that it's passed the right
encapsulation for seek-and-read as well as for read.  Fixes the
"malformed frames when reading some K12 text files" problem for which
we're using bug 6735.

------------------------------------------------------------------------
r40507 | wmeier | 2012-01-14 12:14:43 -0800 (Sat, 14 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/camel-persistentdata.c
   M /trunk/epan/dissectors/packet-ipx.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/reassemble.c
   M /trunk/epan/tcap-persistentdata.c
   M /trunk/file.c

Remove obsolete comments referring to mem_chunks.

------------------------------------------------------------------------
r40506 | wmeier | 2012-01-14 09:18:26 -0800 (Sat, 14 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bzr.c

Several minor changes:
- use consistent indentation;
- use tvb_reported_length_remaining() in one case;
- reformat a long line.

------------------------------------------------------------------------
r40505 | wmeier | 2012-01-14 09:03:34 -0800 (Sat, 14 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-elcom.c

Minor updates:
 - checkcol() not req'd in a few cases;
 - Add an XXX comment about the (mis?)use of tvb_length();
 - lenght -> length;

------------------------------------------------------------------------
r40504 | wmeier | 2012-01-14 08:18:16 -0800 (Sat, 14 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-knet.c

Use REPORT_DISSECTOR_BUG() instead of g_print(); Other minor cleanup.

------------------------------------------------------------------------
r40503 | wmeier | 2012-01-14 07:47:40 -0800 (Sat, 14 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp-core.c
   M /trunk/epan/dissectors/packet-xmpp-jingle.c
   M /trunk/epan/dissectors/packet-xmpp.c

check_col() not req'd and other minor cleanups ....

------------------------------------------------------------------------
r40502 | jmayer | 2012-01-14 07:46:25 -0800 (Sat, 14 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/crypt/Makefile.nmake

Maybe adding $(GNUTLS_CFLAGS) will fix the build problem.

------------------------------------------------------------------------
r40501 | jmayer | 2012-01-14 07:23:04 -0800 (Sat, 14 Jan 2012) | 1 line
Changed paths:
   A /trunk/asn1/c1222
   A /trunk/asn1/c1222/Makefile.am
   A /trunk/asn1/c1222/Makefile.common
   A /trunk/asn1/c1222/Makefile.in
   A /trunk/asn1/c1222/Makefile.nmake
   A /trunk/asn1/c1222/c1222.asn
   A /trunk/asn1/c1222/c1222.cnf
   A /trunk/asn1/c1222/packet-c1222-template.c
   A /trunk/asn1/c1222/packet-c1222-template.h

commit 40500 missed the asn1 directory
------------------------------------------------------------------------
r40500 | jmayer | 2012-01-14 07:22:10 -0800 (Sat, 14 Jan 2012) | 24 lines
Changed paths:
   M /trunk/asn1/Makefile.am
   M /trunk/configure.in
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/Makefile.common
   M /trunk/epan/crypt/Makefile.common
   A /trunk/epan/crypt/eax.c
   A /trunk/epan/crypt/eax.h
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-c1222.c
   A /trunk/epan/dissectors/packet-c1222.h

Ed Beroset <beroset@mindspring.com> via bug 5531

The ANSI C12.22 protocol is a smart grid protocol for utility meters, including
gas, water and electric.  The dissector implemented in the patch file includes
full support for all EPSEM (Extended Protocol Specification for Electricity
Metering) services and includes a full implementation of the C12.22 security
modes.

[...]

To decrypt the attached sample file, you need to set up the key table in the
preferences to include key 0 with a value of 6624C7E23034E4036FE5CB3A8B5DAB44.

Me: Fixes for:

[ 64%] Building C object epan/CMakeFiles/epan.dir/dissectors/packet-c1222.c.o            
../../asn1/c1222/packet-c1222-template.c: In function ‘dissect_epsem’:                   
../../asn1/c1222/packet-c1222-template.c:860:15: error: variable ‘ft’ set but not used [-Werror=unused-but-set-variable]

[  5%] Building C object epan/CMakeFiles/epan.dir/dissectors/packet-c1222.c.o
../../asn1/c1222/packet-c1222-template.c:103:19: error: ‘c1222_flags’ defined but not used [-Werror=unused-variable]



------------------------------------------------------------------------
r40499 | etxrab | 2012-01-14 06:47:37 -0800 (Sat, 14 Jan 2012) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Fix unused parameter warnings
------------------------------------------------------------------------
r40498 | jmayer | 2012-01-14 06:40:58 -0800 (Sat, 14 Jan 2012) | 1 line
Changed paths:
   M /trunk/macosx-setup.sh

Optionally build cmake, document why we need xz
------------------------------------------------------------------------
r40497 | jmayer | 2012-01-14 06:39:30 -0800 (Sat, 14 Jan 2012) | 1 line
Changed paths:
   M /trunk/configure.in

Add another warning (-Warray-bounds) to sync with cmake
------------------------------------------------------------------------
r40496 | etxrab | 2012-01-14 04:52:56 -0800 (Sat, 14 Jan 2012) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

This seams to leave fewer graphical artefacts.
------------------------------------------------------------------------
r40495 | guy | 2012-01-14 02:31:25 -0800 (Sat, 14 Jan 2012) | 2 lines
Changed paths:
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/netmon.c
   M /trunk/wiretap/netmon.h

NetMon 1.x format does *not* support per-packet encapsulation.

------------------------------------------------------------------------
r40494 | guy | 2012-01-14 01:16:31 -0800 (Sat, 14 Jan 2012) | 8 lines
Changed paths:
   M /trunk/gtk/capture_file_dlg.c

In the list of supported file types, put the file type of the file being
saved at the beginning of the list, if it's supported (it might not be
if we don't support writing that file format).  If that happens to be
pcap, put pcap-NG right after it (if we can write something out as pcap,
we can always write it out as pcap-NG); if it happens to be pcap-NG, put
pcap right after it if it's supported (if it has per-packet
encapsulation, pcap won't be supported).

------------------------------------------------------------------------
r40493 | guy | 2012-01-14 01:12:05 -0800 (Sat, 14 Jan 2012) | 7 lines
Changed paths:
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.h

Get rid of unused WTAP_FILE_WTAP file type.

Move pcap-NG right after standard pcap in the list of file types, so
that it shows up early in the list of output file types in the "Save
As..." dialog box (if, that is, it's supported; if not, neither is pcap,
as they use the same link-layer header type values).

------------------------------------------------------------------------
r40492 | guy | 2012-01-14 01:00:37 -0800 (Sat, 14 Jan 2012) | 3 lines
Changed paths:
   M /trunk/wiretap/k12text.l

WTAP_ENCAP_UNKNOWN should never appear as an actual encapsulation type,
and can't be supported as an output encapsulation in any case.

------------------------------------------------------------------------
r40491 | guy | 2012-01-13 19:56:22 -0800 (Fri, 13 Jan 2012) | 4 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

Get rid of some unused #defines.

Use surface_height for various heights, and set it.

------------------------------------------------------------------------
r40490 | jmayer | 2012-01-13 19:21:28 -0800 (Fri, 13 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/reassemble.c

Remove obsolete GLIB_CHECK_VERSION(2,10,0) checks
------------------------------------------------------------------------
r40489 | gerald | 2012-01-13 17:25:33 -0800 (Fri, 13 Jan 2012) | 3 lines
Changed paths:
   M /trunk/tools/runlex.sh

Add some debugging output to help track down an intermittent problem on
one of the buildbots.

------------------------------------------------------------------------
r40488 | gerald | 2012-01-13 16:16:16 -0800 (Fri, 13 Jan 2012) | 7 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro
   M /trunk/ui/qt/display_filter_edit.cpp
   M /trunk/ui/qt/display_filter_edit.h
   A /trunk/ui/qt/label_stack.cpp
   A /trunk/ui/qt/label_stack.h
   M /trunk/ui/qt/main.cpp
   M /trunk/ui/qt/main_status_bar.cpp
   M /trunk/ui/qt/main_status_bar.h
   M /trunk/ui/qt/main_window.cpp
   M /trunk/ui/qt/main_window.h
   M /trunk/ui/qt/main_window.ui
   M /trunk/ui/qt/packet_list.cpp
   M /trunk/ui/qt/packet_list.h
   M /trunk/ui/qt/proto_tree.cpp
   M /trunk/ui/qt/proto_tree.h
   M /trunk/ui/qt/wireshark_application.cpp
   M /trunk/ui/qt/wireshark_application.h

Initial status bar functionality. Promote the main window's status bar
to a MainStatusBar. Add a "LabelStack" widget, which MainStatusBar uses
to duplicate features in GtkStatusbar. Make the protocol tree a
full-blown ProtoTree widget. Move main_cf_callback from main to
WiresharkApplication. Duplicate a lot of the cf callbacks as signals and
slots. Use Q_UNUSED in a few places.

------------------------------------------------------------------------
r40487 | guy | 2012-01-13 14:27:59 -0800 (Fri, 13 Jan 2012) | 3 lines
Changed paths:
   M /trunk/file.c

In all these cases, i is a guint32, so if c_match is <= i, c_match fits
in a guint32; cast it to one to squelch compiler warnings.

------------------------------------------------------------------------
r40486 | wmeier | 2012-01-13 14:04:09 -0800 (Fri, 13 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb-ccid.c

Minor cleanup:
- Move a global var to be local to a fcn;
- Remove an unneeded forward declaration;
- Do some minor reformatting.

------------------------------------------------------------------------
r40485 | wmeier | 2012-01-13 13:44:13 -0800 (Fri, 13 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-mifare.c

Minor cleanup:
- Remove set but unused variable;
- Fix indentation to match that specified by the Editor Modelines

------------------------------------------------------------------------
r40484 | jmayer | 2012-01-13 13:25:27 -0800 (Fri, 13 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common

dfs and mapi do create warnings. move them  back to dirty
------------------------------------------------------------------------
r40483 | wmeier | 2012-01-13 13:09:33 -0800 (Fri, 13 Jan 2012) | 7 lines
Changed paths:
   M /trunk/file.c

Fix Bug #6276: "Find Packet" Bug:

 'The search query e.g. (ASCII or hex) "abac" doesn't find the packet(s)
  containing the string "ababac".'

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6726

------------------------------------------------------------------------
r40482 | etxrab | 2012-01-13 12:45:02 -0800 (Fri, 13 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sua.c

Introduce a dissector table to be used for proprietary tags.
------------------------------------------------------------------------
r40481 | etxrab | 2012-01-13 12:43:07 -0800 (Fri, 13 Jan 2012) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Fix a copy paste error.
------------------------------------------------------------------------
r40480 | jmayer | 2012-01-13 12:11:48 -0800 (Fri, 13 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt

Eliminate duplicate entries created by a merging error
------------------------------------------------------------------------
r40479 | guy | 2012-01-13 12:06:49 -0800 (Fri, 13 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common

Only one instance of packet-dcerpc-mapi.c and packet-dcerpc-mapi.h,
please.

Move some generated DCERPC dissectors back to the clean list; if they
actually *do* generate warnings, move them back.

------------------------------------------------------------------------
r40478 | jmayer | 2012-01-13 11:29:58 -0800 (Fri, 13 Jan 2012) | 4 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.am
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/wiretap/CMakeLists.txt

Sync filelists between autofoo and cmake.
Move some dissectors that throw warnings to DIRTY_
Whitespace cleanups

------------------------------------------------------------------------
r40477 | jmayer | 2012-01-13 11:27:01 -0800 (Fri, 13 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Add comment about possible expert item
------------------------------------------------------------------------
r40476 | alagoutte | 2012-01-13 08:59:22 -0800 (Fri, 13 Jan 2012) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Update ISAKMP to last IANA Parameters (2011-11-07)
Add new ISAKMP Attribut of RFC6407 and new IKE type (GAP ID 22)

------------------------------------------------------------------------
r40475 | alagoutte | 2012-01-13 08:37:21 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/plugins/ethercat/packet-ams.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40474 | alagoutte | 2012-01-13 08:37:04 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/plugins/ethercat/packet-ecatmb.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40473 | alagoutte | 2012-01-13 08:36:07 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40472 | alagoutte | 2012-01-13 08:34:32 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x224.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40471 | alagoutte | 2012-01-13 08:34:15 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xyplex.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40470 | alagoutte | 2012-01-13 08:33:57 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xtp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40469 | alagoutte | 2012-01-13 08:33:40 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xot.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40468 | alagoutte | 2012-01-13 08:33:04 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/rtse/packet-rtse-template.c
   M /trunk/epan/dissectors/packet-rtse.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40467 | alagoutte | 2012-01-13 08:30:39 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/disp/packet-disp-template.c
   M /trunk/epan/dissectors/packet-disp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40466 | alagoutte | 2012-01-13 08:28:54 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/sv/packet-sv-template.c
   M /trunk/epan/dissectors/packet-sv.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40465 | alagoutte | 2012-01-13 08:27:50 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/mpeg-audio/packet-mpeg-audio-template.c
   M /trunk/epan/dissectors/packet-mpeg-audio.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40464 | alagoutte | 2012-01-13 08:26:45 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/sabp/packet-sabp-template.c
   M /trunk/epan/dissectors/packet-sabp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40463 | alagoutte | 2012-01-13 08:24:44 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/t38/t38.cnf
   M /trunk/epan/dissectors/packet-t38.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40462 | alagoutte | 2012-01-13 08:22:50 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/ros/packet-ros-template.c
   M /trunk/epan/dissectors/packet-ros.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40461 | alagoutte | 2012-01-13 08:21:08 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/mms/packet-mms-template.c
   M /trunk/epan/dissectors/packet-mms.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40460 | alagoutte | 2012-01-13 08:20:23 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/idmp/packet-idmp-template.c
   M /trunk/epan/dissectors/packet-idmp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40459 | alagoutte | 2012-01-13 08:19:24 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/epan/dissectors/packet-inap.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40458 | alagoutte | 2012-01-13 08:18:39 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/asn1/mpeg-pes/packet-mpeg-pes-template.c
   M /trunk/epan/dissectors/packet-mpeg-pes.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40457 | alagoutte | 2012-01-13 08:17:26 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/tcap-persistentdata.c

Fix some Dereference of null pointer Warning found by Clang

------------------------------------------------------------------------
r40456 | alagoutte | 2012-01-13 08:16:41 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/wslua/wslua.h

Fix some Dereference of null pointer Warning found by Clang

------------------------------------------------------------------------
r40455 | alagoutte | 2012-01-13 08:13:40 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Add H248-2 Dissector to CMake (Miss in revision 40439)

------------------------------------------------------------------------
r40454 | cmaynard | 2012-01-13 08:05:23 -0800 (Fri, 13 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-megaco.c

Fix some typos.

------------------------------------------------------------------------
r40453 | wmeier | 2012-01-13 06:18:07 -0800 (Fri, 13 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Fix:
packet-gsm_a_rr.c:3867:101: error: parameter 'len' set but not used [-Werror=unused-but-set-parameter]
packet-gsm_a_rr.c:6837:46: warning: variable 'bit_offset_sav2' set but not used [-Wunused-but-set-variable]
packet-gsm_a_rr.c:7458:18: warning: variable 'curr_offset' set but not used [-Wunused-but-set-variab

------------------------------------------------------------------------
r40452 | wmeier | 2012-01-13 06:03:10 -0800 (Fri, 13 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-meta.c
   D /trunk/epan/dissectors/packet-meta.h

Minor cleanup:
 Merge packet-meta.h into packet-meta.c;
 Remove an unneeded #include;
 Remove an unused variable.

------------------------------------------------------------------------
r40451 | etxrab | 2012-01-12 22:42:46 -0800 (Thu, 12 Jan 2012) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Fix:
packet-gsm_a_rr.c:3289: warning: unused parameter 'len'
packet-gsm_a_rr.c:3412: warning: unused parameter 'len'
packet-gsm_a_rr.c:4449: warning: unused variable 'bit_len'
packet-gsm_a_rr.c:4444: warning: unused parameter 'len'
packet-gsm_a_rr.c:4557: warning: unused parameter 'len'
packet-gsm_a_rr.c:6285: warning: unused parameter 'len'
packet-gsm_a_rr.c:6765: warning: unused variable 'bit_len'
packet-gsm_a_rr.c:6759: warning: unused parameter 'len'
packet-gsm_a_rr.c:6987: warning: unused variable 'bit_len'
packet-gsm_a_rr.c:6979: warning: unused parameter 'len'
packet-gsm_a_rr.c:7457: warning: unused parameter 'len'
------------------------------------------------------------------------
r40450 | etxrab | 2012-01-12 22:34:07 -0800 (Thu, 12 Jan 2012) | 4 lines
Changed paths:
   M /trunk/plugins/docsis/packet-mdd.c

From Yi Zhang:
DSG_DA_TO_DSID_ASSOCIATION_DA/DSID is not correctly parsed in DOCSIS MDD packet.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6725
------------------------------------------------------------------------
r40449 | etxrab | 2012-01-12 22:29:03 -0800 (Thu, 12 Jan 2012) | 4 lines
Changed paths:
   M /trunk/plugins/docsis/packet-dcd.c

From Yi Zhang:
The DCD_CLID_BCAST_ID TLV is not supported in DOCSIS plugin.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6724
------------------------------------------------------------------------
r40448 | etxrab | 2012-01-12 22:22:56 -0800 (Thu, 12 Jan 2012) | 4 lines
Changed paths:
   M /trunk/gtk/file_import_dlg.c

From  Edward Sheldrake:
Wireshark crashes if you open the file import dialog and choose something from the "Encapsulation type" list.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6729
------------------------------------------------------------------------
r40447 | etxrab | 2012-01-12 22:11:44 -0800 (Thu, 12 Jan 2012) | 19 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Mike Morrin:
This is largely a cosmetic update of the gsm_a_rr dissector:

•    TBF starting time is now fully decoded.
•    “Double indenting” of IE groups (where an IE dissector adds a subtree just
after the generic dissector adds a subtree) has been eliminated.
•    “Null” break points in CSN.1 IEs have been added where they were
previously missing (this could have caused some correct PDUs to be reported as
malformed).
•    The calculation of CSN.1 IE lengths has been corrected: ((a – b)>>3)+1 is
not the same as (a>>3)-(b>>3)+1 .
•    The handling of CSN.1 padding bits is slightly improved.
•    The handling of CSN.1 “truncated” bits is slightly improved.
•    Eliminated superfluous checks for len==0 at the beginning of some
rest-octet dissectors (the generic dissector won’t call the CSN.1 dissector if
len is 0).
•    A few minor corrections to text strings and formatting.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6728
------------------------------------------------------------------------
r40446 | wmeier | 2012-01-12 14:25:42 -0800 (Thu, 12 Jan 2012) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-meta.c
   M /trunk/epan/dissectors/packet-meta.h

Various minor mods;
- check-col() not needed;
- use tvb_new_subset_remaining() iso tvb_new();
- #if 0 (currently ?) unused 'erf_handle';
- Convert some '4 space tabs' to 4 spaces;
- other reformatting.

------------------------------------------------------------------------
r40445 | wmeier | 2012-01-12 14:13:09 -0800 (Thu, 12 Jan 2012) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-meta.c
   M /trunk/epan/dissectors/packet-meta.h

From Tobias Witek: Add dissector table to 'meta' dissector.

  The attached patch adds a dissector table to the 'meta' dissector
  so that other protocol dissectors can register for specific values
  of 'meta.proto'.

  Additionally, the patch also adds three more protocol values.

  https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6730


------------------------------------------------------------------------
r40444 | wmeier | 2012-01-12 12:40:23 -0800 (Thu, 12 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hip.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-lapd.c
   M /trunk/epan/dissectors/packet-stun.c

Don't do fcn calls in arg of g_?to??(); Macro may very well eval args multiple times.

------------------------------------------------------------------------
r40443 | gerald | 2012-01-12 11:16:15 -0800 (Thu, 12 Jan 2012) | 5 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/epan/stat_cmd_args.c

CMakeLists.txt: Make sure TSHARK_TAP_SRC is defined before
register_tap_files so that the "-z" flag works for TShark.

epan/stat_cmd_args.c: Fixup whitespace.

------------------------------------------------------------------------
r40442 | wmeier | 2012-01-12 07:04:09 -0800 (Thu, 12 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-classicstun.c

Re-indent for readability.

------------------------------------------------------------------------
r40441 | martinm | 2012-01-11 13:31:11 -0800 (Wed, 11 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

"Call nas-eps" dissector for nas_rrc_r8_lte and nas_rrc_r9_lte frames that have L3 payloads.

------------------------------------------------------------------------
r40440 | wmeier | 2012-01-11 12:12:51 -0800 (Wed, 11 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-classicstun.c

Don't do tvb_get...() in arg of g_htonl(); Macro evals args multiple times.

------------------------------------------------------------------------
r40439 | etxrab | 2012-01-11 11:31:45 -0800 (Wed, 11 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-h248_2.c

Add a dissector for h248.2 packages.
------------------------------------------------------------------------
r40437 | gerald | 2012-01-11 09:03:54 -0800 (Wed, 11 Jan 2012) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Copy over updates from the 1.6 branch.

------------------------------------------------------------------------
r40435 | etxrab | 2012-01-10 22:38:25 -0800 (Tue, 10 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ dissect sac message body.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6723
------------------------------------------------------------------------
r40434 | etxrab | 2012-01-10 22:30:20 -0800 (Tue, 10 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Lei Chen:
An error in eutran_measurement_param_desc of GSM si2qua rest octet.

From me fix similar bugs.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6721
------------------------------------------------------------------------
r40424 | alagoutte | 2012-01-10 07:12:13 -0800 (Tue, 10 Jan 2012) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua.c

From mtwire via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6722
Small corrections in the Alcatel UA dissector

The most important change is to add a condition in dissector for TLV with ID equal to 104 as in the case of the 120. No condition causing 'malformed packet'.

------------------------------------------------------------------------
r40423 | alagoutte | 2012-01-10 05:59:27 -0800 (Tue, 10 Jan 2012) | 5 lines
Changed paths:
   M /trunk/pcapio.c

From Jose Pedro Oliveira  via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6719
pcapio.c: bug in libpcap_write_interface_description_block

The attached patch fixes a copy_and_paste error in the code of the function libpcap_write_interface_description_block(): strlen(name) instead of strlen(filter).

------------------------------------------------------------------------
r40422 | alagoutte | 2012-01-10 04:08:43 -0800 (Tue, 10 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radiotap-defs.h
   M /trunk/epan/dissectors/packet-radiotap.c

From Wojciech Dubowik via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6720
Add STBC flag to MCS field in radiotap packet dissector.

From me:
Replace VALS by TFS (and use boolean hf)

------------------------------------------------------------------------
r40421 | gerald | 2012-01-09 11:31:31 -0800 (Mon, 09 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/packet_list_model.cpp

Remove some debug logging.

------------------------------------------------------------------------
r40420 | morriss | 2012-01-09 11:05:00 -0800 (Mon, 09 Jan 2012) | 3 lines
Changed paths:
   M /trunk/gtk/main.h
   M /trunk/gtk/prefs_taps.c

It appears that the intent of r35027 was to use reset_tap_update_timer() not
just on Windows or when we have threads, so make it so.

------------------------------------------------------------------------
r40412 | alagoutte | 2012-01-09 08:36:56 -0800 (Mon, 09 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t38.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

Try to compile with cmake in Ubuntu 11.10

------------------------------------------------------------------------
r40411 | alagoutte | 2012-01-09 08:33:47 -0800 (Mon, 09 Jan 2012) | 4 lines
Changed paths:
   M /trunk/asn1/t38/t38.cnf

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

Try to compile with cmake in Ubuntu 11.10

------------------------------------------------------------------------
r40410 | alagoutte | 2012-01-09 08:32:53 -0800 (Mon, 09 Jan 2012) | 4 lines
Changed paths:
   M /trunk/asn1/spnego/packet-spnego-template.c
   M /trunk/epan/dissectors/packet-spnego.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

Try to compile with cmake in Ubuntu 11.10

------------------------------------------------------------------------
r40409 | gerald | 2012-01-08 22:21:19 -0800 (Sun, 08 Jan 2012) | 2 lines
Changed paths:
   D /trunk/ui/qt/qrc_toolbar.cpp

Remove a generated file (pointed out by Gisle Vanem).

------------------------------------------------------------------------
r40407 | etxrab | 2012-01-08 07:34:23 -0800 (Sun, 08 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ decrypt SAC messages.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6700
------------------------------------------------------------------------
r40405 | etxrab | 2012-01-08 07:30:05 -0800 (Sun, 08 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Mike Morrin:
GSM RR CCCH dissection ignores last octet of PDU.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6715
------------------------------------------------------------------------
r40404 | gerald | 2012-01-08 07:03:27 -0800 (Sun, 08 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2012-01-08]
------------------------------------------------------------------------
r40403 | martinm | 2012-01-06 18:50:37 -0800 (Fri, 06 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Simplify key for cid->context hash table. Copy more details between contexts when updating.

------------------------------------------------------------------------
r40397 | wmeier | 2012-01-06 10:25:20 -0800 (Fri, 06 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

Quote some filename usage.

------------------------------------------------------------------------
r40396 | wmeier | 2012-01-06 10:22:50 -0800 (Fri, 06 Jan 2012) | 2 lines
Changed paths:
   M /trunk/tools/win-setup.sh

Add quotes around some filename usage; Also: use $() instead of backticks

------------------------------------------------------------------------
r40395 | wmeier | 2012-01-06 07:45:46 -0800 (Fri, 06 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Remove support for MSVC < MSVC2005; Update Developer's Guide.

------------------------------------------------------------------------
r40394 | jmayer | 2012-01-06 02:11:30 -0800 (Fri, 06 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Fix: packet-rohc.c:439:20: error: variable ‘PS’ set but not used [-Werror=unused-but-set-variable]

------------------------------------------------------------------------
r40392 | etxrab | 2012-01-05 11:43:37 -0800 (Thu, 05 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-meta.c

From Tobias Witek:
Patch to correctly format IMSI, IMEI and mobile cell in packet-meta.c

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6706
------------------------------------------------------------------------
r40391 | cmaynard | 2012-01-05 11:14:54 -0800 (Thu, 05 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Fix Coverity CID's 1348-1349: UNUSED_VALUE and CID 1344: CONSTANT_EXPRESSION_RESULT.

------------------------------------------------------------------------
r40390 | cmaynard | 2012-01-05 10:53:29 -0800 (Thu, 05 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fix.c

Fix some typos.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6709

------------------------------------------------------------------------
r40388 | martinm | 2012-01-05 09:40:41 -0800 (Thu, 05 Jan 2012) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

- Add the beginning of compressed list handling.
    - Will at least skip the single byte if there is nothing in the list.
    - Checks that the intended encoding type (ET) is found
    - Need to call from lots of places
- Pass correct subtree for feedback items (was passing NULL so items weren't there)
- show SNs as decimal
- remove a few stray tabs
- fix a typo

Still need to port some parts from packet-pdcp-lte.c that aren't handled (e.g. UO_0).  And the context lookup seems broken (at least for IxCatapult logs).

------------------------------------------------------------------------
r40387 | cmaynard | 2012-01-05 09:29:27 -0800 (Thu, 05 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-udp.c

Use length field from UDP header as the pseudo-header's UDP length field instead of using the reported_len.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6711

------------------------------------------------------------------------
r40386 | alagoutte | 2012-01-05 00:29:58 -0800 (Thu, 05 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Fix the following error :
packet-gsm_a_rr.c: In function 'de_rr_p2_rest_oct':
packet-gsm_a_rr.c:4033:105: error: suggest braces around empty body in an 'if' statement [-Werror=empty-body]

------------------------------------------------------------------------
r40385 | etxrab | 2012-01-04 23:24:21 -0800 (Wed, 04 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Mike Morrin:
Improvements to handling of gsm_um traces and dissection of ccch protocol

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5257
------------------------------------------------------------------------
r40384 | etxrab | 2012-01-04 23:17:38 -0800 (Wed, 04 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

From Mike Morrin:
Wrong tvb_get_bits function call in packet-csn1.c.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6708
------------------------------------------------------------------------
r40383 | morriss | 2012-01-04 18:06:08 -0800 (Wed, 04 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

dissect_esp(): 'i' is only (really) used if we HAVE_LIBGCRYPT.
------------------------------------------------------------------------
r40382 | martinm | 2012-01-04 18:00:13 -0800 (Wed, 04 Jan 2012) | 2 lines
Changed paths:
   M /trunk/gtk/mac_lte_stat_dlg.c

Show % UL padding as a progress bar.

------------------------------------------------------------------------
r40381 | morriss | 2012-01-04 17:37:32 -0800 (Wed, 04 Jan 2012) | 1 line
Changed paths:
   M /trunk/doc/README.qt

Wrap lines for those of us who use editors that don't (by default) line wrap.
------------------------------------------------------------------------
r40380 | jmayer | 2012-01-04 15:15:50 -0800 (Wed, 04 Jan 2012) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Fix several warnings turned error of type:
 variable ‘mtu_flag’ set but not used [-Werror=unused-but-set-variable]


------------------------------------------------------------------------
r40379 | gerald | 2012-01-04 14:59:17 -0800 (Wed, 04 Jan 2012) | 2 lines
Changed paths:
   M /trunk/ui/qt/QtShark.pro
   M /trunk/ui/qt/welcome.qrc

Fix compilation on Windows.

------------------------------------------------------------------------
r40378 | gerald | 2012-01-04 14:13:01 -0800 (Wed, 04 Jan 2012) | 2 lines
Changed paths:
   M /trunk/config.h.win32
   A /trunk/doc/README.qt
   M /trunk/gtk/recent.c
   A /trunk/ui
   A /trunk/ui/qt
   A /trunk/ui/qt/QtShark.pro
   A /trunk/ui/qt/byte_view_tab.cpp
   A /trunk/ui/qt/byte_view_tab.h
   A /trunk/ui/qt/byte_view_text.cpp
   A /trunk/ui/qt/byte_view_text.h
   A /trunk/ui/qt/capture_file_dialog.cpp
   A /trunk/ui/qt/capture_file_dialog.h
   A /trunk/ui/qt/capture_info_dialog.cpp
   A /trunk/ui/qt/capture_info_dialog.h
   A /trunk/ui/qt/capture_interface_dialog.cpp
   A /trunk/ui/qt/capture_interface_dialog.h
   A /trunk/ui/qt/capture_start_24.png
   A /trunk/ui/qt/capture_start_active_24.png
   A /trunk/ui/qt/capture_stop_24.png
   A /trunk/ui/qt/color_dialog.cpp
   A /trunk/ui/qt/color_dialog.h
   A /trunk/ui/qt/color_utils.cpp
   A /trunk/ui/qt/color_utils.h
   A /trunk/ui/qt/dfilter_apply_hover.png
   A /trunk/ui/qt/dfilter_apply_normal.png
   A /trunk/ui/qt/dfilter_apply_pressed.png
   A /trunk/ui/qt/dfilter_bookmark_hover.png
   A /trunk/ui/qt/dfilter_bookmark_normal.png
   A /trunk/ui/qt/dfilter_bookmark_pressed.png
   A /trunk/ui/qt/dfilter_dropdown.png
   A /trunk/ui/qt/dfilter_erase_active.png
   A /trunk/ui/qt/dfilter_erase_normal.png
   A /trunk/ui/qt/dfilter_erase_selected.png
   A /trunk/ui/qt/dfilter_refresh_active.png
   A /trunk/ui/qt/dfilter_refresh_normal.png
   A /trunk/ui/qt/display_filter.qrc
   A /trunk/ui/qt/display_filter_16.svg
   A /trunk/ui/qt/display_filter_combo.cpp
   A /trunk/ui/qt/display_filter_combo.h
   A /trunk/ui/qt/display_filter_edit.cpp
   A /trunk/ui/qt/display_filter_edit.h
   A /trunk/ui/qt/fileset_dialog.cpp
   A /trunk/ui/qt/fileset_dialog.h
   A /trunk/ui/qt/gpl-template.txt
   A /trunk/ui/qt/interface_tree.cpp
   A /trunk/ui/qt/interface_tree.h
   A /trunk/ui/qt/main.cpp
   A /trunk/ui/qt/main_status_bar.cpp
   A /trunk/ui/qt/main_status_bar.h
   A /trunk/ui/qt/main_welcome.cpp
   A /trunk/ui/qt/main_welcome.h
   A /trunk/ui/qt/main_window.cpp
   A /trunk/ui/qt/main_window.h
   A /trunk/ui/qt/main_window.ui
   A /trunk/ui/qt/monospace_font.cpp
   A /trunk/ui/qt/monospace_font.h
   A /trunk/ui/qt/packet_list.cpp
   A /trunk/ui/qt/packet_list.h
   A /trunk/ui/qt/packet_list_model.cpp
   A /trunk/ui/qt/packet_list_model.h
   A /trunk/ui/qt/packet_list_record.cpp
   A /trunk/ui/qt/packet_list_record.h
   A /trunk/ui/qt/progress_dialog.cpp
   A /trunk/ui/qt/progress_dialog.h
   A /trunk/ui/qt/progress_overlay.png
   A /trunk/ui/qt/progress_overlay.svg
   A /trunk/ui/qt/proto_tree.cpp
   A /trunk/ui/qt/proto_tree.h
   A /trunk/ui/qt/qrc_toolbar.cpp
   A /trunk/ui/qt/qt_ui_utils.cpp
   A /trunk/ui/qt/qt_ui_utils.h
   A /trunk/ui/qt/recent_file_status.cpp
   A /trunk/ui/qt/recent_file_status.h
   A /trunk/ui/qt/simple_dialog_qt.cpp
   A /trunk/ui/qt/simple_dialog_qt.h
   A /trunk/ui/qt/toolbar.qrc
   A /trunk/ui/qt/toolbar_24.svg
   A /trunk/ui/qt/welcome.qrc
   A /trunk/ui/qt/wireshark_application.cpp
   A /trunk/ui/qt/wireshark_application.h

Add initial support for Qt along with a "ui" subdirectory.

------------------------------------------------------------------------
r40377 | gerald | 2012-01-04 13:26:51 -0800 (Wed, 04 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/crypt/airpdcap_ws.h
   M /trunk/epan/dfilter/dfilter.h
   M /trunk/wsutil/wsgetopt.h

More C++ updates.

------------------------------------------------------------------------
r40376 | etxrab | 2012-01-04 11:06:34 -0800 (Wed, 04 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Use hfi->abbrev insted.
------------------------------------------------------------------------
r40375 | alagoutte | 2012-01-04 09:44:50 -0800 (Wed, 04 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40374 | alagoutte | 2012-01-04 09:42:10 -0800 (Wed, 04 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-enip.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40373 | alagoutte | 2012-01-04 09:35:41 -0800 (Wed, 04 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipmotion.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40372 | alagoutte | 2012-01-04 09:34:36 -0800 (Wed, 04 Jan 2012) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40371 | alagoutte | 2012-01-04 05:29:48 -0800 (Wed, 04 Jan 2012) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cip.h
   M /trunk/epan/dissectors/packet-mbtcp.c
   M /trunk/epan/dissectors/packet-mbtcp.h

From Michael Mann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6697
Modbus object support for CIP dissector

Support for the Modbus object within the CIP dissector.  Essentially wraps the Modbus protocol within a CIP object.

Also included update to Modbus error code per 
http://www.wireshark.org/lists/wireshark-dev/201111/msg00187.html

------------------------------------------------------------------------
r40370 | alagoutte | 2012-01-04 05:01:53 -0800 (Wed, 04 Jan 2012) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

From Andrei Maruseac via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6705
Multipath TCP Option

Extensions for Multipath Operation with Multiple Addresses, as defined in http://tools.ietf.org/html/draft-ietf-mptcp-multiaddressed-04. I implemented this as a TCP option.

From me :
Remove a subtree
Add Subtype in top of multiPath subtree


------------------------------------------------------------------------
r40369 | etxrab | 2012-01-03 23:26:00 -0800 (Tue, 03 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h248_annex_c.c

TMR should be OCTET STRING
------------------------------------------------------------------------
r40368 | etxrab | 2012-01-03 23:20:15 -0800 (Tue, 03 Jan 2012) | 1 line
Changed paths:
   M /trunk/asn1/x2ap/X2AP-CommonDataTypes.asn
   M /trunk/asn1/x2ap/X2AP-Constants.asn
   M /trunk/asn1/x2ap/X2AP-Containers.asn
   M /trunk/asn1/x2ap/X2AP-IEs.asn
   M /trunk/asn1/x2ap/X2AP-PDU-Contents.asn
   M /trunk/asn1/x2ap/X2AP-PDU-Descriptions.asn
   M /trunk/asn1/x2ap/x2ap.cnf
   M /trunk/epan/dissectors/packet-x2ap.c

Update to V10.3.0 (2011-09)
------------------------------------------------------------------------
r40367 | guy | 2012-01-03 19:31:21 -0800 (Tue, 03 Jan 2012) | 3 lines
Changed paths:
   M /trunk/capture_sync.c

Expand, and fix, a comment.  Change a function argument name to match
the name in the definition of the function it calls.

------------------------------------------------------------------------
r40366 | guy | 2012-01-03 19:02:13 -0800 (Tue, 03 Jan 2012) | 4 lines
Changed paths:
   M /trunk/capture_sync.h
   M /trunk/sync_pipe.h

Move stuff that should *only* be known by the lowest-level code that
deals with the sync pipe - i.e., only by sync_pipe.c and dumpcap.c -
into sync_pipe.h.

------------------------------------------------------------------------
r40365 | gerald | 2012-01-03 16:37:14 -0800 (Tue, 03 Jan 2012) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

Make sure each value in a GHashTable is unique. This avoids a
double-free bug triggered by using the "any" address wildcard.

Use g_malloc0 instead of zeroing elements by hand. Check for SSL_FAST
the same way everywhere.

------------------------------------------------------------------------
r40363 | etxrab | 2012-01-03 14:12:16 -0800 (Tue, 03 Jan 2012) | 4 lines
Changed paths:
   M /trunk/asn1/lte-rrc/lte-rrc.cnf
   M /trunk/epan/dissectors/packet-lte-rrc.c

From Pascal Quantin:
Display Home eNodeB name.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6691
------------------------------------------------------------------------
r40362 | etxrab | 2012-01-03 14:08:13 -0800 (Tue, 03 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-rohc.h

Use a hash table to gather information from IR packets and store it in per-packet-data.
------------------------------------------------------------------------
r40361 | etxrab | 2012-01-03 14:06:42 -0800 (Tue, 03 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Enhance error information.
------------------------------------------------------------------------
r40359 | guy | 2012-01-02 21:37:56 -0800 (Mon, 02 Jan 2012) | 2 lines
Changed paths:
   M /trunk/Makefile.common

Move capture_sync.h as well.

------------------------------------------------------------------------
r40358 | guy | 2012-01-02 21:33:02 -0800 (Mon, 02 Jan 2012) | 4 lines
Changed paths:
   M /trunk/Makefile.common

capture_sync.c is another file common to all programs that capture
traffic by running dumpcap (not surprising, as it's the file with all
the "run dumpcap" routines).

------------------------------------------------------------------------
r40357 | etxrab | 2012-01-01 11:57:47 -0800 (Sun, 01 Jan 2012) | 15 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-gsm_a_rr.c
   M /trunk/epan/dissectors/packet-rsl.c
   M /trunk/epan/libwireshark.def
   M /trunk/gtk/gsm_a_stat.c
   M /trunk/tap-gsm_astat.c

From Mike Morrin:
 GSM ENHANCED MEASUREMENT REPORT PDUs were not
dissected when present as L3_INFO in RSL MEAS_RES PDUs.

It seems that the RSL L3_INFO needs to be handled by a different dissector
depending on whether it contains a DTAP, SACCH or CCCH PDU, which fortunately
can be deduced from the RSL PDU type.  packet-rsl.c is updated to implement
this.

In packet-gsm_a_rr.c the dissection of PDUs with RR Short PD format is
improved, and also some items are renamed to make clearer the difference
between SACCH PDUs (which cna be normal or Short PD format) and RR Short PD
format PDUs (which can occur on SACCH, CCCH, or DCH).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6699
------------------------------------------------------------------------
r40354 | gerald | 2012-01-01 07:03:27 -0800 (Sun, 01 Jan 2012) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf

[Automatic manuf, services and enterprise-numbers update for 2012-01-01]
------------------------------------------------------------------------
r40353 | stig | 2012-01-01 02:02:11 -0800 (Sun, 01 Jan 2012) | 1 line
Changed paths:
   M /trunk/packaging/macosx/Info.plist.in
   M /trunk/version_info.c

Happy New Year!
------------------------------------------------------------------------
r40352 | jmayer | 2011-12-31 08:20:47 -0800 (Sat, 31 Dec 2011) | 7 lines
Changed paths:
   M /trunk/macosx-setup.sh
   M /trunk/macosx-support-lib-patches/glib-pkgconfig.patch

- Update the graphical packages
- Newer versions of glib etc require xz. At least Snow Leopard
  does not provide xz, so (unconditionally) download and install this first.
- Put in infrastructure to set up a GTK3 environment instead of GTK2
  (not active by default because configure'ing Wireshark still fails for some
  reason with GTK3 installed).

------------------------------------------------------------------------
r40351 | guy | 2011-12-30 19:20:19 -0800 (Fri, 30 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Put back paragraph break.

------------------------------------------------------------------------
r40350 | guy | 2011-12-30 19:14:30 -0800 (Fri, 30 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Leave more word-wrapping to the toolkit.

------------------------------------------------------------------------
r40349 | gerald | 2011-12-30 17:23:06 -0800 (Fri, 30 Dec 2011) | 2 lines
Changed paths:
   M /trunk/.gitignore

Add more entries and sort them.

------------------------------------------------------------------------
r40348 | cmaynard | 2011-12-30 11:19:19 -0800 (Fri, 30 Dec 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Add Gaurav Tungatkar.

------------------------------------------------------------------------
r40347 | stig | 2011-12-30 07:49:02 -0800 (Fri, 30 Dec 2011) | 1 line
Changed paths:
   M /trunk/AUTHORS

Fix formatting issues.
------------------------------------------------------------------------
r40346 | wmeier | 2011-12-30 07:30:32 -0800 (Fri, 30 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-homeplug.c
   M /trunk/epan/dissectors/packet-ppi.c

Fix 'encoding-arg' for ptvcursor_add_with_subtree(): TRUE=>ENC_LITTLE_ENDIAN, etc

------------------------------------------------------------------------
r40345 | wmeier | 2011-12-30 07:28:04 -0800 (Fri, 30 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h245.c

Regenerated packet-h245.c (should have been included in SVN #40311: add_new_data_source() needed in several places).


------------------------------------------------------------------------
r40344 | alagoutte | 2011-12-30 03:07:04 -0800 (Fri, 30 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-zbee-zcl.c
   M /trunk/epan/dissectors/packet-zbee.h

From Fred Fierling via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6698
Updates for newest profile identifier database, ZigBee 053298r19

Corrects error in Samsung manufacturer code in r18.

------------------------------------------------------------------------
r40343 | guy | 2011-12-29 23:31:18 -0800 (Thu, 29 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

We don't have any links to activate if we don't have pcap.

------------------------------------------------------------------------
r40342 | guy | 2011-12-29 23:07:20 -0800 (Thu, 29 Dec 2011) | 5 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Make the links in the "WinPcap doesn't appear to be installed" text
active.

Get rid of hard returns, and make it word wrap.

------------------------------------------------------------------------
r40341 | guy | 2011-12-29 20:26:33 -0800 (Thu, 29 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Clean up word wrapping a bit.

------------------------------------------------------------------------
r40340 | guy | 2011-12-29 16:52:15 -0800 (Thu, 29 Dec 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

For the "don't have WinPcap" case, put up some stuff in the welcome
screen discussing that.  (XXX - those links should be made live.)

------------------------------------------------------------------------
r40339 | guy | 2011-12-29 16:17:50 -0800 (Thu, 29 Dec 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

I had a capture_errs.c but capture-wpcap.c eated it.

------------------------------------------------------------------------
r40338 | guy | 2011-12-29 15:34:20 -0800 (Thu, 29 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Get rid of extra blank line.

------------------------------------------------------------------------
r40337 | guy | 2011-12-29 15:33:29 -0800 (Thu, 29 Dec 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c

Leave it up to dumpcap to determine whether WinPcap was loaded and, if
it wasn't, whether it matters; that way you can still capture from a
pipe (named or "-" for standard input) even if you don't have WinPcap.

------------------------------------------------------------------------
r40336 | guy | 2011-12-29 15:21:18 -0800 (Thu, 29 Dec 2011) | 4 lines
Changed paths:
   M /trunk/tshark.c

Leave it up to dumpcap to determine whether WinPcap was loaded and, if
it wasn't, whether it matters; that way you can still capture from a
pipe (named or "-" for standard input) even if you don't have WinPcap.

------------------------------------------------------------------------
r40335 | guy | 2011-12-29 15:09:42 -0800 (Thu, 29 Dec 2011) | 4 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture-wpcap.c
   M /trunk/capture-wpcap.h
   D /trunk/capture_errs.c
   D /trunk/capture_errs.h
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/rawshark.c
   M /trunk/tshark.c

Swallow cant_load_winpcap_err() up into capture-wpcap.c, so that
anything that uses WinPcap can use that message text in its error
messages.

------------------------------------------------------------------------
r40334 | guy | 2011-12-29 14:49:49 -0800 (Thu, 29 Dec 2011) | 5 lines
Changed paths:
   M /trunk/capture-wpcap.c
   M /trunk/capture_ifinfo.h
   M /trunk/capture_opts.c
   M /trunk/dumpcap.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main_welcome.c
   M /trunk/tshark.c

Add an additional DONT_HAVE_PCAP return value from get_interface_list()
and capture_interface_list().  Return it if, on Windows, we ask for the
interface list but don't have WinPcap installed.  Handle it like
CANT_GET_INTERFACE_LIST.

------------------------------------------------------------------------
r40333 | guy | 2011-12-29 14:06:22 -0800 (Thu, 29 Dec 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Just hard-code the error for "can't load WinPcap"; the one that
cant_load_winpcap_err() has some redundant gunk in it.

------------------------------------------------------------------------
r40332 | guy | 2011-12-29 13:59:24 -0800 (Thu, 29 Dec 2011) | 4 lines
Changed paths:
   M /trunk/dumpcap.c

On Windows, if we can't open a capture device, check whether WinPcap is
loaded and, if not, report that as the problem, rather than suggesting
that you didn't specify the proper interface.

------------------------------------------------------------------------
r40331 | guy | 2011-12-29 13:43:59 -0800 (Thu, 29 Dec 2011) | 2 lines
Changed paths:
   M /trunk/capture-wpcap.c

Forgot the buffer length argument to g_snprintf().

------------------------------------------------------------------------
r40330 | guy | 2011-12-29 13:18:08 -0800 (Thu, 29 Dec 2011) | 3 lines
Changed paths:
   M /trunk/capture-wpcap.c

If pcap_open_live() or pcap_open() fails due to not having WinPcap,
supply an appropriate error string.

------------------------------------------------------------------------
r40329 | wmeier | 2011-12-29 13:08:53 -0800 (Thu, 29 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl.c

AFAIKT sys/stat.h, sys/types.h, sys/socket.h, winsock2.h, inet_v6_defs.h  #includes aren't needed.
also: Add #include <epan/packet.h>  (altho included by one of the other includes).

------------------------------------------------------------------------
r40328 | wmeier | 2011-12-29 12:44:19 -0800 (Thu, 29 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c

AFAIKT sys/types.h, sys/socket.h, winsock2.h, inet_v6_defs.h #includes aren't needed.

------------------------------------------------------------------------
r40327 | wmeier | 2011-12-29 12:23:18 -0800 (Thu, 29 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c

Do whitespace cleanup; Reformat long lines;
Move proto_register...() to be near the end of the file.

------------------------------------------------------------------------
r40326 | wmeier | 2011-12-29 08:58:41 -0800 (Thu, 29 Dec 2011) | 3 lines
Changed paths:
   M /trunk/configure.in

Define GTK_DISABLE_DEPRECATED only if GTK lt 3.2 since
GTK 3.2 deprecates GtkVBox & GtkHBox which are currently used extensively by Wireshark.

------------------------------------------------------------------------
r40325 | cmaynard | 2011-12-29 08:22:02 -0800 (Thu, 29 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ltp.c

Fix LTP multiple bundle bug and allow LTP/DCCP.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5035

------------------------------------------------------------------------
r40324 | stig | 2011-12-29 03:54:08 -0800 (Thu, 29 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/tap_param_dlg.c

Set filter text after connecting to filter string callback so the
initial filter will be syntax checked.
------------------------------------------------------------------------
r40323 | stig | 2011-12-29 03:44:22 -0800 (Thu, 29 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Fixed a typo: btyes -> bytes
------------------------------------------------------------------------
r40322 | gerald | 2011-12-28 16:12:22 -0800 (Wed, 28 Dec 2011) | 3 lines
Changed paths:
   M /trunk/gtk/utf8_entities.h

Add PLACE_OF_INTEREST_SIGN, a.k.a. the OS X Command key symbol. Annotate
entries with their decimal and hexadecimal values. Add a modeline blurb.

------------------------------------------------------------------------
r40321 | gerald | 2011-12-28 16:08:47 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/airpcap_loader.h
   M /trunk/capture-pcap-util.h
   M /trunk/capture-wpcap.h
   M /trunk/capture.h
   M /trunk/capture_ifinfo.h
   M /trunk/capture_info.h
   M /trunk/capture_opts.h
   M /trunk/capture_ui_utils.h
   M /trunk/capture_wpcap_packet.h
   M /trunk/cfile.h
   M /trunk/color.h
   M /trunk/color_filters.h
   M /trunk/disabled_protos.h
   M /trunk/epan/base64.h
   M /trunk/epan/epan.h
   M /trunk/epan/epan_dissect.h
   M /trunk/epan/ex-opt.h
   M /trunk/epan/prefs.h
   M /trunk/epan/strutil.h
   M /trunk/epan/timestamp.h
   M /trunk/epan/tvbuff.h
   M /trunk/file.h
   M /trunk/filters.h
   M /trunk/globals.h
   M /trunk/gtk/recent.h
   M /trunk/main_statusbar.h
   M /trunk/progress_dlg.h
   M /trunk/register.h

Add 'extern "C"' wrappers and #include guards to various header files.

------------------------------------------------------------------------
r40320 | gerald | 2011-12-28 15:39:14 -0800 (Wed, 28 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sita.c
   M /trunk/epan/dissectors/packet-uts.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/wtap.h

Prepend the sita_phdr fields with "sita_" to make them less
collision-prone.

------------------------------------------------------------------------
r40319 | gerald | 2011-12-28 14:57:02 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/.gitignore

Add some CMake files and directories.

------------------------------------------------------------------------
r40318 | gerald | 2011-12-28 14:42:40 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/packaging/nsis/wireshark.nsi

Remove some NSIS 1.x cruft.

------------------------------------------------------------------------
r40317 | gerald | 2011-12-28 14:37:38 -0800 (Wed, 28 Dec 2011) | 4 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi

Simplify wireshark.nsi a bit by copying DLLs from the wireshark-gtk2
directory.  This picks up any DEP/ASLR-related changes. Run peflags on
more DLLs.

------------------------------------------------------------------------
r40316 | gerald | 2011-12-28 12:29:13 -0800 (Wed, 28 Dec 2011) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/docbook/wsdg_src/WSDG_chapter_quick_setup.xml

Add "peflags" to the list of required executables. Use it to make sure
the DLLs we use have DEP and ASLR enabled.

------------------------------------------------------------------------
r40315 | cmaynard | 2011-12-28 09:02:43 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Fix Coverity CID 1342: UNUSED_VALUE

------------------------------------------------------------------------
r40314 | cmaynard | 2011-12-28 08:59:17 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Add missing break;  Fixes Coverity CID 1343.

------------------------------------------------------------------------
r40313 | cmaynard | 2011-12-28 08:53:50 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdp.c

min() -> MIN().

------------------------------------------------------------------------
r40312 | cmaynard | 2011-12-28 08:36:57 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bt-dht.c
   M /trunk/epan/dissectors/packet-gopher.c
   M /trunk/epan/dissectors/packet-gsm_ipa.c
   M /trunk/epan/dissectors/packet-meta.c
   M /trunk/epan/dissectors/packet-mux27010.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-rdp.c
   M /trunk/epan/dissectors/packet-sametime.c
   M /trunk/epan/dissectors/packet-ua.c
   M /trunk/epan/dissectors/packet-xtp.c
   M /trunk/plugins/unistim/packet-unistim.c

Fix memory leaks involving tvb_get_string[z]().

------------------------------------------------------------------------
r40311 | wmeier | 2011-12-28 08:09:45 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/asn1/h245/h245.cnf

add_new_data_source() needed in several places.

------------------------------------------------------------------------
r40310 | wmeier | 2011-12-28 07:23:56 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/tools/colorfilters2js.pl

Add svn:executable property

------------------------------------------------------------------------
r40309 | wmeier | 2011-12-28 07:05:59 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def
   M /trunk/epan/packet.c
   M /trunk/epan/packet.h
   M /trunk/tshark.c

Add tshark option '-G heuristic-decodes' to dump heuristic dissector tables.

------------------------------------------------------------------------
r40308 | wmeier | 2011-12-28 07:01:17 -0800 (Wed, 28 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mime-encap.c

Remove a not really relevant comment.

------------------------------------------------------------------------
r40307 | wmeier | 2011-12-28 06:57:43 -0800 (Wed, 28 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-image-jfif.c

Remove unneeded #includes;
Reformat some long lines;
Convert '4 space tabs' to spaces.

------------------------------------------------------------------------
r40306 | gerald | 2011-12-27 12:35:41 -0800 (Tue, 27 Dec 2011) | 4 lines
Changed paths:
   M /trunk/doc/wireshark-filter.pod
   M /trunk/epan/ftypes/ftype-bytes.c
   M /trunk/epan/ftypes/ftype-double.c
   M /trunk/epan/ftypes/ftype-integer.c
   M /trunk/epan/ftypes/ftype-none.c
   M /trunk/epan/ftypes/ftype-string.c
   M /trunk/epan/ftypes/ftype-time.c
   M /trunk/epan/ftypes/ftype-tvbuff.c
   M /trunk/epan/libwireshark.def
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h
   M /trunk/tshark.c

Add a "-G ftypes" option, which dumps our supprted FT_… names and
descriptions. Captitalize and fix up the descriptions. Use its output to
create the field type list in the wireshark-filter man page.

------------------------------------------------------------------------
r40305 | wmeier | 2011-12-27 10:54:32 -0800 (Tue, 27 Dec 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/catapult_dct2000.c

Tighten up format string used for date/time parse;
Use 'static' in function definitions to match function declarations;
Do minor reformatting.

------------------------------------------------------------------------
r40304 | cmaynard | 2011-12-27 10:16:12 -0800 (Tue, 27 Dec 2011) | 2 lines
Changed paths:
   M /trunk/file.c

From Jim Young via bug 5580: Only update the time elapsed between the previous displayed packet and this packet if the packet is actually displayed.  Ref: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5580

------------------------------------------------------------------------
r40303 | cmaynard | 2011-12-27 09:46:25 -0800 (Tue, 27 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

Fix a comment.  Correct a few typos.

------------------------------------------------------------------------
r40302 | cmaynard | 2011-12-27 09:34:01 -0800 (Tue, 27 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcm.c

Corrected some obvious typos.

------------------------------------------------------------------------
r40301 | cmaynard | 2011-12-27 09:08:33 -0800 (Tue, 27 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

Use tvb_get_ntoh48() instead of tvb_get_ntohs() || tvb_get_ntohl().

------------------------------------------------------------------------
r40300 | cmaynard | 2011-12-27 08:51:59 -0800 (Tue, 27 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wol.c

Use tvb_ether_to_str() instead of ether_to_str(ep_tvb_memdup()).  Add modelines.

------------------------------------------------------------------------
r40299 | etxrab | 2011-12-27 03:08:52 -0800 (Tue, 27 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Initialise variables.
------------------------------------------------------------------------
r40298 | etxrab | 2011-12-27 02:48:04 -0800 (Tue, 27 Dec 2011) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

From Gaurav Tungatkar:

support extended ICMP for multi-part messages as specified by
RFC 4884. Additionally, it adds support for the Interface Information Object
extension to ICMP as specified by RFC 5837.
1. RFC 4884 - This redefines certain ICMP messages to support multi-part
messages with extensions. It adds a length field to the ICMP header and defines
an extension structure to define extension objects that can be appended to the
selected ICMP messages. It retains backward compatibility with messages that do
not support the extensions defined by this RFC. 
2. RFC 5837 - This defines an extension object to identify the interface and
next-hop information to selected ICMP messages.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6632
------------------------------------------------------------------------
r40297 | etxrab | 2011-12-27 02:15:00 -0800 (Tue, 27 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/radius/dictionary.3gpp2

Dissect Service Option Profile.
------------------------------------------------------------------------
r40296 | martinm | 2011-12-26 16:27:46 -0800 (Mon, 26 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Display the meaning of the special values of the Stop MTCH field.

From Pascal Quantin

------------------------------------------------------------------------
r40295 | guy | 2011-12-26 15:00:33 -0800 (Mon, 26 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_mac.c

That's the 3GPP spec for this protocol layer, right?

------------------------------------------------------------------------
r40294 | alagoutte | 2011-12-26 06:59:50 -0800 (Mon, 26 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Update ICMPv6 to last IANA Parameters (2011-12-21)
* RFC3775 => RFC6275
* draft-ietf-6lowpan-nd-17 => draft-ietf-6lowpan-nd-18

------------------------------------------------------------------------
r40293 | alagoutte | 2011-12-26 06:00:22 -0800 (Mon, 26 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Update IKEv2 to last IANA Parameters (2011-12-19)
RFC-kivinen-ipsecme-secure-password-framework-03 => RFC6467

------------------------------------------------------------------------
r40290 | gerald | 2011-12-25 07:03:26 -0800 (Sun, 25 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-12-25]
------------------------------------------------------------------------
r40289 | etxrab | 2011-12-25 03:48:31 -0800 (Sun, 25 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Revisit the spec, value is 16 bits.
------------------------------------------------------------------------
r40288 | etxrab | 2011-12-25 03:25:39 -0800 (Sun, 25 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-radius.h
   M /trunk/radius/dictionary.3gpp2

Use packet-radius.c to dissect embedded AVP:s.
------------------------------------------------------------------------
r40286 | wmeier | 2011-12-23 08:14:06 -0800 (Fri, 23 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/follow_udp.c

Use tvb accessors rather than directly accessing tvb struct.

------------------------------------------------------------------------
r40285 | cmaynard | 2011-12-23 06:31:24 -0800 (Fri, 23 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi-picmg.c

Use ENC_LITTLE_ENDIAN instead of TRUE as encoding argument to proto_tree_add_bitmask_text().

------------------------------------------------------------------------
r40284 | cmaynard | 2011-12-23 06:20:53 -0800 (Fri, 23 Dec 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Update/simplify the list of some of the stuff I worked on.

------------------------------------------------------------------------
r40283 | etxrab | 2011-12-22 14:31:26 -0800 (Thu, 22 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Use item lenght when dissecting Additional Session Info.
------------------------------------------------------------------------
r40282 | cmaynard | 2011-12-22 13:52:16 -0800 (Thu, 22 Dec 2011) | 2 lines
Changed paths:
   M /trunk/mergecap.c

Alphabetize the list of encapsulation types via "mergecap -T" as well as the list of capture file types via "mergecap -F".

------------------------------------------------------------------------
r40281 | cmaynard | 2011-12-22 11:41:13 -0800 (Thu, 22 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Appease the buildbots.

------------------------------------------------------------------------
r40280 | cmaynard | 2011-12-22 11:22:43 -0800 (Thu, 22 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Revert some of the changes made as part of the patch from bug 6194 committed in r38326.  Also, change the 3 separate reserved bit fields to a single 3-bit reserved field to more closely match the spec.  Lastly, in accordance with NOTE 2 of Table 3-1 of the spec, display the connection id, whatever it is, rather than assuming it's zero just because the Com bit isn't set.

------------------------------------------------------------------------
r40279 | martinm | 2011-12-22 10:45:15 -0800 (Thu, 22 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.h

Missed in last commit, define symbol for new RNTI type...

------------------------------------------------------------------------
r40278 | wmeier | 2011-12-22 10:13:18 -0800 (Thu, 22 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.c

(Trivial) Indentation, whitespace & formatting cleanup.

------------------------------------------------------------------------
r40277 | wmeier | 2011-12-22 10:09:06 -0800 (Thu, 22 Dec 2011) | 2 lines
Changed paths:
   M /trunk/asn1/rrc/rrc.cnf
   M /trunk/epan/dissectors/packet-rrc.c

Add two missing calls to add_new_data_source().

------------------------------------------------------------------------
r40276 | martinm | 2011-12-22 10:05:48 -0800 (Thu, 22 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Support for MCH PDUs (introduced in R9 for MBMS).

From Pascal Quantin.

------------------------------------------------------------------------
r40275 | cmaynard | 2011-12-22 06:49:43 -0800 (Thu, 22 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

What is the airspeed velocity of an unladen swallow?

aspell and my own spelling preferences do not always agree with the spelling variations used by folks across the pond.  Revert a couple of spelling changes.

------------------------------------------------------------------------
r40274 | guy | 2011-12-22 01:22:35 -0800 (Thu, 22 Dec 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/5views.c
   M /trunk/wiretap/netmon.c
   M /trunk/wiretap/ngsniffer.c
   M /trunk/wiretap/snoop.c

The encapsulation following WTAP_ENCAP_ARCNET is
WTAP_ENCAP_ARCNET_LINUX; update various tables mapping Wiretap
encapsulations to file-type encapsulations.  Get rid of some trailing
"sorry, that's not supported" entries while we're at it.

------------------------------------------------------------------------
r40273 | etxrab | 2011-12-21 23:03:42 -0800 (Wed, 21 Dec 2011) | 10 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

From Naoyoshi Ueda:

Enable decryption of TLS 1.2.

 Add some cipher suites from RFC5246 and RFC5289.

Fixed a bug in the handling of stream cipher.
(The explicit IV field in the application record doesn't exist when stream ciphers are used. But the original code handles it as if one-byte IV exists.)

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6688
------------------------------------------------------------------------
r40272 | etxrab | 2011-12-21 22:55:31 -0800 (Wed, 21 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-zbee-aps.c
   M /trunk/epan/dissectors/packet-zbee-zcl.c
   M /trunk/epan/dissectors/packet-zbee.h

From Fred Fierling:
Update the ZigBee dissectors to the latest profile identifier database,
05-3298-18.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6693
------------------------------------------------------------------------
r40271 | cmaynard | 2011-12-21 18:17:11 -0800 (Wed, 21 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi-app.c
   M /trunk/epan/dissectors/packet-ipmi-chassis.c
   M /trunk/epan/dissectors/packet-ipmi-se.c
   M /trunk/epan/dissectors/packet-ipmi-storage.c
   M /trunk/epan/dissectors/packet-ipmi-transport.c

Use ENC_LITTLE_ENDIAN instead of TRUE as endian argument to proto_tree_add_bitmask_text().

------------------------------------------------------------------------
r40270 | cmaynard | 2011-12-21 17:57:20 -0800 (Wed, 21 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sasp.c
   M /trunk/epan/dissectors/packet-tn3270.c

Set encoding to ENC_BIG_ENDIAN instead of the incorrect encoding of TRUE.

------------------------------------------------------------------------
r40269 | wmeier | 2011-12-21 15:42:17 -0800 (Wed, 21 Dec 2011) | 7 lines
Changed paths:
   M /trunk/epan/tvbtest.c

Rework some code in tvbtest to fix an issue when testing composite tvbs.

tvbtest now completes all the tvb tests successfully (including those for composite tvbs) !!

In addition, running tvbtest under valgrind shows no memory leaks.


------------------------------------------------------------------------
r40268 | wmeier | 2011-12-21 13:49:10 -0800 (Wed, 21 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/tvbtest.c

Fix a Windows compile error.

------------------------------------------------------------------------
r40267 | wmeier | 2011-12-21 13:40:25 -0800 (Wed, 21 Dec 2011) | 10 lines
Changed paths:
   M /trunk/epan/tvbtest.c

Add code to allow tvbuff memory leak testing (using valgrind, for example).

Essentially: tvbtest.c patch from Robert G. Jakabosky:
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6573

Also: Update tvbtest code slightly to reflect the revised tvbuffs code
committed in SVN #40264;
 (Composite tvbs should not be individually freed).


------------------------------------------------------------------------
r40266 | cmaynard | 2011-12-21 13:34:37 -0800 (Wed, 21 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Avoid a potential buffer overflow (and fix some typos).  Resolves bug 6391: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6391

------------------------------------------------------------------------
r40265 | wmeier | 2011-12-21 10:57:42 -0800 (Wed, 21 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/epan.c

Remove no longer relevant comment about incrementing tvb usage count to prevent freeing tvbs.

------------------------------------------------------------------------
r40264 | wmeier | 2011-12-21 09:39:02 -0800 (Wed, 21 Dec 2011) | 12 lines
Changed paths:
   M /trunk/epan/tvbuff-int.h
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

A simplified version of tvbuffs:
- Essentially no changes from current dissector de facto tvbuff usage;
- Do away with 'usage_counts' and with 'used_in' GSLists;
- Manage tvb chains via a simple doubly linked list.
- API changes:
  a. tvb_increment_usage_count() and tvb_decrement_usage_count() no
     longer exist;
  b. tvb_free_chain() can only be called for the 'top-level' (initial)
     tvb of a chain) or for a tvb not in a chain.
  c. tvb_free() now just calls tvb_free_chain() [should have no impact
     on existing  dissectors].

------------------------------------------------------------------------
r40263 | alagoutte | 2011-12-21 07:03:39 -0800 (Wed, 21 Dec 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-skinny.c

From jingzhang via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6590
Make wireshark to support SKINNY new version

Current wireshark version can not support the new skinny packets when the header version == "14 00 00 00". It should be the same handling process with "12 00 00 00"(CM7_MSG_TYPE_B), So we added the same function to support CM7_MSG_TYPE_C(we defined it by ourselves, just want to keep the consistency with CM7_MSG_TYPE_B).

From me :
Fix encoding attribut (via fix-encoding.args.pl)

------------------------------------------------------------------------
r40262 | alagoutte | 2011-12-21 06:58:07 -0800 (Wed, 21 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-skinny.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40261 | alagoutte | 2011-12-21 06:28:51 -0800 (Wed, 21 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls.c

From Alexander Koeppe via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6689
Avoid string.h in packet-mpls.c

------------------------------------------------------------------------
r40260 | alagoutte | 2011-12-21 06:21:17 -0800 (Wed, 21 Dec 2011) | 5 lines
Changed paths:
   A /trunk/epan/dissectors/packet-bzr.c

From Jelmer Vernooij via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6686
Dissector for the bzr smart server protocol

The attached patch adds basic support for dissecting the bzr smart server protocol ( http://wiki.wireshark.org/Bazaar ).

------------------------------------------------------------------------
r40259 | alagoutte | 2011-12-21 06:20:34 -0800 (Wed, 21 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common

From Jelmer Vernooij via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6686
Dissector for the bzr smart server protocol

The attached patch adds basic support for dissecting the bzr smart server protocol ( http://wiki.wireshark.org/Bazaar ).

------------------------------------------------------------------------
r40258 | alagoutte | 2011-12-21 06:18:28 -0800 (Wed, 21 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Fix indent and add modelines information

------------------------------------------------------------------------
r40257 | wmeier | 2011-12-20 19:44:23 -0800 (Tue, 20 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Use correct reported_length for a tvb_new_subset() (not that it makes a difference in this case).

------------------------------------------------------------------------
r40256 | sfisher | 2011-12-20 13:53:50 -0800 (Tue, 20 Dec 2011) | 10 lines
Changed paths:
   M /trunk/epan/proto.c


Improve this error message (example output based on attachment in bug #6665):

    OOPS: ',' in 'tpncp.fxs_ana,og_voltage_beading'

Now:

    Invalid character ',' in filter name 'tpncp.fxs_ana,og_voltage_beading'


------------------------------------------------------------------------
r40255 | etxrab | 2011-12-20 11:34:52 -0800 (Tue, 20 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Avoid dupliacte entries in col_proto
------------------------------------------------------------------------
r40254 | cmaynard | 2011-12-20 10:18:08 -0800 (Tue, 20 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Add some additional links to more up to date specfications.

------------------------------------------------------------------------
r40253 | cmaynard | 2011-12-20 10:15:52 -0800 (Tue, 20 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

For a DNSSL lifetime of 0, add some useful text.

------------------------------------------------------------------------
r40251 | cmaynard | 2011-12-20 09:59:51 -0800 (Tue, 20 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

Checking scmUDID for NULL is pointless since the pointer has already been dereferenced.  If g_byte_array_new() can return NULL, then the code should be modified to protect against deferencing the NULL pointer much sooner than this.

------------------------------------------------------------------------
r40250 | cmaynard | 2011-12-20 09:53:44 -0800 (Tue, 20 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Correct a few typos.

------------------------------------------------------------------------
r40247 | cmaynard | 2011-12-19 15:44:01 -0800 (Mon, 19 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb-at.c
   M /trunk/epan/dissectors/packet-usb.c

Add support for dissecting AT commands in USB URB_CONTROL packets.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6037

------------------------------------------------------------------------
r40245 | cmaynard | 2011-12-19 09:59:34 -0800 (Mon, 19 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tftp.c

Tighten up conversation port matching once the 2nd port is known.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5727

------------------------------------------------------------------------
r40244 | etxrab | 2011-12-19 08:57:17 -0800 (Mon, 19 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

Updates from David Wei.
------------------------------------------------------------------------
r40242 | wmeier | 2011-12-18 10:31:30 -0800 (Sun, 18 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Create "Dehunked Entity Body" with O(N) rather than O(N^2) efffort.
[Actually 1 g_malloc() + N tvb_memcpy() instead of
~ N g_malloc()/g_free() + N*(N+1)/2 tvb_memcpy() where N = number of chunks].

------------------------------------------------------------------------
r40241 | cmaynard | 2011-12-18 08:38:31 -0800 (Sun, 18 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Fix Coverity CID's 1339 and 1340: UNUSED_VALUE.

------------------------------------------------------------------------
r40238 | gerald | 2011-12-18 07:03:29 -0800 (Sun, 18 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-12-18]
------------------------------------------------------------------------
r40237 | alagoutte | 2011-12-17 06:26:57 -0800 (Sat, 17 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-zebra.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40236 | etxrab | 2011-12-17 04:21:04 -0800 (Sat, 17 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netanalyzer.c

The author Holger Pfrommer preferes not to show the bits making up the port and length.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6082
------------------------------------------------------------------------
r40235 | alagoutte | 2011-12-17 02:06:38 -0800 (Sat, 17 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ff.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40234 | alagoutte | 2011-12-17 02:05:47 -0800 (Sat, 17 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-zbee-security.c
   M /trunk/epan/dissectors/packet-zbee-zcl.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40233 | alagoutte | 2011-12-17 01:57:35 -0800 (Sat, 17 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Update IKEv2 to last IANA Parameters (2011-11-09)
Add RFC-kivinen-ipsecme-secure-password-framework-03

------------------------------------------------------------------------
r40231 | wmeier | 2011-12-16 11:15:17 -0800 (Fri, 16 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c

Add (what I think are) missing add_new_data_source() calls;

------------------------------------------------------------------------
r40230 | wmeier | 2011-12-16 09:33:09 -0800 (Fri, 16 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Fix tvb memory leak; Also: For a "packet-lifetime" tvb use ep_alloc'd (not se_alloc'd) memory.

------------------------------------------------------------------------
r40229 | etxrab | 2011-12-16 08:32:02 -0800 (Fri, 16 Dec 2011) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Add application ids
------------------------------------------------------------------------
r40228 | wmeier | 2011-12-16 07:58:10 -0800 (Fri, 16 Dec 2011) | 2 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_dissection.xml

Update the "How to handle transformed data" section to reflect current practice.

------------------------------------------------------------------------
r40227 | sahlberg | 2011-12-15 19:54:46 -0800 (Thu, 15 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c

PAC: S4U update, decode the full S4U Delegation Info blob with correct names


------------------------------------------------------------------------
r40226 | sahlberg | 2011-12-15 19:44:43 -0800 (Thu, 15 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c

DCE/RPC: When printing counted strings to the tree, we divided the number of bytes by 2 and thus truncating the string in half for the presentation.


------------------------------------------------------------------------
r40225 | sahlberg | 2011-12-15 19:41:14 -0800 (Thu, 15 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.h
   M /trunk/epan/dissectors/packet-kerberos.c

PAC: rename CONSTRAINED_DELEGATION to S4U_DELEGATION_INFO


------------------------------------------------------------------------
r40224 | sahlberg | 2011-12-15 19:18:04 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

Kerberos: rename the pa type 129 to the correct name PA_FOR_USER and describe where this type is specified

------------------------------------------------------------------------
r40223 | guy | 2011-12-15 16:54:45 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.h

Note why we need <stdio.h>.

------------------------------------------------------------------------
r40222 | wmeier | 2011-12-15 16:50:47 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.h

Oops: #include <stdio.h> is really needed.

------------------------------------------------------------------------
r40221 | wmeier | 2011-12-15 16:33:03 -0800 (Thu, 15 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

Fix tvb memory leak; Add missing call to add_new_data_source();
Also: remove unneeded #includes.

------------------------------------------------------------------------
r40220 | wmeier | 2011-12-15 13:30:51 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Fix a typo

------------------------------------------------------------------------
r40219 | guy | 2011-12-15 13:03:21 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

#if 0 out a bunch of (currently?) unused routines.

------------------------------------------------------------------------
r40218 | guy | 2011-12-15 13:00:15 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Clean up indentation.

------------------------------------------------------------------------
r40217 | guy | 2011-12-15 12:59:44 -0800 (Thu, 15 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

Null out opensafety_item if we're nulling out opensafety_tree.

Clean up indentation.

------------------------------------------------------------------------
r40216 | etxrab | 2011-12-15 12:45:06 -0800 (Thu, 15 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

#if 0 now unused variables.
------------------------------------------------------------------------
r40215 | etxrab | 2011-12-15 12:39:01 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/packet.c
   M /trunk/epan/packet.h

Preparation to make it possible to dissable heuristic protocols
trough the proto dialouge.
------------------------------------------------------------------------
r40214 | etxrab | 2011-12-15 12:34:45 -0800 (Thu, 15 Dec 2011) | 25 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
- New Config option to configure the sequence of frames using UDP
- an Info will be added, if the SCM UDID is not configured or if it is wrongly
configured, so that the user can act on it.
- SCM UDID will only be printed if configured correctly, if not a warning will
be added to inform, that the first byte for the UDID will be assumed to be 00
- UDP dissection can enforce the number of sub-package the dissection should
assume
- SSDO: isRequest is determined by it's field not by the message id
- SSDO: Unused code for SNMT Reset Guarding SCM has been removed
- SNMT: error_group and error_code for SN_FAIL have not been dissected
correctly
- Sercos III: bug != instead of ==, is fixed
- dissect_opensafety_udp renamed to dissect_opensafety_udpdata, because of
future dissector called opensafety_udp which will handle transport of
openSAFETY data over UDP
- dissect_opensafety_udpdata enhanced to determine the index of the given frame
in the package. Needed for correct assembly of COL_INFO
- Added heuristic dissector hook for opensafety_udp dissector. The dissector
will be submitted to this list at a future point

- Enhanced description of the dissector to reflect it's capabilities
- Reworked the description for the config options to be more understandable

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6672
------------------------------------------------------------------------
r40213 | etxrab | 2011-12-15 12:22:54 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rohc.c

Call the rohc dissector directly, the code will be cleaned up
in the next weeks or so.
------------------------------------------------------------------------
r40212 | wmeier | 2011-12-15 10:47:57 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtmpt.c

Conform indentation to that specified by the modeline; Reformat long lines.

------------------------------------------------------------------------
r40211 | wmeier | 2011-12-15 10:13:21 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtmpt.c

Fix some tvb memory leaks; Fix a typo.

------------------------------------------------------------------------
r40210 | etxrab | 2011-12-15 09:28:43 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-rohc.h

From Per Liedberg:
RoHC dissection improvment.
------------------------------------------------------------------------
r40209 | etxrab | 2011-12-15 09:14:56 -0800 (Thu, 15 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sgsap.c

Use correct string length.
------------------------------------------------------------------------
r40208 | wmeier | 2011-12-15 08:01:25 -0800 (Thu, 15 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

In certain cases, don't reference a tvb when displaying a hidden,generated field.

------------------------------------------------------------------------
r40207 | guy | 2011-12-15 00:22:06 -0800 (Thu, 15 Dec 2011) | 14 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

If stuff above the Wiretap library can't handle packet reported lengths
> WTAP_MAX_PACKET_SIZE, either that should be caught above the
per-file-type layer in Wiretap or should be handled by the caller.

We've recently fixed at least one problem with reported lengths > 2^31 -
1 (by clamping the length to 2^31 - 1), so let's just remove the check
from the pcap-NG reader, to squelch some complaints we're getting from
the buildbot (bug 6673 and its duplicates).

(The pcap reader uses it to cope with some of the botched libpcap
formats that changed the per-packet header without changing the magic
number; I'll look at trying to preserve those heuristics while still
allowing reported lengths > WTAP_MAX_PACKET_SIZE.)

------------------------------------------------------------------------
r40206 | sfisher | 2011-12-14 15:27:14 -0800 (Wed, 14 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.h


Fix moving nfs_fhandle_data from packet-nfs.h to packet-nfs.c as begun
in r40205.


------------------------------------------------------------------------
r40205 | wmeier | 2011-12-14 14:01:38 -0800 (Wed, 14 Dec 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

Fix a tvb memory leak;
  Essentially: generate tvbuffs as needed; don't save them for later reuse
               with the result they are never freed.

Also:
- move a struct from packet-nfs.h to packet-nfs.c since it's only used locally;
- reformat some long lines.

------------------------------------------------------------------------
r40204 | cmaynard | 2011-12-14 13:13:06 -0800 (Wed, 14 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/expert.c
   M /trunk/epan/expert.h
   M /trunk/epan/libwireshark.def
   M /trunk/print.c

Treat expert info as a <field> instead of a <proto> when exporting to pdml.

------------------------------------------------------------------------
r40203 | wmeier | 2011-12-14 10:58:08 -0800 (Wed, 14 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldss.c

Add call to add_new_data_source() for a newly created REAL_DATA tvb.

------------------------------------------------------------------------
r40202 | wmeier | 2011-12-14 10:40:03 -0800 (Wed, 14 Dec 2011) | 2 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcom-cba-acco.c

(Trivial) remove commented out calls to tvb_free().

------------------------------------------------------------------------
r40201 | wmeier | 2011-12-14 10:33:00 -0800 (Wed, 14 Dec 2011) | 2 lines
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

tvb_free() can (now) be called from plugins on Windows

------------------------------------------------------------------------
r40200 | sake | 2011-12-14 10:24:41 -0800 (Wed, 14 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl.c

Fix for bug 6032:

After changing the ssl_keys UAT, reparse the list and reload the keys.


------------------------------------------------------------------------
r40199 | wmeier | 2011-12-14 09:35:22 -0800 (Wed, 14 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

Fix tvb memory leak.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3917

------------------------------------------------------------------------
r40198 | wmeier | 2011-12-14 07:19:14 -0800 (Wed, 14 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c

Fix a tvbuff memory leak;
Also: Wireshark code change attributions are usually only in the svn log.

------------------------------------------------------------------------
r40197 | wmeier | 2011-12-14 06:39:16 -0800 (Wed, 14 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bmc.c

Fix a (sort-of) memory leak: Use ep_alloc'd rather than se_alloc'd memory for a tvbuff;

------------------------------------------------------------------------
r40196 | guy | 2011-12-13 21:23:57 -0800 (Tue, 13 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hpteam.c

Put back the source MAC address, but do it right, in one column_add_fstr()
call, and using ep_address_to_str(), so it can handle any address type,
including AT_NONE if the source address isn't available.

------------------------------------------------------------------------
r40195 | guy | 2011-12-13 18:55:26 -0800 (Tue, 13 Dec 2011) | 18 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hpteam.c

Refer to a PID of 0x0002 as the PID for the HP Teaming heartbeat
protocol.

Point to an HP document o the protocol, and discuss the two ways to hook
up the dissector.

Don't bother checking the destination address - either the OUI/PID
suffices, or the MAC address is both necessary and, presumably,
sufficient and we need to introduce a heuristic dissector table for SNAP
frames.  What's more, there's no guarantee that the destination address
is a MAC address - it might be absent, e.g. because you're capturing on
the Linux "any" device and are getting the "Linux cooked" header, with
only a destination address.

Don't put the source address into the Info column - it's already in the
source column *if* it exists (which it might not, for packets captured
from the "any" device and sent by the machine doing the capturing).

------------------------------------------------------------------------
r40194 | guy | 2011-12-13 18:46:16 -0800 (Tue, 13 Dec 2011) | 6 lines
Changed paths:
   M /trunk/epan/to_str.c

Put back the checks for null arguments, but report a dissector bug if
we're given null pointers.

Put in comments clarifying that some routines intentionally do *not*
null terminate the strings they produce.

------------------------------------------------------------------------
r40193 | guy | 2011-12-13 18:03:05 -0800 (Tue, 13 Dec 2011) | 6 lines
Changed paths:
   M /trunk/epan/to_str.c

Back the previous change out; I'll be checking in a change to throw a
dissector bug exception in cases where a null pointer was passed, as
those really *are* dissector bugs (and I have a fix for the bug in
question in the HP Teaming heartbeat dissector, which I'll be checking
in later).

------------------------------------------------------------------------
r40192 | wmeier | 2011-12-13 16:06:16 -0800 (Tue, 13 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Fix [-Wunused-but-set-variable] gcc warning;
Use consistent indentation.

------------------------------------------------------------------------
r40191 | wmeier | 2011-12-13 15:47:47 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Use consistent indentation.

------------------------------------------------------------------------
r40190 | wmeier | 2011-12-13 15:16:13 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee802154.c

Fix memory leak.

------------------------------------------------------------------------
r40189 | wmeier | 2011-12-13 15:03:16 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Fix a memory leak.

------------------------------------------------------------------------
r40188 | wmeier | 2011-12-13 15:02:29 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipars.c

Convert "4 space tabs" to spaces; Minor reformatting.

------------------------------------------------------------------------
r40187 | wmeier | 2011-12-13 14:49:59 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xml.c

Fix tvb memory leak; Fix hex byte display for Unicode XML.

------------------------------------------------------------------------
r40186 | wmeier | 2011-12-13 13:51:33 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-syslog.c

Fix tvbuff memory leak.

------------------------------------------------------------------------
r40185 | wmeier | 2011-12-13 13:03:57 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Use consistent indentation.

------------------------------------------------------------------------
r40184 | cmaynard | 2011-12-13 12:07:21 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/print.c

Don't close the field tag here; it's now closed with </field>.

------------------------------------------------------------------------
r40183 | wmeier | 2011-12-13 11:58:47 -0800 (Tue, 13 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sigcomp.c

Move proto_reg_handoff...(0 to the end of the file as per Wireshark convention.
Minor whitespace cleanup.

------------------------------------------------------------------------
r40182 | wmeier | 2011-12-13 11:54:19 -0800 (Tue, 13 Dec 2011) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sigcomp.c

Fix: Execution Tracing High-Detail field selection highlighting seemingly wrong bytes in hex view pane.

Actual problem:
  A REAL_DATA tvbuff wasn't being added to the "data_sources"
  for a frame. When displaying the frame, when a field referencing the tvb was selected
  for display there was no 'hex bytes' tab for the field and so bytes ended up being
  highlighted in the currently displayed hex bytes tab (thus highlighting bytes in a pane
  not related to the field).

  Consider: Add some code in field creation (proto_tree_add...) to at least warn if
            a field is being created using a tvb whose data_source is not in the
            data_sources list for the frame ?

------------------------------------------------------------------------
r40181 | martinm | 2011-12-13 11:46:24 -0800 (Tue, 13 Dec 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Initialise 'sub_tree' to NULL, to avoid warnings about possibly using
uninitialised.  The warnings are bogus, but could have been avoided, as the test
to see if we're using a compression profile is redundant/will always be TRUE
in those functions...

Also removed some unnecessary braces from switch cases (no local variables were defined).

------------------------------------------------------------------------
r40180 | guy | 2011-12-13 10:56:01 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h248_annex_e.c

The last element of an h248_pkg_param_t should be a pointer.

------------------------------------------------------------------------
r40179 | etxrab | 2011-12-13 09:59:27 -0800 (Tue, 13 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h248_annex_e.c

h248_e_implicit = FALSE;
------------------------------------------------------------------------
r40178 | martinm | 2011-12-13 09:35:45 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Fix typo

------------------------------------------------------------------------
r40177 | etxrab | 2011-12-13 09:13:50 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-rohc.c

From Per Liedberg:
RoHC dissection improvment.
------------------------------------------------------------------------
r40176 | cmaynard | 2011-12-13 08:50:34 -0800 (Tue, 13 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/to_str.c

Protect against NULL pointers as input.  Based on the stacktrace provided, this should avoid crashes reported in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6634

------------------------------------------------------------------------
r40175 | guy | 2011-12-13 01:53:50 -0800 (Tue, 13 Dec 2011) | 11 lines
Changed paths:
   M /trunk/capinfos.c
   M /trunk/capture_info.c
   M /trunk/editcap.c
   M /trunk/file.c
   M /trunk/mergecap.c
   M /trunk/rawshark.c
   M /trunk/tshark.c
   M /trunk/wiretap/5views.c
   M /trunk/wiretap/aethra.c
   M /trunk/wiretap/airopeek9.c
   M /trunk/wiretap/ascendtext.c
   M /trunk/wiretap/ber.c
   M /trunk/wiretap/btsnoop.c
   M /trunk/wiretap/commview.c
   M /trunk/wiretap/cosine.c
   M /trunk/wiretap/csids.c
   M /trunk/wiretap/daintree-sna.c
   M /trunk/wiretap/dbs-etherwatch.c
   M /trunk/wiretap/dct3trace.c
   M /trunk/wiretap/erf.c
   M /trunk/wiretap/etherpeek.c
   M /trunk/wiretap/eyesdn.c
   M /trunk/wiretap/hcidump.c
   M /trunk/wiretap/i4btrace.c
   M /trunk/wiretap/ipfix.c
   M /trunk/wiretap/iptrace.c
   M /trunk/wiretap/iseries.c
   M /trunk/wiretap/k12.c
   M /trunk/wiretap/k12text.l
   M /trunk/wiretap/lanalyzer.c
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/netmon.c
   M /trunk/wiretap/netscreen.c
   M /trunk/wiretap/nettl.c
   M /trunk/wiretap/network_instruments.c
   M /trunk/wiretap/ngsniffer.c
   M /trunk/wiretap/packetlogger.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/pppdump.c
   M /trunk/wiretap/snoop.c
   M /trunk/wiretap/tnef.c
   M /trunk/wiretap/toshiba.c
   M /trunk/wiretap/visual.c
   M /trunk/wiretap/vms.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

Rename WTAP_ERR_BAD_RECORD to WTAP_ERR_BAD_FILE; it really reports any
form of corruption/bogosity in a file, including in a file header as
well as in records in the file.  Change the error message
wtap_strerror() returns for it to reflect that.

Use it for some file header problems for which it wasn't already being
used - WTAP_ERR_UNSUPPORTED shouldn't be used for that, it should only
be used for files that we have no reason to believe are invalid but that
have a version number we don't know about or some other
non-link-layer-encapsulation-type value we don't know about.

------------------------------------------------------------------------
r40174 | guy | 2011-12-12 22:45:16 -0800 (Mon, 12 Dec 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/netmon.c

Crank up the maximum frame table size to 512*2^20 packets, that being a
small amount bigger than the maximum possible number of packets in a
NetMon file.

------------------------------------------------------------------------
r40173 | wmeier | 2011-12-12 20:01:33 -0800 (Mon, 12 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bmc.c
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-opensafety.c
   M /trunk/epan/dissectors/packet-rlc.c
   M /trunk/epan/dissectors/packet-smb.c

Use tvb_new_child_real_data() instead of tvb_new_real_data() + tvb_set_child_real_data_tvbuff().

------------------------------------------------------------------------
r40172 | cmaynard | 2011-12-12 19:17:49 -0800 (Mon, 12 Dec 2011) | 2 lines
Changed paths:
   M /trunk/tshark.c

Add the -H and -W options to the "tshark -h" output.  Ref: http://www.wireshark.org/lists/wireshark-users/201112/msg00044.html

------------------------------------------------------------------------
r40171 | wmeier | 2011-12-12 18:56:44 -0800 (Mon, 12 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-ipsec.c
   M /trunk/epan/dissectors/packet-ldss.c
   M /trunk/epan/dissectors/packet-spice.c

Prevent memory leakage of uncompress tvb and associated data buffer (step 1).
(tvb memory leak will actually remain until a bug in tvbuff.c is also fixed).

------------------------------------------------------------------------
r40170 | guy | 2011-12-12 18:42:42 -0800 (Mon, 12 Dec 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/airopeek9.c
   M /trunk/wiretap/nettl.c
   M /trunk/wiretap/packetlogger.c

Add missing checks for a too-large packet, so we don't blow up trying to
allocate a huge buffer.

------------------------------------------------------------------------
r40169 | guy | 2011-12-12 18:00:41 -0800 (Mon, 12 Dec 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/lanalyzer.c

Check for a bogus record size.  Fixes bug 6670.

------------------------------------------------------------------------
r40168 | guy | 2011-12-12 17:49:27 -0800 (Mon, 12 Dec 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/netmon.c

Add an arbitrary limit on the maximum size of the frame table, so that
we don't crash.  Fixes bug 6669.

------------------------------------------------------------------------
r40167 | guy | 2011-12-12 17:24:12 -0800 (Mon, 12 Dec 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/iptrace.c

Add missing checks for a too-large packet, so we don't blow up trying to
allocate a huge buffer; fixes bug 6668.

Also add some other checks for invalid records.

------------------------------------------------------------------------
r40166 | guy | 2011-12-12 17:05:52 -0800 (Mon, 12 Dec 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/i4btrace.c

Add missing check for a too-large packet, so we don't blow up trying to
allocate a huge buffer; fixes bug 6667.

------------------------------------------------------------------------
r40165 | guy | 2011-12-12 16:57:09 -0800 (Mon, 12 Dec 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/5views.c

Add missing check for a too-large packet, so we don't blow up trying to
allocate a huge buffer; fixes bug 6666.

------------------------------------------------------------------------
r40164 | guy | 2011-12-12 16:44:22 -0800 (Mon, 12 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/packet.c

Clamp the reported length of a packet at G_MAXINT for now, to avoid
crashes due to having no tvbuffs for an epan_dissect_t.

Fixes bug 6663 and its soon-to-be-duplicates.

------------------------------------------------------------------------
r40163 | wmeier | 2011-12-12 16:02:30 -0800 (Mon, 12 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcp-etsi.c

Fix a memory leak of a tvb.

------------------------------------------------------------------------
r40162 | cmaynard | 2011-12-12 11:24:49 -0800 (Mon, 12 Dec 2011) | 2 lines
Changed paths:
   M /trunk/print.c

Add missing </field> for data tree.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3809

------------------------------------------------------------------------
r40161 | cmaynard | 2011-12-12 10:35:49 -0800 (Mon, 12 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mp2t.c
   M /trunk/print.c

Fix incorrect "pos=0" pdml values.  Resolves the issue reported in comment 4 of https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=2432 and closes the bug.

------------------------------------------------------------------------
r40160 | etxrab | 2011-12-12 09:42:24 -0800 (Mon, 12 Dec 2011) | 4 lines
Changed paths:
   M /trunk/diameter/Cisco.xml

From Asmita:
Update to csg2 r7

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6661
------------------------------------------------------------------------
r40159 | jake | 2011-12-12 00:18:18 -0800 (Mon, 12 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

From Roy Marples:
ICMPv6 DNSSL option can contain padding, which does not represent a malformed option.

------------------------------------------------------------------------
r40158 | jake | 2011-12-11 23:56:45 -0800 (Sun, 11 Dec 2011) | 3 lines
Changed paths:
   M /trunk/tools/win-setup.sh

Allow for true error reporing.
Move the comment to where it's intended.

------------------------------------------------------------------------
r40157 | etxrab | 2011-12-11 23:24:57 -0800 (Sun, 11 Dec 2011) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Mike Morrin:
eliminates the global variable for tracking which nibble is
to be decoded by taking advantage of the fact that half octet IEs always occur
in pairs, and thus a pair can be grouped together for decoding.

There was probably also some confusion caused by the macros UPPER_NIBBLE and
LOWER_NIBBLE because the GSM bit numbering is opposite to Wireshark internal
numbering, so I have changed these to be LEFT_NIBBLE and RIGHT_NIBBLE, which
corresponds to the display format in Wireshark.

The dissection order of half octet IEs has been adjusted where necessary to
align with the ordering shown in the GSM specifications.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6658
------------------------------------------------------------------------
r40156 | etxrab | 2011-12-11 22:58:37 -0800 (Sun, 11 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rohc.c

- Change the tree layout to mimic packet-pdcp-lte.c
- Add IPv6 static chain dissectoin
- Part of IPv6 dynamic chain dissectoin
------------------------------------------------------------------------
r40155 | cmaynard | 2011-12-11 16:35:51 -0800 (Sun, 11 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/export_object.c

Well, until someone has the time to write ct2ext(), just return the content type, which is better than nothing.

------------------------------------------------------------------------
r40154 | cmaynard | 2011-12-11 16:27:32 -0800 (Sun, 11 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/export_object.c

If no filename, include the packet number in the generic name.  TODO: Implement the ct2ext() function.

------------------------------------------------------------------------
r40153 | cmaynard | 2011-12-11 15:43:03 -0800 (Sun, 11 Dec 2011) | 2 lines
Changed paths:
   M /trunk/gtk/export_object.c

If the object to export doesn't have a filename, use a generic "object" name instead.  This fixes the crash reported in https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6250

------------------------------------------------------------------------
r40150 | gerald | 2011-12-11 07:03:25 -0800 (Sun, 11 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-12-11]
------------------------------------------------------------------------
r40149 | etxrab | 2011-12-10 05:18:45 -0800 (Sat, 10 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Fix a couple of warnings.
------------------------------------------------------------------------
r40148 | etxrab | 2011-12-10 05:09:17 -0800 (Sat, 10 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

607: warning: unused variable 'd'
------------------------------------------------------------------------
r40147 | etxrab | 2011-12-10 04:50:05 -0800 (Sat, 10 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-rohc.h

Dissect the whole IR dyn packet in packet-rohc.c
------------------------------------------------------------------------
r40146 | sake | 2011-12-10 04:28:28 -0800 (Sat, 10 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

If we know there is a FCS present, don't hand it to the ethernet trailer dissectors, but dissect it on return


------------------------------------------------------------------------
r40145 | tuexen | 2011-12-10 01:48:59 -0800 (Sat, 10 Dec 2011) | 2 lines
Changed paths:
   M /trunk/macosx-setup.sh
   M /trunk/macosx-support-lib-patches/glib-pkgconfig.patch

Update some support libs to newer version.

------------------------------------------------------------------------
r40144 | tuexen | 2011-12-10 01:46:17 -0800 (Sat, 10 Dec 2011) | 2 lines
Changed paths:
   M /trunk

Ignore macosx-support-libs.

------------------------------------------------------------------------
r40143 | guy | 2011-12-09 21:33:48 -0800 (Fri, 09 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

Clarify some stuff in a comment.

Don't call any of the heuristic trailer dissectors if there's no trailer
to dissect.

------------------------------------------------------------------------
r40142 | guy | 2011-12-09 21:29:09 -0800 (Fri, 09 Dec 2011) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-vssmonitoring.c

Clean up indentation.

Do more length checks, so we reject trailers that have nothing to
dissect.

Test for the trailer length being >= 8, rather than for having the 0x08
bit set (they amount to the same thing, as the trailer length is <= 14,
and >= 8 is what we really want if we're checking whether there's a
timestamp).

------------------------------------------------------------------------
r40141 | jake | 2011-12-09 15:14:14 -0800 (Fri, 09 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-iax2.h
   M /trunk/epan/iax2_codec_type.h

From Tilghman Lesher:
Some commands and IEs from the current release of Asterisk are missing from the
IAX protocol dissector.  This patch provides them.

------------------------------------------------------------------------
r40140 | jake | 2011-12-09 14:56:25 -0800 (Fri, 09 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c

From Thomas Dreibholz:
ASCONF and ASCONF_ACK chunks have a "Sequence Number" field (RFC 5061, 4.1.1
and 4.1.2). The dissector wrongly calls it "Serial number". The attached patch
fixes this issue. 

------------------------------------------------------------------------
r40139 | jake | 2011-12-09 14:05:04 -0800 (Fri, 09 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-clv.h
   M /trunk/epan/dissectors/packet-isis-lsp.c

From Nikitha Malgi:
Implementing extensions to Wireshark to support TRILL payloads.

------------------------------------------------------------------------
r40138 | guy | 2011-12-09 13:15:48 -0800 (Fri, 09 Dec 2011) | 7 lines
Changed paths:
   M /trunk/acinclude.m4
   M /trunk/capture-pcap-util-unix.c

Referring to pcap_version[] doesn't do what you want on at least some
UN*Xes (Fedora 16 and probably other Linux distributions, probably at
least some if not all other ELF-based systems, and perhaps also Mac OS
X), and causes problems if pcap_version[] has a different length in the
libpcap with which the executable was built and the libpcap with which
it's run, so we avoid using it for now.

------------------------------------------------------------------------
r40137 | guy | 2011-12-09 12:28:12 -0800 (Fri, 09 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

Get rid of unused variable.

Fix a comparison.

------------------------------------------------------------------------
r40136 | cmaynard | 2011-12-09 11:44:28 -0800 (Fri, 09 Dec 2011) | 2 lines
Changed paths:
   M /trunk/file.c
   M /trunk/print.c
   M /trunk/print.h

Export all data sources of a frame to a C array.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=4988

------------------------------------------------------------------------
r40135 | etxrab | 2011-12-09 10:58:26 -0800 (Fri, 09 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-rohc.h

Dissect the whole IR packet in packet-rohc.c
------------------------------------------------------------------------
r40134 | etxrab | 2011-12-09 10:55:45 -0800 (Fri, 09 Dec 2011) | 1 line
Changed paths:
   M /trunk/asn1/s1ap/S1AP-CommonDataTypes.asn
   M /trunk/asn1/s1ap/S1AP-Constants.asn
   M /trunk/asn1/s1ap/S1AP-Containers.asn
   M /trunk/asn1/s1ap/S1AP-IEs.asn
   M /trunk/asn1/s1ap/S1AP-PDU-Contents.asn
   M /trunk/asn1/s1ap/S1AP-PDU-Descriptions.asn
   M /trunk/asn1/s1ap/S1AP-SonTransfer-IEs.asn
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-s1ap.c

Update to 3GPP TS 36.413 V10.3.0 (2011-09)
------------------------------------------------------------------------
r40133 | alagoutte | 2011-12-09 09:00:28 -0800 (Fri, 09 Dec 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-zbee-zcl.c
   M /trunk/epan/dissectors/packet-zbee-zcl.h

From report of Arasch Honarbacht via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6649
ZigBee ZCL Dissector reports invalid status

The status code 0x8d contained in an attriute status record in a configure reporting response frame is incorrectly displayed as "Write only" (where WRITE_ONLY = 0x8f). According to the ZigBee Cluster Library Specification, Document 075123r03ZB, April 26, 2010 a status of 0x8d should display as "INVALID_DATA_TYPE"

From me :
Fix this issue (Wrong value define) based on Specs available in ZigBee.org

------------------------------------------------------------------------
r40132 | alagoutte | 2011-12-09 08:49:06 -0800 (Fri, 09 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From beelzebutt via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6597
Mesh Peering Management reason code field interpreted as status code

The Mesh Peering Management tag displays a status code instead of a reason code

------------------------------------------------------------------------
r40131 | alagoutte | 2011-12-09 08:39:18 -0800 (Fri, 09 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-elcom.c

From Juha Takala via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6654
ELCOM dissector needs small fixes for some protocol sub-field texts

------------------------------------------------------------------------
r40130 | jake | 2011-12-09 08:34:02 -0800 (Fri, 09 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

From astramax57:
After r38723, some BGP AS_PATH packets were no longer dissected.

------------------------------------------------------------------------
r40129 | grahamb | 2011-12-09 05:31:19 -0800 (Fri, 09 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dnp.c

Fixed wrong registration call causing compilation warnings.
------------------------------------------------------------------------
r40128 | grahamb | 2011-12-09 05:08:50 -0800 (Fri, 09 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dnp.c

Added dissector registration for udp messages to permit use with a USER_DLT as per request from Chris Bontje
------------------------------------------------------------------------
r40127 | grahamb | 2011-12-09 04:42:31 -0800 (Fri, 09 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dnp.c

Added definition and handling for IIN Function Code Not Implemented bit.
------------------------------------------------------------------------
r40126 | jake | 2011-12-09 00:41:38 -0800 (Fri, 09 Dec 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Johannes Berg
It's tedious to parse the blockack bitmap by hand, showing it in wireshark
directly is much nicer. Attached patch does so, only for compressed BA for now.

From me: made it filterable.

------------------------------------------------------------------------
r40125 | etxrab | 2011-12-08 22:16:07 -0800 (Thu, 08 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rohc.c

Use correct offset.
------------------------------------------------------------------------
r40124 | guy | 2011-12-08 19:00:56 -0800 (Thu, 08 Dec 2011) | 3 lines
Changed paths:
   M /trunk/asn1/s1ap/packet-s1ap-template.c
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-s1ap.c

Get rid of declarations of undefined routines and definitins of unused
routines.

------------------------------------------------------------------------
r40123 | guy | 2011-12-08 18:34:53 -0800 (Thu, 08 Dec 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pdcp-lte.h
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-rohc.h

Move the definition of enum rohc_mode into packet-rohc.h.

Have packet-pdcp-lte.h include packet-rohc.h to pick up that definition.

Get rid of now-no-longer-necessary includes.

------------------------------------------------------------------------
r40122 | guy | 2011-12-08 16:59:47 -0800 (Thu, 08 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rohc.c

packet-pdcp-lte.h defines "enum rohc_mode", and packet-rohc.h uses it,
so include packet-pdcp-lte.h first.

Get rid of extra definition of "enum rohc_mode".

------------------------------------------------------------------------
r40121 | guy | 2011-12-08 16:56:48 -0800 (Thu, 08 Dec 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rohc.h

packet-pdcp-lte.h defines "enum rohc_mode", and packet-rohc.h uses it,
so include packet-pdcp-lte.h first.

No extra tokens after #endif, please.

Fix indentation.

------------------------------------------------------------------------
r40120 | etxrab | 2011-12-08 13:45:35 -0800 (Thu, 08 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rohc.c
   A /trunk/epan/dissectors/packet-rohc.h

Start using functions from packet-rohc.c
------------------------------------------------------------------------
r40119 | etxrab | 2011-12-08 13:17:03 -0800 (Thu, 08 Dec 2011) | 1 line
Changed paths:
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/asn1/s1ap/packet-s1ap-template.c
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-bssgp.h
   M /trunk/epan/dissectors/packet-ranap.c
   M /trunk/epan/dissectors/packet-ranap.h
   M /trunk/epan/dissectors/packet-s1ap.c

Try to get the container stuff right...
------------------------------------------------------------------------
r40118 | etxrab | 2011-12-08 11:34:04 -0800 (Thu, 08 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

Use to display ESP SPI BASE_HEX_DEC as it is in decimal in SIP.
------------------------------------------------------------------------
r40117 | etxrab | 2011-12-08 11:32:51 -0800 (Thu, 08 Dec 2011) | 1 line
Changed paths:
   M /trunk/asn1/s1ap/packet-s1ap-template.c
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-s1ap.c

Properly dissect Source-ToTarget-TransparentContainer.
------------------------------------------------------------------------
r40116 | martinm | 2011-12-08 07:19:11 -0800 (Thu, 08 Dec 2011) | 2 lines
Changed paths:
   M /trunk/tap-expert.c

Store expert group value, fix output of each record.

------------------------------------------------------------------------
r40115 | martinm | 2011-12-08 03:15:31 -0800 (Thu, 08 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Skip correct number of bytes.

------------------------------------------------------------------------
r40114 | etxrab | 2011-12-07 11:04:13 -0800 (Wed, 07 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Add a dissector table for private extensions.
------------------------------------------------------------------------
r40113 | wmeier | 2011-12-07 06:47:27 -0800 (Wed, 07 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-vssmonitoring.c

Fix [-Wunused-but-set-variable] GCC warnings;
Remove some trailing blanks;
#include <stdio.h> not needed.

------------------------------------------------------------------------
r40112 | sake | 2011-12-07 05:53:14 -0800 (Wed, 07 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Don't keep out the cmake folks ;-)


------------------------------------------------------------------------
r40111 | martinm | 2011-12-07 04:19:59 -0800 (Wed, 07 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Fix for bug 6650: IP-ID is 2 bytes.
Note that I'm still aiming to change PDCP to use packet-rohc rather than its own, separate implementation...

------------------------------------------------------------------------
r40110 | etxrab | 2011-12-06 22:29:31 -0800 (Tue, 06 Dec 2011) | 1 line
Changed paths:
   M /trunk/asn1/gprscdr/GPRSChargingDataTypesV641.asn
   M /trunk/epan/dissectors/packet-gprscdr.c

RatingGroup -> RatingGroupId
------------------------------------------------------------------------
r40109 | sake | 2011-12-06 15:52:01 -0800 (Tue, 06 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-vssmonitoring.c

Make windows buildbots happy... 


------------------------------------------------------------------------
r40108 | sake | 2011-12-06 15:07:55 -0800 (Tue, 06 Dec 2011) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-eth.c
   A /trunk/epan/dissectors/packet-vssmonitoring.c

- Make a distinction between ethernet padding and an ethernet trailer
- ... and make that distinction configurable for capture files that do not have padding in small frames, but do have trailers
- Add VSS-Monitoring dissector to show by the TAP inserted time- and portstamps


------------------------------------------------------------------------
r40107 | etxrab | 2011-12-06 11:33:55 -0800 (Tue, 06 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-giop.c

Register giop by name (TCP).
------------------------------------------------------------------------
r40106 | etxrab | 2011-12-06 11:28:28 -0800 (Tue, 06 Dec 2011) | 4 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Enabling crosshairs on TCP stream graph paints the screen.
Move the problem to GTK3+

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6646
------------------------------------------------------------------------
r40105 | etxrab | 2011-12-06 11:16:10 -0800 (Tue, 06 Dec 2011) | 1 line
Changed paths:
   A /trunk/asn1/gprscdr/GPRSChargingDataTypesV641.asn
   A /trunk/asn1/gprscdr/GenericChargingDataTypesV641.asn
   M /trunk/asn1/gprscdr/Makefile.common
   M /trunk/asn1/gprscdr/gprscdr.cnf
   M /trunk/asn1/gprscdr/packet-gprscdr-template.c
   M /trunk/epan/dissectors/packet-gprscdr.c
   M /trunk/epan/dissectors/packet-gprscdr.h

Update to 3GPP TS 32.298 V6.4.1 (2006-06)
------------------------------------------------------------------------
r40104 | etxrab | 2011-12-06 11:10:13 -0800 (Tue, 06 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-megaco.c

Accpet lover case Topology descriptor (tp) as we accept other tokens in lowercase.
------------------------------------------------------------------------
r40103 | etxrab | 2011-12-06 11:08:01 -0800 (Tue, 06 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-megaco.c

Fix length of Error parameter.
------------------------------------------------------------------------
r40102 | wmeier | 2011-12-06 08:15:24 -0800 (Tue, 06 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

#if 0 unused stuff ...

------------------------------------------------------------------------
r40101 | guy | 2011-12-05 23:13:40 -0800 (Mon, 05 Dec 2011) | 5 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

In capture_prep_monitor_changed_cb(), don't update the monitor mode
checkbox unless we're actually forcing it off.

Small indentation fix.

------------------------------------------------------------------------
r40100 | etxrab | 2011-12-05 23:07:19 -0800 (Mon, 05 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c
   M /trunk/epan/dissectors/packet-mpls-echo.c
   M /trunk/epan/dissectors/packet-mpls.c

One more contributor...
------------------------------------------------------------------------
r40098 | guy | 2011-12-05 20:00:39 -0800 (Mon, 05 Dec 2011) | 10 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

If capture_get_if_capabilities() fails, pop up a message, just as we
print a message in tshark.  That doesn't fix the problem seen on Linux
distributions, such as recent versions of Debian and derivatives, that
have libpcap 1.1.0 or later built without libnl, where the monitor mode
checkbox doesn't work - that's a libpcap bug, fixed in the 1.2 branch
and trunk, so a future 1.2.1 or 1.3.0 release should fix it, and perhaps
a future Debian release will build libpcap with libnl - but at least it
means you get a dialog box rather than just getting mysterious behavior
when you try to check the "monitor mode" checkbox.

------------------------------------------------------------------------
r40096 | etxrab | 2011-12-05 13:53:00 -0800 (Mon, 05 Dec 2011) | 1 line
Changed paths:
   M /trunk/asn1/gprscdr/gprscdr.cnf
   M /trunk/asn1/gprscdr/packet-gprscdr-template.c
   M /trunk/epan/dissectors/packet-gprscdr.c

Pretify TimeStamp and TimeZone
------------------------------------------------------------------------
r40095 | cmaynard | 2011-12-05 11:12:24 -0800 (Mon, 05 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Explicitly display "Source or Destination Address/Host" like IPv4.

------------------------------------------------------------------------
r40094 | alagoutte | 2011-12-04 10:43:18 -0800 (Sun, 04 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40093 | alagoutte | 2011-12-04 10:43:05 -0800 (Sun, 04 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40092 | alagoutte | 2011-12-04 10:40:19 -0800 (Sun, 04 Dec 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-elcom.c

Enhance Elcom dissector
Fix indent and update modelines

------------------------------------------------------------------------
r40091 | alagoutte | 2011-12-04 10:19:18 -0800 (Sun, 04 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-elcom.c

Enhance Elcom dissector
Replace proto_tree_add_* by proto_tree_add_item
Replace switch/case by value_string

------------------------------------------------------------------------
r40088 | etxrab | 2011-12-04 07:21:22 -0800 (Sun, 04 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Vincent Helfre.
The offset in "Cell Selection Indicator after Release of all TCH and SDCCH" was not correct because the length was element was decoded twice.  So I removed the second decoding of the length.
------------------------------------------------------------------------
r40087 | gerald | 2011-12-04 07:03:28 -0800 (Sun, 04 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-12-04]
------------------------------------------------------------------------
r40086 | cmaynard | 2011-12-03 14:53:55 -0800 (Sat, 03 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-elcom.c

Fix 2 newly reported Coverity CID's 1331 & 1332: UNUSED_VALUE.

------------------------------------------------------------------------
r40085 | wmeier | 2011-12-03 14:08:28 -0800 (Sat, 03 Dec 2011) | 2 lines
Changed paths:
   M /trunk/docbook/wsug_src/WSUG_chapter_advanced.xml
   M /trunk/docbook/wsug_src/WSUG_chapter_use.xml

"Expert Info Composite" is now "Expert Info" (with the old "Expert Info" having been removed).

------------------------------------------------------------------------
r40084 | wmeier | 2011-12-03 11:59:48 -0800 (Sat, 03 Dec 2011) | 2 lines
Changed paths:
   M /trunk/docbook/Makefile.nmake

Do 'md wsluarm_src' only if dir doesn't alreay exist.

------------------------------------------------------------------------
r40083 | cmaynard | 2011-12-03 09:03:06 -0800 (Sat, 03 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Call tap_queue_packet() after pinfo data is updated.  Also, like IPv4, display next header field in decimal instead of hexadecimal (REF: http://www.iana.org/assignments/protocol-numbers/protocol-numbers.xml)

------------------------------------------------------------------------
r40082 | jake | 2011-12-03 05:35:06 -0800 (Sat, 03 Dec 2011) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bgp.h

From Michael Sakaluk:
This patch adds support to the BGP dissector for RFC 5512 and RFC 5640.

------------------------------------------------------------------------
r40081 | etxrab | 2011-12-03 04:11:01 -0800 (Sat, 03 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Handle 20 byte GTP' V0 header.
------------------------------------------------------------------------
r40080 | guy | 2011-12-02 23:16:56 -0800 (Fri, 02 Dec 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/snoop.c

Update some comments to reflect current reality (as in "a lot of stuff
is no longer available, but there's an IETF list of snoop datalink
types, at least").

------------------------------------------------------------------------
r40079 | cmaynard | 2011-12-02 22:10:37 -0800 (Fri, 02 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Fix bug with updating rr_offset before we're done fetching the matchedprefix and causing malformed packets, not to mention incorrect matchedprefixes to be displayed.  Some if() blocks need to execute regardless of whether tree is NULL or not.  Add some additional expert infos to report invalid matchlen values > 128 in violation of RFC 2894.  Fix hf_icmpv6_rr_rm_flag_reserved's bitmask from FFFD to FFFC and change order of flags displayed in tree so they appear from msb to lsb.  Lastl, fix a typo.

------------------------------------------------------------------------
r40078 | guy | 2011-12-02 20:33:05 -0800 (Fri, 02 Dec 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radiotap-iter.h

Bitfields indicate how many bits they are; "guint8 foo:4" is
self-contradictory (it's 4 bits, not 8).  Furthermore, the C language
doesn't support "unsigned char" as a bitfield type; some compilers might
accept that, but if you crank up the warning levels, even GCC will warn
about that.

------------------------------------------------------------------------
r40077 | cmaynard | 2011-12-02 20:32:08 -0800 (Fri, 02 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Some code needs to execute (potentially) whether the tree is NULL or not.  Also, changed "Left Segments" to read, "Segments Left" to better match RFC 2460 and RFC 3775 terminology.

------------------------------------------------------------------------
r40076 | cmaynard | 2011-12-02 20:07:20 -0800 (Fri, 02 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

If a type 2 Mobile IP routing header is present, only set pinfo->dst if seg_left is non-zero.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6560

------------------------------------------------------------------------
r40075 | guy | 2011-12-02 19:01:08 -0800 (Fri, 02 Dec 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

The TCP Packet Mood Option was a cute April 1 RFC, but TCP option 25 is
officially listed as "Unassigned", and people might use it for their own
purposes (and, in fact, one bug-submitter was doing so; they probably
should have used 253 or 254, but...).  Get rid of the code to dissect
it.

------------------------------------------------------------------------
r40074 | guy | 2011-12-02 18:59:43 -0800 (Fri, 02 Dec 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipoib.c

The cool kids say "dissector_add_uint()", not "dissector_add()", now.

------------------------------------------------------------------------
r40073 | jake | 2011-12-02 15:42:52 -0800 (Fri, 02 Dec 2011) | 7 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ospf.c

From Salil Kanitkar:
This patch covers following - 
i) Support for detecting OSPFv2 Opaque RI LSA. (RFC4970)
ii) Support for detecting OSPFv2 RI Capabilities TLV (RFC4970)
iii) Support for detecting OSPF Dynamic Hostname TLV (RFC5642)
iv) As per RFC4970, support for detecting RI LSA for OSPFv3 as well.

------------------------------------------------------------------------
r40072 | jake | 2011-12-02 14:23:07 -0800 (Fri, 02 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ipoib.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/snoop.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

from Petr Sumbera:
Solaris 11 snoop files with IP over Infiniband data are not recognized.
Attached patch allows to view such data.

------------------------------------------------------------------------
r40071 | etxrab | 2011-12-02 14:05:14 -0800 (Fri, 02 Dec 2011) | 6 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-elcom.c

From Juha Takala:
dissector for ELCOM communication protocol.  This protocol is
used mainly by power utilities, to exchange historical, cyclic, and event based
data between SCADA systems.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6616
------------------------------------------------------------------------
r40070 | etxrab | 2011-12-02 13:56:10 -0800 (Fri, 02 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

From Pascal Quantin:
Add S1 related info to the DRX parameter dissection (IE
common to 2G/3G/LTE) as specified in 3GPP 24.301 Release 9.8.0 chapter 10.5.5.6.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6642
------------------------------------------------------------------------
r40069 | etxrab | 2011-12-02 13:45:45 -0800 (Fri, 02 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Extend ULI dissection.
------------------------------------------------------------------------
r40068 | etxrab | 2011-12-01 21:46:11 -0800 (Thu, 01 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c
   M /trunk/epan/dissectors/packet-mpls-echo.c
   M /trunk/epan/dissectors/packet-mpls.c

Add a contributor.
------------------------------------------------------------------------
r40067 | martinm | 2011-12-01 15:17:17 -0800 (Thu, 01 Dec 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

From Pascal Quantin:

Show SDU lengths for UM PDUs.
Also, if the logged pduLength is < the real RLC PDU length, show that the length of the last segment is unknown.

------------------------------------------------------------------------
r40066 | etxrab | 2011-12-01 13:48:25 -0800 (Thu, 01 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Squelch a warning.
------------------------------------------------------------------------
r40065 | etxrab | 2011-12-01 13:26:22 -0800 (Thu, 01 Dec 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-gtpv2.c

Extend dissection of GTPv2 EPS Security Context and Quadruplets.
------------------------------------------------------------------------
r40064 | etxrab | 2011-12-01 12:09:01 -0800 (Thu, 01 Dec 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c

From Pascal Quantin:
updates the decoding of the Test Procedures functions
described in 3GPP 44.014, 34.109 and 36.509.
It also fixes a small issue where Wireshark was trying to decode the skip
indicator as a transaction identifier for those messages.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6638
------------------------------------------------------------------------
r40063 | jmayer | 2011-12-01 06:35:29 -0800 (Thu, 01 Dec 2011) | 7 lines
Changed paths:
   M /trunk/plugins/profinet/packet-pn-rt.c

Fix:

trunk/plugins/profinet/packet-pn-rt.c: In function ‘IsDFP_Frame’:
trunk/plugins/profinet/packet-pn-rt.c:182:9: error: ‘u8SFCycleCounter’ undeclared (first use in this function)
trunk/plugins/profinet/packet-pn-rt.c:182:9: note: each undeclared identifier is reported only once for each function it appears in


------------------------------------------------------------------------
r40062 | martinm | 2011-12-01 05:53:09 -0800 (Thu, 01 Dec 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

When have RLC PDUs that are truncated after headers:
- set extent of headers item properly
- show in the info column what the data would look like, based upon reported length and segment offsets

------------------------------------------------------------------------
r40061 | etxrab | 2011-11-30 22:35:02 -0800 (Wed, 30 Nov 2011) | 2 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

packet-dcerpc-pn-io.c:8735: warning: unused variable 'iSubFrameLen'
packet-dcerpc-pn-io.c:8734: warning: unused variable 'iTotalLen'
------------------------------------------------------------------------
r40060 | etxrab | 2011-11-30 22:33:14 -0800 (Wed, 30 Nov 2011) | 1 line
Changed paths:
   M /trunk/gtk/capture_file_dlg.c
   M /trunk/gtk/capture_if_dlg.c

Get rid of warnings.
------------------------------------------------------------------------
r40059 | etxrab | 2011-11-30 22:05:39 -0800 (Wed, 30 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cip.h
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-enip.h

From Michael Mann:
ENIP dissector - improved I/O connection dissection through "better conversation"

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6617
------------------------------------------------------------------------
r40058 | etxrab | 2011-11-30 21:58:55 -0800 (Wed, 30 Nov 2011) | 4 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c
   M /trunk/plugins/profinet/packet-pn-rt.c
   M /trunk/plugins/profinet/packet-pn.h

From Wido Kelling:
Enhancements to profinet decoding (IEC 61158) V2.3.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6605
------------------------------------------------------------------------
r40057 | etxrab | 2011-11-30 21:42:07 -0800 (Wed, 30 Nov 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

From Pascal Quantin:
adds to the Protocol Configuration Options the decoding of
the following container identifiers:
- Selected Bearer Control Mode
- DSMIPv6 Home Agent Address
- DSMIPv6 Home Network Prefix
- DSMIPv6 IPv4 Home Agent Address
- P-CSCF IPv4 Address
- DNS Server IPv4 Address

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6636
------------------------------------------------------------------------
r40056 | jmayer | 2011-11-30 18:31:47 -0800 (Wed, 30 Nov 2011) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt

Dafine G_DISABLE_SINGLE_INCLUDES while compiling. This mimics a patch
that has been in configure.in for quite some while.

------------------------------------------------------------------------
r40055 | etxrab | 2011-11-30 12:00:42 -0800 (Wed, 30 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c
   M /trunk/epan/dissectors/packet-mpls-echo.c
   M /trunk/epan/dissectors/packet-mpls.c

From Krishnamurthy Mayya:
Add Copyright.
------------------------------------------------------------------------
r40054 | etxrab | 2011-11-30 11:53:59 -0800 (Wed, 30 Nov 2011) | 1 line
Changed paths:
   M /trunk/gtk/about_dlg.c

Use gtk_box_new() if GTK3+
------------------------------------------------------------------------
r40053 | etxrab | 2011-11-30 11:48:17 -0800 (Wed, 30 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sua.c

Make it possible to add a subdissector for the info string.
------------------------------------------------------------------------
r40052 | martinm | 2011-11-30 08:36:54 -0800 (Wed, 30 Nov 2011) | 2 lines
Changed paths:
   M /trunk/tap-expert.c

Use g_ascii_strncasecmp() rather than strncasecmp().

------------------------------------------------------------------------
r40051 | cmaynard | 2011-11-30 07:55:53 -0800 (Wed, 30 Nov 2011) | 2 lines
Changed paths:
   M /trunk/doc/mergecap.pod
   M /trunk/mergecap.c

Hopefully clarify usage a bit to indicate multiple infile's can be specified to be merged.  Also, add GPL and copyright info.

------------------------------------------------------------------------
r40050 | martinm | 2011-11-30 07:45:20 -0800 (Wed, 30 Nov 2011) | 2 lines
Changed paths:
   M /trunk/doc/tshark.pod

Add missing comments in syntax description for -z expert

------------------------------------------------------------------------
r40049 | martinm | 2011-11-30 07:41:39 -0800 (Wed, 30 Nov 2011) | 2 lines
Changed paths:
   M /trunk/doc/tshark.pod
   M /trunk/tap-expert.c

Change the -z args for expert item.  You can now give the minimum severity level to report as well as a filter.  Also, now show duplicate reports only once, and give the frequency rather than the frame number.

------------------------------------------------------------------------
r40048 | cmaynard | 2011-11-30 07:28:58 -0800 (Wed, 30 Nov 2011) | 2 lines
Changed paths:
   M /trunk/mergecap.c

From Eugene Bogush: Initialize read_err to 0 so mergecap works again.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6623

------------------------------------------------------------------------
r40047 | martinm | 2011-11-30 01:47:10 -0800 (Wed, 30 Nov 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Extend coverage of #ifdef HAVE_PCAP_REMOTE to cover the static function insert_new_rows().

------------------------------------------------------------------------
r40046 | etxrab | 2011-11-29 22:58:44 -0800 (Tue, 29 Nov 2011) | 1 line
Changed paths:
   M /trunk/gtk/about_dlg.c
   M /trunk/gtk/capture_dlg.c

Get rid of warnings.
------------------------------------------------------------------------
r40045 | etxrab | 2011-11-29 14:32:31 -0800 (Tue, 29 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

From Pascal Quantin:
decoding of IPv6 Control Protocol embedded in PCO

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6629
------------------------------------------------------------------------
r40044 | etxrab | 2011-11-29 14:25:21 -0800 (Tue, 29 Nov 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

From Pascal Quantin:
Currently Wireshark limits the Access Point Name length to 50 bytes. But
according to 3GPP 24.008 chapter 10.5.6.1, the maximum length is 100 bytes (102
bytes minus the IEI and length fields) and not 50.
The attached patch increases the MAX_APN_LENGTH define value and allow the
correct display of an APN with a size greater than 50 bytes.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6628
------------------------------------------------------------------------
r40043 | guy | 2011-11-29 12:25:49 -0800 (Tue, 29 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Must include header files in a macro, so they get included in the
release tarball.

------------------------------------------------------------------------
r40042 | alagoutte | 2011-11-29 11:54:00 -0800 (Tue, 29 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-infiniband.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40041 | alagoutte | 2011-11-29 11:53:02 -0800 (Tue, 29 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

Fix some Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40040 | alagoutte | 2011-11-29 11:50:30 -0800 (Tue, 29 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-atm.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r40039 | alagoutte | 2011-11-29 11:46:12 -0800 (Tue, 29 Nov 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/greproto.h

ArubaOS 6.x use a new GRE ID (0x9000) for communication between controller and AP
Add this new ID in GRE dissector

The frame with the new GRE ID is not 802.11 frame such as 80XX GRE ID but a 802.3 frame with curious ethertype (8211 the same id with PAPI Protocol...)

------------------------------------------------------------------------
r40038 | alagoutte | 2011-11-29 11:36:53 -0800 (Tue, 29 Nov 2011) | 8 lines
Changed paths:
   M /trunk/plugins/giop/packet-coseventcomm.c
   M /trunk/plugins/giop/packet-cosnaming.c
   M /trunk/plugins/giop/packet-parlay.c
   M /trunk/plugins/giop/packet-tango.c
   M /trunk/tools/wireshark_gen.py

From c.David via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6527
corba dissector generator improvement 

Patch 2 : create a defaulf field hf_operationrequest which provides the requested operation on both the resquest and the reply messages.

From me : 
Regenerate GIOP Plugins

------------------------------------------------------------------------
r40037 | alagoutte | 2011-11-29 11:22:35 -0800 (Tue, 29 Nov 2011) | 8 lines
Changed paths:
   M /trunk/plugins/giop/packet-cosnaming.c
   M /trunk/plugins/giop/packet-parlay.c
   M /trunk/plugins/giop/packet-tango.c
   M /trunk/tools/wireshark_gen.py

From c.David via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6527
corba dissector generator improvement 

Patch 1 : field names is used in dissection instead of "enum value" which is not clear

From me : 
Regenerate GIOP Plugins

------------------------------------------------------------------------
r40036 | etxrab | 2011-11-29 09:46:38 -0800 (Tue, 29 Nov 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_proto_draw.c

Gtk3 package byte highlighter colour fix.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6624
------------------------------------------------------------------------
r40035 | etxrab | 2011-11-29 09:31:52 -0800 (Tue, 29 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-gtp.h

Update value strings.
------------------------------------------------------------------------
r40034 | martinm | 2011-11-29 06:42:22 -0800 (Tue, 29 Nov 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rlc_lte_stat_dlg.c

Add priority to the channel table.

------------------------------------------------------------------------
r40033 | etxrab | 2011-11-28 23:03:31 -0800 (Mon, 28 Nov 2011) | 33 lines
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/epan/dissectors/packet-gsm_map.c

Wireshark crashes in gsm_map dissector

For now use Jeff's fix:
"The REAL problem is that the GSM_MAP dissector is using this value_string_ext
in the hf without BASE_EXT_STRING:

    { &hf_gsm_old_localValue,
      { "localValue", "gsm_old.localValue",
        FT_INT32, BASE_DEC, &gsm_old_GSMMAPOperationLocalvalue_vals_ext, 0,
        "OperationLocalvalue", HFILL }},

This, in turn, appears to be caused because OperationLocalValue is an alias
for/of GSMMAPOperationLocalValue and only the latter is defined with
.USE_VALS_EXT.

I can fix it by doing:

Index: asn1/gsm_map/gsm_map.cnf
===================================================================
--- asn1/gsm_map/gsm_map.cnf    (revision 39628)
+++ asn1/gsm_map/gsm_map.cnf    (working copy)
@@ -54,6 +54,7 @@

 #.USE_VALS_EXT
 GSMMAPOperationLocalvalue
+OperationLocalvalue

 #.EXPORTS
 AddressString


But it seems to be that asn2wrs should arguably be figuring this out on its
own."
------------------------------------------------------------------------
r40032 | gerald | 2011-11-28 16:07:54 -0800 (Mon, 28 Nov 2011) | 2 lines
Changed paths:
   M /trunk/config.nmake

Allow for, but don't yet use, GTK+ 2.24.

------------------------------------------------------------------------
r40031 | martinm | 2011-11-28 10:33:58 -0800 (Mon, 28 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.h

Add newline at the end of the file.

------------------------------------------------------------------------
r40030 | etxrab | 2011-11-28 10:10:57 -0800 (Mon, 28 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-mpls.c

Fix Checkapi found errors.
------------------------------------------------------------------------
r40029 | etxrab | 2011-11-28 09:59:54 -0800 (Mon, 28 Nov 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c
   A /trunk/epan/dissectors/packet-bfd.h
   M /trunk/epan/dissectors/packet-mpls.c
   M /trunk/epan/dissectors/packet-mpls.h

From Krishnamurthy Mayya:

Part of patch:
2. BFD extension has been added as per RFC 6428, to decode the BFD packet with
ACH encapsulation(without IP/UDP header encapsulation). The channel type in ACH
header identifies the BFD payload as BFD CC or CV packet. Also decoding for
MPLS-TP source MEP-ID TLV in BFD CV packet has been added.

applied with a change to add packet-bfd.h

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6610#add_comment
------------------------------------------------------------------------
r40028 | etxrab | 2011-11-28 09:31:09 -0800 (Mon, 28 Nov 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls-echo.c

From Krishnamurthy Mayya:
LSP Ping extension has been added as per RFC 6426, to decode the LSP Ping
packet with ACH encapsulation(without IP/UDP header encapsulation). The channel
type in ACH header identifies the LSP Ping packet. Also support for decoding 
new TLVs and Sub-TLVs defined in the RFC 6426 has been provided.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6610#add_comment
------------------------------------------------------------------------
r40027 | etxrab | 2011-11-28 09:13:45 -0800 (Mon, 28 Nov 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c

From Krishnamurthy Mayya:
BFD extension has been added as per RFC 6428, to decode the BFD packet with
ACH encapsulation(without IP/UDP header encapsulation). The channel type in ACH
header identifies the BFD payload as BFD CC or CV packet. Also decoding for
MPLS-TP source MEP-ID TLV in BFD CV packet has been added.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6610#add_comment
------------------------------------------------------------------------
r40026 | etxrab | 2011-11-28 09:05:35 -0800 (Mon, 28 Nov 2011) | 11 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ldp.c
   M /trunk/epan/dissectors/packet-mpls.c
   M /trunk/epan/dissectors/packet-mpls.h

from Shobhank Sharma:

- Removed some mpls preferences which are no longer relevant/needed like 
  decode PWAC payloads as PPP traffic and assume all channel types except 0x21
are raw BFD. 
- MPLS extension from PW-ACH to MPLS Generic Associated Channel as per RFC 5586 
- Updated Pseudowire Associated Channel Types as per
http://www.iana.org/assignments/pwe3-parameters
- Updated the VCCV bitmaps as per RFC 5885

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6574
------------------------------------------------------------------------
r40025 | etxrab | 2011-11-28 08:42:43 -0800 (Mon, 28 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Squelsh warnings.
------------------------------------------------------------------------
r40024 | etxrab | 2011-11-28 08:41:59 -0800 (Mon, 28 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Prevet a crash when dissecting linked TI.
------------------------------------------------------------------------
r40023 | etxrab | 2011-11-28 08:40:29 -0800 (Mon, 28 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

let packet-gsm_a_gm.c dissect Protocol Configuration Options.
------------------------------------------------------------------------
r40022 | wmeier | 2011-11-28 08:23:55 -0800 (Mon, 28 Nov 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

Use __except(EXCEPTION_EXECUTE_HANDLER) rather than __except(TRUE);

 Strictly speaking, it appears that __except(EXCEPTION_EXECUTE_HANDLER)
 rather than __exept(TRUE) should be used altho in actuality there's
 no difference since TRUE (as defined by GLIB) == EXCEPTION_EXECUTE_HANDLER.


------------------------------------------------------------------------
r40021 | martinm | 2011-11-28 06:52:11 -0800 (Mon, 28 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-mac-lte.h

Allow configuration protocol to configure UL priority for channels in mapping.
This value then gets used in call_rlc_dissector().

------------------------------------------------------------------------
r40020 | wmeier | 2011-11-27 13:14:59 -0800 (Sun, 27 Nov 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Don't specify an hf[] item as using a range_string when it's really using a value_string.

Fixes Bug #6618

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6618

------------------------------------------------------------------------
r40019 | cmaynard | 2011-11-27 08:29:42 -0800 (Sun, 27 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-knet.c

Fix Coverity CID 1330, "Missing Break" by adding some /* FALLTHRU */'s.

------------------------------------------------------------------------
r40018 | cmaynard | 2011-11-27 08:17:22 -0800 (Sun, 27 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntp.c

Fix a typo.

------------------------------------------------------------------------
r40016 | wmeier | 2011-11-27 07:34:07 -0800 (Sun, 27 Nov 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hdfsdata.c
   M /trunk/epan/dissectors/packet-knet.c
   M /trunk/epan/dissectors/packet-mime-encap.c
   M /trunk/epan/dissectors/packet-opensafety.c
   M /trunk/epan/dissectors/packet-rdp.c
   M /trunk/epan/dissectors/packet-spice.c
   M /trunk/epan/dissectors/packet-ua.c

Various Minor cleanup:
- Remove unneeded #includes;
- Use val_to_str_const() in several places;
- Reformat long lines;
- Fix whitepace and indentation.

------------------------------------------------------------------------
r40014 | wmeier | 2011-11-27 07:30:29 -0800 (Sun, 27 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hdfs.c

Use preference port (not defined constant) when port against src port;
Remove unneeded #include.

------------------------------------------------------------------------
r40013 | gerald | 2011-11-27 07:03:25 -0800 (Sun, 27 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-11-27]
------------------------------------------------------------------------
r40011 | alagoutte | 2011-11-26 08:32:20 -0800 (Sat, 26 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-knet.c

Fix a wrong copy/paste....

------------------------------------------------------------------------
r40010 | alagoutte | 2011-11-26 08:23:37 -0800 (Sat, 26 Nov 2011) | 12 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-knet.c

From Kari Vatjus-Anttila  via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5956
kNet (KristalliNet) dissector for Wireshark

kNet is a connection-oriented network protocol for transmitting arbitrary application-specific messages between network hosts. It is designed primarily for applications that require a method for rapid space-efficient real-time communication. kNet is an application-level protocol which can be ran either over UDP, TCP or SCTP transports.

From me :
* Add Modelines information and fix trailing whitespace
* Merge packet-knet.h in packet-knet.c
* Make Checkhf happy
* Fix Clang/GCC Warning about unused variable
* Add Authors info & CMakeList.txt

------------------------------------------------------------------------
r40009 | jmayer | 2011-11-26 02:50:27 -0800 (Sat, 26 Nov 2011) | 2 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

There is now an early (source only) Win32 version of GTK3 available.

------------------------------------------------------------------------
r40008 | cmaynard | 2011-11-25 20:45:49 -0800 (Fri, 25 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Don't pass 'len' to the dissect routine since we know there's only 1 byte present.  This fixes the buildbot complaint about using 'len' uninitialized.

------------------------------------------------------------------------
r40007 | cmaynard | 2011-11-25 20:31:40 -0800 (Fri, 25 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Add a few casts to try to make the buildbots happy.

------------------------------------------------------------------------
r40006 | cmaynard | 2011-11-25 20:16:11 -0800 (Fri, 25 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

IP option improvements.  While fixing bug 6561, I noticed some deficiencies in the IP options dissection capabilities.  Testing of these changes primarily used the capture file attached to that bug report as there were several IP options present.  Packet 222 is an interesting packet that illustrates some of the new filters available.  Further work is needed, but hopefully this is a good first step.  Fuzz testing was performed using my own "menagerie".

------------------------------------------------------------------------
r40005 | wmeier | 2011-11-25 14:08:25 -0800 (Fri, 25 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee802154.c

Add missing '*/' to the end of a comment: Fixes gcc compile error.

------------------------------------------------------------------------
r40004 | wmeier | 2011-11-25 14:02:25 -0800 (Fri, 25 Nov 2011) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-ieee802154.h

From Ivan Lawrow: Added IEEE 802.15.4-2003 AES-CCM security modes

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=4912

------------------------------------------------------------------------
r40003 | sfisher | 2011-11-25 09:19:00 -0800 (Fri, 25 Nov 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-epm.c


Mark drep parameter as unused in the epm_dissect_tower_data function
since its use was removed in r40002.


------------------------------------------------------------------------
r40002 | wmeier | 2011-11-25 09:02:51 -0800 (Fri, 25 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-epm.c

From Wido Kelling: EPM tower UUID must be interpreted always as little endian.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6368

------------------------------------------------------------------------
r40001 | martinm | 2011-11-25 03:19:03 -0800 (Fri, 25 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-mac-lte.h

Add the reason for a UL ReTx (PDCCH retx grant or PHICH NACK).

------------------------------------------------------------------------
r40000 | alagoutte | 2011-11-25 02:41:11 -0800 (Fri, 25 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

Remove unused code (Add in Revision 836)
Fix also some Clang/GCC Warning about unused variable

------------------------------------------------------------------------
r39998 | kukosa | 2011-11-24 07:18:11 -0800 (Thu, 24 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/h245/h245.cnf
   M /trunk/asn1/h460/packet-h460-template.c
   M /trunk/epan/dissectors/packet-h245.c
   M /trunk/epan/dissectors/packet-h460.c

Fix H.460.18 and H.460.19 integration into H.245
------------------------------------------------------------------------
r39997 | martinm | 2011-11-24 04:44:11 -0800 (Thu, 24 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Only add the priority level if it is set inside valid range.

------------------------------------------------------------------------
r39996 | wmeier | 2011-11-23 19:33:29 -0800 (Wed, 23 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

Fix gcc compile error

------------------------------------------------------------------------
r39995 | wmeier | 2011-11-23 19:20:44 -0800 (Wed, 23 Nov 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

Use a GHashTable to store templates instead of
  using a home-grown hash table (which didn't handle collisions);
Include complete "connection info" (srcAddr,srcPort,dstAddr,dstPort) in "Template Name";
Rename various variables;
Re-indent & Re-format code.

------------------------------------------------------------------------
r39994 | cmaynard | 2011-11-23 10:33:45 -0800 (Wed, 23 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Display protocol ID consistently in decimal throughout.  Append each IP option to top-level Options field.  Whitespace cleanup - the majority of the dissector used 2-space indentation, so that's the format chosen.  Added modelines to match.


------------------------------------------------------------------------
r39992 | jake | 2011-11-22 13:51:24 -0800 (Tue, 22 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Move some comments around to make it more boilerplate like.

------------------------------------------------------------------------
r39991 | wmeier | 2011-11-22 12:48:49 -0800 (Tue, 22 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

Fix two compiler errors.

------------------------------------------------------------------------
r39990 | wmeier | 2011-11-22 12:42:25 -0800 (Tue, 22 Nov 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

Handle 2 issues related to cacheing templates:
 - Use a (slightly) less simplistic hashing algorithm to reduce collisions;
   Note: A GHashTable which handles collisions rather than
         a home-grown hash table (which does not) needs to be implemented.
 - Don't replace an existing template in the cache when a collision occurs;

Fixes Bug #6325
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6325

------------------------------------------------------------------------
r39989 | guy | 2011-11-22 11:07:49 -0800 (Tue, 22 Nov 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Show a "Capturing on ..." message similar to TShark.

------------------------------------------------------------------------
r39988 | martinm | 2011-11-22 09:57:25 -0800 (Tue, 22 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Add more packet highlights to the info column.

------------------------------------------------------------------------
r39987 | etxrab | 2011-11-22 09:44:50 -0800 (Tue, 22 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

Fix bugs related to Nounce IE dissection.
------------------------------------------------------------------------
r39986 | cmaynard | 2011-11-22 07:18:20 -0800 (Tue, 22 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

For now, display the protocol in hexadecimal again so displaying it in decimal doesn't get backported to the 1.6 and 1.4 trunks at the request of Joerg.

------------------------------------------------------------------------
r39985 | rbalint | 2011-11-22 05:53:17 -0800 (Tue, 22 Nov 2011) | 1 line
Changed paths:
   M /trunk/INSTALL
   M /trunk/Makefile.am
   M /trunk/configure.in
   M /trunk/debian/rules
   M /trunk/doc/Makefile.am

Unconditionally install idl2wrs
------------------------------------------------------------------------
r39984 | rbalint | 2011-11-22 05:53:06 -0800 (Tue, 22 Nov 2011) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/configure.in
   M /trunk/debian/rules
   M /trunk/tools/Makefile.am
   A /trunk/tools/idl2wrs (from /trunk/tools/idl2wrs.sh.in:39983)
   D /trunk/tools/idl2wrs.sh.in

hardcode /bin/sh to idl2wrs
------------------------------------------------------------------------
r39983 | guy | 2011-11-22 02:08:26 -0800 (Tue, 22 Nov 2011) | 10 lines
Changed paths:
   M /trunk/dumpcap.c

If we're not running as a child process, report the interfaces on which
we're capturing.  (We do not require a -i flag; the message could be
useful if you don't specify the interface, as it lets you know which
interface was chosen, which might not be the interface you'd think it
would be.  Yes, that's arguably a libpcap bug, which I plan to look at;
it should probably try to figure out which interfaces are "active" if
possible, and prefer those.)

Use cmdarg_err() for invalid capture filters and other capture errors.

------------------------------------------------------------------------
r39982 | rbalint | 2011-11-21 16:13:12 -0800 (Mon, 21 Nov 2011) | 1 line
Changed paths:
   A /trunk/.gitignore
   A /trunk/asn1/.gitignore
   A /trunk/doc/.gitignore

Add initial .gitignore files
------------------------------------------------------------------------
r39981 | rbalint | 2011-11-21 16:11:56 -0800 (Mon, 21 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.inc

Don't hardcode 'python' for asn2wrs
------------------------------------------------------------------------
r39980 | etxrab | 2011-11-21 12:08:11 -0800 (Mon, 21 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/tetra/packet-tetra-template.c
   M /trunk/epan/dissectors/packet-tetra.c

Get rid of Warnings.
------------------------------------------------------------------------
r39979 | etxrab | 2011-11-21 12:06:26 -0800 (Mon, 21 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rsvp.c

Typo
------------------------------------------------------------------------
r39978 | etxrab | 2011-11-21 12:04:45 -0800 (Mon, 21 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rsvp.c

Get rid of Warnings.
------------------------------------------------------------------------
r39977 | etxrab | 2011-11-21 10:21:59 -0800 (Mon, 21 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Get rid of Warnings.
------------------------------------------------------------------------
r39976 | etxrab | 2011-11-21 10:16:19 -0800 (Mon, 21 Nov 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Vincent Helfre:
added the display of intermediate value used to decode ARFCN in 
range 1024/256 format.
So now the W(n) values can be displayed and localised in the tvb buffer.
The code was reworked a little to use the get_bit functions.
------------------------------------------------------------------------
r39975 | wmeier | 2011-11-21 09:58:47 -0800 (Mon, 21 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

From Claudio: header value always computed twice

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6592

------------------------------------------------------------------------
r39974 | guy | 2011-11-21 09:49:27 -0800 (Mon, 21 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtn.c

An SDNV length > 8 is also not dissectable.  Should fix bug 6601.

------------------------------------------------------------------------
r39973 | wmeier | 2011-11-21 09:05:17 -0800 (Mon, 21 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

'dissect_ImageLZ_JPEG()' is apparently not used; #if 0 the code for now.

------------------------------------------------------------------------
r39972 | wmeier | 2011-11-21 08:43:01 -0800 (Mon, 21 Nov 2011) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

From Yaniv Kaul: Some enhancements, some fixes, to the Spice dissector:
- SASL authentication support - improved (and correct) state machine.
- indention, tab fixes
- macro to fetch PDU, simplifying the code (and improving its readability)
- properly show the length of agent messages and align them under the right tree.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6589

From me: Fix some indentation & remove some trailing whitespace.

------------------------------------------------------------------------
r39971 | martinm | 2011-11-21 08:18:33 -0800 (Mon, 21 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-mac-lte.h

Add the system frame number (SFN) to the context fields logged along with LTE MAC frames.

------------------------------------------------------------------------
r39970 | jmayer | 2011-11-21 07:39:25 -0800 (Mon, 21 Nov 2011) | 3 lines
Changed paths:
   M /trunk/cmake/modules/FindGTK3.cmake

Linking against GTK3 stoped working because only libgtk3 was linked
against and no libs that gtk3 depended on. Fix this.

------------------------------------------------------------------------
r39969 | jmayer | 2011-11-21 07:03:17 -0800 (Mon, 21 Nov 2011) | 2 lines
Changed paths:
   M /trunk/gtk/prefs_filter_expressions.c
   M /trunk/gtk/time_shift_dlg.c

More warnings "set but not used" fixed

------------------------------------------------------------------------
r39968 | jmayer | 2011-11-21 05:52:35 -0800 (Mon, 21 Nov 2011) | 26 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/dcerpc/CMakeLists.txt

Move generated dissctors that are causing problems to DIRTY.

packet-x11.c: hundreds of:

/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/x11-extension-implementation.h: In function ‘xselinuxGetClientContext’:
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/x11-extension-implementation.h:27994:9: warning: variable ‘f_resource’ set but not used [-Wunused-but-set-variable]
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/x11-extension-implementation.h: In function ‘xselinuxGetClientContext_Reply’:

dissectors/packet-dcerpc-mapi.c: set but not used
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c: In function ‘mapi_dissect_struct_Release_req’:
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c:8592:14: warning: variable ‘tree’ set but not used [-Wunused-but-set-variable]
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c: In function ‘mapi_dissect_struct_Release_repl’:
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c:8617:14: warning: variable ‘tree’ set but not used [-Wunused-but-set-variable]
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c: In function ‘mapi_dissect_struct_RecipSMTP’:
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c:8848:14: warning: variable ‘tree’ set but not used [-Wunused-but-set-variable]


dissecots/packet-dcerpc-drsuapi.c: set but not used
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-drsuapi.c: In function ‘drsuapi_dissect_DsGetNCChangesCtr7’:
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-drsuapi.c:2920:17: warning: variable ‘tree’ set but not used [-Wunused-but-set-variable]

Btw.: Does it really make sense to use an extra CMakefile for the dcerpc/ dir?
      I'd rather the the idl2wrs.c in tools/ and the generatorstuff in epan/CMake

More files with the same problem.

------------------------------------------------------------------------
r39967 | jmayer | 2011-11-21 04:13:36 -0800 (Mon, 21 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

Another case of written to only variable.

------------------------------------------------------------------------
r39966 | jmayer | 2011-11-21 04:11:35 -0800 (Mon, 21 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dec-dnart.c

new_offset was was written to but never read.

------------------------------------------------------------------------
r39965 | jmayer | 2011-11-21 04:08:10 -0800 (Mon, 21 Nov 2011) | 11 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Move a generated file into file lists that do not treat warnings
as errors:

/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c: In function ‘mapi_dissect_struct_Release_req’:
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c:8592:14: error: variable ‘tree’ set but not used [-Werror=unused-but-set-variable]
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c: In function ‘mapi_dissect_struct_Release_repl’:
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c:8617:14: error: variable ‘tree’ set but not used [-Werror=unused-but-set-variable]
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c: In function ‘mapi_dissect_struct_RecipSMTP’:
/home/jmayer/work/wireshark/svn/trunk/epan/dissectors/packet-dcerpc-mapi.c:8848:14: error: variable ‘tree’ set but not used [-Werror=unused-but-set-variable]


------------------------------------------------------------------------
r39964 | guy | 2011-11-20 22:26:03 -0800 (Sun, 20 Nov 2011) | 6 lines
Changed paths:
   M /trunk/file.c
   M /trunk/merge.c
   M /trunk/mergecap.c

On an I/O error, merge_read_packet() and merge_append_read_packet() need
to return a pointer to the merge_in_file_t that got the error.  Set *err
to 0 on success and an error code on an err, treat a null return as an
EOF indication, and if we don't get a null return check for a non-zero
error code and treat that as an I/O error.

------------------------------------------------------------------------
r39963 | cmaynard | 2011-11-20 18:01:59 -0800 (Sun, 20 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Fix potential infinite loop introduced with r39961 and find by the buildbot.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6599

------------------------------------------------------------------------
r39961 | cmaynard | 2011-11-20 07:47:14 -0800 (Sun, 20 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Fix bug 6561: IPv4 UDP/TCP Checksum incorrect if routing header present.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6561

------------------------------------------------------------------------
r39959 | cmaynard | 2011-11-20 07:11:15 -0800 (Sun, 20 Nov 2011) | 2 lines
Changed paths:
   M /trunk/file.c

Fix "'Closing File!' Dialog Hangs" bug 3046: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3046

------------------------------------------------------------------------
r39958 | gerald | 2011-11-20 07:03:25 -0800 (Sun, 20 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-11-20]
------------------------------------------------------------------------
r39957 | etxrab | 2011-11-20 04:43:04 -0800 (Sun, 20 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-amqp.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-dns.h
   M /trunk/epan/dissectors/packet-per.h
   M /trunk/epan/dissectors/packet-t125.c
   M /trunk/epan/emem.h

Get rid of Warnings.
------------------------------------------------------------------------
r39956 | etxrab | 2011-11-20 02:27:26 -0800 (Sun, 20 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/tetra/packet-tetra-template.c
   M /trunk/asn1/tetra/packet-tetra-template.h
   M /trunk/asn1/tetra/tetra.cnf
   M /trunk/epan/dissectors/packet-tetra.c
   M /trunk/epan/dissectors/packet-tetra.h

Remove export.
------------------------------------------------------------------------
r39955 | etxrab | 2011-11-20 01:51:03 -0800 (Sun, 20 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/tetra/packet-tetra-template.c
   M /trunk/epan/dissectors/packet-tetra.c

See if this fixes it, why it worked on my system is anybodys guess.
------------------------------------------------------------------------
r39954 | etxrab | 2011-11-20 00:59:19 -0800 (Sun, 20 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/ldap/ldap.cnf
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/asn1/pkcs12/packet-pkcs12-template.c
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/asn1/t125/packet-t125-template.c
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/asn1/tcap/tcap.cnf
   M /trunk/asn1/tetra/packet-tetra-template.h
   M /trunk/epan/dissectors/packet-amqp.c
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-pkcs12.c
   M /trunk/epan/dissectors/packet-sgsap.c
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/dissectors/packet-snmp.c
   M /trunk/epan/dissectors/packet-tcap.c
   M /trunk/epan/dissectors/packet-tetra.h

Get rid of Warnings.
------------------------------------------------------------------------
r39953 | guy | 2011-11-19 19:15:53 -0800 (Sat, 19 Nov 2011) | 2 lines
Changed paths:
   M /trunk/macosx-setup.sh

Expand a comment.

------------------------------------------------------------------------
r39952 | guy | 2011-11-19 14:57:13 -0800 (Sat, 19 Nov 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

The URI parameter parser always has to advance current_offset in the
loop, otherwise you get stuck in an infinite loop.

(Where in RFC 3261 does it mention the use of commas in URI parameters?)

Should fix bug 6598.

------------------------------------------------------------------------
r39951 | etxrab | 2011-11-19 14:42:51 -0800 (Sat, 19 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/asn1/ansi_tcap/packet-ansi_tcap-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c

Get rid of Warnings.
------------------------------------------------------------------------
r39950 | guy | 2011-11-19 12:49:15 -0800 (Sat, 19 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Clean up indentation.

------------------------------------------------------------------------
r39949 | guy | 2011-11-19 12:18:01 -0800 (Sat, 19 Nov 2011) | 20 lines
Changed paths:
   M /trunk/alert_box.c
   M /trunk/editcap.c
   M /trunk/epan/filesystem.c
   M /trunk/file.c
   M /trunk/merge.c
   M /trunk/merge.h
   M /trunk/mergecap.c
   M /trunk/tshark.c

When reporting "sorry, *this* packet can't be written to a file of that
type" when writing out a capture file (i.e., writing a
per-packet-encapsulation capture to a file type that supports it but
doesn't support one of the packet's encapsulations), report the packet
number and, when doing this in a merge operation, report the file from
which it came.

When reporting "sorry, that file can't be written to a file of that
type, period", show the file type rather than the input file link-layer
type that causes the problem.  (We could show both.  We could be
*really* ambitious and iterate through all possible file types and show
the ones that will or at least might work....)

file_write_error_message() is documented as handling only UNIX-style
errnos, and libwireshark should be usable without libwiretap, so leave
it up to its callers to handle Wiretap errors such as
WTAP_ERR_SHORT_WRITE.

Clean up indentation.

------------------------------------------------------------------------
r39948 | etxrab | 2011-11-19 09:21:35 -0800 (Sat, 19 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ansi_tcap.c
   M /trunk/epan/dissectors/packet-sip.c

Fix Warnings.
------------------------------------------------------------------------
r39947 | etxrab | 2011-11-19 08:24:19 -0800 (Sat, 19 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rdp.c

Revert 39946
------------------------------------------------------------------------
r39946 | etxrab | 2011-11-19 08:15:07 -0800 (Sat, 19 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rdp.c

See if this fixes "warning: initializer element is not computable at load time"
------------------------------------------------------------------------
r39945 | etxrab | 2011-11-19 01:08:50 -0800 (Sat, 19 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ber.h

Get rod of " warning: identifier ‘class’ conflicts with C++ keyword"
------------------------------------------------------------------------
r39944 | guy | 2011-11-18 13:39:18 -0800 (Fri, 18 Nov 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/k12text.l

Fail if somebody tries to write out a packet with an unsupported
encapsulation.

------------------------------------------------------------------------
r39938 | gerald | 2011-11-18 08:51:40 -0800 (Fri, 18 Nov 2011) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Try to preserve native line endings when we rewrite files.

------------------------------------------------------------------------
r39937 | martinm | 2011-11-18 05:42:55 -0800 (Fri, 18 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

From Pascal Quantin:
For status Bitmap, don't show FSN in the info column twice.

------------------------------------------------------------------------
r39936 | martinm | 2011-11-18 04:45:50 -0800 (Fri, 18 Nov 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Make it easier to see:
- bitmap entries
- MRW and MRW-ACK
- RESET and RESET-ACK
- when the Poll bit is set for data

------------------------------------------------------------------------
r39935 | alagoutte | 2011-11-18 04:41:48 -0800 (Fri, 18 Nov 2011) | 2 lines
Changed paths:
   M /trunk/idl/parlay/README.parlay

Ethereal => Wireshark

------------------------------------------------------------------------
r39934 | alagoutte | 2011-11-18 04:39:35 -0800 (Fri, 18 Nov 2011) | 2 lines
Changed paths:
   M /trunk/plugins/giop/packet-coseventcomm.c
   M /trunk/plugins/giop/packet-cosnaming.c
   M /trunk/plugins/giop/packet-parlay.c
   M /trunk/plugins/giop/packet-tango.c

Regenerate GIOP dissector plugins (after change in generator !) for fix Warning found by Clang (>100 !)

------------------------------------------------------------------------
r39933 | alagoutte | 2011-11-18 04:37:33 -0800 (Fri, 18 Nov 2011) | 2 lines
Changed paths:
   M /trunk/tools/wireshark_gen.py

Fix major (> 100) Dead Store (Dead assignement/Dead increment) Warning found by Clang in IDL "generator" of GIOP Plugins

------------------------------------------------------------------------
r39932 | alagoutte | 2011-11-18 04:34:16 -0800 (Fri, 18 Nov 2011) | 9 lines
Changed paths:
   M /trunk/plugins/giop/packet-cosnaming.c
   M /trunk/plugins/giop/packet-parlay.c

Regenerate GIOP dissector plugins (after change in generator !) with following commmands :
:~/wireshark/tools$ ../idl2wrs ../idl/cosnaming.idl > ../plugins/giop/packet-cosnaming.c
:~/wireshark/tools$ ../idl2wrs ../idl/coseventcomm.idl > ../plugins/giop/packet-coseventcomm.c
:~/wireshark/tools$ ../idl2wrs ../idl/parlay/Parlay.idl > ../plugins/giop/packet-parlay.c
:~/wireshark/tools$ ../idl2wrs ../idl/tango.idl > ../plugins/giop/packet-tango.c 

For packet-cosnaming.c, only some white return change
For packet-parley.c, lot of change but only the functions is not in the same order...?! (Order change in 17911)

------------------------------------------------------------------------
r39931 | alagoutte | 2011-11-18 02:30:46 -0800 (Fri, 18 Nov 2011) | 7 lines
Changed paths:
   M /trunk/tools/wireshark_gen.py

Some modification in generated GIOP dissector plugins in not include in "generator" (wireshark_gen.py)
* Remove some uneeded #includes (Revision 32419)
* Don't guard col_set_str (COL_PROTOCOL) with col_check (Revision 29340)
* Add missing #pragma warning disable, now using _MSC_VER (Revision 21222, 21227, 21240)



------------------------------------------------------------------------
r39930 | guy | 2011-11-17 23:13:33 -0800 (Thu, 17 Nov 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Make sure pcap-ng supports a particular encapsulation type before
trying to write out an interface description block for an interface with
that type.

------------------------------------------------------------------------
r39929 | etxrab | 2011-11-17 23:01:10 -0800 (Thu, 17 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c

Use tvb_bcd_dig_to_ep_str().
------------------------------------------------------------------------
r39926 | gerald | 2011-11-17 17:35:58 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Use the source directory argument.

------------------------------------------------------------------------
r39923 | gerald | 2011-11-17 17:17:31 -0800 (Thu, 17 Nov 2011) | 4 lines
Changed paths:
   M /trunk/make-version.pl

Maybe it's not a good idea to modify configure.in or config.nmake during
compilation. Add a "--set-svn" option which only affects svnversion.h and
make it the default behavior.

------------------------------------------------------------------------
r39922 | cmaynard | 2011-11-17 17:08:20 -0800 (Thu, 17 Nov 2011) | 7 lines
Changed paths:
   M /trunk/plugins/Makefile.nmake

Append a path-separator to the plugins directory so xcopy doesn't get confused as to whether it's copying each plugin to a file or a directory.  I.e., hopefully to avoid this situation:

Does wireshark-gtk2\plugins\1.7.1-SVN-39918 specify a file name
or directory name on the target
(F = file, D = directory)?


------------------------------------------------------------------------
r39921 | gerald | 2011-11-17 16:33:14 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Don't clobber release information in configure.in.

------------------------------------------------------------------------
r39918 | wmeier | 2011-11-17 13:58:09 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c

Use extended value strings.

------------------------------------------------------------------------
r39916 | wmeier | 2011-11-17 12:51:07 -0800 (Thu, 17 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c

Remove some unneeded #includes;
Move proto_reg_handoff...() to the end of the file as per convention;
Do some whitespace cleanup.

------------------------------------------------------------------------
r39915 | guy | 2011-11-17 12:17:36 -0800 (Thu, 17 Nov 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/netmon.c

Add checks to make sure we don't overflow the maximum 32-bit file
offset.

------------------------------------------------------------------------
r39913 | gerald | 2011-11-17 12:09:07 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Update some comments.

------------------------------------------------------------------------
r39912 | etxrab | 2011-11-17 12:05:03 -0800 (Thu, 17 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/ansi_tcap/packet-ansi_tcap-template.c
   M /trunk/epan/dissectors/packet-ansi_tcap.c

Add a dissector table for National operation codes.
------------------------------------------------------------------------
r39911 | etxrab | 2011-11-17 12:03:36 -0800 (Thu, 17 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

Fix "With the current changes NAS messages with the "null ciphering algorithm" EEA0 are not handled."

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6348
------------------------------------------------------------------------
r39910 | gerald | 2011-11-17 11:41:36 -0800 (Thu, 17 Nov 2011) | 16 lines
Changed paths:
   M /trunk/Makefile.nmake

From Pascal Quantin via bug 6593:

With Subversion 1.7, the working copy metada storage as changed (see
http://subversion.apache.org/docs/release-notes/1.7.html#wc-ng for details).
As a consequence, the file .svn/entries is no more updated and under Windows
the svnversion.h is no more regenerated (unless explicitely removed).
The attached patch fixes this issue so as to also check the .svn/wc.db file
date in the makefile rule.

Note that wc.db file must be checked before entries file as an upgrade of an
existing repository from subversion 1.6 to 1.7 leave an old entries file around
(that is no more updated).

In Makefile.am file, the svnversion.h file generation seems to be
systematically forced. So I guess Linux/Mac boxes are not impacted.

------------------------------------------------------------------------
r39909 | wmeier | 2011-11-17 09:36:29 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.h

(Trivial) remove an extra blank line.

------------------------------------------------------------------------
r39908 | gerald | 2011-11-17 09:15:51 -0800 (Thu, 17 Nov 2011) | 3 lines
Changed paths:
   M /trunk/make-version.pl

Make sure we terminate WiresharkCurrentVersion so we won't have to
reapply r39907.

------------------------------------------------------------------------
r39907 | cmaynard | 2011-11-17 09:12:42 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Terminate WiresharkCurrentVersion to keep the buildbots happy.  Also, since some changes were already committed to change the "Save As" behavior, add a blurb about it.  Unfortunately this was not mentioned for 1.7.0.  See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6192

------------------------------------------------------------------------
r39906 | martinm | 2011-11-17 08:47:22 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Make it easier to see RLIST details.

------------------------------------------------------------------------
r39905 | wmeier | 2011-11-17 08:42:18 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c

Undo some incorrect (but benign) FALSE->ENC_BIG_ENDIAN conversions done in SVN 37080.

------------------------------------------------------------------------
r39904 | cmaynard | 2011-11-17 08:21:54 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11-keysym.h

Add missing copyright and license.

------------------------------------------------------------------------
r39903 | cmaynard | 2011-11-17 08:10:02 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

distribute -> redistribute.

------------------------------------------------------------------------
r39902 | cmaynard | 2011-11-17 07:57:44 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.c

Fix crash caused by trying to apply a field of type BASE_CUSTOM as a column.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6503.

------------------------------------------------------------------------
r39901 | martinm | 2011-11-17 04:08:50 -0800 (Thu, 17 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Show meaning of special length indication values in the LI root.

------------------------------------------------------------------------
r39900 | guy | 2011-11-17 01:24:15 -0800 (Thu, 17 Nov 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/erf.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/wtap-int.h

Rename pletonll() to reflect what it actually does, namely convert a
host-byte-order 64-bit integral quantity to little-endian byte order.

------------------------------------------------------------------------
r39899 | guy | 2011-11-17 01:04:54 -0800 (Thu, 17 Nov 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/wtap-int.h

A new macro needed by the WTAP_ENCAP_PER_PACKET support for writing
NetMon files.

------------------------------------------------------------------------
r39898 | guy | 2011-11-17 01:03:09 -0800 (Thu, 17 Nov 2011) | 9 lines
Changed paths:
   M /trunk/wiretap/netmon.c

Add support for writing WTAP_ENCAP_PER_PACKET files; they are written
out in version 2.1 of the file format (the minimum version to support
that).

Change some data types to avoid having file offsets that are before the
beginning of the file.

Clean up some other data types and some comments.

------------------------------------------------------------------------
r39897 | etxrab | 2011-11-16 22:46:34 -0800 (Wed, 16 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-ranap.c

Add a missing IE number.
------------------------------------------------------------------------
r39896 | guy | 2011-11-16 22:36:32 -0800 (Wed, 16 Nov 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/file_wrappers.c

Return *some* error if we end up trying to seek before the beginning of
the file, so you don't get weird random errors.  EINVAL is as good as
anything.

------------------------------------------------------------------------
r39895 | guy | 2011-11-16 18:29:26 -0800 (Wed, 16 Nov 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/ngsniffer.c

Put back the check for dates that can be represented in DOS format the
way it was *supposed* to be done, rather than backwards.

------------------------------------------------------------------------
r39894 | cmaynard | 2011-11-16 18:17:57 -0800 (Wed, 16 Nov 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/ngsniffer.c

Revert part of r39883 to avoid dereferencing a NULL pointer.  Thanks Clang.

------------------------------------------------------------------------
r39893 | gerald | 2011-11-16 17:37:14 -0800 (Wed, 16 Nov 2011) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Don't clobber release information for now.

------------------------------------------------------------------------
r39892 | gerald | 2011-11-16 16:48:21 -0800 (Wed, 16 Nov 2011) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Create/update svnversion.h unless we're only running with --get-*.

------------------------------------------------------------------------
r39891 | gerald | 2011-11-16 16:19:03 -0800 (Wed, 16 Nov 2011) | 21 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/config.nmake
   M /trunk/docbook/release-notes.xml
   M /trunk/make-version.pl

Add an SVN_REVISION variable to config.nmake. This can be used to
retrieve our SVN revision in releases.

Use make-version.pl to set all version information. Be more explicit
about the tasks it performs:

  - Fetching the SVN revision which corresponds to our code. The
    revision can be fetched via "svn info", "git svn info", SubWCRev",
    config.nmake, or by prodding .svn.

  - Setting the version numbers (the "major.minor.micro" triplet).

  - Setting the release information (revision/build number, local build
    identifier)

Remove the "is_release" configuration option and dist-hook target.

When run with a "--set-*" option or no options make sure we leave a
valid svnversion.h behind.


------------------------------------------------------------------------
r39890 | cmaynard | 2011-11-16 13:27:30 -0800 (Wed, 16 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

Avoid using "POINT" as it causes compiler errors on some systems.  Add modelines that match the current file's format.  This dissector is now ready to be spiceistributed. 

------------------------------------------------------------------------
r39889 | cmaynard | 2011-11-16 12:18:51 -0800 (Wed, 16 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netanalyzer.c

Don't assign the return value of proto_tree_add_item to a variable if it isn't going to be used.  Fixes Coverity CID 1327.

------------------------------------------------------------------------
r39888 | cmaynard | 2011-11-16 12:09:49 -0800 (Wed, 16 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp-utils.h
   M /trunk/epan/proto.h

Move FI_RESET_FLAG and PROTO_ITEM_SET_VISIBLE macros to proto.h and fix the FI_RESET_FLAG macro, being sure to use the 1's complement operator, '~', instead of the logical negation operator, '!'. (Fixes Coverity CID 1326).

------------------------------------------------------------------------
r39887 | etxrab | 2011-11-16 11:52:00 -0800 (Wed, 16 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/ansi_tcap/ansi_tcap.cnf
   M /trunk/asn1/ansi_tcap/packet-ansi_tcap-template.c
   M /trunk/epan/dissectors/packet-ansi_tcap.c

Dissect national Opcode.
------------------------------------------------------------------------
r39886 | guy | 2011-11-16 09:54:44 -0800 (Wed, 16 Nov 2011) | 15 lines
Changed paths:
   M /trunk/wiretap/netmon.c

Support nanosecond-resolution time for NetMon 2.x format (it's only
100-nanosecond resolution, but that's still better than microsecond
resolution).

For NetMon 1.x format, only claim to support millisecond resolution, as
that's all you get.

Fix handling of negative time deltas in NetMon 2.x format.

When writing a NetMon file, trim the time of the first packet to
millisecond precision to get the capture start time, so that the start
time written to the file (which has millisecond precision) is the same
as the start time used to calculate the deltas written to the packet
headers.

------------------------------------------------------------------------
r39885 | guy | 2011-11-16 09:13:37 -0800 (Wed, 16 Nov 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/k12text.l

OK, this should do it.

------------------------------------------------------------------------
r39884 | guy | 2011-11-16 09:12:47 -0800 (Wed, 16 Nov 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/k12text.l

Fix build on Windows.

------------------------------------------------------------------------
r39883 | guy | 2011-11-16 09:08:00 -0800 (Wed, 16 Nov 2011) | 6 lines
Changed paths:
   M /trunk/wiretap/ngsniffer.c

Another place where we have to protect against MSVC's time-conversion
routines blowing up if handed a too-large time_t.

While we're at it, also check for dates that can't be represented in DOS
format (pre-1980 dates).

------------------------------------------------------------------------
r39882 | guy | 2011-11-16 08:48:02 -0800 (Wed, 16 Nov 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/k12text.l

Another place where we have to protect against MSVC's time-conversion
routines blowing up if handed a too-large time_t.

------------------------------------------------------------------------
r39881 | martinm | 2011-11-16 08:32:40 -0800 (Wed, 16 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Show more sequence numbers in info column, and in root nodes.

------------------------------------------------------------------------
r39880 | kukosa | 2011-11-16 00:55:02 -0800 (Wed, 16 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

Fix handling of empty OpenType at the end of PDU
------------------------------------------------------------------------
r39879 | etxrab | 2011-11-15 21:54:44 -0800 (Tue, 15 Nov 2011) | 5 lines
Changed paths:
   M /trunk/asn1/lcsap/lcsap.cnf
   M /trunk/epan/dissectors/packet-lcsap.c

- Resorted the IEs in numerical order for easier comparison with the list of constants.
- Added two missing IEs

Solves LPPa embedded payloads not shown within LCS-AP
 https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6478
------------------------------------------------------------------------
r39878 | guy | 2011-11-15 19:13:02 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/capinfos.c
   M /trunk/gtk/summary_dlg.c

Handle ctime() and localtime() returning NULL and localtime() on Windows
blowing up when handed a bad value.

------------------------------------------------------------------------
r39877 | guy | 2011-11-15 18:43:58 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/capture_sync.c

Get rid of unnecessary assignment (the code below it always assigns a
value to the variable).  Praise be to Clang Cat.

------------------------------------------------------------------------
r39876 | guy | 2011-11-15 18:18:30 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Don't set variables if we don't look at them later.  All praise Clang
Cat.

------------------------------------------------------------------------
r39875 | wmeier | 2011-11-15 18:13:56 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Add Jakob Hirsch; Fix bad formatting which screwed up AUTHORS display.

------------------------------------------------------------------------
r39874 | wmeier | 2011-11-15 17:59:15 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t30.c

Cleanup & reformatting: whitespace & long-lines.

------------------------------------------------------------------------
r39873 | guy | 2011-11-15 17:56:58 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mysql.c

Thou shalt not use proto_tree_add_string() with an FT_BYTES field.

------------------------------------------------------------------------
r39872 | cmaynard | 2011-11-15 17:37:32 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-evrc.c

Delete pointless orig_offset variable, initialize speech_data_len[], use tvb_reported_length() instead of tvb_length(), and protect against a possible buffer overflow.  This should fix the Clang warning, "packet-evrc.c:364:41: warning: The right operand of '>=' is a garbage value", among other things.

------------------------------------------------------------------------
r39871 | guy | 2011-11-15 17:25:49 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/gtk/new_packet_list.c

Fix indentation.

------------------------------------------------------------------------
r39870 | wmeier | 2011-11-15 13:22:01 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aim-generic.c
   M /trunk/epan/dissectors/packet-aim.c
   M /trunk/epan/dissectors/packet-ajp13.c
   M /trunk/epan/dissectors/packet-asap.c
   M /trunk/epan/dissectors/packet-mp2t.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-uts.c
   M /trunk/epan/dissectors/packet-v52.c

tvb_[reported_]length_remaining can return -1

------------------------------------------------------------------------
r39869 | wmeier | 2011-11-15 13:07:37 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bt-utp.c

Remove unneeded #include

------------------------------------------------------------------------
r39868 | wmeier | 2011-11-15 12:49:40 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mongo.c

(Trivial) Reformat some long lines & do some whitespace cleanup.

------------------------------------------------------------------------
r39867 | etxrab | 2011-11-15 12:14:51 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Check the return value of dissect_sip_name_addr_or_addr_spec()
Should fix the recent fuzz failures.
Thanks Chris for isolating the offending packet.
------------------------------------------------------------------------
r39866 | guy | 2011-11-15 11:44:24 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Squelch a warning.  (This code probably needs a review; we really need a
better general framework for parsing text-based protocols.)

------------------------------------------------------------------------
r39865 | cmaynard | 2011-11-15 11:37:16 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Rename channel_type enums to avoid possible naming conflicts.

------------------------------------------------------------------------
r39864 | guy | 2011-11-15 11:35:13 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

More indentation cleanup.

------------------------------------------------------------------------
r39863 | guy | 2011-11-15 11:33:14 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Clean up indentation.

------------------------------------------------------------------------
r39862 | etxrab | 2011-11-15 11:25:17 -0800 (Tue, 15 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

packet-sip.c:1469: warning: unused variable 'contact_param_end_offset'
------------------------------------------------------------------------
r39861 | etxrab | 2011-11-15 11:03:39 -0800 (Tue, 15 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Restore dissection of contact parameters.
------------------------------------------------------------------------
r39860 | wmeier | 2011-11-15 11:00:08 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bt-dht.c

Remove unneeded #includes;
Move proto_reg_handoff...() to the end of the file as per convention.

------------------------------------------------------------------------
r39859 | wmeier | 2011-11-15 10:31:11 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-uaudp.c

Move proto_reg_handoff...() to the end of the file as per convention;
Do other minor reformatting and cleanup.

------------------------------------------------------------------------
r39858 | wmeier | 2011-11-15 09:44:14 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/packaging/macosx/Scripts/cli-postinstall.sh
   M /trunk/packaging/macosx/Scripts/wireshark-postinstall.sh

Add svn:executable to props

------------------------------------------------------------------------
r39857 | wmeier | 2011-11-15 09:41:41 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars/stepper-down.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars/stepper-left.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars/stepper-right.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars/stepper-up.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars/trough-scrollbar-horiz.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars/trough-scrollbar-vert.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars_1/slider-horiz-prelight.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars_1/slider-horiz.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars_1/slider-vert-prelight.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars_1/slider-vert.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars_6/slider-horiz-prelight.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars_6/slider-horiz.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars_6/slider-vert-prelight.png
   M /trunk/packaging/macosx/Resources/themes/Clearlooks-Quicksilver-OSX/gtk-2.0/Scrollbars_6/slider-vert.png
   M /trunk/packaging/macosx/dmg_background.png
   M /trunk/packaging/macosx/util_background.png

Set svn:mime-type to image/png

------------------------------------------------------------------------
r39856 | wmeier | 2011-11-15 09:33:59 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/docbook/wsug_graphics/toolbar/autoscroll_24.png
   M /trunk/docbook/wsug_graphics/toolbar/capture_filter_24.png
   M /trunk/docbook/wsug_graphics/toolbar/capture_interfaces_24.png
   M /trunk/docbook/wsug_graphics/toolbar/capture_options_24.png
   M /trunk/docbook/wsug_graphics/toolbar/capture_restart_24.png
   M /trunk/docbook/wsug_graphics/toolbar/capture_start_24.png
   M /trunk/docbook/wsug_graphics/toolbar/capture_stop_24.png
   M /trunk/docbook/wsug_graphics/toolbar/colorize_24.png
   M /trunk/docbook/wsug_graphics/toolbar/display_filter_24.png
   M /trunk/docbook/wsug_graphics/toolbar/resize_columns_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_add_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_apply_20.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_bottom_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_clear_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_close_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_colorselector_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_help_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_jump_to_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_left_arrow_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_open_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_preferences_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_print_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_properties_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_refresh_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_right_arrow_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_save_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_save_as_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_search_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_stop_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_top_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_zoom_1_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_zoom_in_24.png
   M /trunk/docbook/wsug_graphics/toolbar/stock_zoom_out_24.png

Set svn:mime-type to image/png

------------------------------------------------------------------------
r39855 | wmeier | 2011-11-15 09:29:27 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/docbook/wsug_graphics/note.png
   M /trunk/docbook/wsug_graphics/tip.png
   M /trunk/docbook/wsug_graphics/warning.png
   M /trunk/docbook/wsug_graphics/ws-analyze-menu.png
   M /trunk/docbook/wsug_graphics/ws-bytes-pane-tabs.png
   M /trunk/docbook/wsug_graphics/ws-bytes-pane.png
   M /trunk/docbook/wsug_graphics/ws-capture-info.png
   M /trunk/docbook/wsug_graphics/ws-capture-interface-details.png
   M /trunk/docbook/wsug_graphics/ws-capture-interfaces-win32.png
   M /trunk/docbook/wsug_graphics/ws-capture-interfaces.png
   M /trunk/docbook/wsug_graphics/ws-capture-menu.png
   M /trunk/docbook/wsug_graphics/ws-capture-options-remote-capture.png
   M /trunk/docbook/wsug_graphics/ws-capture-options-remote-interface.png
   M /trunk/docbook/wsug_graphics/ws-capture-options-remote-settings.png
   M /trunk/docbook/wsug_graphics/ws-capture-options.png
   M /trunk/docbook/wsug_graphics/ws-capture-preferences.png
   M /trunk/docbook/wsug_graphics/ws-choose-color-rule.png
   M /trunk/docbook/wsug_graphics/ws-coloring-fields.png
   M /trunk/docbook/wsug_graphics/ws-coloring-rules-dialog.png
   M /trunk/docbook/wsug_graphics/ws-column-header-popup-menu.png
   M /trunk/docbook/wsug_graphics/ws-decode-as-show.png
   M /trunk/docbook/wsug_graphics/ws-decode-as.png
   M /trunk/docbook/wsug_graphics/ws-details-pane-popup-menu.png
   M /trunk/docbook/wsug_graphics/ws-details-pane.png
   M /trunk/docbook/wsug_graphics/ws-display-filter-tcp.png
   M /trunk/docbook/wsug_graphics/ws-edit-color-rule-dialog.png
   M /trunk/docbook/wsug_graphics/ws-edit-menu.png
   M /trunk/docbook/wsug_graphics/ws-enabled-protocols.png
   M /trunk/docbook/wsug_graphics/ws-expert-colored-tree.png
   M /trunk/docbook/wsug_graphics/ws-expert-column.png
   M /trunk/docbook/wsug_graphics/ws-expert-infos.png
   M /trunk/docbook/wsug_graphics/ws-export-objects.png
   M /trunk/docbook/wsug_graphics/ws-export-pdml.png
   M /trunk/docbook/wsug_graphics/ws-export-plain.png
   M /trunk/docbook/wsug_graphics/ws-export-ps.png
   M /trunk/docbook/wsug_graphics/ws-export-psml.png
   M /trunk/docbook/wsug_graphics/ws-export-selected.png
   M /trunk/docbook/wsug_graphics/ws-file-import.png
   M /trunk/docbook/wsug_graphics/ws-file-menu.png
   M /trunk/docbook/wsug_graphics/ws-file-set-dialog.png
   M /trunk/docbook/wsug_graphics/ws-filter-add-expression.png
   M /trunk/docbook/wsug_graphics/ws-filter-toolbar.png
   M /trunk/docbook/wsug_graphics/ws-filters.png
   M /trunk/docbook/wsug_graphics/ws-find-packet.png
   M /trunk/docbook/wsug_graphics/ws-follow-stream.png
   M /trunk/docbook/wsug_graphics/ws-go-menu.png
   M /trunk/docbook/wsug_graphics/ws-goto-packet.png
   M /trunk/docbook/wsug_graphics/ws-gui-colors-preferences.png
   M /trunk/docbook/wsug_graphics/ws-gui-columns-preferences.png
   M /trunk/docbook/wsug_graphics/ws-gui-config-profiles.png
   M /trunk/docbook/wsug_graphics/ws-gui-font-preferences.png
   M /trunk/docbook/wsug_graphics/ws-gui-interface-options.png
   M /trunk/docbook/wsug_graphics/ws-gui-layout-preferences.png
   M /trunk/docbook/wsug_graphics/ws-gui-preferences.png
   M /trunk/docbook/wsug_graphics/ws-help-menu.png
   M /trunk/docbook/wsug_graphics/ws-internals-menu.png
   M /trunk/docbook/wsug_graphics/ws-list-pane.png
   M /trunk/docbook/wsug_graphics/ws-logo.png
   M /trunk/docbook/wsug_graphics/ws-main-toolbar.png
   M /trunk/docbook/wsug_graphics/ws-main.png
   M /trunk/docbook/wsug_graphics/ws-menu.png
   M /trunk/docbook/wsug_graphics/ws-merge-gtk20.png
   M /trunk/docbook/wsug_graphics/ws-merge-gtk24.png
   M /trunk/docbook/wsug_graphics/ws-merge-win32.png
   M /trunk/docbook/wsug_graphics/ws-nameresolution-preferences.png
   M /trunk/docbook/wsug_graphics/ws-open-gtk20.png
   M /trunk/docbook/wsug_graphics/ws-open-gtk24.png
   M /trunk/docbook/wsug_graphics/ws-open-win32.png
   M /trunk/docbook/wsug_graphics/ws-packet-format.png
   M /trunk/docbook/wsug_graphics/ws-packet-pane-popup-menu.png
   M /trunk/docbook/wsug_graphics/ws-packet-range.png
   M /trunk/docbook/wsug_graphics/ws-packet-selected.png
   M /trunk/docbook/wsug_graphics/ws-packet-sep-win.png
   M /trunk/docbook/wsug_graphics/ws-print.png
   M /trunk/docbook/wsug_graphics/ws-printing-preferences.png
   M /trunk/docbook/wsug_graphics/ws-save-as-gtk20.png
   M /trunk/docbook/wsug_graphics/ws-save-as-gtk24.png
   M /trunk/docbook/wsug_graphics/ws-save-as-win32.png
   M /trunk/docbook/wsug_graphics/ws-statistics-menu.png
   M /trunk/docbook/wsug_graphics/ws-stats-compare.png
   M /trunk/docbook/wsug_graphics/ws-stats-conversations.png
   M /trunk/docbook/wsug_graphics/ws-stats-endpoints.png
   M /trunk/docbook/wsug_graphics/ws-stats-hierarchy.png
   M /trunk/docbook/wsug_graphics/ws-stats-iographs.png
   M /trunk/docbook/wsug_graphics/ws-stats-lte-mac-traffic.png
   M /trunk/docbook/wsug_graphics/ws-stats-lte-rlc-traffic.png
   M /trunk/docbook/wsug_graphics/ws-stats-srt-dcerpc-filter.png
   M /trunk/docbook/wsug_graphics/ws-stats-srt-dcerpc.png
   M /trunk/docbook/wsug_graphics/ws-stats-summary.png
   M /trunk/docbook/wsug_graphics/ws-stats-wlan-traffic.png
   M /trunk/docbook/wsug_graphics/ws-statusbar-empty.png
   M /trunk/docbook/wsug_graphics/ws-statusbar-filter.png
   M /trunk/docbook/wsug_graphics/ws-statusbar-loaded.png
   M /trunk/docbook/wsug_graphics/ws-statusbar-profile.png
   M /trunk/docbook/wsug_graphics/ws-statusbar-selected.png
   M /trunk/docbook/wsug_graphics/ws-tel-rtpstream-analysis.png
   M /trunk/docbook/wsug_graphics/ws-telephony-menu.png
   M /trunk/docbook/wsug_graphics/ws-time-reference.png
   M /trunk/docbook/wsug_graphics/ws-tools-menu.png
   M /trunk/docbook/wsug_graphics/ws-view-menu.png

Set svn:mime-type to image/png

------------------------------------------------------------------------
r39854 | wmeier | 2011-11-15 09:26:04 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/docbook/wsdg_graphics/note.png
   M /trunk/docbook/wsdg_graphics/tip.png
   M /trunk/docbook/wsdg_graphics/warning.png
   M /trunk/docbook/wsdg_graphics/ws-capture-sync.png
   M /trunk/docbook/wsdg_graphics/ws-capture_internals.png
   M /trunk/docbook/wsdg_graphics/ws-function-blocks.png
   M /trunk/docbook/wsdg_graphics/ws-logo.png

Set svn:mime-type to image/png

------------------------------------------------------------------------
r39853 | wmeier | 2011-11-15 09:18:21 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/image/toolbar/pipe_16.png
   M /trunk/image/toolbar/remote_arrow_16.png
   M /trunk/image/toolbar/remote_globe_16.png
   M /trunk/image/toolbar/remote_sat_16.png

Set svn:mime-type to image/png

------------------------------------------------------------------------
r39852 | martinm | 2011-11-15 07:36:39 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Append important details from LI and SURI trees to root item.
Show some SNs in the info column.

------------------------------------------------------------------------
r39851 | wmeier | 2011-11-15 07:28:20 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/tools/compare-abis.sh
   M /trunk/tools/git-compare-abis.sh

Fix some props

------------------------------------------------------------------------
r39850 | wmeier | 2011-11-15 07:16:37 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-frstrans.h
   M /trunk/epan/dissectors/packet-dcerpc-misc.h
   M /trunk/epan/dissectors/packet-ieee80211-prism.c

Fix some svn properties

------------------------------------------------------------------------
r39849 | wmeier | 2011-11-15 07:11:35 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp.h

Fix svn:keywords prop: 'svn:eol-style'->'Id'

------------------------------------------------------------------------
r39848 | wmeier | 2011-11-15 07:08:43 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp-conference.h
   M /trunk/epan/dissectors/packet-xmpp-core.h
   M /trunk/epan/dissectors/packet-xmpp-gtalk.h
   M /trunk/epan/dissectors/packet-xmpp-jingle.h
   M /trunk/epan/dissectors/packet-xmpp-other.h
   M /trunk/epan/dissectors/packet-xmpp-utils.h

Fix svn:keywords prop: 'svn:eol-style'->'Id'

------------------------------------------------------------------------
r39847 | wmeier | 2011-11-15 07:02:01 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/asn1/lppa/LPPA-Common.asn
   M /trunk/asn1/lppa/LPPA-Constant.asn
   M /trunk/asn1/lppa/LPPA-Container.asn
   M /trunk/asn1/lppa/LPPA-ElementaryProcedure.asn
   M /trunk/asn1/lppa/LPPA-InformationElement.asn
   M /trunk/asn1/lppa/LPPA-PDU.asn
   M /trunk/asn1/lppa/Makefile.am
   M /trunk/asn1/lppa/Makefile.common
   M /trunk/asn1/lppa/Makefile.nmake
   M /trunk/asn1/lppa/lppa.cnf
   M /trunk/asn1/lppa/packet-lppa-template.c

Fix props: svn:keyword->svn:keywords; remove svn:executable

------------------------------------------------------------------------
r39846 | martinm | 2011-11-15 04:03:52 -0800 (Tue, 15 Nov 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-rlc.c

UMTS RLC:
- add lookup for "unknown" channel type dissector (mode is known)
- set length extent for SUFI root item
- show data frames in the info column (at least for AM...)

DCT:
- call RLCDCH with "unknown" channel type (as don't know whether IP or RRC)
- support R9

------------------------------------------------------------------------
r39845 | alagoutte | 2011-11-15 00:05:42 -0800 (Tue, 15 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp-conference.h
   M /trunk/epan/dissectors/packet-xmpp-core.h
   M /trunk/epan/dissectors/packet-xmpp-gtalk.h
   M /trunk/epan/dissectors/packet-xmpp-jingle.h
   M /trunk/epan/dissectors/packet-xmpp-other.h
   M /trunk/epan/dissectors/packet-xmpp-utils.h
   M /trunk/epan/dissectors/packet-xmpp.h

 Add svn:keywords and svn:eol-style properties

------------------------------------------------------------------------
r39844 | alagoutte | 2011-11-14 23:56:06 -0800 (Mon, 14 Nov 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cpha.c

Enhance CPHA dissector
* Remove struct and sizeof
* Replace proto_tree_add_* by proto_tree_add_item
* Replace CPHA function (report2str, opcode2str...) by standard Wireshark functions
* and minor bug fix

------------------------------------------------------------------------
r39843 | etxrab | 2011-11-14 23:18:39 -0800 (Mon, 14 Nov 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

From Michael Mann:
Bugfixes for both Buildbot issues:
1. seg-fault with multiple_service_packet
2. infinite loop

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6519
------------------------------------------------------------------------
r39842 | etxrab | 2011-11-14 23:12:19 -0800 (Mon, 14 Nov 2011) | 4 lines
Changed paths:
   M /trunk/make-version.pl

From Michael Mann:
Make it possible to use TortoiseSVN's SubWCRev.exe to update svnversion.h

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5441
------------------------------------------------------------------------
r39841 | guy | 2011-11-14 21:37:56 -0800 (Mon, 14 Nov 2011) | 18 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

OK, *that's* what Clang Cat was going on about:

	packet-dcerpc-pn-io.c:8438:17: warning: Although the value
	stored to 'prm_flag2' is used in the enclosing expression, the
	value is never actually read from 'prm_flag2'

OK, thanks for telling me that, technically,

	prm_flag1 = prm_flag2 = 0;

can be implemented by storing the 0 into prm_flag1 directly rather than
storing 0 into prm_flag2 and copying it to prm_flag1.  Yes, you can haz
cheeseburger.

I guess it would matter if we were actually depending on some
side-effect of fetching prm_flag2, but we're not.  Rewrite this one to
squelch the complaint.

------------------------------------------------------------------------
r39840 | guy | 2011-11-14 21:25:17 -0800 (Mon, 14 Nov 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c

Rewrite some odd code.  Clang Cat does not want:

	packet-reload.c:2875:13: warning: Although the value stored to
	'local_offset' is used in the enclosing expression, the value is
	never actually read from 'local_offset'

although as I read the C90 spec the code is doing pretty much what it
should be doing and the rewritten code does the same thing.  However,
it's also a bit more complicated and harder to read than the rewritten
code.

------------------------------------------------------------------------
r39839 | guy | 2011-11-14 21:10:56 -0800 (Mon, 14 Nov 2011) | 5 lines
Changed paths:
   M /trunk/asn1/tetra/packet-tetra-template.c
   M /trunk/epan/dissectors/packet-tetra.c

At least as I read the code, there can be up to 3 receive channels (the
number of channels is XXX & 0x03, hence in the range 0-3.

Thanks and a tip of the hat to Clang Cat for catching this.

------------------------------------------------------------------------
r39838 | guy | 2011-11-14 20:26:38 -0800 (Mon, 14 Nov 2011) | 14 lines
Changed paths:
   M /trunk/epan/dfilter/dfilter-macro.c
   M /trunk/epan/dfilter/dfilter-macro.h
   M /trunk/epan/dfilter/dfilter.c

Get rid of the depth argument to dfilter_macro_apply(); have an internal
routine that does all the work and that takes a depth argumen, and an
external routine that calls that internal routine with a depth argument
of 0.  The depth is only of use internally, to avoid infinite recursion.

When recursing with that routine, pass depth+1 as the depth value,
rather than passing depth and incrementing it afterwards; the latter
doesn't prevent infinite recursion.  (Thanks and a tip of the hat to
Clang Cat for catching this.)

Squelch some other (harmless) warnings from Clang Cat.

Clean up indentation.

------------------------------------------------------------------------
r39837 | cmaynard | 2011-11-14 12:38:05 -0800 (Mon, 14 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

Append each op name to the operations sub-tree so you don't necessarily have to expand the tree to see which ops are present.  I think it makes more sense to append the names here rather than at the top level which was done to resolve bug 6078, but for now, I leave them appended in both places.

------------------------------------------------------------------------
r39836 | wmeier | 2011-11-14 12:04:04 -0800 (Mon, 14 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hsr-prp-supervision.c
   M /trunk/epan/dissectors/packet-hsr.c
   M /trunk/epan/dissectors/packet-prp.c
   M /trunk/epan/dissectors/packet-rfid-mifare.c

Remove uneeded #includes, forward refs & check_col();
tvb_reported_length_remaining() can return -1;
Localize a variable.

------------------------------------------------------------------------
r39835 | wmeier | 2011-11-14 11:58:12 -0800 (Mon, 14 Nov 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua.c

'guint8=tvb_get_guint8() + 2' can wrap. Use 'gint=...' instead. ditto for 'gint16=...'
Also:
 - remove unneeded #include;
 - Remove unneeded check_col();
 - use val_to_str_const() in several cases.

------------------------------------------------------------------------
r39834 | cmaynard | 2011-11-14 11:57:45 -0800 (Mon, 14 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ucp.c

The Originator protocol identifier is not present in the "provisioning actions operation -61", only the "session management operatin -60".  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6570.

------------------------------------------------------------------------
r39833 | wmeier | 2011-11-14 11:18:18 -0800 (Mon, 14 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua.h

Add svn:keywords and svn:eol-style properties

------------------------------------------------------------------------
r39832 | etxrab | 2011-11-14 11:16:47 -0800 (Mon, 14 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ dissect X.509 certificates.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6575
------------------------------------------------------------------------
r39831 | guy | 2011-11-14 10:42:11 -0800 (Mon, 14 Nov 2011) | 3 lines
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-snmp.c

Do some more length checking to avoid a dissector bug error.  Should fix
bug 6564.

------------------------------------------------------------------------
r39830 | wmeier | 2011-11-14 10:19:14 -0800 (Mon, 14 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb-at.c
   M /trunk/epan/dissectors/packet-usb-ccid.c
   M /trunk/epan/dissectors/packet-usb-hid.c

Very minor cleanup: remove some unneeded #includes & some trailing whitespace

------------------------------------------------------------------------
r39829 | etxrab | 2011-11-14 09:35:04 -0800 (Mon, 14 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/asn1/ros/packet-ros-template.c
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-ros.c

[-Wunused-but-set-variable]
------------------------------------------------------------------------
r39828 | etxrab | 2011-11-14 09:27:18 -0800 (Mon, 14 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

packet-sip.c:1412: warning: 'uri_param_end_offset' may be used uninitialized in this function
------------------------------------------------------------------------
r39827 | etxrab | 2011-11-14 09:10:49 -0800 (Mon, 14 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

From Johan Wåhl:
- dissect Route and Via header.
- Dissect URI parameters.
------------------------------------------------------------------------
r39826 | martinm | 2011-11-14 04:22:54 -0800 (Mon, 14 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

Add remaining UMTS RLC primitive parameters preceding RLC payload.

------------------------------------------------------------------------
r39825 | martinm | 2011-11-14 03:36:53 -0800 (Mon, 14 Nov 2011) | 2 lines
Changed paths:
   M /trunk/tshark.c

Make exit_status volatile to avoid warning.

------------------------------------------------------------------------
r39824 | etxrab | 2011-11-14 00:24:47 -0800 (Mon, 14 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/sbc-ap/packet-sbc-ap-template.c
   M /trunk/epan/dissectors/packet-sbc-ap.c

Fix Id tag.
------------------------------------------------------------------------
r39823 | wmeier | 2011-11-13 15:33:47 -0800 (Sun, 13 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp-conference.c
   M /trunk/epan/dissectors/packet-xmpp-conference.h
   M /trunk/epan/dissectors/packet-xmpp-core.c
   M /trunk/epan/dissectors/packet-xmpp-core.h
   M /trunk/epan/dissectors/packet-xmpp-gtalk.c
   M /trunk/epan/dissectors/packet-xmpp-gtalk.h
   M /trunk/epan/dissectors/packet-xmpp-jingle.c
   M /trunk/epan/dissectors/packet-xmpp-jingle.h
   M /trunk/epan/dissectors/packet-xmpp-other.c
   M /trunk/epan/dissectors/packet-xmpp-other.h
   M /trunk/epan/dissectors/packet-xmpp-utils.c
   M /trunk/epan/dissectors/packet-xmpp-utils.h
   M /trunk/epan/dissectors/packet-xmpp.c

Don't use generic shared function/typedef/struct names;
Remove unneeded #includes;
Cleanup trailing whitespace.

------------------------------------------------------------------------
r39822 | guy | 2011-11-13 14:51:49 -0800 (Sun, 13 Nov 2011) | 11 lines
Changed paths:
   M /trunk/epan/column.c
   M /trunk/epan/column.h
   M /trunk/epan/prefs.c
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/prefs_column.c

If we set "column.hidden" on the command line but don't set
"column.format" in a later argument, make sure we mark the appropriate
existing columns as hidden.

As part of cleaning up the infrastructure for doing this, store the COL_
code for a column in a fmt_data structure rather than a pointer to the
raw column format string; this simplifies some code.

Have a routine to return whether a column is visible, not hidden, as
it's used to set a "visible" flag.

------------------------------------------------------------------------
r39821 | guy | 2011-11-13 14:44:51 -0800 (Sun, 13 Nov 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-arp.c

As we're no longer checking whether we're constructing the Info column,
we can't bail out early on dissection merely because we're not
constructing the protocol tree, as that would mean we wouldn't construct
the Info column unless we're constructing a protocol tree.

Clean up indentation.

------------------------------------------------------------------------
r39818 | gerald | 2011-11-13 07:03:25 -0800 (Sun, 13 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-11-13]
------------------------------------------------------------------------
r39817 | guy | 2011-11-12 17:38:46 -0800 (Sat, 12 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua.c

The sum of a guint16 and 2 does not necessarily fit in a guint16.  Put
it into a gint, instead.  This should fix bug 6572, by preventing an
infinite loop if the sum in question is 0 modulo 2^16.

------------------------------------------------------------------------
r39816 | guy | 2011-11-12 16:04:49 -0800 (Sat, 12 Nov 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/pcap-common.c

Clean up white space.

Note that we don't need to set the FCS length, but might as well do so
anyway.

------------------------------------------------------------------------
r39815 | wmeier | 2011-11-12 15:25:29 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netanalyzer.c

Various additional fixes ....

------------------------------------------------------------------------
r39814 | wmeier | 2011-11-12 15:03:30 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netanalyzer.c

Fix a formatting error.

------------------------------------------------------------------------
r39813 | wmeier | 2011-11-12 14:26:06 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netanalyzer.c

Fix some compile errors and rework some code.

------------------------------------------------------------------------
r39812 | tuexen | 2011-11-12 14:03:55 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Fix compilation if HAVE_LIBGCRYPT is not defined.

------------------------------------------------------------------------
r39811 | guy | 2011-11-12 13:16:43 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-calcappprotocol.c
   M /trunk/epan/dissectors/packet-componentstatus.c
   M /trunk/epan/dissectors/packet-fractalgeneratorprotocol.c
   M /trunk/epan/dissectors/packet-pingpongprotocol.c

Update URL.

------------------------------------------------------------------------
r39810 | wmeier | 2011-11-12 12:27:32 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap.c

Add entries for WTAP_ENCAP_NETANALYZER... to encap_table_base[]

------------------------------------------------------------------------
r39809 | wmeier | 2011-11-12 12:17:43 -0800 (Sat, 12 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-componentstatus.c
   M /trunk/epan/dissectors/packet-fractalgeneratorprotocol.c
   M /trunk/epan/dissectors/packet-netperfmeter.c
   M /trunk/epan/dissectors/packet-pingpongprotocol.c
   M /trunk/epan/dissectors/packet-scriptingservice.c

Remove some unneeded 'if(pinfo)' tests;
Remove some unneeded forward refs.

------------------------------------------------------------------------
r39808 | wmeier | 2011-11-12 12:14:26 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-enrp.c

Fix 2 typos.

------------------------------------------------------------------------
r39807 | wmeier | 2011-11-12 11:45:21 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-calcappprotocol.c

Remove unneeded code.

------------------------------------------------------------------------
r39806 | wmeier | 2011-11-12 11:27:07 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-asap.c

Fix 2 typos

------------------------------------------------------------------------
r39805 | wmeier | 2011-11-12 11:17:21 -0800 (Sat, 12 Nov 2011) | 3 lines
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

Fix some additional [-Wunused-but-set-variable]
Fix some spelling typos

------------------------------------------------------------------------
r39804 | etxrab | 2011-11-12 10:01:38 -0800 (Sat, 12 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   D /trunk/epan/dissectors/packet-hilscher.c
   A /trunk/epan/dissectors/packet-netanalyzer.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/wtap.h

From Holger Pfrommer:
Enhancement of Hilscher Analyzer Dissector.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6082
------------------------------------------------------------------------
r39803 | etxrab | 2011-11-12 04:37:38 -0800 (Sat, 12 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/smrse/packet-smrse-template.c
   M /trunk/asn1/spnego/packet-spnego-template.c
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-kink.c
   M /trunk/epan/dissectors/packet-smrse.c
   M /trunk/epan/dissectors/packet-spnego.c

fix [-Wunused-but-set-variable]
------------------------------------------------------------------------
r39802 | etxrab | 2011-11-12 03:49:37 -0800 (Sat, 12 Nov 2011) | 1 line
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

fix [-Wunused-but-set-variable]
------------------------------------------------------------------------
r39801 | etxrab | 2011-11-12 03:27:41 -0800 (Sat, 12 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-xmpp-utils.c

Add a cast.
------------------------------------------------------------------------
r39800 | etxrab | 2011-11-12 03:23:30 -0800 (Sat, 12 Nov 2011) | 7 lines
Changed paths:
   M /trunk/gtk/simple_dialog.c

From Jan Šafránek:
if the message box is displayed when the main
window is in GDK_WINDOW_STATE_WITHDRAWN state (i.e. the main window is being
composed and it is not shown yet), the message box gets overlapped by the main
window when it's finally shown.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6559
------------------------------------------------------------------------
r39799 | alagoutte | 2011-11-12 02:51:01 -0800 (Sat, 12 Nov 2011) | 13 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-xmpp-conference.c
   A /trunk/epan/dissectors/packet-xmpp-conference.h
   A /trunk/epan/dissectors/packet-xmpp-core.c
   A /trunk/epan/dissectors/packet-xmpp-core.h
   A /trunk/epan/dissectors/packet-xmpp-gtalk.c
   A /trunk/epan/dissectors/packet-xmpp-gtalk.h
   A /trunk/epan/dissectors/packet-xmpp-jingle.c
   A /trunk/epan/dissectors/packet-xmpp-jingle.h
   A /trunk/epan/dissectors/packet-xmpp-other.c
   A /trunk/epan/dissectors/packet-xmpp-other.h
   A /trunk/epan/dissectors/packet-xmpp-utils.c
   A /trunk/epan/dissectors/packet-xmpp-utils.h
   M /trunk/epan/dissectors/packet-xmpp.c
   A /trunk/epan/dissectors/packet-xmpp.h

From Mariusz Okrój and Sebastien Vincent via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6225
Enhance XMPP Dissector

XMPP is communication protocol that is based on XML.

Existing Jabber dissector has only few filtering possibilities and displays packets in inconvenient way.

This dissector is a result of cooperation with Jitsi community as Google Summer of Code project (http://www.jitsi.org/index.php/GSOC2011/XmppWireshark).

From me :
Add Mariusz Okrój in AUTHORS File
Add Modelines information

------------------------------------------------------------------------
r39798 | guy | 2011-11-11 22:35:51 -0800 (Fri, 11 Nov 2011) | 2 lines
Changed paths:
   M /trunk/tshark.c

Catch the OutOfMemoryError exception and print a message.

------------------------------------------------------------------------
r39797 | guy | 2011-11-11 22:16:57 -0800 (Fri, 11 Nov 2011) | 3 lines
Changed paths:
   M /trunk/gtk/packet_list_store.c

Note that we should catch the OutOfMemoryError exception here to avoid
an "unhandled exception" crash if we run out of memory.

------------------------------------------------------------------------
r39796 | wmeier | 2011-11-11 14:21:06 -0800 (Fri, 11 Nov 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap.c

Add (missing) "mime" entry to encap_table_base[].

------------------------------------------------------------------------
r39795 | guy | 2011-11-11 11:07:11 -0800 (Fri, 11 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Add some checks for "character not found"; this should fix some
fuzz-testing failures we're seeing.

------------------------------------------------------------------------
r39794 | stig | 2011-11-11 05:25:48 -0800 (Fri, 11 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c

Fixed abbrev for "Channel rate and type".
Bug reported by damker.
------------------------------------------------------------------------
r39793 | guy | 2011-11-10 19:29:51 -0800 (Thu, 10 Nov 2011) | 3 lines
Changed paths:
   M /trunk/wsutil/crc32.h

OK, one of them was already declared; we still want to declare the other
one.

------------------------------------------------------------------------
r39792 | guy | 2011-11-10 19:28:10 -0800 (Thu, 10 Nov 2011) | 3 lines
Changed paths:
   M /trunk/wsutil/crc32.h
   M /trunk/wsutil/libwsutil.def

If we're exporting routines from crc32.c, declare them in crc32.h and
list them in libwsutil.def.

------------------------------------------------------------------------
r39791 | gerald | 2011-11-10 16:10:05 -0800 (Thu, 10 Nov 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

Link TShark with gthread.

------------------------------------------------------------------------
r39790 | gerald | 2011-11-10 16:04:14 -0800 (Thu, 10 Nov 2011) | 3 lines
Changed paths:
   M /trunk/tshark.c

Initialize threads at program startup. Hopefully this will fix the
current build test failures.

------------------------------------------------------------------------
r39789 | guy | 2011-11-10 15:28:28 -0800 (Thu, 10 Nov 2011) | 2 lines
Changed paths:
   M /trunk/asn1/hnbap/hnbap.cnf
   M /trunk/epan/dissectors/packet-hnbap.c

Get rid of an unused function (dissect_hnbap_AccessResult()).

------------------------------------------------------------------------
r39788 | guy | 2011-11-10 15:02:42 -0800 (Thu, 10 Nov 2011) | 9 lines
Changed paths:
   M /trunk/epan/prefs.c
   M /trunk/epan/prefs.h
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/prefs_capture.c

Get rid of the last remnants of the "check the syntax of capture
filters" preference; now that we always build with threads, we do the
syntax checking in a separate thread, so it doesn't hang the UI, and we
no longer have UI to change it but we were still trying to fetch the
value of the non-existent checkbox for it and getting a warning printed.

(We still check for it when reading, so that we don't print warnings if
it's present.)

------------------------------------------------------------------------
r39787 | etxrab | 2011-11-10 13:44:46 -0800 (Thu, 10 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/hnbap/hnbap.cnf
   M /trunk/epan/dissectors/packet-hnbap.c

Set info col for new messages.
------------------------------------------------------------------------
r39786 | etxrab | 2011-11-10 13:38:15 -0800 (Thu, 10 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/hnbap/HNBAP-CommonDataTypes.asn
   M /trunk/asn1/hnbap/HNBAP-Constants.asn
   M /trunk/asn1/hnbap/HNBAP-Containers.asn
   M /trunk/asn1/hnbap/HNBAP-IEs.asn
   M /trunk/asn1/hnbap/HNBAP-PDU-Contents.asn
   M /trunk/asn1/hnbap/HNBAP-PDU-Descriptions.asn
   M /trunk/asn1/hnbap/hnbap.cnf
   M /trunk/epan/dissectors/packet-hnbap.c

Update HNBAP to V10.1.0 (2011-06)
------------------------------------------------------------------------
r39785 | etxrab | 2011-11-10 12:52:44 -0800 (Thu, 10 Nov 2011) | 3 lines
Changed paths:
   M /trunk/asn1/pkcs1/PKIXAlgs-2009.asn
   M /trunk/asn1/pkcs1/pkcs1.cnf
   M /trunk/epan/dissectors/packet-pkcs1.c

From Martin Kaiser:
RSASSA-PSS support for X.509 certificates.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6541
------------------------------------------------------------------------
r39784 | etxrab | 2011-11-10 12:46:10 -0800 (Thu, 10 Nov 2011) | 4 lines
Changed paths:
   M /trunk/radius/dictionary.3gpp2

From freeradius@arcor.de:
dictionary.3gpp2 corrections.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6558
------------------------------------------------------------------------
r39783 | etxrab | 2011-11-10 12:38:07 -0800 (Thu, 10 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

packet-sip.c:1442: warning: 'c' may be used uninitialized in this function
------------------------------------------------------------------------
r39782 | etxrab | 2011-11-10 12:16:17 -0800 (Thu, 10 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

-Improve dissection of auth items
(https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6553)
- Add parameter items to the tree for some  often trunkated lines.
------------------------------------------------------------------------
r39781 | etxrab | 2011-11-09 22:14:03 -0800 (Wed, 09 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/sbc-ap/SBC-AP-PDU-Contents.asn

Forgot part of commit 39766.
------------------------------------------------------------------------
r39779 | etxrab | 2011-11-09 22:07:16 -0800 (Wed, 09 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-capwap.c

From Dirk:
CAPWAP dissector tries to allocate -1 bytes of memory during reassembly.
- changed to return offset.
------------------------------------------------------------------------
r39778 | gerald | 2011-11-09 20:01:09 -0800 (Wed, 09 Nov 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Pass a GMutex * instead of a GMutex **.

------------------------------------------------------------------------
r39777 | guy | 2011-11-09 16:53:48 -0800 (Wed, 09 Nov 2011) | 8 lines
Changed paths:
   M /trunk/epan/prefs.c

prefs_reset() has to reset the dissector preferences to their defaults,
as we don't save to a preferences file preference values that are equal
to their defaults, so if you change profiles, a preference that has a
non-default value in the old profile and a default value in the new
profile, so that it's *not* in the preference file for the new profile,
will not be set to the right value unless we reset all protocol
preferences to their defaults first.

------------------------------------------------------------------------
r39776 | gerald | 2011-11-09 15:43:50 -0800 (Wed, 09 Nov 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main_welcome.c
   M /trunk/tshark.c

Try to fix the GLib thread API deprecations listed in bug 6552.

------------------------------------------------------------------------
r39775 | stig | 2011-11-09 12:45:06 -0800 (Wed, 09 Nov 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/dumpcap.c

As reported by Michael Speck:
Removed last occurrences of USE_THREADS.
------------------------------------------------------------------------
r39774 | wmeier | 2011-11-09 09:33:18 -0800 (Wed, 09 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-ndr.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-h223.c
   M /trunk/epan/dissectors/packet-h248_annex_c.c
   M /trunk/epan/dissectors/packet-h248_q1950.c
   M /trunk/epan/dissectors/packet-imf.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-ismp.c
   M /trunk/epan/dissectors/packet-jxta.c
   M /trunk/epan/dissectors/packet-kerberos4.c
   M /trunk/epan/dissectors/packet-maccontrol.c
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-opsi.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-q931.c
   M /trunk/epan/dissectors/packet-q933.c
   M /trunk/epan/dissectors/packet-redbackli.c
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-rmt-fec.c
   M /trunk/epan/dissectors/packet-rmt-lct.c
   M /trunk/epan/dissectors/packet-rudp.c
   M /trunk/epan/dissectors/packet-sgsap.c
   M /trunk/epan/dissectors/packet-turbocell.c
   M /trunk/epan/dissectors/packet-udp.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-wps.c

Fix a number of proto_tree_add_item() encoding args.

------------------------------------------------------------------------
r39773 | stig | 2011-11-09 02:05:55 -0800 (Wed, 09 Nov 2011) | 1 line
Changed paths:
   M /trunk/tempfile.c

Removed 'old-style parameter declaration'.
------------------------------------------------------------------------
r39772 | wmeier | 2011-11-08 18:48:51 -0800 (Tue, 08 Nov 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtn.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-vxlan.c

Fix some [-Wunused-but-set-variable] warnings
 (in some cases by changing proto_tree_add_item() to use
  what appears to be the correct 'tree' arg);
Do whitespace cleanup.

------------------------------------------------------------------------
r39771 | wmeier | 2011-11-08 17:35:26 -0800 (Tue, 08 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Fix some [-Wunused-but-set-variable] warnings;
Trailing whitespace cleanup.

------------------------------------------------------------------------
r39770 | cmaynard | 2011-11-08 15:08:12 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

In the unlikely case that there are no ops, don't append anything.  Also, comma-separate them.

------------------------------------------------------------------------
r39769 | gerald | 2011-11-08 14:35:56 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/configure.in
   M /trunk/debian/changelog
   M /trunk/docbook/release-notes.xml
   M /trunk/make-version.pl

1.7.0 → 1.7.1.

------------------------------------------------------------------------
r39768 | gerald | 2011-11-08 12:02:06 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Build 1.7.0.

------------------------------------------------------------------------
r39767 | cmaynard | 2011-11-08 11:37:55 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/doc/tshark.pod
   M /trunk/tap-iostat.c

From Michael Mann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6377, with the tshark man page update by me: tshark -z io,stat,interval,"[SUM|MIN|MAX|AVG](field)field [and filter]" should support floating point.

------------------------------------------------------------------------
r39766 | etxrab | 2011-11-08 11:30:51 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/sbc-ap/sbc-ap.cnf
   M /trunk/epan/dissectors/packet-sbc-ap.c

Try to fix defined but not used warnings.
------------------------------------------------------------------------
r39765 | stig | 2011-11-08 11:21:00 -0800 (Tue, 08 Nov 2011) | 3 lines
Changed paths:
   M /trunk/asn1/HI2Operations
   M /trunk/asn1/acp133
   M /trunk/asn1/acse
   M /trunk/asn1/ansi_map
   M /trunk/asn1/ansi_tcap
   M /trunk/asn1/camel
   M /trunk/asn1/cdt
   M /trunk/asn1/charging_ase
   M /trunk/asn1/cmip
   M /trunk/asn1/cmp
   M /trunk/asn1/cms
   M /trunk/asn1/credssp
   M /trunk/asn1/crmf
   M /trunk/asn1/dap
   M /trunk/asn1/disp
   M /trunk/asn1/dop
   M /trunk/asn1/dsp
   M /trunk/asn1/ess
   M /trunk/asn1/ftam
   M /trunk/asn1/gnm
   M /trunk/asn1/goose
   M /trunk/asn1/gprscdr
   M /trunk/asn1/gsm_map
   M /trunk/asn1/h225
   M /trunk/asn1/h235
   M /trunk/asn1/h245
   M /trunk/asn1/h248
   M /trunk/asn1/h282
   M /trunk/asn1/h283
   M /trunk/asn1/h323
   M /trunk/asn1/h450
   M /trunk/asn1/h450-ros
   M /trunk/asn1/h460
   M /trunk/asn1/h501
   M /trunk/asn1/hnbap
   M /trunk/asn1/idmp
   M /trunk/asn1/inap
   M /trunk/asn1/kerberos
   M /trunk/asn1/lcsap
   M /trunk/asn1/ldap
   M /trunk/asn1/logotypecertextn
   M /trunk/asn1/lpp
   M /trunk/asn1/lppa
   M /trunk/asn1/lte-rrc
   M /trunk/asn1/mms
   M /trunk/asn1/mpeg-audio
   M /trunk/asn1/mpeg-pes
   M /trunk/asn1/nbap
   M /trunk/asn1/ns_cert_exts
   M /trunk/asn1/ocsp
   M /trunk/asn1/p1
   M /trunk/asn1/p22
   M /trunk/asn1/p7
   M /trunk/asn1/p772
   M /trunk/asn1/pcap
   M /trunk/asn1/pkcs1
   M /trunk/asn1/pkcs12
   M /trunk/asn1/pkinit
   M /trunk/asn1/pkix1explicit
   M /trunk/asn1/pkix1implicit
   M /trunk/asn1/pkixac
   M /trunk/asn1/pkixproxy
   M /trunk/asn1/pkixqualified
   M /trunk/asn1/pkixtsp
   M /trunk/asn1/pres
   M /trunk/asn1/q932
   M /trunk/asn1/q932-ros
   M /trunk/asn1/qsig
   M /trunk/asn1/ranap
   M /trunk/asn1/rnsap
   M /trunk/asn1/ros
   M /trunk/asn1/rrc
   M /trunk/asn1/rrlp
   M /trunk/asn1/rtse
   M /trunk/asn1/rua
   M /trunk/asn1/s1ap
   M /trunk/asn1/sabp
   M /trunk/asn1/smrse
   M /trunk/asn1/snmp
   M /trunk/asn1/spnego
   M /trunk/asn1/sv
   M /trunk/asn1/t124
   M /trunk/asn1/t125
   M /trunk/asn1/t38
   M /trunk/asn1/tcap
   M /trunk/asn1/tetra
   M /trunk/asn1/ulp
   M /trunk/asn1/wlancertextn
   M /trunk/asn1/x2ap
   M /trunk/asn1/x509af
   M /trunk/asn1/x509ce
   M /trunk/asn1/x509if
   M /trunk/asn1/x509sat
   M /trunk/asn1/x721

Cleanup in svn:ignore after the change to build the ASN.1 dissectors
directly into epan/dissectors (revision 39333).

------------------------------------------------------------------------
r39764 | cmaynard | 2011-11-08 10:39:11 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/asn1/t38/t38.cnf
   M /trunk/epan/dissectors/packet-clnp.c
   M /trunk/epan/dissectors/packet-dccp.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-icmp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-nhrp.c
   M /trunk/epan/dissectors/packet-p_mul.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-sflow.c
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/dissectors/packet-t38.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-udp.c
   M /trunk/epan/dissectors/packet-vines.c
   M /trunk/epan/packet.c
   M /trunk/epan/packet_info.h
   M /trunk/epan/wslua/wslua_pinfo.c

packet_info's in_error_pkt is now a bitfield like in_gre_pkt.

------------------------------------------------------------------------
r39763 | sfisher | 2011-11-08 10:15:39 -0800 (Tue, 08 Nov 2011) | 5 lines
Changed paths:
   M /trunk/asn1/sbc-ap/packet-sbc-ap-template.c
   M /trunk/epan/dissectors/packet-sbc-ap.c


Fix message_type defined but unused compiler warning/error.  There are 3
more problems that I'll mail to -dev.


------------------------------------------------------------------------
r39762 | etxrab | 2011-11-08 10:06:18 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/sbc-ap/packet-sbc-ap-template.c
   M /trunk/epan/dissectors/packet-sbc-ap.c

packet-sbc-ap-template.c:138: warning: unused variable 'offset'
------------------------------------------------------------------------
r39761 | etxrab | 2011-11-08 09:39:01 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-s1ap.c

Get rid of set-but-not-used warnings.
------------------------------------------------------------------------
r39760 | etxrab | 2011-11-08 09:36:12 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-vxlan.c

Add a dissector for http://tools.ietf.org/html/draft-mahalingam-dutt-dcops-vxlan-00
------------------------------------------------------------------------
r39759 | etxrab | 2011-11-08 09:31:23 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sgsap.c

Use the correct length for the NAS message container.
------------------------------------------------------------------------
r39758 | etxrab | 2011-11-08 09:28:55 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.am
   M /trunk/asn1/Makefile.nmake
   M /trunk/configure.in
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-sbc-ap.c

Add SBc Application Part (SBc-AP) to build.
------------------------------------------------------------------------
r39757 | cmaynard | 2011-11-08 09:25:22 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/dissectors/packet-icmp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/packet_info.h

Improve ICMP conversation tracking, especially when capturing on multiple interfaces and one of them is a GRE tunnel.  Resolves bug 5770, which was reopened.

------------------------------------------------------------------------
r39756 | etxrab | 2011-11-08 09:17:05 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   A /trunk/asn1/sbc-ap
   A /trunk/asn1/sbc-ap/Makefile.am
   A /trunk/asn1/sbc-ap/Makefile.common
   A /trunk/asn1/sbc-ap/Makefile.nmake
   A /trunk/asn1/sbc-ap/SBC-AP-CommonDataTypes.asn
   A /trunk/asn1/sbc-ap/SBC-AP-Constants.asn
   A /trunk/asn1/sbc-ap/SBC-AP-Containers.asn
   A /trunk/asn1/sbc-ap/SBC-AP-IEs.asn
   A /trunk/asn1/sbc-ap/SBC-AP-PDU-Contents.asn
   A /trunk/asn1/sbc-ap/SBC-AP-PDU-Descriptions.asn
   A /trunk/asn1/sbc-ap/packet-sbc-ap-template.c
   A /trunk/asn1/sbc-ap/sbc-ap.cnf

Add SBc Application Part (SBc-AP) dir
------------------------------------------------------------------------
r39755 | gerald | 2011-11-08 08:49:49 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Remove a duplicate "TID" found by checkAPIs.pl.

------------------------------------------------------------------------
r39754 | alagoutte | 2011-11-08 06:45:35 -0800 (Tue, 08 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Pontus Fuchs via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6548
80211 QoS Control: Add Raw TID

------------------------------------------------------------------------
r39753 | martinm | 2011-11-08 06:32:13 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-tvbuff.c

Make some variables volatile to avoid warnings with my gcc version.

------------------------------------------------------------------------
r39752 | alagoutte | 2011-11-08 04:50:13 -0800 (Tue, 08 Nov 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ajp13.c

From Iain Arnell via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6546
packet-ajp13 fails to detect end of request body

AJP13 may use two different packets to signify end of request body;
either zero length packet, or packet with zero length content. The ajp13
dissector already recognizes the former; this patch adds support for the
latter.

------------------------------------------------------------------------
r39751 | gerald | 2011-11-07 15:42:53 -0800 (Mon, 07 Nov 2011) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt
   M /trunk/cmakeconfig.h.in
   M /trunk/config.h.win32
   M /trunk/configure.in
   M /trunk/dumpcap.c
   M /trunk/epan/prefs.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main.h
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/prefs_capture.c
   M /trunk/gtk/prefs_taps.c
   M /trunk/version_info.c

Change the use of threads from "mostly always, depending on your
configure options and Gtk+ and GLib versions" to "always".

------------------------------------------------------------------------
r39750 | alagoutte | 2011-11-07 08:56:16 -0800 (Mon, 07 Nov 2011) | 13 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-usb-ccid.c

From Tyson Key via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6155
Dissector for the USB Integrated Circuit Card Interface Device Class (CCID)

I've implemented a reasonable subset of a dissector for the USB CCID specification (as described at http://www.usb.org/developers/devclass_docs/DWG_Smart-Card_CCID_Rev110.pdf), during the course of experimenting with an ACS ACR122U ISO 14443 card reader and MiFare tokens.

It currently identifies all of the message types listed in that specification,ng.

From me:
* Fix Clang Warning
* Remove trailing whitespace from lines
* Fix Checkhf (Remove a unused entry)
* Added packet-rfid-mifare to Makefile.common and CMakeLists.txt

------------------------------------------------------------------------
r39749 | stig | 2011-11-07 08:09:41 -0800 (Mon, 07 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-tvbuff.c

Do not return from within a TRY/CATCH/ENDTRY because this will make the
except stack invalid, and will lead to a crash.

In this case it was when doing compare functions on a FT_PROTOCOL.
------------------------------------------------------------------------
r39748 | stig | 2011-11-06 23:41:03 -0800 (Sun, 06 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Do not return from within a TRY/CATCH/ENDTRY because this will make the
except stack invalid, and will lead to a crash.

In this case it was when calling a dissector from a table in a Lua script.
------------------------------------------------------------------------
r39747 | guy | 2011-11-06 12:20:14 -0800 (Sun, 06 Nov 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rfid-mifare.c

Attempt to fix the RCS ID.

NULL out blurbs that just give the field name.

This is C code, so it shouldn't be executable; get rid of
svn:executable.

------------------------------------------------------------------------
r39746 | alagoutte | 2011-11-06 11:19:07 -0800 (Sun, 06 Nov 2011) | 13 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-rfid-mifare.c

From Tyson Key via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6161
Dissector for the NXP MiFare Protocol

I've just finished writing a dissector for the NXP-proprietary MiFare Protocol, as used alongside ISO 14443-A by a popular range of contactless (not-so-smart) cards, and various emulations, variants and clones thereof.

It currently supports all of the commands listed in http://www.nxp.com/documents/data_sheet/MF1S703x.pdf that also happen to be supported by LibNFC (http://code.google.com/p/libnfc/) - modulo the "NAK" and CRC bytes, since I haven't found examples of their usage in my USB traces, and I didn't want to hand-craft (probably incorrect) examples for testing.

From me:
* Fix Clang Warning
* Remove trailing whitespace from lines;
* Added packet-rfid-mifare to Makefile.common and CMakeLists.txt
* Add Modelines information

------------------------------------------------------------------------
r39745 | alagoutte | 2011-11-06 11:02:36 -0800 (Sun, 06 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6545
DVB-CI / CI+ fix clang warning about unused variable

------------------------------------------------------------------------
r39744 | stig | 2011-11-06 09:39:13 -0800 (Sun, 06 Nov 2011) | 6 lines
Changed paths:
   M /trunk/epan/wslua/init_wslua.c
   M /trunk/epan/wslua/wslua.h
   M /trunk/epan/wslua/wslua_dumper.c
   M /trunk/epan/wslua/wslua_proto.c
   M /trunk/epan/wslua/wslua_tvb.c
   M /trunk/epan/wslua/wslua_util.c

From Robert G. Jakabosky via bug 5575:
Fix memory errors in Lua dissectors.
- Free Tvb when created from ByteArray.
- Free TvbRange correctly.
- Free string from get_persconffile_path and get_datafile_path.
- Some code cleanup.
------------------------------------------------------------------------
r39741 | gerald | 2011-11-06 07:03:27 -0800 (Sun, 06 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-11-06]
------------------------------------------------------------------------
r39740 | etxrab | 2011-11-06 01:18:26 -0700 (Sun, 06 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-bssgp.h
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-gtpv2.c

Dissect RIM related IEs
------------------------------------------------------------------------
r39739 | guy | 2011-11-05 13:47:11 -0700 (Sat, 05 Nov 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isdn.c

Add a preference to select whether to use LAPD or DPNSS as the protocol
on the D channel.

------------------------------------------------------------------------
r39738 | guy | 2011-11-05 13:45:39 -0700 (Sat, 05 Nov 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dpnss-link.c

Fix what I think is a typo in the introductory comment.

Set the protocol column (perhaps there should be separate names for the
DPNSS layer 2 and layer 3 protocols).

The DPNSS layer 2 protocol appears to be Yet Another HDLC Derivative;
put in a comment noting that we might want to use the xDLC control field
dissector code.

------------------------------------------------------------------------
r39737 | guy | 2011-11-05 13:43:56 -0700 (Sat, 05 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dpnss.c

Fix what I assume is a typo in the introductory comment.

------------------------------------------------------------------------
r39736 | guy | 2011-11-04 16:59:07 -0700 (Fri, 04 Nov 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/aethra.c

Updates based on stuff seen in a new capture.

I'm leaving debug messages in, but #if 0'ed out, for now.

------------------------------------------------------------------------
r39735 | guy | 2011-11-04 11:43:23 -0700 (Fri, 04 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Get rid of non-ASCII characters in comments.

Convert "4-space tabs" to spaces.

------------------------------------------------------------------------
r39734 | etxrab | 2011-11-04 10:39:54 -0700 (Fri, 04 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Dissect RIM Routing Address Discriminator and RAN Transparent Container.
------------------------------------------------------------------------
r39733 | etxrab | 2011-11-04 10:37:38 -0700 (Fri, 04 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/s1ap/packet-s1ap-template.c
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/epan/dissectors/packet-s1ap.c

Dissect RIMInformation.
------------------------------------------------------------------------
r39732 | stig | 2011-11-04 10:02:33 -0700 (Fri, 04 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/prefs.c
   M /trunk/gtk/prefs_capture.c

Only have the option to turn off syntax check capture filter
if not using threads.
------------------------------------------------------------------------
r39731 | morriss | 2011-11-04 06:41:12 -0700 (Fri, 04 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

Terminate a value_string.
------------------------------------------------------------------------
r39730 | stig | 2011-11-04 01:15:29 -0700 (Fri, 04 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall via bug 6538:
Use CRC routines from wsutil + some Code-Clang Analysis fixes.
------------------------------------------------------------------------
r39729 | etxrab | 2011-11-03 15:01:05 -0700 (Thu, 03 Nov 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Fix GRE Key entry
------------------------------------------------------------------------
r39726 | stig | 2011-11-03 13:58:29 -0700 (Thu, 03 Nov 2011) | 3 lines
Changed paths:
   M /trunk/wsutil/CMakeLists.txt
   M /trunk/wsutil/Makefile.common
   M /trunk/wsutil/crc16.c
   M /trunk/wsutil/crc16.h
   A /trunk/wsutil/crc8.c
   A /trunk/wsutil/crc8.h
   M /trunk/wsutil/libwsutil.def

From Roland Knall via bug 6539:
Implementing generic CRC8 and CRC16 functions for openSAFETY in wsutil.

------------------------------------------------------------------------
r39725 | stig | 2011-11-03 13:38:04 -0700 (Thu, 03 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall via bug 6538:
Remove stringToBytes and use hex_str_to_bytes instead.
------------------------------------------------------------------------
r39724 | martinm | 2011-11-03 09:52:37 -0700 (Thu, 03 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

Add (most) primitive header items to the tree before calling UMTS RLC dissector.

------------------------------------------------------------------------
r39723 | sfisher | 2011-11-03 08:38:29 -0700 (Thu, 03 Nov 2011) | 8 lines
Changed paths:
   M /trunk/epan/wspython/register-dissector.py


Remove apparent debug code that causes these console messages on launch:

looking for dissectors in /usr/local/src/wireshark/epan/wspython/wspy_dissectors
looking for dissectors in /home/sfisher/.wireshark/plugins
registered protocols []


------------------------------------------------------------------------
r39722 | gerald | 2011-11-02 13:44:05 -0700 (Wed, 02 Nov 2011) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Update the list of new features.

------------------------------------------------------------------------
r39721 | gerald | 2011-11-02 13:43:10 -0700 (Wed, 02 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cisco-erspan.c

Fix spelling.

------------------------------------------------------------------------
r39720 | guy | 2011-11-02 13:21:11 -0700 (Wed, 02 Nov 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am

We have to remove svnversion.h with "make distclean".

------------------------------------------------------------------------
r39719 | stig | 2011-11-02 13:06:40 -0700 (Wed, 02 Nov 2011) | 1 line
Changed paths:
   M /trunk/gtk/dfilter_expr_dlg.c

Revert revision 39665 (for bug 6472) which introduced bug 6537.
------------------------------------------------------------------------
r39718 | etxrab | 2011-11-02 12:36:33 -0700 (Wed, 02 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

From Roland Knall:
Avoiding the fuzz-test crash, but still allowing for large parts of CIP to be dissected.

ref https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6519
------------------------------------------------------------------------
r39717 | etxrab | 2011-11-02 12:28:38 -0700 (Wed, 02 Nov 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
Remove the warnings for the Clang-Code-Analysis.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6538
------------------------------------------------------------------------
r39716 | guy | 2011-11-02 11:16:26 -0700 (Wed, 02 Nov 2011) | 12 lines
Changed paths:
   M /trunk/Makefile.am

The answer to

	XXX - "svnversion.h" is distributed in the release tarball; should
	we be deleting it with "make clean", or should we only do that with
	"make maintainer-clean"?

is probably "we should only do that with "make maintainer-clean""; see

	http://www.wireshark.org/lists/wireshark-dev/201111/msg00027.html

and followups.

------------------------------------------------------------------------
r39715 | etxrab | 2011-11-02 11:10:34 -0700 (Wed, 02 Nov 2011) | 4 lines
Changed paths:
   A /trunk/asn1/camel/CamelV2diff.asn
   M /trunk/asn1/camel/Makefile.common
   M /trunk/asn1/camel/camel.cnf
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-camel.h

Handle differences in Camel V2

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3911
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6474
------------------------------------------------------------------------
r39714 | guy | 2011-11-02 11:01:27 -0700 (Wed, 02 Nov 2011) | 2 lines
Changed paths:
   M /trunk/packaging/macosx/Makefile.am

Requiescat in pace, osx-build.sh.

------------------------------------------------------------------------
r39713 | gerald | 2011-11-02 10:36:20 -0700 (Wed, 02 Nov 2011) | 3 lines
Changed paths:
   D /trunk/packaging/macosx/osx-build.sh

Remove osx-build.sh. It was never fully ported to the Wireshark build
environment and has been unused for 3 years.

------------------------------------------------------------------------
r39712 | stig | 2011-11-02 04:01:57 -0700 (Wed, 02 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

From Andrew Kampjes via bug 6536:
Improved the Ethernet checksum field, modelled on the TCP checksum field.
------------------------------------------------------------------------
r39711 | etxrab | 2011-11-01 23:38:46 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Export NAEA-CIC to be used by Camel.
------------------------------------------------------------------------
r39710 | etxrab | 2011-11-01 23:30:25 -0700 (Tue, 01 Nov 2011) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

From Yaniv Kaul:
Many enhancements, and some fixes, to the Spice dissector:
- SASL authentication support
- indention, tab fixes
- LZ image dissection (fixing at least one TODO item)
- dissect Spice client agent data
- fix some proto_tree_add_item() offsets
- probably some more that I forgot.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6535#attach_7355
------------------------------------------------------------------------
r39709 | guy | 2011-11-01 20:45:18 -0700 (Tue, 01 Nov 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.c

Use "%g" for float as well as double.

------------------------------------------------------------------------
r39708 | guy | 2011-11-01 18:53:37 -0700 (Tue, 01 Nov 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Amazingly, there *are* apparently protocols with IPv4 addresses in
byte-swapped form - i.e., not network byte order, but the reverse of
network byte order - as, a long time ago, somebody asked to have the
"little_endian" flag affect the way proto_tree_add_item() fetched IPv4
addresses from the packet.

Use ENC_BIG_ENDIAN for IPv4 addresses (ENC_NA and ENC_BIG_ENDIAN have
the same value, but this makes it clearer that we, sadly, need to care).

------------------------------------------------------------------------
r39701 | etxrab | 2011-10-31 23:12:33 -0700 (Mon, 31 Oct 2011) | 34 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
- Renaming opensafety.msg.type to opensafety.msg.direction
- Introducing real opensafety.msg.type as opensafety.msg.category and generated
field
- Adding openSAFETY Sender and Receiver field, for all types of messages
- Adding openSAFETY Domain number and Node number as generated fields, which
allows filtering for them
- Rework PACKET_RECEIVED_BY and PACKET_SEND_FROM_TO_ALL to PACKET_RECEIVER and
PACKET_SENDER
- Replaced PACKET_SEND_FROM_TO with calls to PACKET_RECEIVER and PACKET_SENDER
- Added functions, so that the new sender and receiver fields as well as
network information are added as sub-trees
- Removed DISSECTOR_ASSERT in opensafety_get_scm_udid as it is not needed here
anymore
- Added the connection valid bit to the dissection tree ( has been there as
message type, but was never validated )
- Added calculations for Domain Network Addr, depending if a valid UDID for the
SCM is present in SSDO and SPDO
- Corrected error, where sub-tree for spdo dissection used global ssdo_tree
instead of spdo_tree
- Added "Message Type unknown" which leads to PI_MALFORMED marked entry in
dissect_opensafety_message
- Added check for ( length - frameOffset ) is below or equal zero, to avoid
using dissector asserts
- Added check for freak frame start detection, where both frame starts would be
equal (could happen during fuzztest)
- Removed DISSECTOR_ASSERT for both frame starts being different
- Added check, that if the frame address is above 1024, the package get's
marked as PI_MALFORMED (fuzztest)
- Fixed CID 1215, CID 1224 and CID 1246/1247
- Corrected naming issue with openSAFETY/SercosIII dissection using UDP
transport

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6528
------------------------------------------------------------------------
r39700 | morriss | 2011-10-31 18:23:10 -0700 (Mon, 31 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bt-utp.c
   M /trunk/epan/dissectors/packet-cip.h
   M /trunk/epan/dissectors/packet-fip.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-image-gif.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-wifi-p2p.c
   M /trunk/epan/uat.h

Remove comma at the end of several enumerator lists.
------------------------------------------------------------------------
r39699 | morriss | 2011-10-31 18:08:59 -0700 (Mon, 31 Oct 2011) | 1 line
Changed paths:
   M /trunk/aclocal-fallback/gtk-2.0.m4

When checking for GTK+2, indicate that we will *not* accept GTK 3 and later.
------------------------------------------------------------------------
r39698 | morriss | 2011-10-31 17:58:21 -0700 (Mon, 31 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Disable the CIP dissector until we can solve the fuzz failures.
------------------------------------------------------------------------
r39697 | sfisher | 2011-10-31 14:14:12 -0700 (Mon, 31 Oct 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ua.h


Fix compilation error:

    In file included from packet-uaudp.c:39:
    packet-ua.h:32:38: error: no newline at end of file


------------------------------------------------------------------------
r39696 | guy | 2011-10-31 13:44:31 -0700 (Mon, 31 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

One "packet-" suffices.

------------------------------------------------------------------------
r39695 | guy | 2011-10-31 13:43:31 -0700 (Mon, 31 Oct 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Give Iain Arnell specific credit for various ajp13 enhancements.

------------------------------------------------------------------------
r39692 | alagoutte | 2011-10-31 11:37:58 -0700 (Mon, 31 Oct 2011) | 16 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-ethertype.c
   A /trunk/epan/dissectors/packet-hsr-prp-supervision.c
   A /trunk/epan/dissectors/packet-hsr.c
   M /trunk/epan/dissectors/packet-prp.c
   M /trunk/epan/etypes.h

From Martin Renold via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5730
Dissector for HSR and PRP-1

Here is a patch that adds a dissector for HSR and for PRP-1. Both protocols are defined in IEC62439 Part 3. (High-availability Seamless Redundancy / Parallel Redundancy Protocol)

The existing PRP dissector has been refactored to support both the old PRP (now called PRP-0) and the new PRP-1.

There are three distinct dissectors:
- HSR (ethertype 892F)
- HSR/PRP supervision (ethertype 88FB)
- PRP-0 and PRP-1 (trailer dissector; disabled by default)

From me :
* Fix Clang Warning
* Add modification for CMakeLists.txt

------------------------------------------------------------------------
r39691 | alagoutte | 2011-10-31 10:26:02 -0700 (Mon, 31 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-ua.c
   A /trunk/epan/dissectors/packet-ua.h
   M /trunk/epan/dissectors/packet-uaudp.c

From Marek Tews via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6060
Enhance Universal Alcatel Protocol

Several fixes and heuristic version. You can also specify the ports (as in the previous version), if the heuristic version is not working properly.

------------------------------------------------------------------------
r39690 | etxrab | 2011-10-31 10:04:58 -0700 (Mon, 31 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/rnsap/rnsap.cnf
   M /trunk/asn1/rrc/rrc.cnf
   M /trunk/asn1/t124/t124.cnf
   M /trunk/asn1/t125/t125.cnf
   M /trunk/epan/dissectors/packet-rnsap.c
   M /trunk/epan/dissectors/packet-rrc.c
   M /trunk/epan/dissectors/packet-t124.c
   M /trunk/epan/dissectors/packet-t125.c

Try to fix warnings.
------------------------------------------------------------------------
r39687 | alagoutte | 2011-10-31 06:45:21 -0700 (Mon, 31 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cisco-erspan.c

From me via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6462 & 6505
Wireshark unable to parse ERSPAN from HP Comware platforms
Huawei GRE ERSPAN is not decoded properly 

Add a pref to FORCE to decode directly Ethernet frame in GRE (with no ERSPAN Header)

------------------------------------------------------------------------
r39686 | alagoutte | 2011-10-31 06:30:29 -0700 (Mon, 31 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-componentstatus.c

From Thomas Dreibholz via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6524
Enhancement for the Component Status Protocol dissector

The attached patch adds a dissection of the message flags field to the Component Status Protocol dissector.

------------------------------------------------------------------------
r39685 | alagoutte | 2011-10-31 05:51:25 -0700 (Mon, 31 Oct 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Add BT-DHT to the Author Xiao Xiangquan 

------------------------------------------------------------------------
r39684 | stig | 2011-10-31 01:38:49 -0700 (Mon, 31 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_pinfo.c

No need to ep_strdup a string to lua_pushstring.
------------------------------------------------------------------------
r39683 | etxrab | 2011-10-31 00:05:52 -0700 (Mon, 31 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Set the ENC_ on the remaining proto_add_item().
------------------------------------------------------------------------
r39682 | rbalint | 2011-10-30 15:46:52 -0700 (Sun, 30 Oct 2011) | 1 line
Changed paths:
   A /trunk/tools/git-compare-abis.sh

Compare current ABI to last (git) tagged version's ABI
------------------------------------------------------------------------
r39681 | stig | 2011-10-30 14:32:27 -0700 (Sun, 30 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Don't ep_strdup the protocol name when register a dissector, because
this name will be collected when loading a capture file and the name
will be gone.
------------------------------------------------------------------------
r39680 | stig | 2011-10-30 10:03:24 -0700 (Sun, 30 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Fixed some coding errors:
packet-bacapp.c:6154: error: stray '\250' in program
packet-bacapp.c:7137: warning: cast to pointer from integer of different size
------------------------------------------------------------------------
r39679 | etxrab | 2011-10-30 09:44:02 -0700 (Sun, 30 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Fix unused variable warnings.
------------------------------------------------------------------------
r39678 | etxrab | 2011-10-30 09:23:36 -0700 (Sun, 30 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netperfmeter.c

From Thomas Dreibholz:
Update the NetPerfMeter protocol dissector to the latest
version of NetPerfMeter (http://www.iem.uni-due.de/~dreibh/netperfmeter/).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6518
------------------------------------------------------------------------
r39677 | etxrab | 2011-10-30 09:19:05 -0700 (Sun, 30 Oct 2011) | 4 lines
Changed paths:
   M /trunk/acinclude.m4

From Kevin Hildebrand:
Typo in acinclude.m4 breaks Heimdal kerberos builds

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6512
------------------------------------------------------------------------
r39676 | etxrab | 2011-10-30 09:06:14 -0700 (Sun, 30 Oct 2011) | 64 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

From Lori Tribble:

I found many new properties in BACnet that were not decoded correctly in
Wireshark.  I have attached a patch that adds decoding to the following
properties:

Fixed the following properties to decode:

In the Accumulator Object:
scale (187)
prescale (185)
logging-record (184)

In Access Door Object:
door-members (228)
masked-alarm-values (234)

In the Pulse Converter Object:
input-reference (181)

In the Group Object:
list-of-group-members (53)

In the Event Enrollment Object:
object-property-reference (78)

In the Command Object:
action (2)

In the Trend Log Multiple object:
log-buffer (131)

In the Event Log Object:
log-buffer (131)

In the Structured View object:
subordinate-list (211)

Added decoding for the following enumeration type properties:
  Logging-type (197)
  event-state (36)
  reliability (103)
  notify-type (208)
  door-status (231)
  lock-status (233)
  secured-status (235)
  maintenance-required (158)
  program-state (92)
  program-change (90)
  reason-for-halt (100)
  mode (160)
  silenced (163)
  operation-expected (161)
  tracking-value (164)
  file-access-method (41)

The above fixes also fixed the log-buffer decoding of the old trend log 
recorded as Wireshark bug: #6458

I believe this patch also fixes bug: #6235.  But the original bug did not
contain a capture file so I am not positive my capture represents the
originators issue.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6475
------------------------------------------------------------------------
r39675 | etxrab | 2011-10-30 09:02:20 -0700 (Sun, 30 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ Operator Profile Resource

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6507
------------------------------------------------------------------------
r39674 | etxrab | 2011-10-30 08:57:30 -0700 (Sun, 30 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

From Pascal Quantin:
Fix dissection of PLMN List IE.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6513
------------------------------------------------------------------------
r39673 | stig | 2011-10-30 08:55:18 -0700 (Sun, 30 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Increase the size of a unknown INTEGER to FT_INT64 to be able to show
negative integers and integers up to MAXINT64.  We still don't support
integers between MAXINT64 and MAXUINT64, which would be 9 bytes long.
------------------------------------------------------------------------
r39670 | rbalint | 2011-10-30 07:24:29 -0700 (Sun, 30 Oct 2011) | 1 line
Changed paths:
   M /trunk/wireshark.desktop

pass file to wireshark in wireshark.desktop
------------------------------------------------------------------------
r39669 | gerald | 2011-10-30 07:03:25 -0700 (Sun, 30 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-10-30]
------------------------------------------------------------------------
r39668 | guy | 2011-10-29 23:47:27 -0700 (Sat, 29 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdp.c

Clang Cat is watching you fail to check for a null pointer.

------------------------------------------------------------------------
r39667 | guy | 2011-10-29 13:41:30 -0700 (Sat, 29 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Don't set mr_mult_req_info->num_services *unless we're sure
mr_mult_req_info is non-null*!  This should fix bug 6514, and possibly a
bunch of other buildbot crashes.

------------------------------------------------------------------------
r39666 | stig | 2011-10-29 11:26:57 -0700 (Sat, 29 Oct 2011) | 4 lines
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-snmp.c

Added support for big integer64 values.

This fixes bug 6295.

------------------------------------------------------------------------
r39665 | stig | 2011-10-29 03:28:58 -0700 (Sat, 29 Oct 2011) | 2 lines
Changed paths:
   M /trunk/gtk/dfilter_expr_dlg.c

Based on a patch provided by Prashanth in bug 6472:
Only have one Filter Expression window.
------------------------------------------------------------------------
r39664 | stig | 2011-10-29 02:00:18 -0700 (Sat, 29 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-integer.c

Fixed max and min in sint24_from_unparsed() again.
Note to self: don't think hex while doing something else...
------------------------------------------------------------------------
r39663 | guy | 2011-10-28 15:57:33 -0700 (Fri, 28 Oct 2011) | 8 lines
Changed paths:
   M /trunk/wiretap/aethra.c

It appears that the "packet" records are actually "stuff from the ISDN
link" records, including stuff that's from a G.704 PRI frame but not
from a D or H channel in that frame.  Handle them (currently, we ignore
them).

The low-order bit of the flags field for "packet" records" is "network
to user" (NT->TE), not "user to network" (TE->NT).

------------------------------------------------------------------------
r39662 | stig | 2011-10-28 13:57:46 -0700 (Fri, 28 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/ftypes/ftype-integer.c

Fixed max and min in sint24_from_unparsed().
------------------------------------------------------------------------
r39661 | stig | 2011-10-28 13:32:42 -0700 (Fri, 28 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/ftypes/ftype-integer.c

Fixed a typo: strtoull() -> strtoul()
------------------------------------------------------------------------
r39660 | stig | 2011-10-28 13:30:41 -0700 (Fri, 28 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/ftypes/ftype-integer.c

Simplified code for checking integer ranges.
------------------------------------------------------------------------
r39659 | stig | 2011-10-28 13:14:13 -0700 (Fri, 28 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-integer.c

Added range checking for integers and give an appropriate error
message if value is outside of range (given by field type).
------------------------------------------------------------------------
r39658 | stig | 2011-10-28 13:13:56 -0700 (Fri, 28 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dfilter/semcheck.c

Prefer previous error message if not having hfinfo->strings,
because this may give more interesting information.
------------------------------------------------------------------------
r39657 | martinm | 2011-10-28 11:59:30 -0700 (Fri, 28 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

Fix the width of a type (and hopefully please the buildbots).

------------------------------------------------------------------------
r39656 | martinm | 2011-10-28 11:36:20 -0700 (Fri, 28 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-rlc.c
   M /trunk/epan/dissectors/packet-rlc.h

First go at calling UMTS RLC dissector from IxCatapult logs.

Had to change some #defines in the header file (for UDP-framed/heuristic
dissector) - will need to update example sending program later on tonight.

------------------------------------------------------------------------
r39655 | alagoutte | 2011-10-28 10:44:01 -0700 (Fri, 28 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39654 | alagoutte | 2011-10-28 10:39:31 -0700 (Fri, 28 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-capwap.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39653 | alagoutte | 2011-10-28 07:50:13 -0700 (Fri, 28 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-bt-dht.c

From Xiao Xiangquan via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5767
BitTorrent DHT dissector for wireshark

From me :
* Fix encoding attribut for proto_tree_add_item (with fix-encodings-args script)

------------------------------------------------------------------------
r39652 | alagoutte | 2011-10-28 07:49:31 -0700 (Fri, 28 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bt-utp.c

From Xiao Xiangquan via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5767
Make bt-utp as heuristic dissectors

------------------------------------------------------------------------
r39651 | alagoutte | 2011-10-28 04:20:19 -0700 (Fri, 28 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39650 | alagoutte | 2011-10-28 03:24:57 -0700 (Fri, 28 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btsdp.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39649 | etxrab | 2011-10-27 23:22:24 -0700 (Thu, 27 Oct 2011) | 10 lines
Changed paths:
   M /trunk/epan/wspython/register-dissector.py
   M /trunk/epan/wspython/wspy_dissector.py

From Eliot:
Add runtime tracers (disabled by default) for debug.

Add runtime tracers (disabled by default) for debug.

This may be useful for ongoing development.



https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6448
------------------------------------------------------------------------
r39648 | etxrab | 2011-10-27 23:19:55 -0700 (Thu, 27 Oct 2011) | 10 lines
Changed paths:
   M /trunk/epan/wspython/wspy_dissector.py

From Eliot:
ctypes updates, minor fixes

ctypes updates, minor fixes

Explicitly use ctypes for some calls.
Remove spurious reference to homeplug.
Remove unnecessary line continuation backslashes

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6448
------------------------------------------------------------------------
r39647 | etxrab | 2011-10-27 23:18:59 -0700 (Thu, 27 Oct 2011) | 7 lines
Changed paths:
   M /trunk/epan/wspython/wspy_libws.py

From Eliot:
Define correct ctypes parameter and return types for used functions.

Define correct ctypes parameter and return types for used functions.
Particularly on 64 bit, int default doesn't work.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6448
------------------------------------------------------------------------
r39646 | etxrab | 2011-10-27 23:06:20 -0700 (Thu, 27 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtps2.c

From Adam Mitz:
The RTPS2 dissector doesn't handle octetsToNextHeader properly in INFO_RELY submessages.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6506
------------------------------------------------------------------------
r39645 | guy | 2011-10-27 19:48:52 -0700 (Thu, 27 Oct 2011) | 7 lines
Changed paths:
   M /trunk/wiretap/aethra.c

The version string field isn't followed by 20 bytes of stuff; the last 8
bytes of what we thought was a version string appears to be an 8-byte
record of some sort in the captures we originally looked at, and appears
to be a non-8-byte record in another capture.  If we treat that as a
record, the version string field appears to be null-padded and 41 bytes
long.

------------------------------------------------------------------------
r39640 | wmeier | 2011-10-27 13:30:38 -0700 (Thu, 27 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aarp.c
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-collectd.c
   M /trunk/epan/dissectors/packet-diffserv-mpls-common.c
   M /trunk/epan/dissectors/packet-dis-fields.c
   M /trunk/epan/dissectors/packet-h248_3gpp.c
   M /trunk/epan/dissectors/packet-isis-clv.c
   M /trunk/epan/dissectors/packet-pop.c
   M /trunk/epan/dissectors/packet-radius_packetcable.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-sflow.c
   M /trunk/epan/dissectors/packet-ucp.c

Fix proto_tree_add_item( encoding args;
Do whitespace cleanup (for a few files).

------------------------------------------------------------------------
r39639 | etxrab | 2011-10-27 12:20:39 -0700 (Thu, 27 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

..Filter is not used any more.
------------------------------------------------------------------------
r39637 | etxrab | 2011-10-27 09:49:53 -0700 (Thu, 27 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

Fix comparison with UAT keys.
------------------------------------------------------------------------
r39635 | wmeier | 2011-10-27 08:59:12 -0700 (Thu, 27 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-coap.c
   M /trunk/epan/dissectors/packet-evrc.c
   M /trunk/epan/dissectors/packet-ieee8021ah.c
   M /trunk/epan/dissectors/packet-mikey.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-ospf.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-pw-atm.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/dissectors/packet-tte.c

Fix some proto_tree_add_item() encoding args;
In some files:
 Remove a few unneeded #includes;
 Do some whitespace/indentation cleanup

------------------------------------------------------------------------
r39634 | etxrab | 2011-10-27 08:38:32 -0700 (Thu, 27 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

Fix indentation.
------------------------------------------------------------------------
r39633 | etxrab | 2011-10-27 08:35:48 -0700 (Thu, 27 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

The comparison with the UAT keys are broken, this is
a fix for fetching the IP address.
------------------------------------------------------------------------
r39632 | wmeier | 2011-10-27 07:50:20 -0700 (Thu, 27 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cops.c

Fix a typo.

------------------------------------------------------------------------
r39631 | morriss | 2011-10-27 07:39:12 -0700 (Thu, 27 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Correct an off-by-one error introduced in r39626.
------------------------------------------------------------------------
r39630 | morriss | 2011-10-27 07:30:57 -0700 (Thu, 27 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6498 :

Initialize cip_req_info_t.ciaData, too.

------------------------------------------------------------------------
r39629 | morriss | 2011-10-27 06:30:32 -0700 (Thu, 27 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Followup to r39626: It is also necessary to initialize the number of services
to 0 (in case we throw an exception decoding the first service).

------------------------------------------------------------------------
r39628 | guy | 2011-10-26 20:00:03 -0700 (Wed, 26 Oct 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/aethra.c

Fix cut-and-pasteo that happened not to cause a problem on *P64
platforms but failed on *P32 platforms.

Remove the debugging code (the above was the problem in question).

------------------------------------------------------------------------
r39627 | morriss | 2011-10-26 19:32:32 -0700 (Wed, 26 Oct 2011) | 4 lines
Changed paths:
   M /trunk/tools/Makefile.am
   A /trunk/tools/valgrind-wireshark.sh

Add a little shell script to export the appropriate variables necessary for
running valgrind and then run it on either tshark or (if the user is very
patient) Wireshark.

------------------------------------------------------------------------
r39626 | morriss | 2011-10-26 18:48:39 -0700 (Wed, 26 Oct 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6491 :

Don't set mr_mult_req_info->num_services until we're sure we've
initialized the full structure for that service.  Otherwise if we
happen to throw an exception before initializing the whole
structure, we'll core someplace (like dissect_cip_generic_service_rsp())
which expects all num_services entries to be fully initialized.


------------------------------------------------------------------------
r39624 | guy | 2011-10-26 16:41:15 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/aethra.c

Add some debugging code; the current code doesn't work when compiled
with MSVC on Win32, and the fix will remove the debugging code as well.

------------------------------------------------------------------------
r39623 | wmeier | 2011-10-26 16:16:04 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Fix a [-Wunused-but-set-variable] compiler warning;
Also: Remove trailing whitespace from lines.

------------------------------------------------------------------------
r39621 | etxrab | 2011-10-26 14:42:45 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

The comparison with the UAT keys are broken, this is
a fix for the SPI the src and dst IP address strings needs fixing too.
I'll look into that tomorrow if no one beats me too it.
------------------------------------------------------------------------
r39620 | tuexen | 2011-10-26 13:58:05 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Declare unused parameters as such. Don't assign them to themselves.

------------------------------------------------------------------------
r39619 | guy | 2011-10-26 13:53:27 -0700 (Wed, 26 Oct 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/aethra.c

Put the magic number into the aethra_hdr structure, to avoid compiler
padding of the structure getting in the way (it should now not require
padding).

------------------------------------------------------------------------
r39618 | wmeier | 2011-10-26 13:43:58 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

Fix proto_tree_add_item() encoding args.

------------------------------------------------------------------------
r39617 | wmeier | 2011-10-26 13:25:00 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtps.c

Fix a proto_tree_add_item() encoding areg;
Use gboolean instead of int in certain cases.

------------------------------------------------------------------------
r39616 | wmeier | 2011-10-26 13:06:48 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtps2.c

Fix proto_tree_add_item() encoding args;
Use gboolean instead of int in certain cases.

------------------------------------------------------------------------
r39615 | wmeier | 2011-10-26 12:24:58 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtps.c

Fix proto_tree_add_item() encoding args.

------------------------------------------------------------------------
r39614 | wmeier | 2011-10-26 11:57:02 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Fix proto_tree_add_item() encoding args;
Also: remove unneeded #include.

------------------------------------------------------------------------
r39613 | wmeier | 2011-10-26 11:38:09 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lmp.c

Fix some proto_tree_add_item() encoding args.

------------------------------------------------------------------------
r39612 | wmeier | 2011-10-26 11:11:24 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-catapult-dct2000.c

Fix some proto_tree_add_item() encoding args;
Remove some unneeded #includes.

------------------------------------------------------------------------
r39611 | alagoutte | 2011-10-26 11:02:17 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btobex.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39610 | alagoutte | 2011-10-26 11:02:01 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cpha.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39609 | alagoutte | 2011-10-26 11:01:42 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h263p.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39608 | alagoutte | 2011-10-26 11:01:25 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-srvloc.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39607 | alagoutte | 2011-10-26 11:01:12 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ctdb.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39606 | alagoutte | 2011-10-26 11:00:54 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-amqp.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39605 | wmeier | 2011-10-26 10:04:26 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-infiniband.c

Add missing hf[] entries (and fix proto_tree_add_item() encoding args).

------------------------------------------------------------------------
r39604 | alagoutte | 2011-10-26 08:53:25 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-brp.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39603 | stig | 2011-10-26 05:15:07 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-enip.c

Removed duplicate enip.connection_transport_data entry.

This fixes bug 6490.
------------------------------------------------------------------------
r39602 | martinm | 2011-10-26 03:09:20 -0700 (Wed, 26 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-enip.h

Add a newline at the end of this file.

------------------------------------------------------------------------
r39601 | stig | 2011-10-26 01:34:10 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-integer.c

Fixed compare functions for 64 bits integers:
- Do not cast unsigned values to signed
- Do cast signed values from the internal stored unsigned
------------------------------------------------------------------------
r39600 | etxrab | 2011-10-25 23:23:39 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/t124/t124.cnf
   M /trunk/epan/dissectors/packet-t124.c

Try to get rid of defined but not used warnings.
------------------------------------------------------------------------
r39599 | etxrab | 2011-10-25 23:14:53 -0700 (Tue, 25 Oct 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Try to fix
cc1: warnings being treated as errors
packet-cip.c: In function 'dissect_cip_generic_service_req':
packet-cip.c:3281: warning: format not a string literal and no format arguments
packet-cip.c: In function 'dissect_cip_generic_service_rsp':
packet-cip.c:3631: warning: format not a string literal and no format arguments
packet-cip.c: In function 'dissect_cip_data':
packet-cip.c:4881: warning: comparison between signed and unsigned
------------------------------------------------------------------------
r39597 | etxrab | 2011-10-25 22:07:57 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/diameter/Cisco.xml

White space changes.
------------------------------------------------------------------------
r39596 | etxrab | 2011-10-25 22:03:26 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/radius/dictionary.iea

Extended with VSA:s from Peter Deacon  trough
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6486
------------------------------------------------------------------------
r39595 | etxrab | 2011-10-25 21:55:21 -0700 (Tue, 25 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cip.h
   M /trunk/epan/dissectors/packet-cipmotion.c
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-enip.h

From Michael Mann:
Improved CIP and ENIP dissectors

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6416
------------------------------------------------------------------------
r39594 | guy | 2011-10-25 21:53:48 -0700 (Tue, 25 Oct 2011) | 3 lines
Changed paths:
   M /trunk/doc/wireshark.pod.template
   M /trunk/docbook/wsug_src/WSUG_chapter_io.xml

Sync up the file format lists, add the Aethra files, and promote pcap-ng
to come right after pcap and not to be tagged as experimental.

------------------------------------------------------------------------
r39593 | guy | 2011-10-25 21:51:48 -0700 (Tue, 25 Oct 2011) | 4 lines
Changed paths:
   M /trunk/README

Get rid of the list of capture file formats, so we have one fewer list
that we can fail to update.  Point the user at the Wireshark man page,
instead.

------------------------------------------------------------------------
r39592 | guy | 2011-10-25 21:31:06 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/CMakeLists.txt

Add the code to read Aethra files.

------------------------------------------------------------------------
r39591 | guy | 2011-10-25 21:05:17 -0700 (Tue, 25 Oct 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/aethra.c

Ok, we found what appears to be the capture start time.  Use it.

Also mark what appear to be strings in the file header.

------------------------------------------------------------------------
r39590 | guy | 2011-10-25 20:14:21 -0700 (Tue, 25 Oct 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/aethra.c

It appears that the octet in the record header after the record length
might be a record type, with 0 being a "Stop Monitor" record and 1 being
a packet.  Ignore records other than packet records.

------------------------------------------------------------------------
r39589 | guy | 2011-10-25 19:37:45 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/aethra.c

Avoid warnings.

------------------------------------------------------------------------
r39588 | guy | 2011-10-25 19:18:55 -0700 (Tue, 25 Oct 2011) | 14 lines
Changed paths:
   M /trunk/wiretap/Makefile.common
   A /trunk/wiretap/aethra.c
   A /trunk/wiretap/aethra.h
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.h

Initial support for .aps files from Aethra Telecommunications' PC108
software.  More work is needed:

	we don't know where the capture start time is yet;

	we aren't handling the "stop capture" record;

	we don't know where the ISDN channel is;

	there might be non-ISDN file formats;

but this at least is easier than trying to text2pcap hex dumps from that
software into pcap files.

------------------------------------------------------------------------
r39587 | morriss | 2011-10-25 18:42:55 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/doc/README.developer

Fix a spelling mistake.  Wrap a few long lines.
------------------------------------------------------------------------
r39582 | gerald | 2011-10-25 15:03:54 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Forward-port r39581 from the 1.6 trunk.

------------------------------------------------------------------------
r39580 | wmeier | 2011-10-25 13:16:26 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c

Fix proto_tree_add_item() encoding args.

------------------------------------------------------------------------
r39579 | etxrab | 2011-10-25 13:08:26 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-eigrp.c
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-ipdc.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-netflow.c

Fix some set but not used [-Wunused-but-set-variable] warnings.
------------------------------------------------------------------------
r39578 | wmeier | 2011-10-25 12:26:46 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldp.c

Fix proto_tree_add_item() encoding args.

------------------------------------------------------------------------
r39577 | wmeier | 2011-10-25 12:19:01 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppi.c

Fix an encoding arg

------------------------------------------------------------------------
r39575 | etxrab | 2011-10-25 12:15:55 -0700 (Tue, 25 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

From Pascal Quantin.
wrong decoding of Activate default EPS bearer context request message containing a IPv6 interface id.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6484
------------------------------------------------------------------------
r39574 | etxrab | 2011-10-25 12:10:34 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Custom.nmake
   M /trunk/epan/dissectors/Makefile.common

Make Custom.nmake usable.
(Should it be Custom_make.common or something like that)
------------------------------------------------------------------------
r39572 | gerald | 2011-10-25 12:04:26 -0700 (Tue, 25 Oct 2011) | 3 lines
Changed paths:
   M /trunk/Makefile.am

In dist-hook, don't try to copy version.conf if it already exists in the
destination directory.

------------------------------------------------------------------------
r39571 | stig | 2011-10-25 12:04:10 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/wslua/wslua_proto.c

Allow signed integers displayed as BASE_HEX_DEC.
------------------------------------------------------------------------
r39570 | wmeier | 2011-10-25 11:51:57 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rmt-norm.c

Fix proto_tree_add_item() encoding args.

------------------------------------------------------------------------
r39569 | stig | 2011-10-25 10:58:08 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/proto.c

Display BASE_DEC_HEX correct for int64/uint64.
------------------------------------------------------------------------
r39568 | wmeier | 2011-10-25 10:27:48 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Update information about 'encoding' arg values for particular field-types.

------------------------------------------------------------------------
r39567 | wmeier | 2011-10-25 10:04:48 -0700 (Tue, 25 Oct 2011) | 3 lines
Changed paths:
   M /trunk/tools/fix-encoding-args.pl

Add encoding arg fix capability for proto_tree_add_bits_item,...,tvb_get_bits,...ptvcursor_add,...
Add 'find-all' capability.

------------------------------------------------------------------------
r39566 | wmeier | 2011-10-25 09:04:31 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-homeplug-av.c
   M /trunk/epan/dissectors/packet-homeplug.c
   M /trunk/epan/dissectors/packet-omapi.c
   M /trunk/epan/dissectors/packet-pgm.c
   M /trunk/epan/dissectors/packet-ppi.c
   M /trunk/epan/dissectors/packet-roofnet.c
   M /trunk/epan/dissectors/packet-vicp.c

Fix encoding arg for ptvcursor_add() and ptvcursor_add_noadvance() function calls.

------------------------------------------------------------------------
r39565 | wmeier | 2011-10-25 08:53:29 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-spoolss.c

Fix encoding arg for call to tvb_get_unicode_string().

------------------------------------------------------------------------
r39564 | cmaynard | 2011-10-25 07:19:34 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dfilter/sttype-test.c

Fix Coverity CID 432, "Missing Break".

------------------------------------------------------------------------
r39563 | stig | 2011-10-25 04:20:54 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Added another Lua warning:
- FT_FRAMENUM can not have a bitmask.
------------------------------------------------------------------------
r39562 | stig | 2011-10-25 04:13:11 -0700 (Tue, 25 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Added Lua error messages when:
- Adding a INT64/UINT64 field with a value string (currently unsupported).
- Trying to display a signed integer as hexadecimal.
------------------------------------------------------------------------
r39561 | stig | 2011-10-25 03:55:52 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/proto.c

Added missing support for FT_INT64 in proto_tree_add_bits_format_value().
------------------------------------------------------------------------
r39560 | stig | 2011-10-25 03:48:20 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/proto.c

Simplified code checking if FT_UINT64 is displayed as BASE_NONE.
------------------------------------------------------------------------
r39559 | stig | 2011-10-25 03:48:11 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/proto.c

Allow signed integers displayed as DEC_HEX.
------------------------------------------------------------------------
r39558 | stig | 2011-10-25 03:48:03 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/proto.c

Fixed using signed 64-bits integer in custom column.
------------------------------------------------------------------------
r39557 | stig | 2011-10-25 03:26:30 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.c

Revert "Allow value_strings for FT_INT64 and FT_UINT64.", as we
haven't generic support for value_strings for 64-bit values yet.
------------------------------------------------------------------------
r39556 | stig | 2011-10-25 00:46:25 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/proto.c

Allow value_strings for FT_INT64 and FT_UINT64.
------------------------------------------------------------------------
r39555 | guy | 2011-10-24 23:08:16 -0700 (Mon, 24 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

Add missing semicolon.

------------------------------------------------------------------------
r39554 | etxrab | 2011-10-24 22:47:07 -0700 (Mon, 24 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/t124/t124.cnf
   M /trunk/asn1/t125/t125.cnf
   M /trunk/epan/dissectors/packet-t124.c
   M /trunk/epan/dissectors/packet-t125.c

 Try to get rid of "defined but not used" warnings.
------------------------------------------------------------------------
r39553 | etxrab | 2011-10-24 22:46:31 -0700 (Mon, 24 Oct 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

From Neil Piercy:

The binary display and decimal values are corrupt in the case where they are
"stitched" together from words and octets: the complete words are extracted
ready for LSB padding, but when the final octet/word is added (also so
extracted), the data already present is shifted by a whole number of octets
(not allowing for the padding), and the value is then used by the binary and
decimal display functions as if it were MSB padded. This results in both a
corrupt bit pattern and wrong padding of the bit pattern in the display.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6473
------------------------------------------------------------------------
r39551 | morriss | 2011-10-24 18:28:00 -0700 (Mon, 24 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-imap.c

From Michael Mann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6446 :

Add some filters to the IMAP dissector (proto_tree_add_text() ->
proto_tree_add_item()).

------------------------------------------------------------------------
r39550 | morriss | 2011-10-24 18:13:21 -0700 (Mon, 24 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smtp.c

From Michael Mann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6470 :

Add some filters to the SMTP dissector (proto_tree_add_text() ->
proto_tree_add_item()).

------------------------------------------------------------------------
r39549 | morriss | 2011-10-24 17:51:58 -0700 (Mon, 24 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bgp.h

From Thomas Loockx via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6324 :

I've updated the bgp dissector code to support the mcast-vpn nlri. These nlri's
are used to implement multicast vpn (mvpn) and are fully described in
draft-ietf-l3vpn-2547bis-mcast-bgp-08.txt (section 4).

------------------------------------------------------------------------
r39548 | wmeier | 2011-10-24 17:09:52 -0700 (Mon, 24 Oct 2011) | 3 lines
Changed paths:
   M /trunk/docbook/Makefile.am

From Ed Beroset: Fix a typo in Makefile
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6482

------------------------------------------------------------------------
r39547 | wmeier | 2011-10-24 17:03:47 -0700 (Mon, 24 Oct 2011) | 7 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_dissection.xml

From Ed Beroset: updated examples to use ENC_BIG_ENDIAN instead of FALSE.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6482

From me:
 - Use ENC_NA for proto_tree_add_item(...,proto_foo,...);
 - Also: fix a typo unrelated to Ed's patch.

------------------------------------------------------------------------
r39545 | wmeier | 2011-10-24 16:18:34 -0700 (Mon, 24 Oct 2011) | 2 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_tools.xml

Update compiler & redistributable information.

------------------------------------------------------------------------
r39540 | wmeier | 2011-10-24 13:18:01 -0700 (Mon, 24 Oct 2011) | 2 lines
Changed paths:
   M /trunk/asn1/sv/packet-sv-template.c
   M /trunk/epan/dissectors/packet-sv.c

Fix encoding arg for a proto_tree_add_bitmask() function call.

------------------------------------------------------------------------
r39539 | wmeier | 2011-10-24 12:57:53 -0700 (Mon, 24 Oct 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-6lowpan.c
   M /trunk/epan/dissectors/packet-ansi_801.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-ayiya.c
   M /trunk/epan/dissectors/packet-capwap.c
   M /trunk/epan/dissectors/packet-csn1.c
   M /trunk/epan/dissectors/packet-eigrp.c
   M /trunk/epan/dissectors/packet-fcels.c
   M /trunk/epan/dissectors/packet-fip.c
   M /trunk/epan/dissectors/packet-fp_hint.c
   M /trunk/epan/dissectors/packet-giop.c
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-gsm_a_rr.c
   M /trunk/epan/dissectors/packet-h263.c
   M /trunk/epan/dissectors/packet-h264.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ipmi-app.c
   M /trunk/epan/dissectors/packet-ipmi-picmg.c
   M /trunk/epan/dissectors/packet-ismacryp.c
   M /trunk/epan/dissectors/packet-lon.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-maccontrol.c
   M /trunk/epan/dissectors/packet-mp4ves.c
   M /trunk/epan/dissectors/packet-mrp-msrp.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-omron-fins.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-scsi-mmc.c
   M /trunk/epan/dissectors/packet-scsi-sbc.c
   M /trunk/epan/dissectors/packet-scsi-smc.c
   M /trunk/epan/dissectors/packet-scsi-ssc.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-tdmoe.c
   M /trunk/epan/dissectors/packet-tn3270.c
   M /trunk/epan/dissectors/packet-tn5250.c
   M /trunk/epan/dissectors/packet-trill.c
   M /trunk/epan/dissectors/packet-turbocell.c
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-xmcp.c

Fix encoding arg for various fcn calls:
 - proto_tree_add_bits_item
 - proto_tree_add_bits_ret_val
 - proto_tree_add_bitmask
 - tvb_get_bits
 - tvb_get_bits16
 - tvb_get_bits24
 - tvb_get_bits32
 - tvb_get_bits64


------------------------------------------------------------------------
r39538 | wmeier | 2011-10-24 12:52:43 -0700 (Mon, 24 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h

Convert proto_tree_add_bitmask(), proto_tree_add_bitmask_text(), proto_tree_add_bitmask_tree() to have 'encoding' arg rather than 'little_endian' arg

------------------------------------------------------------------------
r39536 | wmeier | 2011-10-24 10:36:20 -0700 (Mon, 24 Oct 2011) | 2 lines
Changed paths:
   M /trunk/tools/fix-encoding-args.pl

Fix bug (introduced in SVN #39504) which caused only 1st file of a list to be processed.

------------------------------------------------------------------------
r39535 | etxrab | 2011-10-24 09:37:07 -0700 (Mon, 24 Oct 2011) | 8 lines
Changed paths:
   M /trunk/epan/wspython/wspy_dissector.py
   M /trunk/epan/wspython/wspy_register.c

From Eliot:
Change to python support functions.

Avoid passing C dissector callback via python to create_dissector_handle.
This caused problems at least on 64 bit linux.

Get all dissector args in one call.  Simplifies common usage.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6448
------------------------------------------------------------------------
r39534 | etxrab | 2011-10-24 09:33:01 -0700 (Mon, 24 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/wspython/register-dissector.py
   M /trunk/epan/wspython/wspy_register.c

From Eliot:
Search personal plugins dir for python plugins

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6448
------------------------------------------------------------------------
r39533 | etxrab | 2011-10-24 09:18:08 -0700 (Mon, 24 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dec-dnart.c

fix Wunused-but-set-variable warnings.
------------------------------------------------------------------------
r39532 | cmaynard | 2011-10-24 05:58:48 -0700 (Mon, 24 Oct 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Fix Giorgio Tino's e-mail address and change Nessjoen's @ to [AT] like everyone else.

------------------------------------------------------------------------
r39531 | wmeier | 2011-10-23 16:13:57 -0700 (Sun, 23 Oct 2011) | 4 lines
Changed paths:
   M /trunk/asn1/x509sat/x509sat.cnf
   M /trunk/epan/dissectors/packet-x509sat.c

Replace use of tvb_get_ephemeral_faked_unicode() by use of tvb_get_ephemeral_unicode_string();
Fix encoding arg.


------------------------------------------------------------------------
r39530 | wmeier | 2011-10-23 15:58:45 -0700 (Sun, 23 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dtpt.c
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_sms.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-ms-mms.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-rdp.c
   M /trunk/epan/dissectors/packet-srvloc.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-tnef.c
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-xml.c

Replace use of tvb_get_ephemeral_faked_unicode() by use of tvb_get_ephemeral_unicode_string();
Fix encoding arg as needed.

------------------------------------------------------------------------
r39529 | guy | 2011-10-23 15:49:11 -0700 (Sun, 23 Oct 2011) | 11 lines
Changed paths:
   M /trunk/doc/text2pcap.pod

Speak of a "link-layer header type" rather than a "link-layer type"; a
given link-layer type, e.g. 802.11, might have multiple header types
(802.11, 802.11 plus various radio headers, Ethernet), and multiple
link-layer types might have the same header type (802.11 interfaces
might supply Ethernet headers, and Linux loopback interfaces supply
Ethernet headers as well).

Point to tcpdump.org's page of link-layer header types, rather than to
the net/bpf.h header that 1) might not exist on your system and 2) might
not be up-to-date if it does exist.

------------------------------------------------------------------------
r39528 | wmeier | 2011-10-23 15:02:56 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.c

Add a comment about tvb_get_ephemeral_faked_unicode() has been replaced by tvb_get_ephemeral_unicode_string().

------------------------------------------------------------------------
r39527 | wmeier | 2011-10-23 13:50:48 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-assa_r3.c

Fix a proto_tree_add_item() encoding arg.

------------------------------------------------------------------------
r39526 | wmeier | 2011-10-23 13:50:12 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mim.c

Remove some unneeded lines of code.

------------------------------------------------------------------------
r39525 | wmeier | 2011-10-23 13:49:19 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hdfs.c

Remove an unneeded #include.

------------------------------------------------------------------------
r39524 | wmeier | 2011-10-23 13:48:47 -0700 (Sun, 23 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcdns.c

Fix a proto_tree_add_item() encoding arg;
Remove some unneeded #includes.

------------------------------------------------------------------------
r39523 | etxrab | 2011-10-23 13:42:29 -0700 (Sun, 23 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/t125/t125.cnf
   M /trunk/epan/dissectors/packet-t125.c

 Try to get rid of "defined but not used" warnings.
------------------------------------------------------------------------
r39522 | etxrab | 2011-10-23 13:24:23 -0700 (Sun, 23 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/t124/packet-t124-template.c
   M /trunk/asn1/t124/t124.cnf
   M /trunk/epan/dissectors/packet-t124.c

Try to get rid of "defined but not used" warnings.
------------------------------------------------------------------------
r39521 | stig | 2011-10-23 12:44:44 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/asn1/lppa

Set svn:ignore targets.

------------------------------------------------------------------------
r39520 | etxrab | 2011-10-23 11:52:57 -0700 (Sun, 23 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common

Remove csg added by mistake.
------------------------------------------------------------------------
r39519 | wmeier | 2011-10-23 11:48:50 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-usb-hid.c
   M /trunk/epan/dissectors/packet-windows-common.c

Fix a few proto_tree_add_item() encoding args.

------------------------------------------------------------------------
r39518 | guy | 2011-10-23 11:27:07 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Get rid of trailing backslash on last element of a list.

------------------------------------------------------------------------
r39517 | etxrab | 2011-10-23 11:06:53 -0700 (Sun, 23 Oct 2011) | 5 lines
Changed paths:
   A /trunk/epan/dissectors/packet-lppa.c

From Pascal Quantin.
The attached patch adds the LPPa (LTE Positioning Protocol A) dissector as
specified in 3GPP 36.455 release 9.4.1.
(Part 2)
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6478
------------------------------------------------------------------------
r39516 | etxrab | 2011-10-23 11:05:07 -0700 (Sun, 23 Oct 2011) | 5 lines
Changed paths:
   M /trunk/asn1/Makefile.am
   M /trunk/asn1/Makefile.nmake
   M /trunk/asn1/lcsap/lcsap.cnf
   M /trunk/asn1/lcsap/packet-lcsap-template.c
   M /trunk/asn1/s1ap/packet-s1ap-template.c
   M /trunk/asn1/s1ap/s1ap.cnf
   M /trunk/configure.in
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-lcsap.c
   M /trunk/epan/dissectors/packet-s1ap.c

From Pascal Quantin.
The attached patch adds the LPPa (LTE Positioning Protocol A) dissector as
specified in 3GPP 36.455 release 9.4.1.
(Part 2)
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6478
------------------------------------------------------------------------
r39515 | etxrab | 2011-10-23 10:58:45 -0700 (Sun, 23 Oct 2011) | 5 lines
Changed paths:
   A /trunk/asn1/lppa
   A /trunk/asn1/lppa/LPPA-Common.asn
   A /trunk/asn1/lppa/LPPA-Constant.asn
   A /trunk/asn1/lppa/LPPA-Container.asn
   A /trunk/asn1/lppa/LPPA-ElementaryProcedure.asn
   A /trunk/asn1/lppa/LPPA-InformationElement.asn
   A /trunk/asn1/lppa/LPPA-PDU.asn
   A /trunk/asn1/lppa/Makefile.am
   A /trunk/asn1/lppa/Makefile.common
   A /trunk/asn1/lppa/Makefile.nmake
   A /trunk/asn1/lppa/lppa.cnf
   A /trunk/asn1/lppa/packet-lppa-template.c

From Pascal Quantin.
The attached patch adds the LPPa (LTE Positioning Protocol A) dissector as
specified in 3GPP 36.455 release 9.4.1.
(Just adding the asn1 dir)
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6478
------------------------------------------------------------------------
r39514 | wmeier | 2011-10-23 10:11:39 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi-se.c
   M /trunk/epan/dissectors/packet-ms-mms.c
   M /trunk/epan/dissectors/packet-netbios.c
   M /trunk/epan/dissectors/packet-smb-browse.c

Fix a few proto_tree_add_item() encoding args.

------------------------------------------------------------------------
r39513 | wmeier | 2011-10-23 10:10:59 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-rdp.c

(Trivial) Whitespace cleanup.

------------------------------------------------------------------------
r39510 | stig | 2011-10-23 07:06:17 -0700 (Sun, 23 Oct 2011) | 5 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Set default focus to the filter text box.

Don't use a tree view for IP addresses, as it's not possible to
do any actions on them.  Just list them as labels.  Maybe we should
have the scrolled window only if having more than 2 IP addresses?
------------------------------------------------------------------------
r39509 | gerald | 2011-10-23 07:03:27 -0700 (Sun, 23 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-10-23]
------------------------------------------------------------------------
r39508 | gerald | 2011-10-21 12:07:42 -0700 (Fri, 21 Oct 2011) | 6 lines
Changed paths:
   M /trunk/wiretap/erf.c

From Huzaifa Sidhpurwala of Red Hat Security Response Team:

I found a heap-based buffer overflow, when parsing ERF file format.
The overflow seems to be controlled by the values read from the file, 
and hence seems exploitable to me.

------------------------------------------------------------------------
r39507 | wmeier | 2011-10-21 07:33:43 -0700 (Fri, 21 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi-mmc.c
   M /trunk/epan/dissectors/packet-scsi-osd.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-ssl.c

Fix a few proto_tree_add_item() encoding args manually.
Some whitespace cleanup.

------------------------------------------------------------------------
r39506 | jake | 2011-10-21 01:32:10 -0700 (Fri, 21 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtps2.c

Fix for bug 6449:
Last RTPS2 submessage could have zero as octets_to_next_header.

From me: coding style unused parameters.

------------------------------------------------------------------------
r39505 | wmeier | 2011-10-20 19:54:58 -0700 (Thu, 20 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Fix two proto_tree_add_item() encoding args not handled by fix-encoding-arg.

------------------------------------------------------------------------
r39504 | wmeier | 2011-10-20 19:34:05 -0700 (Thu, 20 Oct 2011) | 2 lines
Changed paths:
   M /trunk/tools/fix-encoding-args.pl

Exit with number of lines needing an encoding arg change.

------------------------------------------------------------------------
r39503 | wmeier | 2011-10-20 19:10:19 -0700 (Thu, 20 Oct 2011) | 3 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/asn1/ansi_tcap/packet-ansi_tcap-template.c
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/asn1/cmip/packet-cmip-template.c
   M /trunk/asn1/cmp/packet-cmp-template.c
   M /trunk/asn1/goose/packet-goose-template.c
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/h282/packet-h282-template.c
   M /trunk/asn1/h283/packet-h283-template.c
   M /trunk/asn1/h501/packet-h501-template.c
   M /trunk/asn1/hnbap/packet-hnbap-template.c
   M /trunk/asn1/idmp/packet-idmp-template.c
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/asn1/kerberos/packet-kerberos-template.c
   M /trunk/asn1/lcsap/packet-lcsap-template.c
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/asn1/mms/packet-mms-template.c
   M /trunk/asn1/mpeg-pes/packet-mpeg-pes-template.c
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/asn1/ocsp/packet-ocsp-template.c
   M /trunk/asn1/pcap/packet-pcap-template.c
   M /trunk/asn1/pkixtsp/packet-pkixtsp-template.c
   M /trunk/asn1/qsig/packet-qsig-template.c
   M /trunk/asn1/ranap/packet-ranap-template.c
   M /trunk/asn1/rrc/packet-rrc-template.c
   M /trunk/asn1/rua/packet-rua-template.c
   M /trunk/asn1/s1ap/packet-s1ap-template.c
   M /trunk/asn1/sabp/packet-sabp-template.c
   M /trunk/asn1/smrse/packet-smrse-template.c
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/asn1/spnego/packet-spnego-template.c
   M /trunk/asn1/sv/packet-sv-template.c
   M /trunk/asn1/t124/packet-t124-template.c
   M /trunk/asn1/t125/packet-t125-template.c
   M /trunk/asn1/x2ap/packet-x2ap-template.c
   M /trunk/epan/dissectors/packet-2dparityfec.c
   M /trunk/epan/dissectors/packet-3com-njack.c
   M /trunk/epan/dissectors/packet-3com-xns.c
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-acap.c
   M /trunk/epan/dissectors/packet-actrace.c
   M /trunk/epan/dissectors/packet-agentx.c
   M /trunk/epan/dissectors/packet-airopeek.c
   M /trunk/epan/dissectors/packet-alcap.c
   M /trunk/epan/dissectors/packet-amqp.c
   M /trunk/epan/dissectors/packet-amr.c
   M /trunk/epan/dissectors/packet-ancp.c
   M /trunk/epan/dissectors/packet-ans.c
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-ansi_tcap.c
   M /trunk/epan/dissectors/packet-aoe.c
   M /trunk/epan/dissectors/packet-app-pkix-cert.c
   M /trunk/epan/dissectors/packet-applemidi.c
   M /trunk/epan/dissectors/packet-arcnet.c
   M /trunk/epan/dissectors/packet-armagetronad.c
   M /trunk/epan/dissectors/packet-artnet.c
   M /trunk/epan/dissectors/packet-aruba-adp.c
   M /trunk/epan/dissectors/packet-aruba-erm.c
   M /trunk/epan/dissectors/packet-aruba-papi.c
   M /trunk/epan/dissectors/packet-asf.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-atalk.c
   M /trunk/epan/dissectors/packet-atm.c
   M /trunk/epan/dissectors/packet-auto_rp.c
   M /trunk/epan/dissectors/packet-ax4000.c
   M /trunk/epan/dissectors/packet-bacapp.c
   M /trunk/epan/dissectors/packet-bacnet.c
   M /trunk/epan/dissectors/packet-banana.c
   M /trunk/epan/dissectors/packet-bat.c
   M /trunk/epan/dissectors/packet-batadv.c
   M /trunk/epan/dissectors/packet-bctp.c
   M /trunk/epan/dissectors/packet-beep.c
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-bofl.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-brp.c
   M /trunk/epan/dissectors/packet-bssap.c
   M /trunk/epan/dissectors/packet-bt-utp.c
   M /trunk/epan/dissectors/packet-btamp.c
   M /trunk/epan/dissectors/packet-bthci_acl.c
   M /trunk/epan/dissectors/packet-bthci_cmd.c
   M /trunk/epan/dissectors/packet-bthci_evt.c
   M /trunk/epan/dissectors/packet-bthci_sco.c
   M /trunk/epan/dissectors/packet-btl2cap.c
   M /trunk/epan/dissectors/packet-btobex.c
   M /trunk/epan/dissectors/packet-btrfcomm.c
   M /trunk/epan/dissectors/packet-btsdp.c
   M /trunk/epan/dissectors/packet-bvlc.c
   M /trunk/epan/dissectors/packet-calcappprotocol.c
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-capwap.c
   M /trunk/epan/dissectors/packet-cast.c
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-ccsds.c
   M /trunk/epan/dissectors/packet-cdp.c
   M /trunk/epan/dissectors/packet-cfm.c
   M /trunk/epan/dissectors/packet-cgmp.c
   M /trunk/epan/dissectors/packet-chdlc.c
   M /trunk/epan/dissectors/packet-cimd.c
   M /trunk/epan/dissectors/packet-cimetrics.c
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cipmotion.c
   M /trunk/epan/dissectors/packet-cisco-erspan.c
   M /trunk/epan/dissectors/packet-cisco-sm.c
   M /trunk/epan/dissectors/packet-cisco-wids.c
   M /trunk/epan/dissectors/packet-classicstun.c
   M /trunk/epan/dissectors/packet-clnp.c
   M /trunk/epan/dissectors/packet-cmip.c
   M /trunk/epan/dissectors/packet-cmp.c
   M /trunk/epan/dissectors/packet-cmpp.c
   M /trunk/epan/dissectors/packet-cnip.c
   M /trunk/epan/dissectors/packet-coap.c
   M /trunk/epan/dissectors/packet-collectd.c
   M /trunk/epan/dissectors/packet-componentstatus.c
   M /trunk/epan/dissectors/packet-cops.c
   M /trunk/epan/dissectors/packet-cpfi.c
   M /trunk/epan/dissectors/packet-cpha.c
   M /trunk/epan/dissectors/packet-csm-encaps.c
   M /trunk/epan/dissectors/packet-cups.c
   M /trunk/epan/dissectors/packet-daap.c
   M /trunk/epan/dissectors/packet-daytime.c
   M /trunk/epan/dissectors/packet-db-lsp.c
   M /trunk/epan/dissectors/packet-dcc.c
   M /trunk/epan/dissectors/packet-dccp.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-dcp-etsi.c
   M /trunk/epan/dissectors/packet-ddtp.c
   M /trunk/epan/dissectors/packet-dec-bpdu.c
   M /trunk/epan/dissectors/packet-dec-dnart.c
   M /trunk/epan/dissectors/packet-dect.c
   M /trunk/epan/dissectors/packet-dhcp-failover.c
   M /trunk/epan/dissectors/packet-dhcpv6.c
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-distcc.c
   M /trunk/epan/dissectors/packet-dlm3.c
   M /trunk/epan/dissectors/packet-dlsw.c
   M /trunk/epan/dissectors/packet-dnp.c
   M /trunk/epan/dissectors/packet-dplay.c
   M /trunk/epan/dissectors/packet-dpnss-link.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-dtn.c
   M /trunk/epan/dissectors/packet-dtp.c
   M /trunk/epan/dissectors/packet-dtpt.c
   M /trunk/epan/dissectors/packet-dvmrp.c
   M /trunk/epan/dissectors/packet-e100.c
   M /trunk/epan/dissectors/packet-eap.c
   M /trunk/epan/dissectors/packet-eapol.c
   M /trunk/epan/dissectors/packet-echo.c
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-egd.c
   M /trunk/epan/dissectors/packet-ehs.c
   M /trunk/epan/dissectors/packet-enttec.c
   M /trunk/epan/dissectors/packet-epl.c
   M /trunk/epan/dissectors/packet-epl_v1.c
   M /trunk/epan/dissectors/packet-epmd.c
   M /trunk/epan/dissectors/packet-erf.c
   M /trunk/epan/dissectors/packet-erldp.c
   M /trunk/epan/dissectors/packet-esio.c
   M /trunk/epan/dissectors/packet-esis.c
   M /trunk/epan/dissectors/packet-eth.c
   M /trunk/epan/dissectors/packet-evrc.c
   M /trunk/epan/dissectors/packet-exec.c
   M /trunk/epan/dissectors/packet-extreme.c
   M /trunk/epan/dissectors/packet-fcgi.c
   M /trunk/epan/dissectors/packet-fefd.c
   M /trunk/epan/dissectors/packet-ff.c
   M /trunk/epan/dissectors/packet-fix.c
   M /trunk/epan/dissectors/packet-flip.c
   M /trunk/epan/dissectors/packet-fmtp.c
   M /trunk/epan/dissectors/packet-fp_hint.c
   M /trunk/epan/dissectors/packet-fractalgeneratorprotocol.c
   M /trunk/epan/dissectors/packet-ftp.c
   M /trunk/epan/dissectors/packet-g723.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-gift.c
   M /trunk/epan/dissectors/packet-giop.c
   M /trunk/epan/dissectors/packet-git.c
   M /trunk/epan/dissectors/packet-glbp.c
   M /trunk/epan/dissectors/packet-gmhdr.c
   M /trunk/epan/dissectors/packet-gmrp.c
   M /trunk/epan/dissectors/packet-gnutella.c
   M /trunk/epan/dissectors/packet-goose.c
   M /trunk/epan/dissectors/packet-gopher.c
   M /trunk/epan/dissectors/packet-gpef.c
   M /trunk/epan/dissectors/packet-gsm_bsslap.c
   M /trunk/epan/dissectors/packet-gsm_ipa.c
   M /trunk/epan/dissectors/packet-gsm_sms_ud.c
   M /trunk/epan/dissectors/packet-gsm_um.c
   M /trunk/epan/dissectors/packet-gssapi.c
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-gvcp.c
   M /trunk/epan/dissectors/packet-gvrp.c
   M /trunk/epan/dissectors/packet-h1.c
   M /trunk/epan/dissectors/packet-h223.c
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h261.c
   M /trunk/epan/dissectors/packet-h263.c
   M /trunk/epan/dissectors/packet-h263p.c
   M /trunk/epan/dissectors/packet-h282.c
   M /trunk/epan/dissectors/packet-h283.c
   M /trunk/epan/dissectors/packet-h501.c
   M /trunk/epan/dissectors/packet-hci_h1.c
   M /trunk/epan/dissectors/packet-hci_h4.c
   M /trunk/epan/dissectors/packet-hdfs.c
   M /trunk/epan/dissectors/packet-hdfsdata.c
   M /trunk/epan/dissectors/packet-hip.c
   M /trunk/epan/dissectors/packet-hnbap.c
   M /trunk/epan/dissectors/packet-homeplug-av.c
   M /trunk/epan/dissectors/packet-homeplug.c
   M /trunk/epan/dissectors/packet-hp-erm.c
   M /trunk/epan/dissectors/packet-hpext.c
   M /trunk/epan/dissectors/packet-hpsw.c
   M /trunk/epan/dissectors/packet-hpteam.c
   M /trunk/epan/dissectors/packet-hsrp.c
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-hyperscsi.c
   M /trunk/epan/dissectors/packet-iapp.c
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-icap.c
   M /trunk/epan/dissectors/packet-icep.c
   M /trunk/epan/dissectors/packet-icmp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-icp.c
   M /trunk/epan/dissectors/packet-idmp.c
   M /trunk/epan/dissectors/packet-idp.c
   M /trunk/epan/dissectors/packet-iec104.c
   M /trunk/epan/dissectors/packet-ieee1722.c
   M /trunk/epan/dissectors/packet-ieee80211-prism.c
   M /trunk/epan/dissectors/packet-ieee80211-radio.c
   M /trunk/epan/dissectors/packet-ieee80211-wlancap.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ieee802a.c
   M /trunk/epan/dissectors/packet-igap.c
   M /trunk/epan/dissectors/packet-igmp.c
   M /trunk/epan/dissectors/packet-image-gif.c
   M /trunk/epan/dissectors/packet-image-jfif.c
   M /trunk/epan/dissectors/packet-image-png.c
   M /trunk/epan/dissectors/packet-imap.c
   M /trunk/epan/dissectors/packet-imf.c
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-interlink.c
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ipdc.c
   M /trunk/epan/dissectors/packet-ipmi.c
   M /trunk/epan/dissectors/packet-ipnet.c
   M /trunk/epan/dissectors/packet-ipp.c
   M /trunk/epan/dissectors/packet-ipsec-tcp.c
   M /trunk/epan/dissectors/packet-ipsec.c
   M /trunk/epan/dissectors/packet-ipsi-ctl.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-ipvs-syncd.c
   M /trunk/epan/dissectors/packet-ipx.c
   M /trunk/epan/dissectors/packet-ipxwan.c
   M /trunk/epan/dissectors/packet-irc.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-isdn.c
   M /trunk/epan/dissectors/packet-isis.c
   M /trunk/epan/dissectors/packet-ismacryp.c
   M /trunk/epan/dissectors/packet-ismp.c
   M /trunk/epan/dissectors/packet-isns.c
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-itdm.c
   M /trunk/epan/dissectors/packet-iwarp-ddp-rdmap.c
   M /trunk/epan/dissectors/packet-iwarp-mpa.c
   M /trunk/epan/dissectors/packet-jpeg.c
   M /trunk/epan/dissectors/packet-json.c
   M /trunk/epan/dissectors/packet-kdp.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos4.c
   M /trunk/epan/dissectors/packet-kink.c
   M /trunk/epan/dissectors/packet-kismet.c
   M /trunk/epan/dissectors/packet-kpasswd.c
   M /trunk/epan/dissectors/packet-l1-events.c
   M /trunk/epan/dissectors/packet-l2tp.c
   M /trunk/epan/dissectors/packet-lanforge.c
   M /trunk/epan/dissectors/packet-lapd.c
   M /trunk/epan/dissectors/packet-lapdm.c
   M /trunk/epan/dissectors/packet-laplink.c
   M /trunk/epan/dissectors/packet-lcsap.c
   M /trunk/epan/dissectors/packet-ldp.c
   M /trunk/epan/dissectors/packet-ldss.c
   M /trunk/epan/dissectors/packet-lge_monitor.c
   M /trunk/epan/dissectors/packet-linx.c
   M /trunk/epan/dissectors/packet-lisp-data.c
   M /trunk/epan/dissectors/packet-lisp.c
   M /trunk/epan/dissectors/packet-llc.c
   M /trunk/epan/dissectors/packet-lldp.c
   M /trunk/epan/dissectors/packet-llt.c
   M /trunk/epan/dissectors/packet-lmi.c
   M /trunk/epan/dissectors/packet-lmp.c
   M /trunk/epan/dissectors/packet-loop.c
   M /trunk/epan/dissectors/packet-lpd.c
   M /trunk/epan/dissectors/packet-lsc.c
   M /trunk/epan/dissectors/packet-lte-rrc.c
   M /trunk/epan/dissectors/packet-ltp.c
   M /trunk/epan/dissectors/packet-lwapp.c
   M /trunk/epan/dissectors/packet-lwres.c
   M /trunk/epan/dissectors/packet-m2tp.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-maccontrol.c
   M /trunk/epan/dissectors/packet-manolito.c
   M /trunk/epan/dissectors/packet-media.c
   M /trunk/epan/dissectors/packet-megaco.c
   M /trunk/epan/dissectors/packet-mesh.c
   M /trunk/epan/dissectors/packet-meta.c
   M /trunk/epan/dissectors/packet-mgcp.c
   M /trunk/epan/dissectors/packet-mikey.c
   M /trunk/epan/dissectors/packet-mim.c
   M /trunk/epan/dissectors/packet-mime-encap.c
   M /trunk/epan/dissectors/packet-miop.c
   M /trunk/epan/dissectors/packet-mip.c
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-mms.c
   M /trunk/epan/dissectors/packet-mmse.c
   M /trunk/epan/dissectors/packet-mndp.c
   M /trunk/epan/dissectors/packet-mp2t.c
   M /trunk/epan/dissectors/packet-mp4ves.c
   M /trunk/epan/dissectors/packet-mpeg-pes.c
   M /trunk/epan/dissectors/packet-mpeg1.c
   M /trunk/epan/dissectors/packet-mpls-echo.c
   M /trunk/epan/dissectors/packet-mpls.c
   M /trunk/epan/dissectors/packet-mq-pcf.c
   M /trunk/epan/dissectors/packet-mrdisc.c
   M /trunk/epan/dissectors/packet-mrp-msrp.c
   M /trunk/epan/dissectors/packet-ms-mms.c
   M /trunk/epan/dissectors/packet-msdp.c
   M /trunk/epan/dissectors/packet-msn-messenger.c
   M /trunk/epan/dissectors/packet-msnip.c
   M /trunk/epan/dissectors/packet-msnlb.c
   M /trunk/epan/dissectors/packet-msproxy.c
   M /trunk/epan/dissectors/packet-msrp.c
   M /trunk/epan/dissectors/packet-mstp.c
   M /trunk/epan/dissectors/packet-multipart.c
   M /trunk/epan/dissectors/packet-mux27010.c
   M /trunk/epan/dissectors/packet-nas_eps.c
   M /trunk/epan/dissectors/packet-nasdaq-soup.c
   M /trunk/epan/dissectors/packet-nb_rtpmux.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-nbd.c
   M /trunk/epan/dissectors/packet-nbipx.c
   M /trunk/epan/dissectors/packet-nbns.c
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ncs.c
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-netbios.c
   M /trunk/epan/dissectors/packet-netdump.c
   M /trunk/epan/dissectors/packet-netperfmeter.c
   M /trunk/epan/dissectors/packet-netsync.c
   M /trunk/epan/dissectors/packet-newmail.c
   M /trunk/epan/dissectors/packet-nlsp.c
   M /trunk/epan/dissectors/packet-nntp.c
   M /trunk/epan/dissectors/packet-nsip.c
   M /trunk/epan/dissectors/packet-nsrp.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-ntp.c
   M /trunk/epan/dissectors/packet-null.c
   M /trunk/epan/dissectors/packet-ocsp.c
   M /trunk/epan/dissectors/packet-oicq.c
   M /trunk/epan/dissectors/packet-olsr.c
   M /trunk/epan/dissectors/packet-omapi.c
   M /trunk/epan/dissectors/packet-omron-fins.c
   M /trunk/epan/dissectors/packet-opensafety.c
   M /trunk/epan/dissectors/packet-opsi.c
   M /trunk/epan/dissectors/packet-ositp.c
   M /trunk/epan/dissectors/packet-ospf.c
   M /trunk/epan/dissectors/packet-p_mul.c
   M /trunk/epan/dissectors/packet-packetbb.c
   M /trunk/epan/dissectors/packet-paltalk.c
   M /trunk/epan/dissectors/packet-pcap.c
   M /trunk/epan/dissectors/packet-pcep.c
   M /trunk/epan/dissectors/packet-pcli.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pflog.c
   M /trunk/epan/dissectors/packet-pim.c
   M /trunk/epan/dissectors/packet-pingpongprotocol.c
   M /trunk/epan/dissectors/packet-pkixtsp.c
   M /trunk/epan/dissectors/packet-pktc.c
   M /trunk/epan/dissectors/packet-pktgen.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-pop.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-pppoe.c
   M /trunk/epan/dissectors/packet-pptp.c
   M /trunk/epan/dissectors/packet-prp.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-pvfs2.c
   M /trunk/epan/dissectors/packet-pw-atm.c
   M /trunk/epan/dissectors/packet-pw-cesopsn.c
   M /trunk/epan/dissectors/packet-pw-common.c
   M /trunk/epan/dissectors/packet-pw-eth.c
   M /trunk/epan/dissectors/packet-pw-fr.c
   M /trunk/epan/dissectors/packet-pw-hdlc.c
   M /trunk/epan/dissectors/packet-pw-satop.c
   M /trunk/epan/dissectors/packet-q2931.c
   M /trunk/epan/dissectors/packet-q931.c
   M /trunk/epan/dissectors/packet-q933.c
   M /trunk/epan/dissectors/packet-qllc.c
   M /trunk/epan/dissectors/packet-qsig.c
   M /trunk/epan/dissectors/packet-quake.c
   M /trunk/epan/dissectors/packet-quake2.c
   M /trunk/epan/dissectors/packet-quake3.c
   M /trunk/epan/dissectors/packet-quakeworld.c
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-ranap.c
   M /trunk/epan/dissectors/packet-raw.c
   M /trunk/epan/dissectors/packet-rdm.c
   M /trunk/epan/dissectors/packet-rdp.c
   M /trunk/epan/dissectors/packet-rdt.c
   M /trunk/epan/dissectors/packet-redback.c
   M /trunk/epan/dissectors/packet-redbackli.c
   M /trunk/epan/dissectors/packet-reload-framing.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-retix-bpdu.c
   M /trunk/epan/dissectors/packet-rfc2190.c
   M /trunk/epan/dissectors/packet-rgmp.c
   M /trunk/epan/dissectors/packet-rip.c
   M /trunk/epan/dissectors/packet-ripng.c
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-rlc.c
   M /trunk/epan/dissectors/packet-rlm.c
   M /trunk/epan/dissectors/packet-rlogin.c
   M /trunk/epan/dissectors/packet-rmi.c
   M /trunk/epan/dissectors/packet-rmp.c
   M /trunk/epan/dissectors/packet-rmt-alc.c
   M /trunk/epan/dissectors/packet-rmt-norm.c
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-roofnet.c
   M /trunk/epan/dissectors/packet-rpc.c
   M /trunk/epan/dissectors/packet-rpl.c
   M /trunk/epan/dissectors/packet-rrc.c
   M /trunk/epan/dissectors/packet-rsh.c
   M /trunk/epan/dissectors/packet-rsip.c
   M /trunk/epan/dissectors/packet-rsl.c
   M /trunk/epan/dissectors/packet-rsvp.c
   M /trunk/epan/dissectors/packet-rsync.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-rtmpt.c
   M /trunk/epan/dissectors/packet-rtnet.c
   M /trunk/epan/dissectors/packet-rtp-events.c
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-rtps.c
   M /trunk/epan/dissectors/packet-rtps2.c
   M /trunk/epan/dissectors/packet-rtsp.c
   M /trunk/epan/dissectors/packet-rua.c
   M /trunk/epan/dissectors/packet-rudp.c
   M /trunk/epan/dissectors/packet-s1ap.c
   M /trunk/epan/dissectors/packet-s5066.c
   M /trunk/epan/dissectors/packet-sabp.c
   M /trunk/epan/dissectors/packet-sap.c
   M /trunk/epan/dissectors/packet-sasp.c
   M /trunk/epan/dissectors/packet-sbus.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-sccpmg.c
   M /trunk/epan/dissectors/packet-scriptingservice.c
   M /trunk/epan/dissectors/packet-sdlc.c
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-sebek.c
   M /trunk/epan/dissectors/packet-sercosiii.c
   M /trunk/epan/dissectors/packet-ses.c
   M /trunk/epan/dissectors/packet-sflow.c
   M /trunk/epan/dissectors/packet-sgsap.c
   M /trunk/epan/dissectors/packet-sigcomp.c
   M /trunk/epan/dissectors/packet-simulcrypt.c
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/dissectors/packet-sipfrag.c
   M /trunk/epan/dissectors/packet-skinny.c
   M /trunk/epan/dissectors/packet-slimp3.c
   M /trunk/epan/dissectors/packet-slowprotocols.c
   M /trunk/epan/dissectors/packet-slsk.c
   M /trunk/epan/dissectors/packet-smb-browse.c
   M /trunk/epan/dissectors/packet-smb-logon.c
   M /trunk/epan/dissectors/packet-smb-mailslot.c
   M /trunk/epan/dissectors/packet-smb-pipe.c
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smpp.c
   M /trunk/epan/dissectors/packet-smrse.c
   M /trunk/epan/dissectors/packet-smtp.c
   M /trunk/epan/dissectors/packet-sna.c
   M /trunk/epan/dissectors/packet-snaeth.c
   M /trunk/epan/dissectors/packet-sndcp-xid.c
   M /trunk/epan/dissectors/packet-sndcp.c
   M /trunk/epan/dissectors/packet-snmp.c
   M /trunk/epan/dissectors/packet-socketcan.c
   M /trunk/epan/dissectors/packet-socks.c
   M /trunk/epan/dissectors/packet-spnego.c
   M /trunk/epan/dissectors/packet-spp.c
   M /trunk/epan/dissectors/packet-sqloracle.c
   M /trunk/epan/dissectors/packet-srp.c
   M /trunk/epan/dissectors/packet-srvloc.c
   M /trunk/epan/dissectors/packet-sscf-nni.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-starteam.c
   M /trunk/epan/dissectors/packet-stun.c
   M /trunk/epan/dissectors/packet-sv.c
   M /trunk/epan/dissectors/packet-synphasor.c
   M /trunk/epan/dissectors/packet-t124.c
   M /trunk/epan/dissectors/packet-t125.c
   M /trunk/epan/dissectors/packet-tali.c
   M /trunk/epan/dissectors/packet-tapa.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-teamspeak2.c
   M /trunk/epan/dissectors/packet-teimanagement.c
   M /trunk/epan/dissectors/packet-telkonet.c
   M /trunk/epan/dissectors/packet-telnet.c
   M /trunk/epan/dissectors/packet-teredo.c
   M /trunk/epan/dissectors/packet-text-media.c
   M /trunk/epan/dissectors/packet-tftp.c
   M /trunk/epan/dissectors/packet-time.c
   M /trunk/epan/dissectors/packet-tipc.c
   M /trunk/epan/dissectors/packet-tivoconnect.c
   M /trunk/epan/dissectors/packet-tnef.c
   M /trunk/epan/dissectors/packet-tns.c
   M /trunk/epan/dissectors/packet-tpkt.c
   M /trunk/epan/dissectors/packet-tpncp.c
   M /trunk/epan/dissectors/packet-tr.c
   M /trunk/epan/dissectors/packet-trill.c
   M /trunk/epan/dissectors/packet-trmac.c
   M /trunk/epan/dissectors/packet-tsp.c
   M /trunk/epan/dissectors/packet-tte-pcf.c
   M /trunk/epan/dissectors/packet-tte.c
   M /trunk/epan/dissectors/packet-turbocell.c
   M /trunk/epan/dissectors/packet-turnchannel.c
   M /trunk/epan/dissectors/packet-tuxedo.c
   M /trunk/epan/dissectors/packet-ua.c
   M /trunk/epan/dissectors/packet-uaudp.c
   M /trunk/epan/dissectors/packet-ucp.c
   M /trunk/epan/dissectors/packet-udld.c
   M /trunk/epan/dissectors/packet-uma.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_mac.c
   M /trunk/epan/dissectors/packet-user_encap.c
   M /trunk/epan/dissectors/packet-v52.c
   M /trunk/epan/dissectors/packet-v5ua.c
   M /trunk/epan/dissectors/packet-vicp.c
   M /trunk/epan/dissectors/packet-vines.c
   M /trunk/epan/dissectors/packet-vlan.c
   M /trunk/epan/dissectors/packet-vmlab.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-vrrp.c
   M /trunk/epan/dissectors/packet-vtp.c
   M /trunk/epan/dissectors/packet-vuze-dht.c
   M /trunk/epan/dissectors/packet-wassp.c
   M /trunk/epan/dissectors/packet-wbxml.c
   M /trunk/epan/dissectors/packet-wccp.c
   M /trunk/epan/dissectors/packet-wcp.c
   M /trunk/epan/dissectors/packet-wfleet-hdlc.c
   M /trunk/epan/dissectors/packet-who.c
   M /trunk/epan/dissectors/packet-winsrepl.c
   M /trunk/epan/dissectors/packet-wlccp.c
   M /trunk/epan/dissectors/packet-wol.c
   M /trunk/epan/dissectors/packet-wow.c
   M /trunk/epan/dissectors/packet-wsmp.c
   M /trunk/epan/dissectors/packet-wtls.c
   M /trunk/epan/dissectors/packet-wtp.c
   M /trunk/epan/dissectors/packet-x11.c
   M /trunk/epan/dissectors/packet-x224.c
   M /trunk/epan/dissectors/packet-x25.c
   M /trunk/epan/dissectors/packet-x29.c
   M /trunk/epan/dissectors/packet-x2ap.c
   M /trunk/epan/dissectors/packet-xcsl.c
   M /trunk/epan/dissectors/packet-xdmcp.c
   M /trunk/epan/dissectors/packet-xmcp.c
   M /trunk/epan/dissectors/packet-xmpp.c
   M /trunk/epan/dissectors/packet-xtp.c
   M /trunk/epan/dissectors/packet-xyplex.c
   M /trunk/epan/dissectors/packet-yhoo.c
   M /trunk/epan/dissectors/packet-ymsg.c
   M /trunk/epan/dissectors/packet-zebra.c
   M /trunk/epan/dissectors/packet-ziop.c
   M /trunk/plugins/ethercat/packet-ams.c
   M /trunk/plugins/ethercat/packet-ecatmb.c
   M /trunk/plugins/ethercat/packet-esl.c
   M /trunk/plugins/ethercat/packet-ethercat-datagram.c
   M /trunk/plugins/ethercat/packet-ethercat-frame.c
   M /trunk/plugins/ethercat/packet-ioraw.c
   M /trunk/plugins/ethercat/packet-nv.c
   M /trunk/plugins/gryphon/packet-gryphon.c
   M /trunk/plugins/irda/packet-ircomm.c
   M /trunk/plugins/irda/packet-irda.c
   M /trunk/plugins/m2m/packet-m2m.c
   M /trunk/plugins/opcua/opcua.c
   M /trunk/plugins/profinet/packet-pn-mrp.c
   M /trunk/plugins/profinet/packet-pn-rt.c
   M /trunk/plugins/tpg/packet-http.c
   M /trunk/plugins/unistim/packet-unistim.c
   M /trunk/plugins/wimaxasncp/packet-wimaxasncp.c

For proto_tree_add_item(..., proto_xxx, ...)use ENC_NA as the encoding arg.
Also: remove trailing whitespace for a number of files.

------------------------------------------------------------------------
r39502 | morriss | 2011-10-20 18:50:25 -0700 (Thu, 20 Oct 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5221 :

Don't assume that the Called party number has digits: it may not, especially
in protocols like INAP.

Rearrange the (pre-existing) no-digits check when dissecting Calling addresses
so we don't pass the empty address to taps.

------------------------------------------------------------------------
r39501 | morriss | 2011-10-20 18:03:48 -0700 (Thu, 20 Oct 2011) | 6 lines
Changed paths:
   M /trunk/gtk/text_import.c
   M /trunk/text2pcap.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3161 :

Solaris doesn't like _XOPEN_SOURCE being defined but with no value, at least
when being compiled in C99-mode.  So set it to 600 (XPG6); hopefully this
won't break any other systems.

------------------------------------------------------------------------
r39500 | gerald | 2011-10-20 16:46:04 -0700 (Thu, 20 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-infiniband.c

From Huzaifa Sidhpurwala: Fix a null pointer dereference.

------------------------------------------------------------------------
r39499 | alagoutte | 2011-10-20 13:45:34 -0700 (Thu, 20 Oct 2011) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mongo.c

FromThomas Buchanan via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6467
Add Binary JSON (BSON) decoding support to Mongo packet dissector

Implement BSON spec to correctly see BSON document type and not in Bytes format...

The specification for BSON can be found at http://bsonspec.org/

The decoding is not entirely complete, there are still potential enhancements to provide more information about a couple of data types, but it greatly enhances visibility into these packet types.

From me :
* Fix warning from fix-encoding-args.pl script.

------------------------------------------------------------------------
r39498 | tuexen | 2011-10-20 12:44:40 -0700 (Thu, 20 Oct 2011) | 6 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/capture_sync.c
   M /trunk/capture_ui_utils.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_dlg.h
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/capture_if_dlg.h
   M /trunk/gtk/main.c
   M /trunk/gtk/main.h
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/main_welcome.h
   M /trunk/gtk/prefs_capture.c

Back out infrastructure change. We missed supporting
stdin and pipes.




------------------------------------------------------------------------
r39497 | tuexen | 2011-10-20 12:15:38 -0700 (Thu, 20 Oct 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

(Try to) fix compilation.

------------------------------------------------------------------------
r39496 | stig | 2011-10-20 11:57:26 -0700 (Thu, 20 Oct 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/prefs_capture.c

Use g_strdup.
------------------------------------------------------------------------
r39495 | tuexen | 2011-10-20 11:17:54 -0700 (Thu, 20 Oct 2011) | 12 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/capture_sync.c
   M /trunk/capture_ui_utils.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_dlg.h
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/capture_if_dlg.h
   M /trunk/gtk/main.c
   M /trunk/gtk/main.h
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/main_welcome.h
   M /trunk/gtk/prefs_capture.c

Use a global list containing all interfaces and only change
properties of the entries when changes are made in the GUI.
Do not misuse the list of interfaces specified on the command
line anymore.

This patch does not provide any new functionality, it just
provides the base for future extensions like removing
remote interface, mulitple airpcap devices and multiple
pipes.

This patch was provided by Irene Ruengeler.

------------------------------------------------------------------------
r39494 | jake | 2011-10-20 10:49:19 -0700 (Thu, 20 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Fix for bug 6469:
Retrieve the fill bits in the correct amount and from the correct place.

------------------------------------------------------------------------
r39493 | alagoutte | 2011-10-20 09:09:58 -0700 (Thu, 20 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dplay.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39492 | wmeier | 2011-10-20 07:43:11 -0700 (Thu, 20 Oct 2011) | 4 lines
Changed paths:
   M /trunk/tools/fix-encoding-args.pl

Add conversion for FT_ETHER hf[] field type;
Add capability to convert encoding arg for 'proto' hf_index_names [the
 variable which stores the return value from proto_register_protocol()].

------------------------------------------------------------------------
r39491 | wmeier | 2011-10-20 07:36:14 -0700 (Thu, 20 Oct 2011) | 2 lines
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-snmp.c

Use ENC_NA as proto_tree_add_item() encoding arg for FT_ETHER hf[] field type.

------------------------------------------------------------------------
r39490 | wmeier | 2011-10-20 07:30:27 -0700 (Thu, 20 Oct 2011) | 2 lines
Changed paths:
   M /trunk/plugins/docsis/packet-bpkmattr.c
   M /trunk/plugins/docsis/packet-dccreq.c
   M /trunk/plugins/docsis/packet-dcd.c
   M /trunk/plugins/docsis/packet-macmgmt.c
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/ethercat/packet-ecatmb.c
   M /trunk/plugins/unistim/packet-unistim.c
   M /trunk/plugins/wimax/msg_dcd.c
   M /trunk/plugins/wimax/msg_dreg.c
   M /trunk/plugins/wimax/msg_reg_req.c
   M /trunk/plugins/wimax/msg_rng_req.c
   M /trunk/plugins/wimax/msg_rng_rsp.c
   M /trunk/plugins/wimax/wimax_utils.c

Use ENC_NA as proto_tree_add_item() encoding arg for FT_ETHER hf[] field type.

------------------------------------------------------------------------
r39489 | wmeier | 2011-10-20 07:11:32 -0700 (Thu, 20 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-glbp.c

Fix a typo.

------------------------------------------------------------------------
r39488 | wmeier | 2011-10-20 07:07:54 -0700 (Thu, 20 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c
   M /trunk/epan/dissectors/packet-ancp.c
   M /trunk/epan/dissectors/packet-ans.c
   M /trunk/epan/dissectors/packet-artnet.c
   M /trunk/epan/dissectors/packet-aruba-adp.c
   M /trunk/epan/dissectors/packet-bacnet.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-capwap.c
   M /trunk/epan/dissectors/packet-cfm.c
   M /trunk/epan/dissectors/packet-cgmp.c
   M /trunk/epan/dissectors/packet-dec-bpdu.c
   M /trunk/epan/dissectors/packet-dec-dnart.c
   M /trunk/epan/dissectors/packet-eigrp.c
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-enttec.c
   M /trunk/epan/dissectors/packet-extreme.c
   M /trunk/epan/dissectors/packet-fip.c
   M /trunk/epan/dissectors/packet-glbp.c
   M /trunk/epan/dissectors/packet-gmrp.c
   M /trunk/epan/dissectors/packet-gvcp.c
   M /trunk/epan/dissectors/packet-hsrp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-idp.c
   M /trunk/epan/dissectors/packet-ieee80211-wlancap.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ipmi-transport.c
   M /trunk/epan/dissectors/packet-ipxwan.c
   M /trunk/epan/dissectors/packet-isl.c
   M /trunk/epan/dissectors/packet-ismp.c
   M /trunk/epan/dissectors/packet-ldp.c
   M /trunk/epan/dissectors/packet-linx.c
   M /trunk/epan/dissectors/packet-loop.c
   M /trunk/epan/dissectors/packet-mrp-msrp.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-prp.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-retix-bpdu.c
   M /trunk/epan/dissectors/packet-rpl.c
   M /trunk/epan/dissectors/packet-tapa.c
   M /trunk/epan/dissectors/packet-turbocell.c
   M /trunk/epan/dissectors/packet-wai.c
   M /trunk/epan/dissectors/packet-wassp.c
   M /trunk/epan/dissectors/packet-wifi-p2p.c
   M /trunk/epan/dissectors/packet-wlccp.c
   M /trunk/epan/dissectors/packet-wps.c

Use ENC_NA as proto_tree_add_item() encoding arg for FT_ETHER hf[] field type.
(Some minor whitespace cleanup).

------------------------------------------------------------------------
r39487 | jake | 2011-10-19 23:51:53 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   M /trunk/debian/control

Update minimum version requirement for GTK to 2.12.

------------------------------------------------------------------------
r39485 | guy | 2011-10-19 19:38:40 -0700 (Wed, 19 Oct 2011) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

As bug 3954 notes, nowhere does RFC 3954 indicate that a system or
interface scope is always 4 bytes.  For that matter, nowhere does it
indicate that the scopes have any particular interpretation except as a
sequence of octets.

Get rid of the checks for a length of 4, and make ScopeSystem an
FT_BYTES.  If, by *convention*, they're usually IPv4 or IPv6 addresses,
somebody can throw in code to display them as such if they happen to be
4 or 16 bytes, respectively.  Leave ScopeInterface as an integer for
now, in case, by convention, they're interface indices, but still leave
the length check out.

Fixes bug 3954.

------------------------------------------------------------------------
r39484 | morriss | 2011-10-19 19:29:13 -0700 (Wed, 19 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/conversation.c
   M /trunk/epan/packet.c

Delay freeing of seasonal memory until after the conversation cleanup routine
has been called.

In the conversation cleanup routine, free the GSlist for any proto_data which
may have been hanging off the (se_allocated) conversation.

------------------------------------------------------------------------
r39483 | morriss | 2011-10-19 18:55:04 -0700 (Wed, 19 Oct 2011) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mysql.c

From András Veres-Szentkirályi via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6426 :

The current MySQL dissector ignored the execute parameters as metadata is
needed from previous packets to decode the fields. I added the necessary code
to store these in conn_data and developed dissector for all fields I could
reproduce on the network.

This also fixes a memory leak by moving the stmts structure (the pointer to
which is stored in se_allocated memory) into se_trees.

From me: use se_tree_create_non_persistent() so the entire tree is forgotten when
the se_ memory goes away.  Also some reformatting.

------------------------------------------------------------------------
r39482 | wmeier | 2011-10-19 16:24:52 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Specify ENC_TIME_TIMESPEC for a proto_tree_add_item() encoding arg for a field with type FT_ABSOLUTE_TIME.

------------------------------------------------------------------------
r39481 | alagoutte | 2011-10-19 14:55:08 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bthci_cmd.c
   M /trunk/epan/dissectors/packet-bthci_evt.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39480 | alagoutte | 2011-10-19 14:52:31 -0700 (Wed, 19 Oct 2011) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-hdcp.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6463
dissector for HDCP (High bandwidth Digital Content Protection)

HDCP can run on top of TCP, there's no fixed port number assigned. I created a heuristic dissector that's disabled by default and can be enabled by setting a preference (similar to the hilscher dissector). The idea behind this is that some HDCP messages are hard to recognize (e.g. one byte message id + 8 random bytes). Having the dissector enabled at all times may generate false positives.

------------------------------------------------------------------------
r39479 | alagoutte | 2011-10-19 14:29:02 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Copy/Paste is a devil...

------------------------------------------------------------------------
r39478 | alagoutte | 2011-10-19 14:22:42 -0700 (Wed, 19 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/etypes.h

From pascl via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6465
New Protocol Submission for MVRP (Multiple VLAN Registration Protocol)

Missed modification of etypes.h file

------------------------------------------------------------------------
r39477 | alagoutte | 2011-10-19 14:19:08 -0700 (Wed, 19 Oct 2011) | 11 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-mrp-mvrp.c

From pascl via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6465
New Protocol Submission for MVRP (Multiple VLAN Registration Protocol)

New dissector submission for Multiple VLAN Registration Protocol (MVRP) defined in 802.1ak Standard, section 11. MVRP is used to to dynamically create and update Dynamic VLAN Registration Entries.

From me :
* Fix error from fix-encodings-args script
* Add Modeline information
* Added packet-mrp-mvrp.c to CMakeLists.txt


------------------------------------------------------------------------
r39476 | wmeier | 2011-10-19 13:58:36 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nsip.c

Use ENC_... instead of locally defined NSIP_LITTLE_ENDIAN for proto_tree_add_item() encoding arg.

------------------------------------------------------------------------
r39475 | wmeier | 2011-10-19 13:32:21 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lmp.c
   M /trunk/epan/dissectors/packet-radius_packetcable.c

Fix several benign instances wherein proto_tree_add_[uint|boolean]() was intended rather than proto_tree_add_item().

------------------------------------------------------------------------
r39474 | wmeier | 2011-10-19 13:29:36 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radiotap.c

Manually fix a proto_tree_add_item() encoding arg.

------------------------------------------------------------------------
r39473 | wmeier | 2011-10-19 13:28:08 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mq.c

use consistent indentation.

------------------------------------------------------------------------
r39472 | etxrab | 2011-10-19 10:59:47 -0700 (Wed, 19 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/asn1/tcap/tcap.cnf
   M /trunk/epan/dissectors/packet-tcap.c

Let subdissectors have a stab at the packet even if it's cut short.
------------------------------------------------------------------------
r39471 | wmeier | 2011-10-19 10:17:35 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   A /trunk/tools/fix-encoding-args.pl

Perl program to fix proto_tree_add_item() encoding args as appropriate (and as possible).

------------------------------------------------------------------------
r39470 | sfisher | 2011-10-19 09:15:53 -0700 (Wed, 19 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c


Fix Coverity ID #1288: UNUSED_VALUE in spotlight_dissect_query_loop:
"returned_pointer: Pointer ... is never used" due to break and end 
of function after the switch block.


------------------------------------------------------------------------
r39469 | sfisher | 2011-10-19 09:08:13 -0700 (Wed, 19 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c


Fix Coverity ID 1300: UNUSED_VALUE in dissect_spotlight: "returned_pointer
is never used" because of the return -1 at the end of this if block.
Removed item_toc = assignment and fixed indentation.


------------------------------------------------------------------------
r39468 | stig | 2011-10-19 08:32:49 -0700 (Wed, 19 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_pinfo.c

Duplicate Lua strings we put into the private_table.
------------------------------------------------------------------------
r39467 | wmeier | 2011-10-19 08:04:44 -0700 (Wed, 19 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-lmp.c
   M /trunk/epan/dissectors/packet-mikey.c
   M /trunk/epan/dissectors/packet-ospf.c
   M /trunk/epan/dissectors/packet-pcep.c
   M /trunk/epan/dissectors/packet-rsvp.c

More conversions of proto_tree_add_item() 'encoding' arg

------------------------------------------------------------------------
r39466 | tuexen | 2011-10-19 02:53:39 -0700 (Wed, 19 Oct 2011) | 3 lines
Changed paths:
   M /trunk/gtk/sctp_graph_dlg.c

Fix a bug when drawing TSN plots which results in a crash.
Obtained from Irene Ruengeler.

------------------------------------------------------------------------
r39465 | alagoutte | 2011-10-18 23:44:44 -0700 (Tue, 18 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mrp-msrp.c

From pascl via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6464
MRP-MSRP: Missing error descriptions (error code 17, 18 and 19)

Multiple Stream Reservation Protocol (MSRP) defines 19 failures codes in 802.1Qat (table 35-6). Actual packet-mrp-msrp.c only defines the first 16 failures codes.

------------------------------------------------------------------------
r39464 | morriss | 2011-10-18 17:37:52 -0700 (Tue, 18 Oct 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

From Pascal Quantin via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6468 :

The attached patch fixes a memory corruption of the ep_allocated buffer when
building the decoded bitmap.

From me: some reformatting.

------------------------------------------------------------------------
r39463 | alagoutte | 2011-10-18 16:21:15 -0700 (Tue, 18 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btamp.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang
packet-btamp.c:xxx:y: warning: Value stored to 'offset' is never read (x14)

------------------------------------------------------------------------
r39462 | morriss | 2011-10-18 11:05:11 -0700 (Tue, 18 Oct 2011) | 4 lines
Changed paths:
   M /trunk/gtk/expert_comp_dlg.c
   M /trunk/gtk/main_menubar.c

There's only one expert info dialog now; dispense with the "composite" part
of the name (at least what we show users; the files and functions still
reference composite).

------------------------------------------------------------------------
r39461 | stig | 2011-10-18 10:46:00 -0700 (Tue, 18 Oct 2011) | 11 lines
Changed paths:
   M /trunk/epan/packet_info.h
   M /trunk/epan/wslua/init_wslua.c
   M /trunk/epan/wslua/wslua.h
   M /trunk/epan/wslua/wslua_pinfo.c

Added a private hash table to transport string values between dissectors.
This works between C and Lua.

In C the pinfo.private_table pointer must be initialized using
g_hash_table_new (g_str_hash, g_str_equal);

In Lua the values are available using pinfo.private.<key>, and the
table is created automatically on first usage.  It's possible to use
this datatypes: nil, boolean, number and string, but every value
is converted to string so numbers must be converted using tonumber()
on usage.  Boolean is either nil or an empty string.
------------------------------------------------------------------------
r39460 | morriss | 2011-10-18 09:13:12 -0700 (Tue, 18 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c

Add an expert info if we found the checksum to be bad.
Add the checksum info to the tree even when !tree so that the expert_info
summary... "icon"... in the lower-left corner is correct.

------------------------------------------------------------------------
r39459 | stig | 2011-10-18 09:06:17 -0700 (Tue, 18 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Added support for User-Agent.
Fixed finding line end for content type parameters.
------------------------------------------------------------------------
r39458 | stig | 2011-10-18 03:17:19 -0700 (Tue, 18 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_pinfo.c

Use PINFO_GET_BOOLEAN for visited.
------------------------------------------------------------------------
r39457 | stig | 2011-10-18 02:13:33 -0700 (Tue, 18 Oct 2011) | 2 lines
Changed paths:
   M /trunk/asn1/lpp

Set svn:ignore targets.

------------------------------------------------------------------------
r39456 | guy | 2011-10-17 23:50:20 -0700 (Mon, 17 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/proto.h

Note some character encodings that can probably be used Real Soon Now,
and the dissectors that deal with them.

------------------------------------------------------------------------
r39455 | morriss | 2011-10-17 18:51:01 -0700 (Mon, 17 Oct 2011) | 31 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

From Dirk Jagdmann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6450 :

Several updates to the DCE/RPC dissector:

- changed the variable name "ndr64_uuid" to "uuid_ndr64" to make it similar the
the other UUID variable names. Minor changes to the UUID names.

- changes the UUID name for the 32bit NDR to describe that. In the DCE/RPC
standard this UUID is described as "Version 1.1 network data representation
protocol", but this is an unnecessarily long name and it's the only 32bit
version defined for DCE/RPC anyway. The new name "32bit NDR" is similar to the
changed name for the 64bit NDR.

- added an UUID for "bind time feature negotiation" found with Microsoft PDUs.

- added an UUID for "asynchonous MAPI". Of course this UUID/name should be
added to the MAPI dissector, but the MAPI dissector is generated C code from
Samba/OpenChange pidl sources. Eventually those might get updated. An
alternative would be to create a new file to specifically register UUIDs used
in the DCE/RPC context.

- when the g_hash_table_insert() function is used, I've removed the code to
lookup and remove the key, as g_hash_table_insert() is doing that internally
(or more precise, it is overwriting the old value).

- in the dissector function for Bind and BindAck, I now print all context items
into COL_INFO and not just the first one.

- added a new value for Bind results, used by Microsoft products. (The
"Negotiate ACK" is used with the "bind time feature negotiation" UUID)

------------------------------------------------------------------------
r39454 | morriss | 2011-10-17 18:27:01 -0700 (Mon, 17 Oct 2011) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pcep.c

From Roberto Morro via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6451 :

The patch fixes a bug in the PCEP Objective Function (OF) object tree
visualization (it didn't recognize the object and showed it as "Unknown
object").

Also fixes a small bug.

From me: remove a couple of unnecessary includes.

------------------------------------------------------------------------
r39453 | morriss | 2011-10-17 18:05:57 -0700 (Mon, 17 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

From Daniel via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6461 :

Register the USB dissector by name.

------------------------------------------------------------------------
r39452 | cmaynard | 2011-10-17 17:49:16 -0700 (Mon, 17 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bthci_acl.c
   M /trunk/epan/dissectors/packet-bthci_evt.c
   M /trunk/epan/dissectors/packet-bthci_sco.c

Display filter name cleanup.

------------------------------------------------------------------------
r39451 | wmeier | 2011-10-17 17:39:20 -0700 (Mon, 17 Oct 2011) | 3 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/asn1/smrse/packet-smrse-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-smrse.c

Do some more conversions of proto_tree_add_item() 'encoding' arg
  (previously missed).

------------------------------------------------------------------------
r39450 | wmeier | 2011-10-17 17:17:48 -0700 (Mon, 17 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/plugins/docsis/packet-bintrngreq.c
   M /trunk/plugins/docsis/packet-docsis.c
   M /trunk/plugins/docsis/packet-macmgmt.c
   M /trunk/plugins/docsis/packet-map.c
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/docsis/packet-type29ucd.c
   M /trunk/plugins/docsis/packet-ucd.c
   M /trunk/plugins/ethercat/packet-ethercat-datagram.c
   M /trunk/plugins/irda/packet-irda.c
   M /trunk/plugins/opcua/opcua_transport_layer.c
   M /trunk/plugins/unistim/packet-unistim.c
   M /trunk/plugins/wimax/msg_dcd.c
   M /trunk/plugins/wimax/msg_pmc.c
   M /trunk/plugins/wimax/msg_reg_req.c
   M /trunk/plugins/wimax/msg_rep.c
   M /trunk/plugins/wimax/msg_rng_rsp.c
   M /trunk/plugins/wimax/msg_sbc.c
   M /trunk/plugins/wimax/msg_ucd.c
   M /trunk/plugins/wimax/wimax_compact_dlmap_ie_decoder.c
   M /trunk/plugins/wimax/wimax_compact_ulmap_ie_decoder.c
   M /trunk/plugins/wimax/wimax_utils.c
   M /trunk/plugins/wimaxasncp/packet-wimaxasncp.c

Do some more conversions of proto_tree_add_item() 'encoding' arg
 (previously missed).

------------------------------------------------------------------------
r39449 | cmaynard | 2011-10-17 16:59:32 -0700 (Mon, 17 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-atalk.c

Fixup some display filter names.

------------------------------------------------------------------------
r39448 | cmaynard | 2011-10-17 16:58:25 -0700 (Mon, 17 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Cleanup AFP Version display filter name.

------------------------------------------------------------------------
r39447 | wmeier | 2011-10-17 15:23:11 -0700 (Mon, 17 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ismacryp.c

Remove #if 0'd code which appears to duplicate existing code

------------------------------------------------------------------------
r39446 | alagoutte | 2011-10-17 11:19:18 -0700 (Mon, 17 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

Enhance BGP Capability message
* Make field filterable 
* Use expert info to display a wrong length
* Remove duplicate code for type and length

------------------------------------------------------------------------
r39445 | cmaynard | 2011-10-17 07:56:37 -0700 (Mon, 17 Oct 2011) | 6 lines
Changed paths:
   M /trunk/file.c

From Michael Mann: Add cf_callback_invoke to cf_open to tidy up the currently open file before opening a new one.  Fixes bugs 5987 and 6457.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5987
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6457


------------------------------------------------------------------------
r39444 | morriss | 2011-10-17 07:53:13 -0700 (Mon, 17 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/libwireshark.def

Add dissectors/packet-lcsap.c to CMake.  Remove dissect_lcsap_Correlation_ID_PDU() from list of exports since it's only used within libwireshark.
------------------------------------------------------------------------
r39443 | guy | 2011-10-16 23:09:04 -0700 (Sun, 16 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/libwireshark.def

dissect_lcsap_Correlation_ID_PDU() is used in one module and exported in
another; see if this fixes the Ubuntu build.

------------------------------------------------------------------------
r39442 | wmeier | 2011-10-16 16:38:49 -0700 (Sun, 16 Oct 2011) | 46 lines
Changed paths:
   M /trunk/epan/dissectors/packet-2dparityfec.c
   M /trunk/epan/dissectors/packet-ancp.c
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-btobex.c
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-dcerpc-browser.c
   M /trunk/epan/dissectors/packet-dcerpc-tapi.c
   M /trunk/epan/dissectors/packet-dcp-etsi.c
   M /trunk/epan/dissectors/packet-dect.c
   M /trunk/epan/dissectors/packet-dlm3.c
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-dplay.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-ehs.c
   M /trunk/epan/dissectors/packet-eigrp.c
   M /trunk/epan/dissectors/packet-evrc.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/dissectors/packet-h263.c
   M /trunk/epan/dissectors/packet-h263p.c
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-icep.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-image-gif.c
   M /trunk/epan/dissectors/packet-image-jfif.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-ipmi-se.c
   M /trunk/epan/dissectors/packet-ipmi-transport.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-isis.c
   M /trunk/epan/dissectors/packet-ismacryp.c
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-json.c
   M /trunk/epan/dissectors/packet-l2tp.c
   M /trunk/epan/dissectors/packet-linx.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-mongo.c
   M /trunk/epan/dissectors/packet-mp2t.c
   M /trunk/epan/dissectors/packet-mrp-msrp.c
   M /trunk/epan/dissectors/packet-msdp.c
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-netflow.c
   M /trunk/epan/dissectors/packet-nlsp.c
   M /trunk/epan/dissectors/packet-oicq.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pim.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-pptp.c
   M /trunk/epan/dissectors/packet-pw-atm.c
   M /trunk/epan/dissectors/packet-pw-cesopsn.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-ripng.c
   M /trunk/epan/dissectors/packet-sbus.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-sercosiii.c
   M /trunk/epan/dissectors/packet-ses.c
   M /trunk/epan/dissectors/packet-sflow.c
   M /trunk/epan/dissectors/packet-simulcrypt.c
   M /trunk/epan/dissectors/packet-slowprotocols.c
   M /trunk/epan/dissectors/packet-slsk.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-synphasor.c
   M /trunk/epan/dissectors/packet-tapa.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-tipc.c
   M /trunk/epan/dissectors/packet-tivoconnect.c
   M /trunk/epan/dissectors/packet-tpkt.c
   M /trunk/epan/dissectors/packet-turbocell.c
   M /trunk/epan/dissectors/packet-uma.c
   M /trunk/epan/dissectors/packet-usb-hid.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-wps.c

Do some conversions of proto_tree_add_item() 'encoding' arg.
(previously missed).

    57   FT_BOOLEAN:       FALSE-->ENC_BIG_ENDIAN
    31   FT_BOOLEAN:       TRUE-->ENC_LITTLE_ENDIAN

    10   FT_BYTES:         ENC_BIG_ENDIAN-->ENC_NA
     1   FT_BYTES:         ENC_LITTLE_ENDIAN-->ENC_NA
    21   FT_BYTES:         FALSE-->ENC_NA
     2   FT_BYTES:         TRUE-->ENC_NA

     2   FT_IPXNET:        ENC_BIG_ENDIAN-->ENC_NA

     6   FT_IPv6:          ENC_BIG_ENDIAN-->ENC_NA
     1   FT_IPv6:          FALSE-->ENC_NA

     6   FT_NONE:          ENC_BIG_ENDIAN-->ENC_NA
    19   FT_NONE:          FALSE-->ENC_NA
     3   FT_NONE:          TRUE-->ENC_NA

     1   FT_STRING:        ENC_BIG_ENDIAN-->ENC_ASCII|ENC_NA
     1   FT_STRING:        ENC_LITTLE_ENDIAN-->ENC_ASCII|ENC_NA
     5   FT_STRING:        FALSE-->ENC_ASCII|ENC_NA
     1   FT_STRING:        TRUE-->ENC_ASCII|ENC_NA

     4   FT_STRINGZ:       ENC_NA-->ENC_ASCII|ENC_NA
     8   FT_STRINGZ:       FALSE-->ENC_ASCII|ENC_NA

     1   FT_INT32:         FALSE-->ENC_BIG_ENDIAN
     1   FT_INT32:         TRUE-->ENC_LITTLE_ENDIAN

    11   FT_UINT8:         0-->ENC_BIG_ENDIAN
   111   FT_UINT8:         FALSE-->ENC_BIG_ENDIAN
    17   FT_UINT8:         TRUE-->ENC_LITTLE_ENDIAN
     1   FT_UINT16:        0-->ENC_BIG_ENDIAN
    68   FT_UINT16:        FALSE-->ENC_BIG_ENDIAN
    18   FT_UINT16:        TRUE-->ENC_LITTLE_ENDIAN
     4   FT_UINT24:        FALSE-->ENC_BIG_ENDIAN
    70   FT_UINT32:        FALSE-->ENC_BIG_ENDIAN
     1   FT_UINT32:        TRUE-->ENC_LITTLE_ENDIAN
     4   FT_UINT64:        FALSE-->ENC_BIG_ENDIAN
     1   FT_UINT64:        TRUE-->ENC_LITTLE_ENDIAN

     1   FT_UINT_STRING:   FALSE-->ENC_ASCII|ENC_BIG_ENDIAN


------------------------------------------------------------------------
r39441 | guy | 2011-10-16 11:34:45 -0700 (Sun, 16 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Have to include packet-lcsap.h, so it gets put into the source tarball.

------------------------------------------------------------------------
r39440 | etxrab | 2011-10-16 10:29:12 -0700 (Sun, 16 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen: 
Reassemble GAS Query Response if needed.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6443
------------------------------------------------------------------------
r39439 | etxrab | 2011-10-16 10:24:50 -0700 (Sun, 16 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/Makefile.am

From Eliot:
This patch adds the symbols to a filter expression, and should remove them if
you
are building without python.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6448
------------------------------------------------------------------------
r39438 | etxrab | 2011-10-16 10:21:19 -0700 (Sun, 16 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eigrp.c

From Donnie Savage:
EIGRP dissector cleanup.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6459
------------------------------------------------------------------------
r39437 | etxrab | 2011-10-16 09:54:44 -0700 (Sun, 16 Oct 2011) | 4 lines
Changed paths:
   A /trunk/asn1/lcsap/packet-lcsap-template.h

From Pascal Quantin.
LTE Positioning Protocol dissector. Add missing file.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6460
------------------------------------------------------------------------
r39436 | etxrab | 2011-10-16 09:02:26 -0700 (Sun, 16 Oct 2011) | 4 lines
Changed paths:
   M /trunk/asn1/Makefile.am
   M /trunk/asn1/Makefile.nmake
   M /trunk/asn1/lcsap/Makefile.common
   M /trunk/asn1/lcsap/lcsap.cnf
   A /trunk/asn1/lpp
   A /trunk/asn1/lpp/LPP.asn
   A /trunk/asn1/lpp/Makefile.am
   A /trunk/asn1/lpp/Makefile.common
   A /trunk/asn1/lpp/Makefile.nmake
   A /trunk/asn1/lpp/lpp.cnf
   A /trunk/asn1/lpp/packet-lpp-template.c
   M /trunk/configure.in
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-lcsap.c
   A /trunk/epan/dissectors/packet-lcsap.h
   A /trunk/epan/dissectors/packet-lpp.c
   M /trunk/epan/dissectors/packet-nas_eps.c

From Pascal Quantin.
LTE Positioning Protocol dissector

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6460
------------------------------------------------------------------------
r39433 | gerald | 2011-10-16 07:03:24 -0700 (Sun, 16 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-10-16]
------------------------------------------------------------------------
r39432 | wmeier | 2011-10-15 14:43:46 -0700 (Sat, 15 Oct 2011) | 2 lines
Changed paths:
   M /trunk/asn1/Makefile.nmake
   M /trunk/asn1/t124/Makefile.nmake

Windows: Fix and re-enable asn1\t124 build;

------------------------------------------------------------------------
r39431 | wmeier | 2011-10-15 13:41:07 -0700 (Sat, 15 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t124.c
   M /trunk/epan/dissectors/packet-t124.h

 Update 2 generated ASN1 *.[hc] files after recent work done by Jeff Morriss;
 The only change in each file is in a comment showing the asn2wrs cmd used to build that file.


------------------------------------------------------------------------
r39430 | wmeier | 2011-10-15 13:39:35 -0700 (Sat, 15 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.c

Fix a 'set but not used' compiler warning.

------------------------------------------------------------------------
r39429 | wmeier | 2011-10-15 12:58:31 -0700 (Sat, 15 Oct 2011) | 7 lines
Changed paths:
   M /trunk/plugins/docsis/packet-bpkmattr.c
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/docsis/packet-vendor.c
   M /trunk/plugins/ethercat/packet-ams.c
   M /trunk/plugins/ethercat/packet-ecatmb.c
   M /trunk/plugins/irda/packet-irda.c
   M /trunk/plugins/opcua/opcua_transport_layer.c
   M /trunk/plugins/unistim/packet-unistim.c
   M /trunk/plugins/wimax/msg_ucd.c

Convert plugin files proto_tree_add_item() 'encoding' arg for field types FT_STRING, FT_STRINGZ, FT_UINT_STRING as follows:
 1. If there's no character encoding (ENC_ASCII, ...) specified
    then use ENC_ASCII.
 2. For all but FT_UINT_STRING, always use ENC_NA
    (replacing any existing True/1/FALSE/0
    /ENC_BIG_ENDIAN/ENC_LITTLE_ENDIAN).

------------------------------------------------------------------------
r39428 | wmeier | 2011-10-15 12:48:19 -0700 (Sat, 15 Oct 2011) | 7 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/asn1/ftam/packet-ftam-template.c
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-ftam.c
   M /trunk/epan/dissectors/packet-snmp.c

Convert asn1 template files proto_tree_add_item() 'encoding' arg for field types FT_STRING as follows:
 1. If there's no character encoding (ENC_ASCII, ...) specified
    then use ENC_ASCII.
 2. Always use ENC_NA
    (replacing any existing True/1/FALSE/0
    /ENC_BIG_ENDIAN/ENC_LITTLE_ENDIAN).

------------------------------------------------------------------------
r39427 | wmeier | 2011-10-15 12:27:27 -0700 (Sat, 15 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-HI2Operations.c
   M /trunk/epan/dissectors/packet-acp133.c
   M /trunk/epan/dissectors/packet-acp133.h
   M /trunk/epan/dissectors/packet-acse.c
   M /trunk/epan/dissectors/packet-acse.h
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-ansi_map.h
   M /trunk/epan/dissectors/packet-ansi_tcap.c
   M /trunk/epan/dissectors/packet-ansi_tcap.h
   M /trunk/epan/dissectors/packet-cdt.c
   M /trunk/epan/dissectors/packet-cdt.h
   M /trunk/epan/dissectors/packet-charging_ase.c
   M /trunk/epan/dissectors/packet-charging_ase.h
   M /trunk/epan/dissectors/packet-cmip.c
   M /trunk/epan/dissectors/packet-cmip.h
   M /trunk/epan/dissectors/packet-cmp.c
   M /trunk/epan/dissectors/packet-cmp.h
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-cms.h
   M /trunk/epan/dissectors/packet-credssp.c
   M /trunk/epan/dissectors/packet-credssp.h
   M /trunk/epan/dissectors/packet-crmf.c
   M /trunk/epan/dissectors/packet-crmf.h
   M /trunk/epan/dissectors/packet-dap.c
   M /trunk/epan/dissectors/packet-dap.h
   M /trunk/epan/dissectors/packet-disp.c
   M /trunk/epan/dissectors/packet-disp.h
   M /trunk/epan/dissectors/packet-dop.c
   M /trunk/epan/dissectors/packet-dop.h
   M /trunk/epan/dissectors/packet-dsp.c
   M /trunk/epan/dissectors/packet-dsp.h
   M /trunk/epan/dissectors/packet-ess.c
   M /trunk/epan/dissectors/packet-ess.h
   M /trunk/epan/dissectors/packet-ftam.c
   M /trunk/epan/dissectors/packet-ftam.h
   M /trunk/epan/dissectors/packet-gnm.c
   M /trunk/epan/dissectors/packet-gnm.h
   M /trunk/epan/dissectors/packet-goose.c
   M /trunk/epan/dissectors/packet-gprscdr.c
   M /trunk/epan/dissectors/packet-gprscdr.h
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h225.h
   M /trunk/epan/dissectors/packet-h235.c
   M /trunk/epan/dissectors/packet-h235.h
   M /trunk/epan/dissectors/packet-h245.c
   M /trunk/epan/dissectors/packet-h245.h
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h
   M /trunk/epan/dissectors/packet-h282.c
   M /trunk/epan/dissectors/packet-h283.c
   M /trunk/epan/dissectors/packet-h323.c
   M /trunk/epan/dissectors/packet-h323.h
   M /trunk/epan/dissectors/packet-h450-ros.c
   M /trunk/epan/dissectors/packet-h450-ros.h
   M /trunk/epan/dissectors/packet-h450.c
   M /trunk/epan/dissectors/packet-h460.c
   M /trunk/epan/dissectors/packet-h501.c
   M /trunk/epan/dissectors/packet-hnbap.c
   M /trunk/epan/dissectors/packet-idmp.c
   M /trunk/epan/dissectors/packet-idmp.h
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-inap.h
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/dissectors/packet-ldap.h
   M /trunk/epan/dissectors/packet-logotypecertextn.c
   M /trunk/epan/dissectors/packet-logotypecertextn.h
   M /trunk/epan/dissectors/packet-lte-rrc.c
   M /trunk/epan/dissectors/packet-lte-rrc.h
   M /trunk/epan/dissectors/packet-mms.c
   M /trunk/epan/dissectors/packet-mms.h
   M /trunk/epan/dissectors/packet-mpeg-audio.c
   M /trunk/epan/dissectors/packet-mpeg-pes.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-ns_cert_exts.c
   M /trunk/epan/dissectors/packet-ocsp.c
   M /trunk/epan/dissectors/packet-ocsp.h
   M /trunk/epan/dissectors/packet-p1.c
   M /trunk/epan/dissectors/packet-p1.h
   M /trunk/epan/dissectors/packet-p22.c
   M /trunk/epan/dissectors/packet-p22.h
   M /trunk/epan/dissectors/packet-p7.c
   M /trunk/epan/dissectors/packet-p7.h
   M /trunk/epan/dissectors/packet-p772.c
   M /trunk/epan/dissectors/packet-p772.h
   M /trunk/epan/dissectors/packet-pcap.c
   M /trunk/epan/dissectors/packet-pkcs1.c
   M /trunk/epan/dissectors/packet-pkcs1.h
   M /trunk/epan/dissectors/packet-pkcs12.c
   M /trunk/epan/dissectors/packet-pkcs12.h
   M /trunk/epan/dissectors/packet-pkinit.c
   M /trunk/epan/dissectors/packet-pkinit.h
   M /trunk/epan/dissectors/packet-pkix1explicit.c
   M /trunk/epan/dissectors/packet-pkix1explicit.h
   M /trunk/epan/dissectors/packet-pkix1implicit.c
   M /trunk/epan/dissectors/packet-pkix1implicit.h
   M /trunk/epan/dissectors/packet-pkixac.c
   M /trunk/epan/dissectors/packet-pkixac.h
   M /trunk/epan/dissectors/packet-pkixproxy.c
   M /trunk/epan/dissectors/packet-pkixproxy.h
   M /trunk/epan/dissectors/packet-pkixqualified.c
   M /trunk/epan/dissectors/packet-pkixqualified.h
   M /trunk/epan/dissectors/packet-pkixtsp.c
   M /trunk/epan/dissectors/packet-pkixtsp.h
   M /trunk/epan/dissectors/packet-pres.c
   M /trunk/epan/dissectors/packet-pres.h
   M /trunk/epan/dissectors/packet-q932-ros.c
   M /trunk/epan/dissectors/packet-q932.c
   M /trunk/epan/dissectors/packet-q932.h
   M /trunk/epan/dissectors/packet-qsig.c
   M /trunk/epan/dissectors/packet-qsig.h
   M /trunk/epan/dissectors/packet-rnsap.c
   M /trunk/epan/dissectors/packet-ros.c
   M /trunk/epan/dissectors/packet-ros.h
   M /trunk/epan/dissectors/packet-rrc.c
   M /trunk/epan/dissectors/packet-rrc.h
   M /trunk/epan/dissectors/packet-rrlp.c
   M /trunk/epan/dissectors/packet-rtse.c
   M /trunk/epan/dissectors/packet-rtse.h
   M /trunk/epan/dissectors/packet-rua.c
   M /trunk/epan/dissectors/packet-s1ap.c
   M /trunk/epan/dissectors/packet-s1ap.h
   M /trunk/epan/dissectors/packet-sabp.c
   M /trunk/epan/dissectors/packet-smrse.c
   M /trunk/epan/dissectors/packet-smrse.h
   M /trunk/epan/dissectors/packet-snmp.c
   M /trunk/epan/dissectors/packet-snmp.h
   M /trunk/epan/dissectors/packet-spnego.c
   M /trunk/epan/dissectors/packet-sv.c
   M /trunk/epan/dissectors/packet-sv.h
   M /trunk/epan/dissectors/packet-t125.c
   M /trunk/epan/dissectors/packet-t125.h
   M /trunk/epan/dissectors/packet-t38.c
   M /trunk/epan/dissectors/packet-t38.h
   M /trunk/epan/dissectors/packet-tcap.c
   M /trunk/epan/dissectors/packet-tcap.h
   M /trunk/epan/dissectors/packet-ulp.c
   M /trunk/epan/dissectors/packet-wlancertextn.c
   M /trunk/epan/dissectors/packet-wlancertextn.h
   M /trunk/epan/dissectors/packet-x2ap.c
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509af.h
   M /trunk/epan/dissectors/packet-x509ce.c
   M /trunk/epan/dissectors/packet-x509ce.h
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h
   M /trunk/epan/dissectors/packet-x509sat.c
   M /trunk/epan/dissectors/packet-x509sat.h

Update generated ASN1 *.[hc] files after recent work done by Jeff Morriss;
The only change in each file is in a comment showing the asn2wrs cmd used to build that file.

------------------------------------------------------------------------
r39426 | wmeier | 2011-10-15 11:46:26 -0700 (Sat, 15 Oct 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-9p.c
   M /trunk/epan/dissectors/packet-acn.c
   M /trunk/epan/dissectors/packet-afp.c
   M /trunk/epan/dissectors/packet-agentx.c
   M /trunk/epan/dissectors/packet-aim-location.c
   M /trunk/epan/dissectors/packet-aim-signon.c
   M /trunk/epan/dissectors/packet-aim-ssi.c
   M /trunk/epan/dissectors/packet-aim-userlookup.c
   M /trunk/epan/dissectors/packet-aim.c
   M /trunk/epan/dissectors/packet-ajp13.c
   M /trunk/epan/dissectors/packet-amqp.c
   M /trunk/epan/dissectors/packet-ancp.c
   M /trunk/epan/dissectors/packet-applemidi.c
   M /trunk/epan/dissectors/packet-artnet.c
   M /trunk/epan/dissectors/packet-aruba-papi.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-atalk.c
   M /trunk/epan/dissectors/packet-banana.c
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-bjnp.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-bpdu.c
   M /trunk/epan/dissectors/packet-bthci_cmd.c
   M /trunk/epan/dissectors/packet-bthci_evt.c
   M /trunk/epan/dissectors/packet-btrfcomm.c
   M /trunk/epan/dissectors/packet-capwap.c
   M /trunk/epan/dissectors/packet-cast.c
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-cdp.c
   M /trunk/epan/dissectors/packet-cfm.c
   M /trunk/epan/dissectors/packet-cigi.c
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-classicstun.c
   M /trunk/epan/dissectors/packet-collectd.c
   M /trunk/epan/dissectors/packet-componentstatus.c
   M /trunk/epan/dissectors/packet-cops.c
   M /trunk/epan/dissectors/packet-daap.c
   M /trunk/epan/dissectors/packet-data.c
   M /trunk/epan/dissectors/packet-daytime.c
   M /trunk/epan/dissectors/packet-db-lsp.c
   M /trunk/epan/dissectors/packet-dcc.c
   M /trunk/epan/dissectors/packet-dcerpc-epm.c
   M /trunk/epan/dissectors/packet-dcerpc-fileexp.c
   M /trunk/epan/dissectors/packet-dcerpc-fldb.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc-rpriv.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_acct.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_misc.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_pgo.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcp-etsi.c
   M /trunk/epan/dissectors/packet-dec-dnart.c
   M /trunk/epan/dissectors/packet-dhcp-failover.c
   M /trunk/epan/dissectors/packet-diameter_3gpp.c
   M /trunk/epan/dissectors/packet-distcc.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-dplay.c
   M /trunk/epan/dissectors/packet-dpnss.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-dtn.c
   M /trunk/epan/dissectors/packet-dua.c
   M /trunk/epan/dissectors/packet-dvbci.c
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-enttec.c
   M /trunk/epan/dissectors/packet-epl.c
   M /trunk/epan/dissectors/packet-epmd.c
   M /trunk/epan/dissectors/packet-erldp.c
   M /trunk/epan/dissectors/packet-etch.c
   M /trunk/epan/dissectors/packet-fcdns.c
   M /trunk/epan/dissectors/packet-fcfcs.c
   M /trunk/epan/dissectors/packet-fcfzs.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-ff.c
   M /trunk/epan/dissectors/packet-fix.c
   M /trunk/epan/dissectors/packet-ftp.c
   M /trunk/epan/dissectors/packet-fw1.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-glbp.c
   M /trunk/epan/dissectors/packet-gnutella.c
   M /trunk/epan/dissectors/packet-gopher.c
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk/epan/dissectors/packet-gsm_ipa.c
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-hdfs.c
   M /trunk/epan/dissectors/packet-hdfsdata.c
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-ieee80211-prism.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-image-png.c
   M /trunk/epan/dissectors/packet-imf.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-interlink.c
   M /trunk/epan/dissectors/packet-ipmi-app.c
   M /trunk/epan/dissectors/packet-ipmi-picmg.c
   M /trunk/epan/dissectors/packet-ipmi-se.c
   M /trunk/epan/dissectors/packet-ipmi-storage.c
   M /trunk/epan/dissectors/packet-ipmi-transport.c
   M /trunk/epan/dissectors/packet-ipxwan.c
   M /trunk/epan/dissectors/packet-irc.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-iua.c
   M /trunk/epan/dissectors/packet-jxta.c
   M /trunk/epan/dissectors/packet-kdp.c
   M /trunk/epan/dissectors/packet-kpasswd.c
   M /trunk/epan/dissectors/packet-laplink.c
   M /trunk/epan/dissectors/packet-linx.c
   M /trunk/epan/dissectors/packet-lwres.c
   M /trunk/epan/dissectors/packet-m2ua.c
   M /trunk/epan/dissectors/packet-m3ua.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-mactelnet.c
   M /trunk/epan/dissectors/packet-megaco.c
   M /trunk/epan/dissectors/packet-memcache.c
   M /trunk/epan/dissectors/packet-mgcp.c
   M /trunk/epan/dissectors/packet-miop.c
   M /trunk/epan/dissectors/packet-mip.c
   M /trunk/epan/dissectors/packet-mongo.c
   M /trunk/epan/dissectors/packet-ms-mms.c
   M /trunk/epan/dissectors/packet-msrp.c
   M /trunk/epan/dissectors/packet-multipart.c
   M /trunk/epan/dissectors/packet-mysql.c
   M /trunk/epan/dissectors/packet-nasdaq-itch.c
   M /trunk/epan/dissectors/packet-nasdaq-soup.c
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-netflow.c
   M /trunk/epan/dissectors/packet-netsync.c
   M /trunk/epan/dissectors/packet-nsrp.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-ntp.c
   M /trunk/epan/dissectors/packet-oicq.c
   M /trunk/epan/dissectors/packet-olsr.c
   M /trunk/epan/dissectors/packet-omron-fins.c
   M /trunk/epan/dissectors/packet-packetlogger.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pflog.c
   M /trunk/epan/dissectors/packet-pgsql.c
   M /trunk/epan/dissectors/packet-pktc.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-ppi-antenna.c
   M /trunk/epan/dissectors/packet-ppi-gps.c
   M /trunk/epan/dissectors/packet-ppi-vector.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-pppoe.c
   M /trunk/epan/dissectors/packet-pptp.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-quake.c
   M /trunk/epan/dissectors/packet-radius_packetcable.c
   M /trunk/epan/dissectors/packet-redbackli.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-rip.c
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-rlogin.c
   M /trunk/epan/dissectors/packet-rmp.c
   M /trunk/epan/dissectors/packet-rpcap.c
   M /trunk/epan/dissectors/packet-rsip.c
   M /trunk/epan/dissectors/packet-rsync.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-rtmpt.c
   M /trunk/epan/dissectors/packet-sasp.c
   M /trunk/epan/dissectors/packet-scriptingservice.c
   M /trunk/epan/dissectors/packet-scsi-mmc.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-sebek.c
   M /trunk/epan/dissectors/packet-ses.c
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/dissectors/packet-skinny.c
   M /trunk/epan/dissectors/packet-slsk.c
   M /trunk/epan/dissectors/packet-smb-browse.c
   M /trunk/epan/dissectors/packet-smb-mailslot.c
   M /trunk/epan/dissectors/packet-smb-pipe.c
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smtp.c
   M /trunk/epan/dissectors/packet-socks.c
   M /trunk/epan/dissectors/packet-spice.c
   M /trunk/epan/dissectors/packet-srvloc.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/dissectors/packet-starteam.c
   M /trunk/epan/dissectors/packet-stun.c
   M /trunk/epan/dissectors/packet-sua.c
   M /trunk/epan/dissectors/packet-synergy.c
   M /trunk/epan/dissectors/packet-syslog.c
   M /trunk/epan/dissectors/packet-tapa.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-teamspeak2.c
   M /trunk/epan/dissectors/packet-telnet.c
   M /trunk/epan/dissectors/packet-tftp.c
   M /trunk/epan/dissectors/packet-tipc.c
   M /trunk/epan/dissectors/packet-tivoconnect.c
   M /trunk/epan/dissectors/packet-tnef.c
   M /trunk/epan/dissectors/packet-tns.c
   M /trunk/epan/dissectors/packet-tsp.c
   M /trunk/epan/dissectors/packet-turbocell.c
   M /trunk/epan/dissectors/packet-ua.c
   M /trunk/epan/dissectors/packet-ucp.c
   M /trunk/epan/dissectors/packet-uma.c
   M /trunk/epan/dissectors/packet-usb-at.c
   M /trunk/epan/dissectors/packet-v52.c
   M /trunk/epan/dissectors/packet-v5ua.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-vtp.c
   M /trunk/epan/dissectors/packet-wbxml.c
   M /trunk/epan/dissectors/packet-wifi-p2p.c
   M /trunk/epan/dissectors/packet-wlccp.c
   M /trunk/epan/dissectors/packet-wow.c
   M /trunk/epan/dissectors/packet-wps.c
   M /trunk/epan/dissectors/packet-wsmp.c
   M /trunk/epan/dissectors/packet-wsp.c
   M /trunk/epan/dissectors/packet-wtls.c
   M /trunk/epan/dissectors/packet-x224.c
   M /trunk/epan/dissectors/packet-xcsl.c
   M /trunk/epan/dissectors/packet-xmcp.c
   M /trunk/epan/dissectors/packet-xml.c
   M /trunk/epan/dissectors/packet-xot.c
   M /trunk/epan/dissectors/packet-yhoo.c
   M /trunk/epan/dissectors/packet-ymsg.c
   M /trunk/epan/dissectors/packet-zebra.c
   M /trunk/epan/dissectors/packet-ziop.c
   M /trunk/epan/dissectors/packet-zrtp.c

Convert proto_tree_add_item() 'encoding' arg for field types FT_STRING, FT_STRINGZ, FT_UINT_STRING as follows:
 1. If there's no character encoding (ENC_ASCII, ...) specified
    then use ENC_ASCII.
 2. For all but FT_UINT_STRING, always use ENC_NA
    (replacing any existing True/1/FALSE/0
    /ENC_BIG_ENDIAN/ENC_LITTLE_ENDIAN).



------------------------------------------------------------------------
r39425 | wmeier | 2011-10-15 08:21:35 -0700 (Sat, 15 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fmtp.c

Remove some unneeded code form proto_reg_handoff...();
Comment out an unused #define;
Do some whitespace cleanup ("4 space tabs" ==> spaces).

------------------------------------------------------------------------
r39424 | martinm | 2011-10-14 09:03:11 -0700 (Fri, 14 Oct 2011) | 5 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Make make_menu_actions() static again, but protect with
#ifdef HAVE_LUA_5_1
#endif
As per discission on wireshark-dev, this function might later see wider use, so don't add 'lua' to the function name.

------------------------------------------------------------------------
r39423 | morriss | 2011-10-14 06:26:32 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.inc.nmake

Build generate_export when building 'all' on Windows too.
------------------------------------------------------------------------
r39422 | martinm | 2011-10-14 04:03:29 -0700 (Fri, 14 Oct 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

make_menu_items() isn't called without LUA support, so can't be static.

------------------------------------------------------------------------
r39421 | morriss | 2011-10-14 03:22:01 -0700 (Fri, 14 Oct 2011) | 12 lines
Changed paths:
   M /trunk/asn1/Makefile.inc
   M /trunk/asn1/Makefile.inc.nmake
   M /trunk/asn1/acse/Makefile.common
   M /trunk/asn1/charging_ase/Makefile.common
   M /trunk/asn1/cmip/Makefile.common
   M /trunk/asn1/cms/Makefile.common
   M /trunk/asn1/credssp/Makefile.common
   M /trunk/asn1/crmf/Makefile.common
   M /trunk/asn1/dap/Makefile.common
   M /trunk/asn1/disp/Makefile.common
   M /trunk/asn1/dop/Makefile.common
   M /trunk/asn1/dsp/Makefile.common
   M /trunk/asn1/ess/Makefile.common
   M /trunk/asn1/gprscdr/Makefile.common
   M /trunk/asn1/gsm_map/Makefile.common
   M /trunk/asn1/h225/Makefile.common
   M /trunk/asn1/h235/Makefile.common
   M /trunk/asn1/h245/Makefile.common
   M /trunk/asn1/h450-ros/Makefile.common
   M /trunk/asn1/idmp/Makefile.common
   M /trunk/asn1/inap/Makefile.common
   M /trunk/asn1/kerberos/Makefile.common
   M /trunk/asn1/lte-rrc/Makefile.common
   M /trunk/asn1/p1/Makefile.common
   M /trunk/asn1/p22/Makefile.common
   M /trunk/asn1/p7/Makefile.common
   M /trunk/asn1/p772/Makefile.common
   M /trunk/asn1/pkcs12/Makefile.common
   M /trunk/asn1/q932/Makefile.common
   M /trunk/asn1/qsig/Makefile.common
   M /trunk/asn1/ros/Makefile.common
   M /trunk/asn1/rtse/Makefile.common
   M /trunk/asn1/x509af/Makefile.common
   M /trunk/asn1/x509ce/Makefile.common
   M /trunk/asn1/x509if/Makefile.common
   M /trunk/asn1/x509sat/Makefile.common

Don't generate the conformance file for exported types when building the
dissector; instead built it only when the separate target (generate_export)
is built.

Built generate_export when building "all".

This prevents the exp_*.cnf files from being regenerated each time another one
of the exp_*.cnf files (which the current dissector depends on) has changed
(despite the fact that the exported types does not depe

Also fix the CLEANFILES definition so it actually cleans things.

------------------------------------------------------------------------
r39420 | stig | 2011-10-14 01:39:23 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-mapi.c
   M /trunk/epan/dissectors/pidl/mapi/request.cnf.c

Removed unused old_offset in mapi_dissect_struct_request.
------------------------------------------------------------------------
r39419 | stig | 2011-10-14 01:22:16 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/wiretap/erf.c

Removed newencap as it's unused.
------------------------------------------------------------------------
r39418 | guy | 2011-10-14 01:00:21 -0700 (Fri, 14 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ajp13.c

From Iain Arnell:

Adds additional header fields for AJP13 request attributes.

------------------------------------------------------------------------
r39417 | guy | 2011-10-14 00:52:11 -0700 (Fri, 14 Oct 2011) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ajp13.c

From Iain Arnell:

The existing code adds all ajp13 header names to the protocol tree as
ajp13.hval; header values aren't added at all. The original intention
appears to have been to add header names as ajp13.hname and their values
as ajp13.hval. Even if implemented properly, this doesn't allow
filtering properly (unless there's some funky syntax I'm not aware of).

This patch uses dedicated header fields for those request/response
headers that are explicitly defined in AJP13 protocol. Undefined headers
names and their values are added as a single ajp13.additional_header in
easily matched "Header-Name: Value" string format.

------------------------------------------------------------------------
r39416 | guy | 2011-10-14 00:45:22 -0700 (Fri, 14 Oct 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ajp13.c

From Iain Arnell:

AJP13 uses a string size of 0xFFFF to indicate a null string;
ajp13_get_nstring function would incorrectly return invalid data.

In disaply_req_body function, the content_length really is the length of
the data; there is no trailing null.

------------------------------------------------------------------------
r39415 | stig | 2011-10-14 00:44:50 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Added support for SIO-Label from draft-zeilenga-email-seclabel-04.
------------------------------------------------------------------------
r39414 | stig | 2011-10-14 00:44:40 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/p1/p1.cnf
   M /trunk/epan/dissectors/packet-p1.c
   M /trunk/epan/dissectors/packet-p1.h

Export MessageSecurityLabel_PDU.
------------------------------------------------------------------------
r39413 | stig | 2011-10-14 00:44:20 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/ess/ess.cnf
   M /trunk/asn1/ess/packet-ess-template.h
   M /trunk/epan/dissectors/packet-ess.c
   M /trunk/epan/dissectors/packet-ess.h

Export ESSSecurityLabel_PDU.
------------------------------------------------------------------------
r39412 | etxrab | 2011-10-13 23:19:37 -0700 (Thu, 13 Oct 2011) | 1 line
Changed paths:
   M /trunk/gtk/funnel_stat.c

{0, NULL} is required as the last value_string array entry: value_string VALS_GROUP_NAMES[]
------------------------------------------------------------------------
r39411 | etxrab | 2011-10-13 22:42:37 -0700 (Thu, 13 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-brp.c

From Rob Kruciak:
Add a port preference setting.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6430
------------------------------------------------------------------------
r39410 | etxrab | 2011-10-13 22:08:39 -0700 (Thu, 13 Oct 2011) | 6 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/main_menubar.c

From Tony Trinh:
Patch to fix/restore Lua menu functionality

Remove unnecessary Lua placeholder in UI definition for the main menu bar

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6405
------------------------------------------------------------------------
r39409 | tuexen | 2011-10-13 13:13:52 -0700 (Thu, 13 Oct 2011) | 2 lines
Changed paths:
   M /trunk/filters.c

Use g_list_first() to find the first element in the list.

------------------------------------------------------------------------
r39408 | etxrab | 2011-10-13 12:41:34 -0700 (Thu, 13 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/ranap/packet-ranap-template.c
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-ranap.c
   M /trunk/epan/dissectors/packet-ranap.h

Dissect NSAP encoded transport layer address.
------------------------------------------------------------------------
r39407 | stig | 2011-10-13 12:39:35 -0700 (Thu, 13 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/wslua/wslua_pinfo.c

Added some Lua pinfo fields:
ethertype, fragmented, in_error_pkt, match_uint and match_string.
------------------------------------------------------------------------
r39406 | tuexen | 2011-10-13 12:04:25 -0700 (Thu, 13 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/gtk/sctp_graph_dlg.c

Make clang on Mac OS X 10.7.2. happy.

------------------------------------------------------------------------
r39405 | etxrab | 2011-10-13 11:22:55 -0700 (Thu, 13 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

From Pascal Quantin.
a follow-up patch that fixes the dissection of the Generic NAS transport messages.
------------------------------------------------------------------------
r39404 | cmaynard | 2011-10-13 08:49:45 -0700 (Thu, 13 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ajp13.c
   M /trunk/epan/dissectors/packet-fmtp.c

Delete unused hf_ entries found by checkhf.pl.

------------------------------------------------------------------------
r39403 | etxrab | 2011-10-12 23:06:53 -0700 (Wed, 12 Oct 2011) | 8 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-fmtp.c

From Christophe PALETOU:
Add dissector for public protocol Flight Message Transfer Protocol (FMTP)
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6433

- Modified and moved col_add_fstr outside of if(tree)
- call data dissector for data
- use ENC_BIG_ENDIAN
- minor cleanups
------------------------------------------------------------------------
r39402 | etxrab | 2011-10-12 22:15:50 -0700 (Wed, 12 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

From Horaci Macias:
Parse User-to-User header 
http://tools.ietf.org/html/draft-ietf-cuss-sip-uui-02

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6432
------------------------------------------------------------------------
r39401 | wmeier | 2011-10-12 19:05:00 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Fix a typo

------------------------------------------------------------------------
r39400 | wmeier | 2011-10-12 18:24:43 -0700 (Wed, 12 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipmotion.c

Initial a variable to prevent a (not actualy valid) compiler warning:
'inst_count' may be used uninitialized in this function.

------------------------------------------------------------------------
r39399 | wmeier | 2011-10-12 18:17:51 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipmotion.c

Fix a "set but not used" compiler warning.

------------------------------------------------------------------------
r39398 | wmeier | 2011-10-12 18:09:17 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipmotion.c

Fix a "defined but not used" compiler warning.

------------------------------------------------------------------------
r39397 | wmeier | 2011-10-12 17:16:54 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cipmotion.c

Mark some function parameters as unused (_U_); Fixes compiler warnings.

------------------------------------------------------------------------
r39396 | wmeier | 2011-10-12 17:00:52 -0700 (Wed, 12 Oct 2011) | 14 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cip.h
   A /trunk/epan/dissectors/packet-cipmotion.c
   M /trunk/epan/dissectors/packet-enip.c

From Benjamin Stocks (with some work by Michael Mann): "CIP Motion" dissector;
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5929

From me:
packet-cipmotion.c:
  FT_BOOLEAN fields with bitmasks need a bit-fieldwidth in the hf[] entry 'display' field;
  Define attribute_size as guint32 since it has to store guint8*guint16;
  Use ENC_NA as encoding arg in proto_tree_add_item() for FT_BYTES field types;
  Remove trailing whitespace from lines;
  Other minor cleanup and reformatting.

packet-enip.c:
  Use ENC_NA as encoding arg in proto_tree_add_item() for FT_BYTES field types;

------------------------------------------------------------------------
r39395 | etxrab | 2011-10-12 14:17:23 -0700 (Wed, 12 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

From Pascal Quantin.
Add dissection of Location services messages
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6454
------------------------------------------------------------------------
r39394 | etxrab | 2011-10-12 11:57:50 -0700 (Wed, 12 Oct 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-atm.c
   M /trunk/epan/dissectors/packet-meta.c
   M /trunk/wiretap/wtap.h

From Tobias Witek: 
This patch extends the ATM parser so as to allow GPRS NS traffic encapsulated
in ATM AAL5.

Additionally, added support for this into the 'Meta' dissector.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6447
------------------------------------------------------------------------
r39393 | cmaynard | 2011-10-12 11:38:38 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c

When looping, be sure to iterate over the right number of elements.  Fixes Coverity OVERRUN_STATIC errors reported in CID's 1305 and 1306.  Also, fix the 3 offending display filter names discovered with tools/checkfiltername.pl.

------------------------------------------------------------------------
r39392 | wmeier | 2011-10-12 11:04:58 -0700 (Wed, 12 Oct 2011) | 12 lines
Changed paths:
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/network_instruments.c

From Robert Bullen: Fix for: Two minor bugs in Wiretap library:

First bug: The Network Instruments Observer file format abbreviation is
incorrect. It is "niobserverv" instead of "niobserver", which is probably a
vestige from 1.4 when the abbreviation was "niobserverv9".

Second bug: The packet header magic number field is correctly swapped the first
time when reading the entire packet header. It is incorrectly swapped yet again
when reporting an invalid value. Both swaps use GUINT_FROM_LE, which is a no-op
on little-endian platforms. But the error message that is displayed to users of
big-endian platforms will contain a byte-reversed value.

------------------------------------------------------------------------
r39391 | cmaynard | 2011-10-12 11:01:41 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eigrp.c

There are no preferences for this dissector so eliminate unneeded preference-related code.  Fixes Coverity CID 1311.

------------------------------------------------------------------------
r39390 | guy | 2011-10-12 10:55:49 -0700 (Wed, 12 Oct 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ajp13.c

From Iain Arnell:

A missing value_ptr parameter in the handling of ajp13 response headers
led to them being displayed differently than the request headers.

This patch also simplifies the offset/length calculation for header
values, and skips the size for consistency with handling of other ajp13
string values.

------------------------------------------------------------------------
r39389 | guy | 2011-10-12 10:54:23 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Add Iain Arnell, who contributed ajp13 patches.

------------------------------------------------------------------------
r39388 | guy | 2011-10-12 10:53:58 -0700 (Wed, 12 Oct 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ajp13.c

From Iain Arnell:

Revision 35984 introduced a regression in ajp13_get_nstring. According
to the comments here, the returned length _includes_ the trailing null.
The encoded length, however, does _not_ including the trailing null.
This patch resolves the problem by simply adding 1 to the returned
length.

------------------------------------------------------------------------
r39387 | wmeier | 2011-10-12 10:30:31 -0700 (Wed, 12 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nt-tpcp.c

Fix a benign bug: use intended proto_tree_add_uint() instaed of proto_tree_add_item();
Fix an endianness issue;
Add a comment re "tvb_memcpy to a struct is not kosher".

------------------------------------------------------------------------
r39386 | etxrab | 2011-10-12 09:41:42 -0700 (Wed, 12 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/camel/CAP-GPRS-ReferenceNumber.asn
   M /trunk/asn1/camel/CAP-SMS-ops-args.asn
   M /trunk/asn1/camel/CAP-U-ABORT-Data.asn
   M /trunk/asn1/camel/CAP-classes.asn
   M /trunk/asn1/camel/CAP-datatypes.asn
   M /trunk/asn1/camel/CAP-errorcodes.asn
   M /trunk/asn1/camel/CAP-errortypes.asn
   M /trunk/asn1/camel/CAP-gprsSSF-gsmSCF-ops-args.asn
   M /trunk/asn1/camel/CAP-gsmSCF-gsmSRF-ops-args.asn
   M /trunk/asn1/camel/CAP-gsmSSF-gsmSCF-ops-args.asn
   M /trunk/asn1/camel/CAP-object-identifiers.asn
   M /trunk/asn1/camel/CAP-operationcodes.asn
   M /trunk/asn1/gsm_map/GSMMAP.asn
   M /trunk/asn1/gsm_map/MAP-ApplicationContexts.asn
   M /trunk/asn1/gsm_map/MAP-BS-Code.asn
   M /trunk/asn1/gsm_map/MAP-CH-DataTypes.asn
   M /trunk/asn1/gsm_map/MAP-CallHandlingOperations.asn
   M /trunk/asn1/gsm_map/MAP-CommonDataTypes.asn
   M /trunk/asn1/gsm_map/MAP-DialogueInformation.asn
   M /trunk/asn1/gsm_map/MAP-ER-DataTypes.asn
   M /trunk/asn1/gsm_map/MAP-Errors.asn
   M /trunk/asn1/gsm_map/MAP-ExtensionDataTypes.asn
   M /trunk/asn1/gsm_map/MAP-GR-DataTypes.asn
   M /trunk/asn1/gsm_map/MAP-Group-Call-Operations.asn
   M /trunk/asn1/gsm_map/MAP-LCS-DataTypes.asn
   M /trunk/asn1/gsm_map/MAP-LocationServiceOperations.asn
   M /trunk/asn1/gsm_map/MAP-MS-DataTypes.asn
   M /trunk/asn1/gsm_map/MAP-MobileServiceOperations.asn
   M /trunk/asn1/gsm_map/MAP-OM-DataTypes.asn
   M /trunk/asn1/gsm_map/MAP-OperationAndMaintenanceOperations.asn
   M /trunk/asn1/gsm_map/MAP-Protocol.asn
   M /trunk/asn1/gsm_map/MAP-SM-DataTypes.asn
   M /trunk/asn1/gsm_map/MAP-SS-Code.asn
   M /trunk/asn1/gsm_map/MAP-SS-DataTypes.asn
   M /trunk/asn1/gsm_map/MAP-ShortMessageServiceOperations.asn
   M /trunk/asn1/gsm_map/MAP-SupplementaryServiceOperations.asn
   M /trunk/asn1/gsm_map/MAP-TS-Code.asn
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-camel.h
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Update the Camel and MAP ASN.1 files.
------------------------------------------------------------------------
r39385 | wmeier | 2011-10-12 09:31:41 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wcp.c

Cleanup use of proto_tree_add_item()/proto_tree_add_uint() in a few cases

------------------------------------------------------------------------
r39384 | wmeier | 2011-10-12 08:02:11 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Fix a benign bug: Use correct proto_tree_add_item() encoding arg.

------------------------------------------------------------------------
r39383 | wmeier | 2011-10-12 07:12:36 -0700 (Wed, 12 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gmhdr.c
   M /trunk/epan/dissectors/packet-netflow.c
   M /trunk/epan/dissectors/packet-reload.c

Fix some proto_tree_add_item() FT_ABSOLUTE_TIME encoding parameters:

Again: a tip o'the hat to Guy.


------------------------------------------------------------------------
r39382 | alagoutte | 2011-10-12 00:44:14 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Add Modification CMake (Following add in Rev 39379)

------------------------------------------------------------------------
r39381 | etxrab | 2011-10-11 22:27:41 -0700 (Tue, 11 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/libwireshark.def

Revert http://anonsvn.wireshark.org/viewvc/viewvc.cgi?view=rev&revision=39380
------------------------------------------------------------------------
r39380 | etxrab | 2011-10-11 22:12:49 -0700 (Tue, 11 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/libwireshark.def

From Eliot:
Patch libwireshark.def adding some symbols needed by wspyton
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6448
------------------------------------------------------------------------
r39379 | etxrab | 2011-10-11 22:08:51 -0700 (Tue, 11 Oct 2011) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ieee80211-prism.c
   A /trunk/epan/dissectors/packet-ieee80211-radio.c
   A /trunk/epan/dissectors/packet-ieee80211-wlancap.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ieee80211.h

From Jouni Malinen: 
Move sniffer meta data parsing to separate files

packet-ieee80211.c includes dissectors for three different styles
of IEEE 802.11 sniffer meta data (like signal strength). Move these
to separate files in the same style as a fourth format (radiotap)
was already handled, so that packet-ieee80211.c focuses on the
actual IEEE 802.11 frame dissecting.

This reverts
http://anonsvn.wireshark.org/viewvc?revision=23911&view=revision
Objections?
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6443
------------------------------------------------------------------------
r39378 | wmeier | 2011-10-11 20:28:07 -0700 (Tue, 11 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Fix a case wherein proto_tree_add_boolean() was intended instead of proto_tree_add_item().
Also: Use proto_tree_add_boolean() instead of proto_tree_add_item() for code consistency in 2 other cases.


------------------------------------------------------------------------
r39377 | guy | 2011-10-11 13:19:46 -0700 (Tue, 11 Oct 2011) | 3 lines
Changed paths:
   M /trunk/asn1/lcsap/packet-lcsap-template.c

Update template to match generated dissector - dissector_try_port() is
dead, long live dissector_try_uint().

------------------------------------------------------------------------
r39376 | etxrab | 2011-10-11 12:35:43 -0700 (Tue, 11 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-lcsap.c

Use dissector_try_uint()
------------------------------------------------------------------------
r39375 | etxrab | 2011-10-11 12:24:19 -0700 (Tue, 11 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/wspython/wspy_dissector.py

From Eliot:
Patch wspy_dissector.py to use dissector_add_uint
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6448
------------------------------------------------------------------------
r39374 | etxrab | 2011-10-11 12:16:15 -0700 (Tue, 11 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/wspython/wspy_dissectors/homeplug.py.sample

From Eliot:
Patch homeplug.py wspython sample to not conflict with built in homeplug

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6448
------------------------------------------------------------------------
r39373 | stig | 2011-10-11 12:01:32 -0700 (Tue, 11 Oct 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Make asn1/lcsap/Makefile

------------------------------------------------------------------------
r39372 | stig | 2011-10-11 12:01:15 -0700 (Tue, 11 Oct 2011) | 2 lines
Changed paths:
   M /trunk/asn1/lcsap

Set svn:ignore targets.

------------------------------------------------------------------------
r39371 | etxrab | 2011-10-11 11:46:27 -0700 (Tue, 11 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen: 
Dissect Time Advertisement and Time Zone elements.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6443
------------------------------------------------------------------------
r39370 | etxrab | 2011-10-11 11:43:13 -0700 (Tue, 11 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen: 
ieee80211: Start splitting add_tagged_field into helper functions.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6443
------------------------------------------------------------------------
r39369 | etxrab | 2011-10-11 11:40:02 -0700 (Tue, 11 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen: 
Simplify tag_num_vals.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6443
------------------------------------------------------------------------
r39368 | etxrab | 2011-10-11 11:29:29 -0700 (Tue, 11 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen: 
Dissect WNM (IEEE 802.11v) information.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6443
------------------------------------------------------------------------
r39367 | etxrab | 2011-10-11 11:26:03 -0700 (Tue, 11 Oct 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-wifi-p2p.c
   M /trunk/epan/dissectors/packet-wifi-p2p.h

From Jouni Malinen: 
Wi-Fi P2P: Show frame name in col_info

Make it easier to find specific P2P frames by adding the name of the P2P
Public Action frames into col_info.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6443
------------------------------------------------------------------------
r39366 | etxrab | 2011-10-11 11:21:27 -0700 (Tue, 11 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

From Harald Welte:
In order to ensure one consistent GSMTAP definition, some comments are added to
the code in order to make sure modifications are first merged in the GSMTAP
mainline header file, and then propagated to wireshark.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6442
------------------------------------------------------------------------
r39365 | etxrab | 2011-10-11 11:16:53 -0700 (Tue, 11 Oct 2011) | 1 line
Changed paths:
   M /trunk/AUTHORS
   M /trunk/asn1/Makefile.am
   M /trunk/asn1/Makefile.nmake
   M /trunk/asn1/lcsap/lcsap.cnf
   M /trunk/asn1/lcsap/packet-lcsap-template.c
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-lcsap.c

Build the LCS-AP dissector.
------------------------------------------------------------------------
r39364 | martinm | 2011-10-11 11:06:01 -0700 (Tue, 11 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c

Avoid longjmp warning by making adding volatile.

------------------------------------------------------------------------
r39363 | gerald | 2011-10-11 10:57:09 -0700 (Tue, 11 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ipv6.c

Enable GeoIP lookups by default. Don't add GeoIP subtrees if we didn't
find any databases.

------------------------------------------------------------------------
r39362 | etxrab | 2011-10-11 09:49:18 -0700 (Tue, 11 Oct 2011) | 2 lines
Changed paths:
   A /trunk/asn1/lcsap
   A /trunk/asn1/lcsap/LCS-AP-CommonDataTypes.asn
   A /trunk/asn1/lcsap/LCS-AP-Constants.asn
   A /trunk/asn1/lcsap/LCS-AP-Containers.asn
   A /trunk/asn1/lcsap/LCS-AP-IEs.asn
   A /trunk/asn1/lcsap/LCS-AP-PDU-Contents.asn
   A /trunk/asn1/lcsap/LCS-AP-PDU-Descriptions.asn
   A /trunk/asn1/lcsap/Makefile.am
   A /trunk/asn1/lcsap/Makefile.common
   A /trunk/asn1/lcsap/Makefile.nmake
   A /trunk/asn1/lcsap/lcsap.cnf
   A /trunk/asn1/lcsap/packet-lcsap-template.c

From Spenser Sheng:
LCS-AP dissector.
------------------------------------------------------------------------
r39361 | wmeier | 2011-10-11 08:39:47 -0700 (Tue, 11 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-9p.c
   M /trunk/epan/dissectors/packet-aim-messaging.c
   M /trunk/epan/dissectors/packet-dec-dnart.c
   M /trunk/epan/dissectors/packet-sbus.c

Fix benign bugs wherein proto_tree_add_uint() was intended instead of proto_tree_add_item();
 (Replaces changes made in SVN #39351).

------------------------------------------------------------------------
r39360 | wmeier | 2011-10-11 08:11:51 -0700 (Tue, 11 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bittorrent.c

Fix a bug wherein proto_tree_add_uint() was intended instead of proto_tree_add_item();
This bug would have caused display of a FT_UINT32 field with the wrong endianness.
(Replaces change made in SVN #39350).


------------------------------------------------------------------------
r39359 | wmeier | 2011-10-11 07:58:54 -0700 (Tue, 11 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl.c

Use intended proto_tree_add_uint() instead of proto_tree_add_item() to fix benign bugs (Replaces SVN #39348).

------------------------------------------------------------------------
r39358 | wmeier | 2011-10-11 07:49:09 -0700 (Tue, 11 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip.c

Fix several cases wherein proto_tree_add_uint() was intended iso proto_tree_add_item();
One case would have caused display of a FT_UINT16 field with the wrong endianness.

------------------------------------------------------------------------
r39357 | wmeier | 2011-10-11 07:31:01 -0700 (Tue, 11 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip.c

Revert SVN #39347; There's a better way.

------------------------------------------------------------------------
r39356 | wmeier | 2011-10-11 07:10:52 -0700 (Tue, 11 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smpp.c

Fix a number of benign bugs wherein proto_tree_add_uint was intended (rather than proto_tree_add_item).
Tip o' the hat to Guy ...

------------------------------------------------------------------------
r39355 | wmeier | 2011-10-11 07:02:26 -0700 (Tue, 11 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smpp.c

Revert SVN #39345; (There's a better way ...)

------------------------------------------------------------------------
r39354 | guy | 2011-10-10 18:25:54 -0700 (Mon, 10 Oct 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

No libpcap, no capturing, no capture filters, no capture_filter_init().

------------------------------------------------------------------------
r39353 | morriss | 2011-10-10 17:46:21 -0700 (Mon, 10 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/t124

Ignore (this directory's copy of) MCS-PROTOCOL.asn
------------------------------------------------------------------------
r39352 | wmeier | 2011-10-10 16:45:33 -0700 (Mon, 10 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

Fix "unused variable" compile error.

------------------------------------------------------------------------
r39351 | wmeier | 2011-10-10 16:36:07 -0700 (Mon, 10 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-9p.c
   M /trunk/epan/dissectors/packet-aim-messaging.c
   M /trunk/epan/dissectors/packet-dec-dnart.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-sbus.c

 Fix benign bugs in some proto_tree_add_item() 'encoding' args;

------------------------------------------------------------------------
r39350 | wmeier | 2011-10-10 16:34:24 -0700 (Mon, 10 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-manolito.c

Fix bugs which caused certain fields to display with the wrong endianness;
Specifically: some proto_tree_add_item() 'encoding' args were incorrect.

------------------------------------------------------------------------
r39349 | gerald | 2011-10-10 15:39:35 -0700 (Mon, 10 Oct 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_dlg.h
   M /trunk/gtk/main.c

Check our capture filter syntax in a separate thread.

------------------------------------------------------------------------
r39348 | wmeier | 2011-10-10 14:53:15 -0700 (Mon, 10 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl.c

Fix benign bugs in some proto_tree_add_item() 'encoding' args;

------------------------------------------------------------------------
r39347 | wmeier | 2011-10-10 14:46:19 -0700 (Mon, 10 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip.c

Fix additiuonal bugs in some proto_tree_add_item() 'encoding' args;
Two of the bugs would appear to have caused display of a FT_UINT16 field with
 the wrong endianness.

------------------------------------------------------------------------
r39346 | wmeier | 2011-10-10 14:29:10 -0700 (Mon, 10 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip.c

Fix benign bug in some proto_tree_add_item() 'encoding' args;
Use consistent indentation.

------------------------------------------------------------------------
r39345 | wmeier | 2011-10-10 14:12:05 -0700 (Mon, 10 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smpp.c

Fix some benign bugs in proto_tree_add_item() 'encoding' arg.

------------------------------------------------------------------------
r39344 | wmeier | 2011-10-10 13:57:56 -0700 (Mon, 10 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-assa_r3.c

Comment out some unused hf[] entries;
Add notes about missing hf[] entries.

------------------------------------------------------------------------
r39343 | wmeier | 2011-10-10 13:12:57 -0700 (Mon, 10 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-assa_r3.c

Convert proto_tree_add_item() 'encoding' parameter as appropriate.

------------------------------------------------------------------------
r39342 | etxrab | 2011-10-10 12:16:58 -0700 (Mon, 10 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-eigrp.c

Use guint64
------------------------------------------------------------------------
r39341 | wmeier | 2011-10-10 12:10:13 -0700 (Mon, 10 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-jxta.c

Fix a benign bug in proto_tree_add_item() 'encoding' arg.

------------------------------------------------------------------------
r39340 | etxrab | 2011-10-10 11:26:33 -0700 (Mon, 10 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/Custom.make
   M /trunk/asn1/Makefile.nmake

Make it possible to build custom ASN1 based dissectors on Windows.
------------------------------------------------------------------------
r39339 | etxrab | 2011-10-10 11:11:18 -0700 (Mon, 10 Oct 2011) | 15 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-eigrp.c

From Donnie Savage:
Re-write of the EIGRP dissector to support Multi-Protocol (TLV 2.0) and
Multi-Topology (TLV 3.0).  This version also support Service Advertisement
Framework(SAF) extensions to EIGRP

Dissector includes:
- Dissection of all EIGRP Opcodes and TLVs
- Decode of EIGRP Flags and bitfields
- Decode of EIGRP Communities
- Decode of latest EIGRP "wide metric" formats
- Decode of EIGRP Extended Metrics
- Decode of SAF packets with XML client data handed off to XML dissector

From me:
Fix checkapi errors/warnings use G_GINT64_CONSTANT and G_GINT64_MODIFIER
------------------------------------------------------------------------
r39338 | etxrab | 2011-10-10 10:42:43 -0700 (Mon, 10 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/gprscdr/gprscdr.cnf
   M /trunk/asn1/gprscdr/packet-gprscdr-template.c
   M /trunk/asn1/tetra/tetra.cnf
   M /trunk/epan/dissectors/packet-gprscdr.c
   M /trunk/epan/dissectors/packet-gprscdr.h
   M /trunk/epan/dissectors/packet-tetra.c
   M /trunk/epan/dissectors/packet-tetra.h

Fix unused function warnings
------------------------------------------------------------------------
r39337 | morriss | 2011-10-10 07:54:12 -0700 (Mon, 10 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.inc.nmake
   M /trunk/asn1/Makefile.nmake
   M /trunk/asn1/Makefile.preinc.nmake

Fix ASN.1 dissector generation on Windows.
------------------------------------------------------------------------
r39336 | morriss | 2011-10-10 05:54:27 -0700 (Mon, 10 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.inc.nmake

Fix a typo
------------------------------------------------------------------------
r39335 | morriss | 2011-10-10 05:52:53 -0700 (Mon, 10 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.inc
   M /trunk/asn1/Makefile.inc.nmake

Don't remove the ASN.1 dissectors when cleaning: we don't (re)build them during the make process yet.
------------------------------------------------------------------------
r39334 | stig | 2011-10-10 01:50:55 -0700 (Mon, 10 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

From Anders:
Move packet-t38.c to ASN1_DISSECTOR_SRC.
------------------------------------------------------------------------
r39333 | morriss | 2011-10-09 19:31:11 -0700 (Sun, 09 Oct 2011) | 17 lines
Changed paths:
   M /trunk/asn1/HI2Operations/Makefile.common
   M /trunk/asn1/Makefile.inc
   M /trunk/asn1/Makefile.inc.nmake
   M /trunk/asn1/Makefile.preinc
   M /trunk/asn1/Makefile.preinc.nmake
   M /trunk/asn1/acp133/Makefile.common
   M /trunk/asn1/acse/Makefile.common
   M /trunk/asn1/ansi_map/Makefile.common
   M /trunk/asn1/ansi_tcap/Makefile.common
   M /trunk/asn1/camel/Makefile.common
   M /trunk/asn1/cdt/Makefile.common
   M /trunk/asn1/charging_ase/Makefile.common
   M /trunk/asn1/cmip/Makefile.common
   M /trunk/asn1/cmp/Makefile.common
   M /trunk/asn1/cms/Makefile.common
   M /trunk/asn1/credssp/Makefile.common
   M /trunk/asn1/crmf/Makefile.common
   M /trunk/asn1/dap/Makefile.common
   M /trunk/asn1/disp/Makefile.common
   M /trunk/asn1/dop/Makefile.common
   M /trunk/asn1/dsp/Makefile.common
   M /trunk/asn1/ess/Makefile.common
   M /trunk/asn1/ftam/Makefile.common
   M /trunk/asn1/gnm/Makefile.common
   M /trunk/asn1/goose/Makefile.common
   M /trunk/asn1/gprscdr/Makefile.common
   M /trunk/asn1/gsm_map/Makefile.common
   M /trunk/asn1/h225/Makefile.common
   M /trunk/asn1/h235/Makefile.common
   M /trunk/asn1/h245/Makefile.common
   M /trunk/asn1/h248/Makefile.common
   M /trunk/asn1/h282/Makefile.common
   M /trunk/asn1/h283/Makefile.common
   M /trunk/asn1/h323/Makefile.common
   M /trunk/asn1/h450/Makefile.common
   M /trunk/asn1/h450-ros/Makefile.common
   M /trunk/asn1/h460/Makefile.common
   M /trunk/asn1/h501/Makefile.common
   M /trunk/asn1/hnbap/Makefile.common
   M /trunk/asn1/idmp/Makefile.common
   M /trunk/asn1/inap/Makefile.common
   M /trunk/asn1/kerberos/Makefile.am
   M /trunk/asn1/kerberos/Makefile.common
   M /trunk/asn1/ldap/Makefile.common
   M /trunk/asn1/logotypecertextn/Makefile.common
   M /trunk/asn1/lte-rrc/Makefile.common
   M /trunk/asn1/mms/Makefile.common
   M /trunk/asn1/mpeg-audio/Makefile.common
   M /trunk/asn1/mpeg-pes/Makefile.common
   M /trunk/asn1/nbap/Makefile.common
   M /trunk/asn1/ns_cert_exts/Makefile.common
   M /trunk/asn1/ocsp/Makefile.common
   M /trunk/asn1/p1/Makefile.common
   M /trunk/asn1/p22/Makefile.common
   M /trunk/asn1/p7/Makefile.common
   M /trunk/asn1/p772/Makefile.common
   M /trunk/asn1/pcap/Makefile.common
   M /trunk/asn1/pkcs1/Makefile.common
   M /trunk/asn1/pkcs12/Makefile.common
   M /trunk/asn1/pkinit/Makefile.common
   M /trunk/asn1/pkix1explicit/Makefile.common
   M /trunk/asn1/pkix1implicit/Makefile.common
   M /trunk/asn1/pkixac/Makefile.common
   M /trunk/asn1/pkixproxy/Makefile.common
   M /trunk/asn1/pkixqualified/Makefile.common
   M /trunk/asn1/pkixtsp/Makefile.common
   M /trunk/asn1/pres/Makefile.common
   M /trunk/asn1/q932/Makefile.common
   M /trunk/asn1/q932-ros/Makefile.common
   M /trunk/asn1/qsig/Makefile.common
   M /trunk/asn1/ranap/Makefile.common
   M /trunk/asn1/rnsap/Makefile.common
   M /trunk/asn1/ros/Makefile.common
   M /trunk/asn1/rrc/Makefile.common
   M /trunk/asn1/rrlp/Makefile.common
   M /trunk/asn1/rtse/Makefile.common
   M /trunk/asn1/rua/Makefile.common
   M /trunk/asn1/s1ap/Makefile.common
   M /trunk/asn1/sabp/Makefile.common
   M /trunk/asn1/smrse/Makefile.common
   M /trunk/asn1/snmp/Makefile.common
   M /trunk/asn1/spnego/Makefile.common
   M /trunk/asn1/sv/Makefile.common
   M /trunk/asn1/t124/Makefile.am
   M /trunk/asn1/t124/Makefile.common
   M /trunk/asn1/t124/Makefile.nmake
   M /trunk/asn1/t125/Makefile.common
   M /trunk/asn1/t38/Makefile.common
   M /trunk/asn1/tcap/Makefile.common
   M /trunk/asn1/tetra/Makefile.common
   M /trunk/asn1/ulp/Makefile.common
   M /trunk/asn1/wlancertextn/Makefile.common
   M /trunk/asn1/x2ap/Makefile.common
   M /trunk/asn1/x509af/Makefile.common
   M /trunk/asn1/x509ce/Makefile.common
   M /trunk/asn1/x509if/Makefile.common
   M /trunk/asn1/x509sat/Makefile.common
   M /trunk/asn1/x721/Makefile.am
   M /trunk/asn1/x721/Makefile.common
   M /trunk/tools/asn2wrs.py

Build the ASN.1 dissectors directly into epan/dissectors (rather than building
them and then copying them over).  The "all" target to builds these dissectors
now (instead of "generate_files" and/or "copy_files").

asn2wrs's "-O" option now means "the dissector goes in this directory" (rather
than "all output goes in this directory"); it also means that the "-s" (single
output file) option is now required.

Fix things up so that it's possible to build all of the ASN.1 dissectors in
one shot.

Fix building of conformance files when doing out-of-source-tree builds.


Unfortunately "make all" in the asn1 directory always builds something--I think
because of circular depedencies.

------------------------------------------------------------------------
r39332 | wmeier | 2011-10-09 18:38:20 -0700 (Sun, 09 Oct 2011) | 12 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/asn1/gsm_map/packet-gsm_map-template.c
   M /trunk/asn1/idmp/packet-idmp-template.c
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-idmp.c
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/dissectors/packet-snmp.c

Convert 'encoding' parameter of certain proto_tree_add_item() calls in asn1/*:
  Specifically:  Replace FALSE|0 and TRUE|1 by ENC_BIG_ENDIAN|ENC_LITTLE_ENDIAN as
  the encoding parameter for proto_tree_add_item() calls which directly reference
  an item in hf[] which has a type of:
     FT_BOOLEAN
     FT_IPv4
     FT_EUI64
     FT_GUID
     FT_UINT_STRING

 Also: For type FT_IPv6 use ENC_NA. (This was missed in SVN #39260)

------------------------------------------------------------------------
r39331 | wmeier | 2011-10-09 18:34:44 -0700 (Sun, 09 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.h

After regenerating asn1 files, packet-gsm_map.h changed, (presumably due to asn2wrs.py change in SVN #39320).

------------------------------------------------------------------------
r39330 | wmeier | 2011-10-09 18:32:07 -0700 (Sun, 09 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-qsig.h
   M /trunk/epan/dissectors/packet-t125.h

After re-generating ASN1 files, 2 .h files changed (presumably due to asn2wrs.py change in SVN #39320).

------------------------------------------------------------------------
r39329 | wmeier | 2011-10-09 17:53:55 -0700 (Sun, 09 Oct 2011) | 12 lines
Changed paths:
   M /trunk/plugins/docsis/packet-bpkmattr.c
   M /trunk/plugins/docsis/packet-dcd.c
   M /trunk/plugins/docsis/packet-docsis.c
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/ethercat/packet-ams.c
   M /trunk/plugins/ethercat/packet-ecatmb.c
   M /trunk/plugins/ethercat/packet-esl.c
   M /trunk/plugins/ethercat/packet-ethercat-datagram.c
   M /trunk/plugins/irda/packet-irda.c
   M /trunk/plugins/opcua/opcua_simpletypes.c
   M /trunk/plugins/unistim/packet-unistim.c
   M /trunk/plugins/wimax/msg_arq.c
   M /trunk/plugins/wimax/msg_reg_req.c
   M /trunk/plugins/wimax/msg_rep.c
   M /trunk/plugins/wimax/msg_rng_req.c
   M /trunk/plugins/wimax/msg_rng_rsp.c
   M /trunk/plugins/wimax/msg_sbc.c
   M /trunk/plugins/wimax/wimax_compact_dlmap_ie_decoder.c
   M /trunk/plugins/wimax/wimax_compact_ulmap_ie_decoder.c
   M /trunk/plugins/wimax/wimax_utils.c

Convert 'encoding' parameter of certain proto_tree_add_item() calls in plugins/*:
  Specifically:  Replace FALSE|0 and TRUE|1 by ENC_BIG_ENDIAN|ENC_LITTLE_ENDIAN as
  the encoding parameter for proto_tree_add_item() calls which directly reference
  an item in hf[] which has a type of:
     FT_BOOLEAN
     FT_IPv4
     FT_EUI64
     FT_GUID
     FT_UINT_STRING

Also: For type FT_ITv6 use ENC_NA. (This was missed in an earlier SVN)

------------------------------------------------------------------------
r39328 | wmeier | 2011-10-09 17:39:31 -0700 (Sun, 09 Oct 2011) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-2dparityfec.c
   M /trunk/epan/dissectors/packet-acn.c
   M /trunk/epan/dissectors/packet-ancp.c
   M /trunk/epan/dissectors/packet-ansi_a.c
   M /trunk/epan/dissectors/packet-aodv.c
   M /trunk/epan/dissectors/packet-aruba-papi.c
   M /trunk/epan/dissectors/packet-asap.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-bacapp.c
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-btamp.c
   M /trunk/epan/dissectors/packet-btl2cap.c
   M /trunk/epan/dissectors/packet-btobex.c
   M /trunk/epan/dissectors/packet-bvlc.c
   M /trunk/epan/dissectors/packet-capwap.c
   M /trunk/epan/dissectors/packet-ccsds.c
   M /trunk/epan/dissectors/packet-classicstun.c
   M /trunk/epan/dissectors/packet-dcc.c
   M /trunk/epan/dissectors/packet-dcerpc-epm.c
   M /trunk/epan/dissectors/packet-ddtp.c
   M /trunk/epan/dissectors/packet-dhcpv6.c
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-dvbci.c
   M /trunk/epan/dissectors/packet-dvmrp.c
   M /trunk/epan/dissectors/packet-e100.c
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-egd.c
   M /trunk/epan/dissectors/packet-ehs.c
   M /trunk/epan/dissectors/packet-eigrp.c
   M /trunk/epan/dissectors/packet-enrp.c
   M /trunk/epan/dissectors/packet-epl.c
   M /trunk/epan/dissectors/packet-eth.c
   M /trunk/epan/dissectors/packet-evrc.c
   M /trunk/epan/dissectors/packet-fcdns.c
   M /trunk/epan/dissectors/packet-fcels.c
   M /trunk/epan/dissectors/packet-fcfcs.c
   M /trunk/epan/dissectors/packet-fcgi.c
   M /trunk/epan/dissectors/packet-fcip.c
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-fefd.c
   M /trunk/epan/dissectors/packet-ff.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-glbp.c
   M /trunk/epan/dissectors/packet-gnutella.c
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-gsmtap.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-gvcp.c
   M /trunk/epan/dissectors/packet-h263p.c
   M /trunk/epan/dissectors/packet-hclnfsd.c
   M /trunk/epan/dissectors/packet-hip.c
   M /trunk/epan/dissectors/packet-hsrp.c
   M /trunk/epan/dissectors/packet-hyperscsi.c
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-icmp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-ieee1722.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-igap.c
   M /trunk/epan/dissectors/packet-image-png.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-infiniband_sdp.c
   M /trunk/epan/dissectors/packet-ipmi-chassis.c
   M /trunk/epan/dissectors/packet-ipmi-picmg.c
   M /trunk/epan/dissectors/packet-ipmi-se.c
   M /trunk/epan/dissectors/packet-ipmi-session.c
   M /trunk/epan/dissectors/packet-ipmi-transport.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-ipvs-syncd.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-isl.c
   M /trunk/epan/dissectors/packet-ismp.c
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-itdm.c
   M /trunk/epan/dissectors/packet-iwarp-ddp-rdmap.c
   M /trunk/epan/dissectors/packet-iwarp-mpa.c
   M /trunk/epan/dissectors/packet-jxta.c
   M /trunk/epan/dissectors/packet-kdp.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-l2tp.c
   M /trunk/epan/dissectors/packet-ldp.c
   M /trunk/epan/dissectors/packet-lisp-data.c
   M /trunk/epan/dissectors/packet-lisp.c
   M /trunk/epan/dissectors/packet-lldp.c
   M /trunk/epan/dissectors/packet-mip.c
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-mpls-echo.c
   M /trunk/epan/dissectors/packet-msdp.c
   M /trunk/epan/dissectors/packet-msnlb.c
   M /trunk/epan/dissectors/packet-msproxy.c
   M /trunk/epan/dissectors/packet-mux27010.c
   M /trunk/epan/dissectors/packet-nb_rtpmux.c
   M /trunk/epan/dissectors/packet-nbns.c
   M /trunk/epan/dissectors/packet-ncp-sss.c
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-ndp.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-netflow.c
   M /trunk/epan/dissectors/packet-nhrp.c
   M /trunk/epan/dissectors/packet-nlsp.c
   M /trunk/epan/dissectors/packet-olsr.c
   M /trunk/epan/dissectors/packet-omron-fins.c
   M /trunk/epan/dissectors/packet-packetbb.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pflog.c
   M /trunk/epan/dissectors/packet-pktc.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-ppi-sensor.c
   M /trunk/epan/dissectors/packet-ppi.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-pppoe.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-q931.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-radius_packetcable.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-rgmp.c
   M /trunk/epan/dissectors/packet-rip.c
   M /trunk/epan/dissectors/packet-ripng.c
   M /trunk/epan/dissectors/packet-rmp.c
   M /trunk/epan/dissectors/packet-rsip.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-rtnet.c
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-sasp.c
   M /trunk/epan/dissectors/packet-sbus.c
   M /trunk/epan/dissectors/packet-scsi-mmc.c
   M /trunk/epan/dissectors/packet-scsi-osd.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-sebek.c
   M /trunk/epan/dissectors/packet-sflow.c
   M /trunk/epan/dissectors/packet-simulcrypt.c
   M /trunk/epan/dissectors/packet-slimp3.c
   M /trunk/epan/dissectors/packet-slsk.c
   M /trunk/epan/dissectors/packet-smb-logon.c
   M /trunk/epan/dissectors/packet-socketcan.c
   M /trunk/epan/dissectors/packet-socks.c
   M /trunk/epan/dissectors/packet-stun.c
   M /trunk/epan/dissectors/packet-sua.c
   M /trunk/epan/dissectors/packet-symantec.c
   M /trunk/epan/dissectors/packet-synergy.c
   M /trunk/epan/dissectors/packet-tacacs.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-teamspeak2.c
   M /trunk/epan/dissectors/packet-tnef.c
   M /trunk/epan/dissectors/packet-tns.c
   M /trunk/epan/dissectors/packet-trill.c
   M /trunk/epan/dissectors/packet-turbocell.c
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-v52.c
   M /trunk/epan/dissectors/packet-v5ua.c
   M /trunk/epan/dissectors/packet-vcdu.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-vrrp.c
   M /trunk/epan/dissectors/packet-vtp.c
   M /trunk/epan/dissectors/packet-vuze-dht.c
   M /trunk/epan/dissectors/packet-vxi11.c
   M /trunk/epan/dissectors/packet-wai.c
   M /trunk/epan/dissectors/packet-wccp.c
   M /trunk/epan/dissectors/packet-windows-common.c
   M /trunk/epan/dissectors/packet-winsrepl.c
   M /trunk/epan/dissectors/packet-wow.c
   M /trunk/epan/dissectors/packet-wps.c
   M /trunk/epan/dissectors/packet-x224.c
   M /trunk/epan/dissectors/packet-xmcp.c
   M /trunk/epan/dissectors/packet-ypbind.c
   M /trunk/epan/dissectors/packet-ypserv.c
   M /trunk/epan/dissectors/packet-zbee-zcl.c
   M /trunk/epan/dissectors/packet-zebra.c

 Convert 'encoding' parameter of certain proto_tree_add_item() calls in non-autogenerated epan/dissectors:
  Specifically:  Replace FALSE|0 and TRUE|1 by ENC_BIG_ENDIAN|ENC_LITTLE_ENDIAN as
  the encoding parameter for proto_tree_add_item() calls which directly reference
  an item in hf[] which has a type of:
     FT_BOOLEAN
     FT_IPv4
     FT_EUI64
     FT_GUID
     FT_UINT_STRING

Also: For type FT_ITv6 use ENC_NA. (This was missed in SVN #39260)

------------------------------------------------------------------------
r39327 | guy | 2011-10-09 10:42:49 -0700 (Sun, 09 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipdc.c

Add a comment with links to I-Ds for protocols that look as if they're
at least somewhat related.

------------------------------------------------------------------------
r39326 | etxrab | 2011-10-09 08:46:10 -0700 (Sun, 09 Oct 2011) | 1 line
Changed paths:
   M /trunk/README.irix

Fix a typo.
------------------------------------------------------------------------
r39323 | gerald | 2011-10-09 07:03:25 -0700 (Sun, 09 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-10-09]
------------------------------------------------------------------------
r39322 | alagoutte | 2011-10-09 06:09:46 -0700 (Sun, 09 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6422
Clean up IEEE 802.11 dissector - fixed fields

Many of the fixed fields use similar bitfield construction in the proto_tree. Use proto_tree_add_bitmask() to avoid having to implement the same subtree and item addition separately for each field.

------------------------------------------------------------------------
r39321 | alagoutte | 2011-10-09 06:06:32 -0700 (Sun, 09 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bgp.h

Enhance BGP Open message
* Make field filterable 
* Remove bgp_open struct
* Fix a bug of offset in Optionnel Parameter TLV (Bug include by me in Revision #39098)

------------------------------------------------------------------------
r39320 | stig | 2011-10-09 03:42:54 -0700 (Sun, 09 Oct 2011) | 5 lines
Changed paths:
   M /trunk/tools/asn2wrs.py

Always generate packet-*-exp.h.

This fixes a bug when only exporting _PDU objects, and we can have
'#include "packet-*-exp.h"' in packet-*-template.h even when having
no #.EXPORTS in the conformation file.
------------------------------------------------------------------------
r39319 | stig | 2011-10-09 02:55:14 -0700 (Sun, 09 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/uat-int.h
   M /trunk/epan/uat.c
   M /trunk/gtk/uat_gui.c

Added a button to refresh a UAT from the system defaults (if existing).
Added a button to clear the list.
Added tooltip to some buttons.
Removed unused clist code.
------------------------------------------------------------------------
r39318 | stig | 2011-10-09 02:54:48 -0700 (Sun, 09 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/filesystem.c

Check for NULL pointer in file_exists().
------------------------------------------------------------------------
r39317 | guy | 2011-10-08 12:44:36 -0700 (Sat, 08 Oct 2011) | 4 lines
Changed paths:
   M /trunk/macosx-setup.sh

Move the GeoIP entry where it belongs.

Expand a couple of comments.

------------------------------------------------------------------------
r39316 | alagoutte | 2011-10-08 11:12:59 -0700 (Sat, 08 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

Enhance BGP Header
* Remove a not needed subtree
* Make field filtereable
* Use expert info to display a wrong length

------------------------------------------------------------------------
r39315 | alagoutte | 2011-10-08 10:51:03 -0700 (Sat, 08 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6422
Clean up IEEE 802.11 dissector - fixed fields

The fixed field identifiers were defined to have specific values. However, this is used only within the parser and does not correspond to any specific packet field. As such, there is no need for the specific values to be maintained and an enum makes it simpler to add and remove these fields as needed.

------------------------------------------------------------------------
r39314 | alagoutte | 2011-10-08 10:50:06 -0700 (Sat, 08 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6422
Clean up IEEE 802.11 dissector - fixed fields

The app_fixed_field() function has grown to overly complex and long function. Split it into separate helper functions for each fixed field and a table of dissector functions. This makes it easier to extend and maintain the implementation.

------------------------------------------------------------------------
r39313 | alagoutte | 2011-10-08 10:22:45 -0700 (Sat, 08 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6421
IEEE 802.11u ANQP enhancements

Dissect vendor-specific ANQP Capabilities

------------------------------------------------------------------------
r39312 | alagoutte | 2011-10-08 10:21:44 -0700 (Sat, 08 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6421
IEEE 802.11u ANQP enhancements

Dissect NAI Realm List

------------------------------------------------------------------------
r39311 | alagoutte | 2011-10-08 09:55:54 -0700 (Sat, 08 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6420
WPA IE pairwise cipher suite dissector uses incorrect value_string list

From me :
* Use correct value_string for WPA Key MGMT...

------------------------------------------------------------------------
r39310 | jmayer | 2011-10-08 08:17:56 -0700 (Sat, 08 Oct 2011) | 2 lines
Changed paths:
   M /trunk/macosx-setup.sh

Remove a duplicate entry

------------------------------------------------------------------------
r39309 | wmeier | 2011-10-08 07:42:11 -0700 (Sat, 08 Oct 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c

From Stéphane Bryant: fixes in reload fragmentation handling
  -Fixes in reload fragmentation
  -also updated the code to reflect draft-zong-p2psip-drr-01

From me:
  Remove one line of the patch which appears to be incorrect:
  At about line 4118 (in dissect_reload_message())
-      pinfo->fragmented = save_fragmented;
+      pinfo->fragmented = pinfo->fragmented;


------------------------------------------------------------------------
r39308 | wmeier | 2011-10-08 07:14:32 -0700 (Sat, 08 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c

From Stéphane Bryant: remove the variables that the previous patch left unused

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6317

From me: Add hf[] entry for 'hf_reload_dmflag_underlay_hop'

------------------------------------------------------------------------
r39307 | jmayer | 2011-10-07 23:09:38 -0700 (Fri, 07 Oct 2011) | 2 lines
Changed paths:
   M /trunk/cmake/modules/FindGEOIP.cmake
   M /trunk/cmakeconfig.h.in

Mimic test for IPv6 support in GeoIP from autofoo

------------------------------------------------------------------------
r39306 | etxrab | 2011-10-07 09:46:37 -0700 (Fri, 07 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ CC resource version 2

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6436
------------------------------------------------------------------------
r39305 | etxrab | 2011-10-07 09:42:52 -0700 (Fri, 07 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c

- Put a TRY/CATCH block around dissect_h264_nal_unit() in case
a bogus nal unit was sent.
- Delete an unused hf entry.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6407
------------------------------------------------------------------------
r39304 | morriss | 2011-10-07 06:53:43 -0700 (Fri, 07 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/libwireshark.def

As suggested/requested in
http://ask.wireshark.org/questions/6756/linking-error-with-str_to_str :

Add str_to_str to the list of exported functions.

------------------------------------------------------------------------
r39303 | gerald | 2011-10-06 15:05:11 -0700 (Thu, 06 Oct 2011) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-epm.c

From Dirk Jagdmann:

Below is a small enhancement to the EPM dissector. It adds the "type" of
EPM Map request/response to the INFO column. This way I don't have to
dig into the proto tree if I want to see what service is requested.

From me:

Add a modeline blurb.

------------------------------------------------------------------------
r39302 | wmeier | 2011-10-06 14:12:21 -0700 (Thu, 06 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c

Use '"%" G_GINT64_MODIFIER "d"' instead of "%ld" to format a guint64.
Fixes a compile warning

------------------------------------------------------------------------
r39301 | wmeier | 2011-10-06 13:46:45 -0700 (Thu, 06 Oct 2011) | 30 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-reload-framing.c
   M /trunk/epan/dissectors/packet-reload.c
   A /trunk/epan/dissectors/packet-reload.h

From Stéphane Bryant: improvements in RELOAD dissection

- Follow closely draft-ietf-p2psip-base-18
- Added support for draft-ietf-p2psip-base-18,
  draft-ietf-p2psip-sip-06,
  draft-ietf-p2psip-service-discovery-03,
  draft-ietf-p2psip-self-tuning-04,
  draft-ietf-p2psip-diagnostics-06,
  draft-zong-p2psip-drr-00,
- Handoff to the xml dissectors for
  configuration data
- export the message content dissection function
  in the new packet-reload.h file for use in
  related protocols (draft-hautakorpi-p2psip-with-hip-01)

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6317

From me:
- Fix a few C++ style comments;
- Fix:
packet-reload.c(2156) ... conversion from 'guint64' to 'guint32', possible loss of data
packet-reload.c(3528) ... conversion from 'guint64' to 'guint32', possible loss of data

Note: Additional fix yet req'd since checkhf.pl gives:
  ERROR: NO ARRAY: packet-reload.c, hf_reload_dmflag_underlay_hop
  Unused entry: packet-reload.c, hf_reload_storeddata_signature
  Unused entry: packet-reload.c, hf_reload_storeddataspecifiers

(Compile is OK).

------------------------------------------------------------------------
r39300 | gerald | 2011-10-06 13:28:40 -0700 (Thu, 06 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/geoip_db.c

Don't stuff "(null)" into the protocol tree.

------------------------------------------------------------------------
r39299 | gerald | 2011-10-06 12:33:15 -0700 (Thu, 06 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/geoip_db.c

Assume all strings coming from GeoIP are ISO-8859-1. Fix IPv6
destination GeoIP lookups.

------------------------------------------------------------------------
r39298 | stig | 2011-10-06 12:26:21 -0700 (Thu, 06 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-multipart.c

Added media type multipart/report from RFC3462.
------------------------------------------------------------------------
r39297 | etxrab | 2011-10-06 12:07:26 -0700 (Thu, 06 Oct 2011) | 3 lines
Changed paths:
   M /trunk/asn1/s1ap/packet-s1ap-template.c
   M /trunk/epan/dissectors/packet-s1ap.c

Typo FT_IPv4 isf FT_IPv6.
Fixes
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6435
------------------------------------------------------------------------
r39296 | etxrab | 2011-10-06 11:46:47 -0700 (Thu, 06 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Add exports
------------------------------------------------------------------------
r39295 | jake | 2011-10-06 10:53:44 -0700 (Thu, 06 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Fix for bug 6356:
Wireshark encounters error while parsing ieee80211 QoS Null data.
The error is because of invalid read when trying to read mesh_flags 
(after the header), which doesn't exist.

------------------------------------------------------------------------
r39294 | wmeier | 2011-10-06 09:50:13 -0700 (Thu, 06 Oct 2011) | 18 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/asn1/cmp/packet-cmp-template.c
   M /trunk/asn1/gsm_map/packet-gsm_map-template.c
   M /trunk/asn1/idmp/packet-idmp-template.c
   M /trunk/asn1/kerberos/packet-kerberos-template.c
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/asn1/mpeg-pes/packet-mpeg-pes-template.c
   M /trunk/asn1/qsig/packet-qsig-template.c
   M /trunk/asn1/smrse/packet-smrse-template.c
   M /trunk/asn1/spnego/packet-spnego-template.c
   M /trunk/asn1/sv/packet-sv-template.c
   M /trunk/asn1/tetra/packet-tetra-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-cmp.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-idmp.c
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/dissectors/packet-mpeg-pes.c
   M /trunk/epan/dissectors/packet-qsig.c
   M /trunk/epan/dissectors/packet-smrse.c
   M /trunk/epan/dissectors/packet-spnego.c
   M /trunk/epan/dissectors/packet-sv.c
   M /trunk/epan/dissectors/packet-tetra.c

Convert 'encoding' parameter of certain proto_tree_add_item() calls in asn1 dissectors:
 Specifically:  Replace FALSE|0 and TRUE|1 by ENC_BIG_ENDIAN|ENC_LITTLE_ENDIAN as
 the encoding parameter for proto_tree_add_item() calls which directly reference
 an item in hf[] which has a type of:
    FT_UINT8
    FT_UINT16
    FT_UINT24
    FT_UINT32
    FT_UINT64
    FT_INT8
    FT_INT16
    FT_INT24
    FT_INT32
    FT_INT64
    FT_FLOAT
    FT_DOUBLE


------------------------------------------------------------------------
r39293 | wmeier | 2011-10-06 09:43:24 -0700 (Thu, 06 Oct 2011) | 3 lines
Changed paths:
   M /trunk/asn1/Makefile.nmake

Add missing (presumably) entries for credssp,idmp,t124 & x721.
However: t124 & x721 fail to build on Windows so comment them out.

------------------------------------------------------------------------
r39292 | wmeier | 2011-10-06 07:46:34 -0700 (Thu, 06 Oct 2011) | 18 lines
Changed paths:
   M /trunk/plugins/docsis/packet-bintrngreq.c
   M /trunk/plugins/docsis/packet-bpkmattr.c
   M /trunk/plugins/docsis/packet-bpkmreq.c
   M /trunk/plugins/docsis/packet-bpkmrsp.c
   M /trunk/plugins/docsis/packet-cmctrlreq.c
   M /trunk/plugins/docsis/packet-cmctrlrsp.c
   M /trunk/plugins/docsis/packet-cmstatus.c
   M /trunk/plugins/docsis/packet-dbcack.c
   M /trunk/plugins/docsis/packet-dbcreq.c
   M /trunk/plugins/docsis/packet-dbcrsp.c
   M /trunk/plugins/docsis/packet-dccack.c
   M /trunk/plugins/docsis/packet-dccreq.c
   M /trunk/plugins/docsis/packet-dccrsp.c
   M /trunk/plugins/docsis/packet-dcd.c
   M /trunk/plugins/docsis/packet-docsis.c
   M /trunk/plugins/docsis/packet-dpvreq.c
   M /trunk/plugins/docsis/packet-dpvrsp.c
   M /trunk/plugins/docsis/packet-dsaack.c
   M /trunk/plugins/docsis/packet-dsareq.c
   M /trunk/plugins/docsis/packet-dsarsp.c
   M /trunk/plugins/docsis/packet-dscack.c
   M /trunk/plugins/docsis/packet-dscreq.c
   M /trunk/plugins/docsis/packet-dscrsp.c
   M /trunk/plugins/docsis/packet-dsdreq.c
   M /trunk/plugins/docsis/packet-dsdrsp.c
   M /trunk/plugins/docsis/packet-intrngreq.c
   M /trunk/plugins/docsis/packet-macmgmt.c
   M /trunk/plugins/docsis/packet-map.c
   M /trunk/plugins/docsis/packet-mdd.c
   M /trunk/plugins/docsis/packet-regack.c
   M /trunk/plugins/docsis/packet-regreq.c
   M /trunk/plugins/docsis/packet-regreqmp.c
   M /trunk/plugins/docsis/packet-regrsp.c
   M /trunk/plugins/docsis/packet-regrspmp.c
   M /trunk/plugins/docsis/packet-rngreq.c
   M /trunk/plugins/docsis/packet-rngrsp.c
   M /trunk/plugins/docsis/packet-sync.c
   M /trunk/plugins/docsis/packet-tlv-cmctrl.c
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/docsis/packet-type29ucd.c
   M /trunk/plugins/docsis/packet-uccreq.c
   M /trunk/plugins/docsis/packet-uccrsp.c
   M /trunk/plugins/docsis/packet-ucd.c
   M /trunk/plugins/docsis/packet-vendor.c
   M /trunk/plugins/ethercat/packet-ams.c
   M /trunk/plugins/ethercat/packet-ecatmb.c
   M /trunk/plugins/ethercat/packet-esl.c
   M /trunk/plugins/ethercat/packet-ethercat-datagram.c
   M /trunk/plugins/ethercat/packet-ethercat-frame.c
   M /trunk/plugins/ethercat/packet-nv.c
   M /trunk/plugins/irda/packet-ircomm.c
   M /trunk/plugins/irda/packet-irda.c
   M /trunk/plugins/irda/packet-sir.c
   M /trunk/plugins/m2m/packet-m2m.c
   M /trunk/plugins/opcua/opcua_application_layer.c
   M /trunk/plugins/opcua/opcua_enumparser.c
   M /trunk/plugins/opcua/opcua_security_layer.c
   M /trunk/plugins/opcua/opcua_simpletypes.c
   M /trunk/plugins/opcua/opcua_transport_layer.c
   M /trunk/plugins/profinet/packet-dcom-cba-acco.c
   M /trunk/plugins/unistim/packet-unistim.c
   M /trunk/plugins/wimax/mac_hd_generic_decoder.c
   M /trunk/plugins/wimax/mac_hd_type1_decoder.c
   M /trunk/plugins/wimax/mac_hd_type2_decoder.c
   M /trunk/plugins/wimax/msg_aas_beam.c
   M /trunk/plugins/wimax/msg_aas_fbck.c
   M /trunk/plugins/wimax/msg_arq.c
   M /trunk/plugins/wimax/msg_clk_cmp.c
   M /trunk/plugins/wimax/msg_dcd.c
   M /trunk/plugins/wimax/msg_dlmap.c
   M /trunk/plugins/wimax/msg_dreg.c
   M /trunk/plugins/wimax/msg_dsa.c
   M /trunk/plugins/wimax/msg_dsc.c
   M /trunk/plugins/wimax/msg_dsd.c
   M /trunk/plugins/wimax/msg_dsx_rvd.c
   M /trunk/plugins/wimax/msg_fpc.c
   M /trunk/plugins/wimax/msg_pkm.c
   M /trunk/plugins/wimax/msg_pmc.c
   M /trunk/plugins/wimax/msg_prc_lt_ctrl.c
   M /trunk/plugins/wimax/msg_reg_req.c
   M /trunk/plugins/wimax/msg_reg_rsp.c
   M /trunk/plugins/wimax/msg_rep.c
   M /trunk/plugins/wimax/msg_res_cmd.c
   M /trunk/plugins/wimax/msg_rng_req.c
   M /trunk/plugins/wimax/msg_rng_rsp.c
   M /trunk/plugins/wimax/msg_sbc.c
   M /trunk/plugins/wimax/msg_ucd.c
   M /trunk/plugins/wimax/msg_ulmap.c
   M /trunk/plugins/wimax/wimax_cdma_code_decoder.c
   M /trunk/plugins/wimax/wimax_compact_dlmap_ie_decoder.c
   M /trunk/plugins/wimax/wimax_compact_ulmap_ie_decoder.c
   M /trunk/plugins/wimax/wimax_fch_decoder.c
   M /trunk/plugins/wimax/wimax_ffb_decoder.c
   M /trunk/plugins/wimax/wimax_hack_decoder.c
   M /trunk/plugins/wimax/wimax_harq_map_decoder.c
   M /trunk/plugins/wimax/wimax_phy_attributes_decoder.c
   M /trunk/plugins/wimax/wimax_utils.c

Convert 'encoding' parameter of certain proto_tree_add_item() calls in plugin dissectors:
 Specifically:  Replace FALSE|0 and TRUE|1 by ENC_BIG_ENDIAN|ENC_LITTLE_ENDIAN as
 the encoding parameter for proto_tree_add_item() calls which directly reference
 an item in hf[] which has a type of:
    FT_UINT8
    FT_UINT16
    FT_UINT24
    FT_UINT32
    FT_UINT64
    FT_INT8
    FT_INT16
    FT_INT24
    FT_INT32
    FT_INT64
    FT_FLOAT
    FT_DOUBLE


------------------------------------------------------------------------
r39291 | stig | 2011-10-05 23:53:07 -0700 (Wed, 05 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/geoip_db.c

It seems like GEOIP_NETSPEED_EDITION_REV1_V6 was added to GeoIP 1.4.8.
------------------------------------------------------------------------
r39290 | etxrab | 2011-10-05 23:15:32 -0700 (Wed, 05 Oct 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Fix unused parameter warnings.
------------------------------------------------------------------------
r39289 | etxrab | 2011-10-05 22:48:48 -0700 (Wed, 05 Oct 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Removed unconditional g_warnings and a bit of code clean up.
------------------------------------------------------------------------
r39288 | wmeier | 2011-10-05 20:35:44 -0700 (Wed, 05 Oct 2011) | 18 lines
Changed paths:
   M /trunk/epan/dissectors/packet-2dparityfec.c
   M /trunk/epan/dissectors/packet-aim-buddylist.c
   M /trunk/epan/dissectors/packet-aim-generic.c
   M /trunk/epan/dissectors/packet-aim-icq.c
   M /trunk/epan/dissectors/packet-aim-sst.c
   M /trunk/epan/dissectors/packet-ancp.c
   M /trunk/epan/dissectors/packet-ansi_637.c
   M /trunk/epan/dissectors/packet-ansi_a.c
   M /trunk/epan/dissectors/packet-applemidi.c
   M /trunk/epan/dissectors/packet-artnet.c
   M /trunk/epan/dissectors/packet-aruba-erm.c
   M /trunk/epan/dissectors/packet-aruba-papi.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-ax4000.c
   M /trunk/epan/dissectors/packet-bacapp.c
   M /trunk/epan/dissectors/packet-bacnet.c
   M /trunk/epan/dissectors/packet-banana.c
   M /trunk/epan/dissectors/packet-bctp.c
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-brdwlk.c
   M /trunk/epan/dissectors/packet-bt-utp.c
   M /trunk/epan/dissectors/packet-btamp.c
   M /trunk/epan/dissectors/packet-bthci_sco.c
   M /trunk/epan/dissectors/packet-btl2cap.c
   M /trunk/epan/dissectors/packet-btobex.c
   M /trunk/epan/dissectors/packet-btsdp.c
   M /trunk/epan/dissectors/packet-bvlc.c
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-ccsds.c
   M /trunk/epan/dissectors/packet-cdp.c
   M /trunk/epan/dissectors/packet-cgmp.c
   M /trunk/epan/dissectors/packet-cimetrics.c
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-classicstun.c
   M /trunk/epan/dissectors/packet-coap.c
   M /trunk/epan/dissectors/packet-collectd.c
   M /trunk/epan/dissectors/packet-cops.c
   M /trunk/epan/dissectors/packet-dcc.c
   M /trunk/epan/dissectors/packet-dcerpc-epm.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-ddtp.c
   M /trunk/epan/dissectors/packet-dec-dnart.c
   M /trunk/epan/dissectors/packet-dect.c
   M /trunk/epan/dissectors/packet-dhcpv6.c
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-dtn.c
   M /trunk/epan/dissectors/packet-dtp.c
   M /trunk/epan/dissectors/packet-dvmrp.c
   M /trunk/epan/dissectors/packet-e100.c
   M /trunk/epan/dissectors/packet-eap.c
   M /trunk/epan/dissectors/packet-eapol.c
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-egd.c
   M /trunk/epan/dissectors/packet-ehs.c
   M /trunk/epan/dissectors/packet-eigrp.c
   M /trunk/epan/dissectors/packet-enttec.c
   M /trunk/epan/dissectors/packet-epl.c
   M /trunk/epan/dissectors/packet-epl_v1.c
   M /trunk/epan/dissectors/packet-esio.c
   M /trunk/epan/dissectors/packet-eth.c
   M /trunk/epan/dissectors/packet-evrc.c
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fcct.c
   M /trunk/epan/dissectors/packet-fcdns.c
   M /trunk/epan/dissectors/packet-fcels.c
   M /trunk/epan/dissectors/packet-fcfcs.c
   M /trunk/epan/dissectors/packet-fcfzs.c
   M /trunk/epan/dissectors/packet-fcgi.c
   M /trunk/epan/dissectors/packet-fcip.c
   M /trunk/epan/dissectors/packet-fcoe.c
   M /trunk/epan/dissectors/packet-fcoib.c
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-fcsb3.c
   M /trunk/epan/dissectors/packet-fcsp.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-fefd.c
   M /trunk/epan/dissectors/packet-ff.c
   M /trunk/epan/dissectors/packet-fip.c
   M /trunk/epan/dissectors/packet-flip.c
   M /trunk/epan/dissectors/packet-fp_hint.c
   M /trunk/epan/dissectors/packet-fractalgeneratorprotocol.c
   M /trunk/epan/dissectors/packet-fw1.c
   M /trunk/epan/dissectors/packet-g723.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-gmhdr.c
   M /trunk/epan/dissectors/packet-gmrp.c
   M /trunk/epan/dissectors/packet-gnutella.c
   M /trunk/epan/dissectors/packet-gopher.c
   M /trunk/epan/dissectors/packet-gpef.c
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk/epan/dissectors/packet-gsm_bsslap.c
   M /trunk/epan/dissectors/packet-gsmtap.c
   M /trunk/epan/dissectors/packet-gvcp.c
   M /trunk/epan/dissectors/packet-gvrp.c
   M /trunk/epan/dissectors/packet-h223.c
   M /trunk/epan/dissectors/packet-h248_annex_c.c
   M /trunk/epan/dissectors/packet-h263p.c
   M /trunk/epan/dissectors/packet-hci_h4.c
   M /trunk/epan/dissectors/packet-hilscher.c
   M /trunk/epan/dissectors/packet-hip.c
   M /trunk/epan/dissectors/packet-hpsw.c
   M /trunk/epan/dissectors/packet-hsrp.c
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-icep.c
   M /trunk/epan/dissectors/packet-icmp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-icp.c
   M /trunk/epan/dissectors/packet-icq.c
   M /trunk/epan/dissectors/packet-idp.c
   M /trunk/epan/dissectors/packet-ieee1722.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ifcp.c
   M /trunk/epan/dissectors/packet-igrp.c
   M /trunk/epan/dissectors/packet-image-png.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-infiniband_sdp.c
   M /trunk/epan/dissectors/packet-interlink.c
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ipmi-app.c
   M /trunk/epan/dissectors/packet-ipmi-chassis.c
   M /trunk/epan/dissectors/packet-ipmi-picmg.c
   M /trunk/epan/dissectors/packet-ipmi-se.c
   M /trunk/epan/dissectors/packet-ipmi-session.c
   M /trunk/epan/dissectors/packet-ipmi-storage.c
   M /trunk/epan/dissectors/packet-ipmi-transport.c
   M /trunk/epan/dissectors/packet-ipmi.c
   M /trunk/epan/dissectors/packet-ipnet.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-ipvs-syncd.c
   M /trunk/epan/dissectors/packet-ipx.c
   M /trunk/epan/dissectors/packet-ipxwan.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-isis-hello.c
   M /trunk/epan/dissectors/packet-isis-lsp.c
   M /trunk/epan/dissectors/packet-isis.c
   M /trunk/epan/dissectors/packet-isl.c
   M /trunk/epan/dissectors/packet-ismacryp.c
   M /trunk/epan/dissectors/packet-ismp.c
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-itdm.c
   M /trunk/epan/dissectors/packet-iwarp-ddp-rdmap.c
   M /trunk/epan/dissectors/packet-iwarp-mpa.c
   M /trunk/epan/dissectors/packet-jmirror.c
   M /trunk/epan/dissectors/packet-jpeg.c
   M /trunk/epan/dissectors/packet-juniper.c
   M /trunk/epan/dissectors/packet-jxta.c
   M /trunk/epan/dissectors/packet-kdp.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos4.c
   M /trunk/epan/dissectors/packet-kink.c
   M /trunk/epan/dissectors/packet-l2tp.c
   M /trunk/epan/dissectors/packet-lanforge.c
   M /trunk/epan/dissectors/packet-laplink.c
   M /trunk/epan/dissectors/packet-ldp.c
   M /trunk/epan/dissectors/packet-ldss.c
   M /trunk/epan/dissectors/packet-lge_monitor.c
   M /trunk/epan/dissectors/packet-linx.c
   M /trunk/epan/dissectors/packet-lisp-data.c
   M /trunk/epan/dissectors/packet-lisp.c
   M /trunk/epan/dissectors/packet-lldp.c
   M /trunk/epan/dissectors/packet-llt.c
   M /trunk/epan/dissectors/packet-lmi.c
   M /trunk/epan/dissectors/packet-loop.c
   M /trunk/epan/dissectors/packet-lwres.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-mbtcp.c
   M /trunk/epan/dissectors/packet-mdshdr.c
   M /trunk/epan/dissectors/packet-mip.c
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-mount.c
   M /trunk/epan/dissectors/packet-mp2t.c
   M /trunk/epan/dissectors/packet-mpls-echo.c
   M /trunk/epan/dissectors/packet-mpls.c
   M /trunk/epan/dissectors/packet-mq.c
   M /trunk/epan/dissectors/packet-mrdisc.c
   M /trunk/epan/dissectors/packet-mrp-msrp.c
   M /trunk/epan/dissectors/packet-ms-mms.c
   M /trunk/epan/dissectors/packet-msdp.c
   M /trunk/epan/dissectors/packet-msnlb.c
   M /trunk/epan/dissectors/packet-msproxy.c
   M /trunk/epan/dissectors/packet-mstp.c
   M /trunk/epan/dissectors/packet-mux27010.c
   M /trunk/epan/dissectors/packet-nasdaq-itch.c
   M /trunk/epan/dissectors/packet-nasdaq-soup.c
   M /trunk/epan/dissectors/packet-nb_rtpmux.c
   M /trunk/epan/dissectors/packet-nbd.c
   M /trunk/epan/dissectors/packet-nbns.c
   M /trunk/epan/dissectors/packet-ncp-nmas.c
   M /trunk/epan/dissectors/packet-ncp-sss.c
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ncs.c
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-ndp.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-netbios.c
   M /trunk/epan/dissectors/packet-netdump.c
   M /trunk/epan/dissectors/packet-netflow.c
   M /trunk/epan/dissectors/packet-netsync.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-nhrp.c
   M /trunk/epan/dissectors/packet-nlsp.c
   M /trunk/epan/dissectors/packet-nsip.c
   M /trunk/epan/dissectors/packet-nsrp.c
   M /trunk/epan/dissectors/packet-nstrace.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-nwmtp.c
   M /trunk/epan/dissectors/packet-oicq.c
   M /trunk/epan/dissectors/packet-olsr.c
   M /trunk/epan/dissectors/packet-omron-fins.c
   M /trunk/epan/dissectors/packet-opsi.c
   M /trunk/epan/dissectors/packet-packetbb.c
   M /trunk/epan/dissectors/packet-paltalk.c
   M /trunk/epan/dissectors/packet-pcnfsd.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pgm.c
   M /trunk/epan/dissectors/packet-pim.c
   M /trunk/epan/dissectors/packet-pingpongprotocol.c
   M /trunk/epan/dissectors/packet-pktc.c
   M /trunk/epan/dissectors/packet-pktgen.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-portmap.c
   M /trunk/epan/dissectors/packet-ppi-sensor.c
   M /trunk/epan/dissectors/packet-ppi.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-pppoe.c
   M /trunk/epan/dissectors/packet-pptp.c
   M /trunk/epan/dissectors/packet-prp.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-pvfs2.c
   M /trunk/epan/dissectors/packet-pw-atm.c
   M /trunk/epan/dissectors/packet-pw-cesopsn.c
   M /trunk/epan/dissectors/packet-pw-fr.c
   M /trunk/epan/dissectors/packet-pw-satop.c
   M /trunk/epan/dissectors/packet-q931.c
   M /trunk/epan/dissectors/packet-qllc.c
   M /trunk/epan/dissectors/packet-quake.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-radius_packetcable.c
   M /trunk/epan/dissectors/packet-rdm.c
   M /trunk/epan/dissectors/packet-rdt.c
   M /trunk/epan/dissectors/packet-redback.c
   M /trunk/epan/dissectors/packet-redbackli.c
   M /trunk/epan/dissectors/packet-reload-framing.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-retix-bpdu.c
   M /trunk/epan/dissectors/packet-rip.c
   M /trunk/epan/dissectors/packet-ripng.c
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-rlm.c
   M /trunk/epan/dissectors/packet-rlogin.c
   M /trunk/epan/dissectors/packet-rmcp.c
   M /trunk/epan/dissectors/packet-rmi.c
   M /trunk/epan/dissectors/packet-rmp.c
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-rpl.c
   M /trunk/epan/dissectors/packet-rsip.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-rtmpt.c
   M /trunk/epan/dissectors/packet-rtnet.c
   M /trunk/epan/dissectors/packet-rtp-events.c
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-rtps.c
   M /trunk/epan/dissectors/packet-rtps2.c
   M /trunk/epan/dissectors/packet-rudp.c
   M /trunk/epan/dissectors/packet-rx.c
   M /trunk/epan/dissectors/packet-s5066.c
   M /trunk/epan/dissectors/packet-sasp.c
   M /trunk/epan/dissectors/packet-sbus.c
   M /trunk/epan/dissectors/packet-scriptingservice.c
   M /trunk/epan/dissectors/packet-scsi-mmc.c
   M /trunk/epan/dissectors/packet-scsi-osd.c
   M /trunk/epan/dissectors/packet-scsi-sbc.c
   M /trunk/epan/dissectors/packet-scsi-smc.c
   M /trunk/epan/dissectors/packet-scsi-ssc.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-sebek.c
   M /trunk/epan/dissectors/packet-sercosiii.c
   M /trunk/epan/dissectors/packet-ses.c
   M /trunk/epan/dissectors/packet-sflow.c
   M /trunk/epan/dissectors/packet-sgsap.c
   M /trunk/epan/dissectors/packet-simulcrypt.c
   M /trunk/epan/dissectors/packet-slimp3.c
   M /trunk/epan/dissectors/packet-sll.c
   M /trunk/epan/dissectors/packet-slowprotocols.c
   M /trunk/epan/dissectors/packet-slsk.c
   M /trunk/epan/dissectors/packet-smb-browse.c
   M /trunk/epan/dissectors/packet-smb-logon.c
   M /trunk/epan/dissectors/packet-smb-mailslot.c
   M /trunk/epan/dissectors/packet-smb-pipe.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-sna.c
   M /trunk/epan/dissectors/packet-socketcan.c
   M /trunk/epan/dissectors/packet-socks.c
   M /trunk/epan/dissectors/packet-spice.c
   M /trunk/epan/dissectors/packet-spp.c
   M /trunk/epan/dissectors/packet-srp.c
   M /trunk/epan/dissectors/packet-srvloc.c
   M /trunk/epan/dissectors/packet-sscf-nni.c
   M /trunk/epan/dissectors/packet-sscop.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-starteam.c
   M /trunk/epan/dissectors/packet-synergy.c
   M /trunk/epan/dissectors/packet-tacacs.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-teamspeak2.c
   M /trunk/epan/dissectors/packet-teimanagement.c
   M /trunk/epan/dissectors/packet-teredo.c
   M /trunk/epan/dissectors/packet-tipc.c
   M /trunk/epan/dissectors/packet-tnef.c
   M /trunk/epan/dissectors/packet-tns.c
   M /trunk/epan/dissectors/packet-trill.c
   M /trunk/epan/dissectors/packet-tsp.c
   M /trunk/epan/dissectors/packet-tte-pcf.c
   M /trunk/epan/dissectors/packet-tte.c
   M /trunk/epan/dissectors/packet-turbocell.c
   M /trunk/epan/dissectors/packet-tuxedo.c
   M /trunk/epan/dissectors/packet-tzsp.c
   M /trunk/epan/dissectors/packet-udld.c
   M /trunk/epan/dissectors/packet-uma.c
   M /trunk/epan/dissectors/packet-usb-hid.c
   M /trunk/epan/dissectors/packet-usb-hub.c
   M /trunk/epan/dissectors/packet-usb-masstorage.c
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-v52.c
   M /trunk/epan/dissectors/packet-v5ua.c
   M /trunk/epan/dissectors/packet-vcdu.c
   M /trunk/epan/dissectors/packet-vlan.c
   M /trunk/epan/dissectors/packet-vmlab.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-vrrp.c
   M /trunk/epan/dissectors/packet-vtp.c
   M /trunk/epan/dissectors/packet-vuze-dht.c
   M /trunk/epan/dissectors/packet-vxi11.c
   M /trunk/epan/dissectors/packet-wai.c
   M /trunk/epan/dissectors/packet-wccp.c
   M /trunk/epan/dissectors/packet-wcp.c
   M /trunk/epan/dissectors/packet-who.c
   M /trunk/epan/dissectors/packet-wifi-p2p.c
   M /trunk/epan/dissectors/packet-windows-common.c
   M /trunk/epan/dissectors/packet-winsrepl.c
   M /trunk/epan/dissectors/packet-wow.c
   M /trunk/epan/dissectors/packet-wps.c
   M /trunk/epan/dissectors/packet-wsmp.c
   M /trunk/epan/dissectors/packet-x224.c
   M /trunk/epan/dissectors/packet-x25.c
   M /trunk/epan/dissectors/packet-x29.c
   M /trunk/epan/dissectors/packet-xdmcp.c
   M /trunk/epan/dissectors/packet-xmcp.c
   M /trunk/epan/dissectors/packet-xot.c
   M /trunk/epan/dissectors/packet-yhoo.c
   M /trunk/epan/dissectors/packet-ymsg.c
   M /trunk/epan/dissectors/packet-zbee-zcl.c
   M /trunk/epan/dissectors/packet-zebra.c
   M /trunk/epan/dissectors/packet-ziop.c

Convert 'encoding' parameter of certain proto_tree_add_item() calls in non-autogenerated epan/dissectors:
 Specifically:  Replace FALSE|0 and TRUE|1 by ENC_BIG_ENDIAN|ENC_LITTLE_ENDIAN as
 the encoding parameter for proto_tree_add_item() calls which directly reference
 an item in hf[] which has a type of:
    FT_UINT8
    FT_UINT16
    FT_UINT24
    FT_UINT32
    FT_UINT64
    FT_INT8
    FT_INT16
    FT_INT24
    FT_INT32
    FT_INT64
    FT_FLOAT
    FT_DOUBLE


------------------------------------------------------------------------
r39287 | gerald | 2011-10-05 19:43:51 -0700 (Wed, 05 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/geoip_db.c

Don't break strict aliasing rules.

------------------------------------------------------------------------
r39286 | wmeier | 2011-10-05 17:53:06 -0700 (Wed, 05 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-brp.c

Create expert item for invalid packet type instead of using DISSECTOR_ASSERT_NOT_REACHED();
Reformat some long lines;
Refactor code slightly.

------------------------------------------------------------------------
r39285 | gerald | 2011-10-05 16:59:07 -0700 (Wed, 05 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/geoip_db.c

GEOIP_NETSPEED_EDITION_V6 → GEOIP_NETSPEED_EDITION_REV1_V6.

------------------------------------------------------------------------
r39284 | gerald | 2011-10-05 16:20:45 -0700 (Wed, 05 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/geoip_db.c

Add a dummy version of geoip_db_lookup_ipv6(). Should fix compilation on
a few of the build slaves.

------------------------------------------------------------------------
r39283 | gerald | 2011-10-05 16:02:31 -0700 (Wed, 05 Oct 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.h.win32
   M /trunk/config.nmake

Add a HAVE_GEOIP_V6 configuration option and enable it by default.

------------------------------------------------------------------------
r39282 | gerald | 2011-10-05 15:39:18 -0700 (Wed, 05 Oct 2011) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile.nmake

Add $(GEOIP_CFLAGS).

------------------------------------------------------------------------
r39281 | gerald | 2011-10-05 15:37:00 -0700 (Wed, 05 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/geoip_db.c

Fix GeoIP-sans-IPv6 compilation.

------------------------------------------------------------------------
r39280 | gerald | 2011-10-05 15:27:51 -0700 (Wed, 05 Oct 2011) | 3 lines
Changed paths:
   M /trunk/acinclude.m4
   M /trunk/docbook/release-notes.xml
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/geoip_db.c
   M /trunk/epan/geoip_db.h
   M /trunk/epan/libwireshark.def
   M /trunk/gtk/hostlist_table.c

Add GeoIP IPv6 database support. Tested with GeoIP 1.4.7, but older
versions *should* be supported.

------------------------------------------------------------------------
r39279 | wmeier | 2011-10-05 14:00:53 -0700 (Wed, 05 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

packet-ipdc.h no longer exists ...

------------------------------------------------------------------------
r39278 | wmeier | 2011-10-05 13:57:56 -0700 (Wed, 05 Oct 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipdc.c
   D /trunk/epan/dissectors/packet-ipdc.h

Fix proto_tree_add_item() encoding parameter:
- Use ENC_BIG_ENDIAN instead of a (non-sensical) variable value;
- Use ENC_NA for hf field type FT_BYTES;

Also:
- Remove unneeded #includes;
- Use consistent indentation;
- val_to_str_...()  ==> val_to_str_..._const()

------------------------------------------------------------------------
r39277 | cmaynard | 2011-10-05 13:28:50 -0700 (Wed, 05 Oct 2011) | 2 lines
Changed paths:
   M /trunk/tap-iousers.c

In iousers_init(), compare "conv,ipv6" before "conv,ip" and be sure to compare all 9 characters of that string instead of only 7.  Also correct the offset when looking for a possible comma followed by an optional filter.

------------------------------------------------------------------------
r39276 | wmeier | 2011-10-05 12:21:48 -0700 (Wed, 05 Oct 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wap.h
   M /trunk/epan/dissectors/packet-wsp.c
   M /trunk/epan/dissectors/packet-wtls.c
   M /trunk/epan/dissectors/packet-wtp.c

All: Fix proto_tree_add_item() encoding parameter:
- Use 'ENC_(LITTLE|BIG)_ENDIAN' instead of locally defined 'bo_(little|big)_endian';
- Use ENC_NA for hf fields with type FT_NONE or FT_BYTES.

packet-wsp.c:
- #if 0 unused hf fields;
-Fix two minor bugs in "sir" dissection.

------------------------------------------------------------------------
r39275 | etxrab | 2011-10-05 11:28:40 -0700 (Wed, 05 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/tcap-persistentdata.c

Check if the continue is from the originating side too.
------------------------------------------------------------------------
r39274 | etxrab | 2011-10-05 11:27:48 -0700 (Wed, 05 Oct 2011) | 1 line
Changed paths:
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/epan/dissectors/packet-inap.c

Add a couple of OID strings.
------------------------------------------------------------------------
r39273 | cmaynard | 2011-10-05 11:22:30 -0700 (Wed, 05 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.h

Some minor documentation changes: little_endian -> encoding.  Also, fully parenthesize FI_BITS_OFFSET, FI_BITS_SIZE, and FI_GET_FLAG macro arguments.

------------------------------------------------------------------------
r39272 | wmeier | 2011-10-05 09:12:29 -0700 (Wed, 05 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-brp.c

Add a short description ofthe dissector (from the Bug submission)
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6428

------------------------------------------------------------------------
r39271 | wmeier | 2011-10-05 09:06:01 -0700 (Wed, 05 Oct 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-brp.c

Various cleanup:
- Add Gerald Combs copyright;
- Use correct address for FSF;
- Move proto_reg_handoff...() to the end of the file per convention;
- Remove unneeded check_col() and col_clear();
- Localize brp_handle;
- Whitespace cleanup ("4 space tabs" ==> spaces; remove trailing spaces).

------------------------------------------------------------------------
r39270 | wmeier | 2011-10-05 07:51:06 -0700 (Wed, 05 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dec-dnart.c

Use ENC_NA as the proto_tree_add_item() encoding parameter for a field of type  FT_BYTES;
 Fixes what appears to be a minor bug.

------------------------------------------------------------------------
r39269 | stig | 2011-10-05 04:44:38 -0700 (Wed, 05 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Cleanup the unregister loop to avoid freeing wrong data.
------------------------------------------------------------------------
r39268 | stig | 2011-10-05 04:44:29 -0700 (Wed, 05 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Cleanup the unregister loop to avoid freeing wrong data.
------------------------------------------------------------------------
r39267 | stig | 2011-10-05 04:44:19 -0700 (Wed, 05 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.c

Use g_tree_steal to remove an entry without calling the destroy function.
This because we use the destroy function to determine same_name_hfinfo.
------------------------------------------------------------------------
r39266 | etxrab | 2011-10-04 22:53:53 -0700 (Tue, 04 Oct 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/simple_dialog.c
   M /trunk/simple_dialog.h

Michael Mann:
Removed the Save button if live capture is going on when File->Quit is selected. Solves Assertion failed when doing File->Quit->Save during live capture
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=1710
------------------------------------------------------------------------
r39265 | etxrab | 2011-10-04 22:42:16 -0700 (Tue, 04 Oct 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main.c

From Sake Blok and Michael Mann:
Change "File -> Save As" to only save the displayed frames by default.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6192
------------------------------------------------------------------------
r39264 | etxrab | 2011-10-04 22:40:34 -0700 (Tue, 04 Oct 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_file_dlg.c
   M /trunk/gtk/capture_file_dlg.h
   M /trunk/gtk/drag_and_drop.c
   M /trunk/gtk/file_import_dlg.c
   M /trunk/gtk/main_menubar.c
   M /trunk/win32/file_dlg_win32.c

From Sake Blok and Michael Mann:
Change "File -> Save As" to only save the displayed frames by default.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6192
------------------------------------------------------------------------
r39263 | wmeier | 2011-10-04 19:39:04 -0700 (Tue, 04 Oct 2011) | 9 lines
Changed paths:
   M /trunk/asn1/mpeg-audio/packet-mpeg-audio-template.c
   M /trunk/asn1/mpeg-pes/packet-mpeg-pes-template.c
   M /trunk/asn1/qsig/packet-qsig-template.c
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/asn1/spnego/packet-spnego-template.c
   M /trunk/asn1/tetra/packet-tetra-template.c
   M /trunk/epan/dissectors/packet-mpeg-audio.c
   M /trunk/epan/dissectors/packet-mpeg-pes.c
   M /trunk/epan/dissectors/packet-qsig.c
   M /trunk/epan/dissectors/packet-snmp.c
   M /trunk/epan/dissectors/packet-spnego.c
   M /trunk/epan/dissectors/packet-tetra.c

Use ENC_NA as encoding for proto_tree_add_item() calls which directly reference an hf item (in hf[] with types:
     FT_NONE
     FT_BYTES
     FT_IPV6
     FT_IPXNET
     FT_OID
Note: Encoding field set to ENC_NA only if the field was previously TRUE|FALSE|1|0|ENC_LITTLE_ENDIAN|ENC_BIG_ENDIAN
 

------------------------------------------------------------------------
r39262 | wmeier | 2011-10-04 18:00:06 -0700 (Tue, 04 Oct 2011) | 9 lines
Changed paths:
   M /trunk/plugins/docsis/packet-bpkmattr.c
   M /trunk/plugins/docsis/packet-cmstatus.c
   M /trunk/plugins/docsis/packet-dccack.c
   M /trunk/plugins/docsis/packet-dccreq.c
   M /trunk/plugins/docsis/packet-dccrsp.c
   M /trunk/plugins/docsis/packet-dcd.c
   M /trunk/plugins/docsis/packet-docsis.c
   M /trunk/plugins/docsis/packet-rngrsp.c
   M /trunk/plugins/docsis/packet-tlv-cmctrl.c
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/docsis/packet-type29ucd.c
   M /trunk/plugins/docsis/packet-ucd.c
   M /trunk/plugins/docsis/packet-vendor.c
   M /trunk/plugins/ethercat/packet-ams.c
   M /trunk/plugins/ethercat/packet-ecatmb.c
   M /trunk/plugins/ethercat/packet-ethercat-datagram.c
   M /trunk/plugins/ethercat/packet-ioraw.c
   M /trunk/plugins/ethercat/packet-nv.c
   M /trunk/plugins/irda/packet-ircomm.c
   M /trunk/plugins/irda/packet-irda.c
   M /trunk/plugins/irda/packet-sir.c
   M /trunk/plugins/m2m/packet-m2m.c
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c
   M /trunk/plugins/profinet/packet-dcom-cba-acco.c
   M /trunk/plugins/profinet/packet-dcom-cba.c
   M /trunk/plugins/profinet/packet-pn-dcp.c
   M /trunk/plugins/profinet/packet-pn-ptcp.c
   M /trunk/plugins/profinet/packet-pn-rt.c
   M /trunk/plugins/unistim/packet-unistim.c
   M /trunk/plugins/wimax/mac_hd_generic_decoder.c
   M /trunk/plugins/wimax/mac_hd_type1_decoder.c
   M /trunk/plugins/wimax/mac_hd_type2_decoder.c
   M /trunk/plugins/wimax/mac_mgmt_msg_decoder.c
   M /trunk/plugins/wimax/msg_dcd.c
   M /trunk/plugins/wimax/msg_dlmap.c
   M /trunk/plugins/wimax/msg_dreg.c
   M /trunk/plugins/wimax/msg_dsd.c
   M /trunk/plugins/wimax/msg_reg_req.c
   M /trunk/plugins/wimax/msg_reg_rsp.c
   M /trunk/plugins/wimax/msg_rep.c
   M /trunk/plugins/wimax/msg_res_cmd.c
   M /trunk/plugins/wimax/msg_rng_req.c
   M /trunk/plugins/wimax/msg_rng_rsp.c
   M /trunk/plugins/wimax/msg_sbc.c
   M /trunk/plugins/wimax/msg_ucd.c
   M /trunk/plugins/wimax/wimax_compact_dlmap_ie_decoder.c
   M /trunk/plugins/wimax/wimax_compact_ulmap_ie_decoder.c
   M /trunk/plugins/wimax/wimax_pdu_decoder.c
   M /trunk/plugins/wimax/wimax_utils.c

Use ENC_NA as encoding for proto_tree_add_item() calls which directly reference an hf item (in hf[] with types:
    FT_NONE
    FT_BYTES
    FT_IPV6
    FT_IPXNET
    FT_OID

Note: Encoding field set to ENC_NA only if the field was previously TRUE|FALSE|1|0|ENC_LITTLE_ENDIAN|ENC_BIG_ENDIAN

------------------------------------------------------------------------
r39261 | wmeier | 2011-10-04 17:25:09 -0700 (Tue, 04 Oct 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-fcdns.c
   M /trunk/epan/dissectors/packet-fcfcs.c
   M /trunk/epan/dissectors/packet-fcfzs.c
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-rtps2.c
   M /trunk/epan/dissectors/packet-scsi-osd.c
   M /trunk/epan/dissectors/packet-scsi-sbc.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-ssl.c

Use ENC_NA as encoding for proto_tree_add_item() calls which directly reference an hf item with types in hf[] of:
    FT_NONE
    FT_BYTES
    FT_IPV6
    FT_IPXNET
    FT_OID

------------------------------------------------------------------------
r39260 | wmeier | 2011-10-04 15:44:31 -0700 (Tue, 04 Oct 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-2dparityfec.c
   M /trunk/epan/dissectors/packet-3com-njack.c
   M /trunk/epan/dissectors/packet-aim-generic.c
   M /trunk/epan/dissectors/packet-aim-messaging.c
   M /trunk/epan/dissectors/packet-aim-sst.c
   M /trunk/epan/dissectors/packet-airopeek.c
   M /trunk/epan/dissectors/packet-alcap.c
   M /trunk/epan/dissectors/packet-amqp.c
   M /trunk/epan/dissectors/packet-arcnet.c
   M /trunk/epan/dissectors/packet-artnet.c
   M /trunk/epan/dissectors/packet-aruba-papi.c
   M /trunk/epan/dissectors/packet-asap.c
   M /trunk/epan/dissectors/packet-asf.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-atalk.c
   M /trunk/epan/dissectors/packet-ayiya.c
   M /trunk/epan/dissectors/packet-bacnet.c
   M /trunk/epan/dissectors/packet-banana.c
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-bmc.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-bpdu.c
   M /trunk/epan/dissectors/packet-bssap.c
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-bt-utp.c
   M /trunk/epan/dissectors/packet-btamp.c
   M /trunk/epan/dissectors/packet-bthci_cmd.c
   M /trunk/epan/dissectors/packet-bthci_evt.c
   M /trunk/epan/dissectors/packet-bthci_sco.c
   M /trunk/epan/dissectors/packet-btl2cap.c
   M /trunk/epan/dissectors/packet-btobex.c
   M /trunk/epan/dissectors/packet-btrfcomm.c
   M /trunk/epan/dissectors/packet-bvlc.c
   M /trunk/epan/dissectors/packet-capwap.c
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-cfm.c
   M /trunk/epan/dissectors/packet-cigi.c
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cisco-erspan.c
   M /trunk/epan/dissectors/packet-cisco-wids.c
   M /trunk/epan/dissectors/packet-classicstun.c
   M /trunk/epan/dissectors/packet-collectd.c
   M /trunk/epan/dissectors/packet-data.c
   M /trunk/epan/dissectors/packet-dcc.c
   M /trunk/epan/dissectors/packet-dcerpc-krb5rpc.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcom-dispatch.c
   M /trunk/epan/dissectors/packet-dcom-remunkn.c
   M /trunk/epan/dissectors/packet-dcom.c
   M /trunk/epan/dissectors/packet-dcp-etsi.c
   M /trunk/epan/dissectors/packet-dec-dnart.c
   M /trunk/epan/dissectors/packet-dect.c
   M /trunk/epan/dissectors/packet-dhcp-failover.c
   M /trunk/epan/dissectors/packet-dhcpv6.c
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-diameter_3gpp.c
   M /trunk/epan/dissectors/packet-distcc.c
   M /trunk/epan/dissectors/packet-dlm3.c
   M /trunk/epan/dissectors/packet-dnp.c
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-dplay.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-dua.c
   M /trunk/epan/dissectors/packet-dvbci.c
   M /trunk/epan/dissectors/packet-dvmrp.c
   M /trunk/epan/dissectors/packet-eapol.c
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-eigrp.c
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-enrp.c
   M /trunk/epan/dissectors/packet-enttec.c
   M /trunk/epan/dissectors/packet-epl.c
   M /trunk/epan/dissectors/packet-epl_v1.c
   M /trunk/epan/dissectors/packet-extreme.c
   M /trunk/epan/dissectors/packet-fcels.c
   M /trunk/epan/dissectors/packet-fcgi.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-fip.c
   M /trunk/epan/dissectors/packet-fix.c
   M /trunk/epan/dissectors/packet-fp_hint.c
   M /trunk/epan/dissectors/packet-fractalgeneratorprotocol.c
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/dissectors/packet-gdsdb.c
   M /trunk/epan/dissectors/packet-giop.c
   M /trunk/epan/dissectors/packet-git.c
   M /trunk/epan/dissectors/packet-glbp.c
   M /trunk/epan/dissectors/packet-gmhdr.c
   M /trunk/epan/dissectors/packet-gnutella.c
   M /trunk/epan/dissectors/packet-gpef.c
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-gvcp.c
   M /trunk/epan/dissectors/packet-h223.c
   M /trunk/epan/dissectors/packet-h261.c
   M /trunk/epan/dissectors/packet-h263p.c
   M /trunk/epan/dissectors/packet-hip.c
   M /trunk/epan/dissectors/packet-hp-erm.c
   M /trunk/epan/dissectors/packet-hpteam.c
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-icmp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-ieee1722.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-igmp.c
   M /trunk/epan/dissectors/packet-image-png.c
   M /trunk/epan/dissectors/packet-imf.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-infiniband_sdp.c
   M /trunk/epan/dissectors/packet-ipmi-app.c
   M /trunk/epan/dissectors/packet-ipmi-chassis.c
   M /trunk/epan/dissectors/packet-ipmi-picmg.c
   M /trunk/epan/dissectors/packet-ipmi-se.c
   M /trunk/epan/dissectors/packet-ipmi-session.c
   M /trunk/epan/dissectors/packet-ipmi-storage.c
   M /trunk/epan/dissectors/packet-ipmi-transport.c
   M /trunk/epan/dissectors/packet-ipmi.c
   M /trunk/epan/dissectors/packet-ipsec-tcp.c
   M /trunk/epan/dissectors/packet-ipsec.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-ipxwan.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-ismacryp.c
   M /trunk/epan/dissectors/packet-ismp.c
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-iua.c
   M /trunk/epan/dissectors/packet-iwarp-ddp-rdmap.c
   M /trunk/epan/dissectors/packet-iwarp-mpa.c
   M /trunk/epan/dissectors/packet-jpeg.c
   M /trunk/epan/dissectors/packet-json.c
   M /trunk/epan/dissectors/packet-jxta.c
   M /trunk/epan/dissectors/packet-kdp.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos4.c
   M /trunk/epan/dissectors/packet-kink.c
   M /trunk/epan/dissectors/packet-klm.c
   M /trunk/epan/dissectors/packet-kpasswd.c
   M /trunk/epan/dissectors/packet-l2tp.c
   M /trunk/epan/dissectors/packet-laplink.c
   M /trunk/epan/dissectors/packet-ldp.c
   M /trunk/epan/dissectors/packet-ldss.c
   M /trunk/epan/dissectors/packet-lisp.c
   M /trunk/epan/dissectors/packet-lldp.c
   M /trunk/epan/dissectors/packet-ltp.c
   M /trunk/epan/dissectors/packet-m2pa.c
   M /trunk/epan/dissectors/packet-m2tp.c
   M /trunk/epan/dissectors/packet-m2ua.c
   M /trunk/epan/dissectors/packet-m3ua.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-meta.c
   M /trunk/epan/dissectors/packet-mgcp.c
   M /trunk/epan/dissectors/packet-mip.c
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-mndp.c
   M /trunk/epan/dissectors/packet-mount.c
   M /trunk/epan/dissectors/packet-mp2t.c
   M /trunk/epan/dissectors/packet-mp4ves.c
   M /trunk/epan/dissectors/packet-mpeg1.c
   M /trunk/epan/dissectors/packet-mpls-echo.c
   M /trunk/epan/dissectors/packet-mrdisc.c
   M /trunk/epan/dissectors/packet-ms-mms.c
   M /trunk/epan/dissectors/packet-msnip.c
   M /trunk/epan/dissectors/packet-msnlb.c
   M /trunk/epan/dissectors/packet-msrp.c
   M /trunk/epan/dissectors/packet-nas_eps.c
   M /trunk/epan/dissectors/packet-nb_rtpmux.c
   M /trunk/epan/dissectors/packet-nbd.c
   M /trunk/epan/dissectors/packet-ncp-nmas.c
   M /trunk/epan/dissectors/packet-ncp-sss.c
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-netdump.c
   M /trunk/epan/dissectors/packet-netperfmeter.c
   M /trunk/epan/dissectors/packet-netsync.c
   M /trunk/epan/dissectors/packet-newmail.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-nfsacl.c
   M /trunk/epan/dissectors/packet-nisplus.c
   M /trunk/epan/dissectors/packet-nlm.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-omron-fins.c
   M /trunk/epan/dissectors/packet-ositp.c
   M /trunk/epan/dissectors/packet-p_mul.c
   M /trunk/epan/dissectors/packet-packetbb.c
   M /trunk/epan/dissectors/packet-paltalk.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pflog.c
   M /trunk/epan/dissectors/packet-pim.c
   M /trunk/epan/dissectors/packet-pingpongprotocol.c
   M /trunk/epan/dissectors/packet-pktc.c
   M /trunk/epan/dissectors/packet-pnrp.c
   M /trunk/epan/dissectors/packet-portmap.c
   M /trunk/epan/dissectors/packet-ppi-sensor.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-pppoe.c
   M /trunk/epan/dissectors/packet-pptp.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-pw-cesopsn.c
   M /trunk/epan/dissectors/packet-pw-satop.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-rdm.c
   M /trunk/epan/dissectors/packet-rdp.c
   M /trunk/epan/dissectors/packet-rdt.c
   M /trunk/epan/dissectors/packet-redback.c
   M /trunk/epan/dissectors/packet-redbackli.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-ripng.c
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-rlc.c
   M /trunk/epan/dissectors/packet-rlogin.c
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-rpc.c
   M /trunk/epan/dissectors/packet-rpcap.c
   M /trunk/epan/dissectors/packet-rpl.c
   M /trunk/epan/dissectors/packet-rquota.c
   M /trunk/epan/dissectors/packet-rsip.c
   M /trunk/epan/dissectors/packet-rsl.c
   M /trunk/epan/dissectors/packet-rsync.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-rtmpt.c
   M /trunk/epan/dissectors/packet-rtnet.c
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-rx.c
   M /trunk/epan/dissectors/packet-s5066.c
   M /trunk/epan/dissectors/packet-sap.c
   M /trunk/epan/dissectors/packet-scriptingservice.c
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-sercosiii.c
   M /trunk/epan/dissectors/packet-ses.c
   M /trunk/epan/dissectors/packet-sflow.c
   M /trunk/epan/dissectors/packet-sigcomp.c
   M /trunk/epan/dissectors/packet-simulcrypt.c
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/dissectors/packet-skinny.c
   M /trunk/epan/dissectors/packet-sll.c
   M /trunk/epan/dissectors/packet-slowprotocols.c
   M /trunk/epan/dissectors/packet-smb-logon.c
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smpp.c
   M /trunk/epan/dissectors/packet-sna.c
   M /trunk/epan/dissectors/packet-socks.c
   M /trunk/epan/dissectors/packet-spice.c
   M /trunk/epan/dissectors/packet-spray.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-stat-notify.c
   M /trunk/epan/dissectors/packet-stat.c
   M /trunk/epan/dissectors/packet-stun.c
   M /trunk/epan/dissectors/packet-sua.c
   M /trunk/epan/dissectors/packet-synergy.c
   M /trunk/epan/dissectors/packet-tapa.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-teamspeak2.c
   M /trunk/epan/dissectors/packet-telkonet.c
   M /trunk/epan/dissectors/packet-teredo.c
   M /trunk/epan/dissectors/packet-tipc.c
   M /trunk/epan/dissectors/packet-tnef.c
   M /trunk/epan/dissectors/packet-tns.c
   M /trunk/epan/dissectors/packet-trill.c
   M /trunk/epan/dissectors/packet-tte-pcf.c
   M /trunk/epan/dissectors/packet-ua.c
   M /trunk/epan/dissectors/packet-ucp.c
   M /trunk/epan/dissectors/packet-uma.c
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-usb-hid.c
   M /trunk/epan/dissectors/packet-usb.c
   M /trunk/epan/dissectors/packet-v5ua.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-vtp.c
   M /trunk/epan/dissectors/packet-vuze-dht.c
   M /trunk/epan/dissectors/packet-wai.c
   M /trunk/epan/dissectors/packet-wassp.c
   M /trunk/epan/dissectors/packet-who.c
   M /trunk/epan/dissectors/packet-wifi-p2p.c
   M /trunk/epan/dissectors/packet-wlccp.c
   M /trunk/epan/dissectors/packet-wol.c
   M /trunk/epan/dissectors/packet-wow.c
   M /trunk/epan/dissectors/packet-wps.c
   M /trunk/epan/dissectors/packet-xmcp.c
   M /trunk/epan/dissectors/packet-yppasswd.c
   M /trunk/epan/dissectors/packet-ypserv.c
   M /trunk/epan/dissectors/packet-zbee-aps.c
   M /trunk/epan/dissectors/packet-zbee-security.c
   M /trunk/epan/dissectors/packet-zrtp.c

Use ENC_NA as encoding for proto_tree_add_item() calls which directly reference an hf item (in hf[] with types:
   FT_NONE
   FT_BYTES
   FT_IPV6
   FT_IPXNET
   FT_OID

Note: Encoding field set to ENC_NA only if the field was previously TRUE|FALSE|ENC_LITTLE_ENDIAN|ENC_BIG_ENDIAN

------------------------------------------------------------------------
r39259 | stig | 2011-10-04 14:06:40 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Free duplicated strings in hf entries.
------------------------------------------------------------------------
r39258 | stig | 2011-10-04 14:06:20 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Free duplicated strings in hf entries.
------------------------------------------------------------------------
r39257 | gerald | 2011-10-04 13:50:12 -0700 (Tue, 04 Oct 2011) | 2 lines
Changed paths:
   M /trunk/config.nmake

Add more entries to the Python CRT list.

------------------------------------------------------------------------
r39256 | etxrab | 2011-10-04 12:19:43 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-brp.c

Remove unused variables.
------------------------------------------------------------------------
r39255 | etxrab | 2011-10-04 12:04:56 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-brp.c

Added Id
------------------------------------------------------------------------
r39254 | etxrab | 2011-10-04 12:03:55 -0700 (Tue, 04 Oct 2011) | 9 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-brp.c

From Rob Kruciak:
This is a dissector for the BRP (Bandwidth Reservation Protocol). This protocol
is used by various telecommunications vendors to establish VoD (Video
On-Demand) sessions between a STB (Set Top Box) at the customer's home and the
VoD server at the video head-end. 

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6428
- Changed hf blurbs to NULL
- Used dissector_add_handle() as the proposed port is registered to a different protocol.
------------------------------------------------------------------------
r39253 | stig | 2011-10-04 11:53:35 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Make custom IMF headers a part of profiles.
------------------------------------------------------------------------
r39252 | stig | 2011-10-04 11:41:07 -0700 (Tue, 04 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Delete allocated header fields when updating the UAT.
Don't call header_fields_initialize_cb for prefs, as it will be called
when done in the UAT.
------------------------------------------------------------------------
r39251 | stig | 2011-10-04 11:40:56 -0700 (Tue, 04 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Unregister and delete allocated header fields when updating the UAT.
Avoid double loading the UAT.
Use the post update callback in uat_new for regenerating header_fields_hash.
------------------------------------------------------------------------
r39250 | morriss | 2011-10-04 06:30:50 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Make value_strings const to fix checkapi warning. Do some minor reformatting.
------------------------------------------------------------------------
r39249 | stig | 2011-10-04 03:13:05 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Added support for configuring custom IMF headers.
------------------------------------------------------------------------
r39248 | stig | 2011-10-04 03:12:55 -0700 (Tue, 04 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h

Add proto_unregister_field().

This can be used to unregister fields registered in dissector UAT's.
------------------------------------------------------------------------
r39247 | etxrab | 2011-10-03 22:27:14 -0700 (Mon, 03 Oct 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/erf.c

From Andrew Kampjes:
Allows the saving of packets with snapped length to ERF. Prevents the adding of
automatic CRC and rounds down to the nearest 8 bytes instead of up, adding
zeros.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6409
------------------------------------------------------------------------
r39246 | etxrab | 2011-10-03 14:15:04 -0700 (Mon, 03 Oct 2011) | 4 lines
Changed paths:
   M /trunk/asn1/lte-rrc/lte-rrc.cnf
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/epan/dissectors/packet-lte-rrc.c

From Pascal Quantin:
Add dissection of GERAN related messages.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6427
------------------------------------------------------------------------
r39245 | etxrab | 2011-10-03 10:22:47 -0700 (Mon, 03 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

Fix a typo
------------------------------------------------------------------------
r39244 | etxrab | 2011-10-03 09:47:54 -0700 (Mon, 03 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-smb2.c

Set ENC
------------------------------------------------------------------------
r39243 | alagoutte | 2011-10-03 04:49:17 -0700 (Mon, 03 Oct 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

Fix checkhf error in packet-smb2.c file.
Unused entry: epan/dissectors/packet-smb2.c, hf_smb2_data_length => Add in Revision #16546 and never used
Unused entry: epan/dissectors/packet-smb2.c, hf_smb2_file_name_info => Add in Revision #25371 and never used
Unused entry: epan/dissectors/packet-smb2.c, hf_smb2_security_blob_len => Remove in Revision #16557
Unused entry: epan/dissectors/packet-smb2.c, hf_smb2_response_buffer_offset => Remove in Revision #21793
Unused entry: epan/dissectors/packet-smb2.c, hf_smb2_security_blob_offset => Remove in Revision #16557
Unused entry: epan/dissectors/packet-smb2.c, hf_smb2_response_size => Remove in Revision #16605

------------------------------------------------------------------------
r39242 | guy | 2011-10-03 00:28:45 -0700 (Mon, 03 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t30.c

Thou shalt not use g_sprintf() lest thou overflow a buffer.  (Yes, even
if you know it's safe.  Sorry.)

------------------------------------------------------------------------
r39241 | guy | 2011-10-03 00:19:05 -0700 (Mon, 03 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t30.c

%hhu = %u in printf-like functions, as "char", "signed char", and
"unsigned char" get upsized to "int" and "unsigned int" when passed to
varargs functions.

------------------------------------------------------------------------
r39240 | guy | 2011-10-02 23:40:58 -0700 (Sun, 02 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.h

Fix tpo.

------------------------------------------------------------------------
r39239 | guy | 2011-10-02 23:39:59 -0700 (Sun, 02 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t30.c

Cast away a warning - if that buffer has more than 2^31-1 characters in
it, we have a real problem.

------------------------------------------------------------------------
r39238 | etxrab | 2011-10-02 23:24:28 -0700 (Sun, 02 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Remove unused hf field.
------------------------------------------------------------------------
r39237 | guy | 2011-10-02 23:12:11 -0700 (Sun, 02 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

tvb_get_bits{16,32,64} get passed encoding values.  Rename the argument
appropriately; the only valid encoding is big-endian, so we don't
actually do anything different with the argument, so as not to break
code that passed it a gboolean endian flag.

------------------------------------------------------------------------
r39236 | etxrab | 2011-10-02 22:44:17 -0700 (Sun, 02 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dpnss.c

Set encoding.
------------------------------------------------------------------------
r39235 | etxrab | 2011-10-02 22:34:56 -0700 (Sun, 02 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t30.c

From Jakob Hirsch:
Parse T.30 PPR (partial page request) and show requested frames.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6326
------------------------------------------------------------------------
r39234 | etxrab | 2011-10-02 22:13:53 -0700 (Sun, 02 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec-udp.c

From David Mueller:
Incorrect identification of UDP-encapsulated NAT-keepalive packets.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6414
------------------------------------------------------------------------
r39233 | etxrab | 2011-10-02 21:53:17 -0700 (Sun, 02 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/wsutil/airpdcap_wep.c
   M /trunk/wsutil/crc32.c
   M /trunk/wsutil/crc32.h
   M /trunk/wsutil/libwsutil.def

From Michael Mann:
Condense all SCTP CRC routines to wsutil/crc32.[ch]. Also made
crc32_ccitt_table not explicitly accessible (must use crc32_ccitt_table_lookup).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6298
------------------------------------------------------------------------
r39232 | guy | 2011-10-02 12:05:20 -0700 (Sun, 02 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-enip.h

OK, those seem to depend on at least some of the CIP changes, so back
the ENIP changes out as well.

------------------------------------------------------------------------
r39231 | guy | 2011-10-02 11:58:21 -0700 (Sun, 02 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.h

Back out the changes to packet-cip.h, too, so that a fixed version of
the patch that updates both can be cleanly applied.

------------------------------------------------------------------------
r39230 | guy | 2011-10-02 11:47:00 -0700 (Sun, 02 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Back out improvements - it's still getting a lot of "used uninitialized"
errors, so I'll reopen the bug and log all the warnings that have been
produced, and mark the patch as "rejected".

------------------------------------------------------------------------
r39229 | guy | 2011-10-02 11:31:33 -0700 (Sun, 02 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

"seg_size" isn't set here, and the items don't appear to have a variable
segment size, they just appear to be 2 bytes long.

------------------------------------------------------------------------
r39228 | tuexen | 2011-10-02 10:59:00 -0700 (Sun, 02 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-enip.c

Fix warnings.

------------------------------------------------------------------------
r39227 | etxrab | 2011-10-02 10:27:05 -0700 (Sun, 02 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Add comments.
------------------------------------------------------------------------
r39226 | tuexen | 2011-10-02 10:18:23 -0700 (Sun, 02 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Fix warnings.

------------------------------------------------------------------------
r39225 | stig | 2011-10-02 10:02:10 -0700 (Sun, 02 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/wslua/wslua_tvb.c

From Alex Vallee via bug 6346:
Added Lua TvbRange unicode string methods.
------------------------------------------------------------------------
r39224 | etxrab | 2011-10-02 09:42:41 -0700 (Sun, 02 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
Low Speed Communication Resource

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6423
------------------------------------------------------------------------
r39223 | etxrab | 2011-10-02 09:39:04 -0700 (Sun, 02 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ Host Control Version 2

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6419
------------------------------------------------------------------------
r39222 | etxrab | 2011-10-02 09:35:10 -0700 (Sun, 02 Oct 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cip.h
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-enip.h

From Michael Mann :

General improvements to CIP and ENIP dissectors. 
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6416
------------------------------------------------------------------------
r39221 | stig | 2011-10-02 09:19:55 -0700 (Sun, 02 Oct 2011) | 6 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/wspython/wspy_register.c
   M /trunk/epan/wspython/wspy_register.h
   M /trunk/gtk/about_dlg.c
   M /trunk/register.h

Removed the protocol registration updates in the splash screen for Python
dissectors, because it does not work as expected and causes an assert.

Added generic splash updates for python register and handoff instead.

This should fix bug 5431.
------------------------------------------------------------------------
r39220 | etxrab | 2011-10-02 08:12:47 -0700 (Sun, 02 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

From Pascal Quantin:
I identified a new regression. When selecting a bit string, the highlighted bytes in the packet view are not the correct ones.
------------------------------------------------------------------------
r39219 | etxrab | 2011-10-02 08:08:27 -0700 (Sun, 02 Oct 2011) | 4 lines
Changed paths:
   M /trunk/asn1/lte-rrc/lte-rrc.cnf
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/epan/dissectors/packet-lte-rrc.c

From Pascal Quantin:
[LTE RRC] Enhance dissection of NeighCellConfig IE.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6412
------------------------------------------------------------------------
r39216 | gerald | 2011-10-02 07:03:24 -0700 (Sun, 02 Oct 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-10-02]
------------------------------------------------------------------------
r39215 | stig | 2011-10-02 06:43:57 -0700 (Sun, 02 Oct 2011) | 2 lines
Changed paths:
   M /trunk/text2pcap.c

From Peter Fales via bug 6424:
Corrected IP address with text2pcap -i option on big endian machines.
------------------------------------------------------------------------
r39214 | stig | 2011-10-02 06:39:35 -0700 (Sun, 02 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/epan.c
   M /trunk/epan/wslua/init_wslua.c
   M /trunk/epan/wslua/wslua.h
   M /trunk/gtk/about_dlg.c
   M /trunk/register.h

Added register action for loading Lua plugins.
Removed an unused argument to wslua_init().
------------------------------------------------------------------------
r39213 | stig | 2011-10-02 06:39:15 -0700 (Sun, 02 Oct 2011) | 1 line
Changed paths:
   M /trunk/gtk/about_dlg.c

Always update splash screen when action has changed.
------------------------------------------------------------------------
r39212 | guy | 2011-10-02 01:58:35 -0700 (Sun, 02 Oct 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Squelch some more warnings.

------------------------------------------------------------------------
r39211 | guy | 2011-10-02 01:40:03 -0700 (Sun, 02 Oct 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Squelch warnings (at that point, toc_offset has been determined to fit
into an int, as has offset + toc_offset + 8).

------------------------------------------------------------------------
r39210 | guy | 2011-10-02 01:12:08 -0700 (Sun, 02 Oct 2011) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

SQ_TYPE_NULL appears to do run-length encoding of nulls; do run-length
encoding of the list of nulls in the protocol tree, so if we have a
ridiculously large number of nulls, we don't have a ridiculously large
number of protocol tree entries, one for each null.  This should
(finally) fix bug 6378.

Add some additional sanity checks to avoid integer overflows and
underflows due to subtracting N from a value not guaranteed to be >= N.

In the big switch statements for AFP command codes, put the break
statement on a separate line, so it's a bit more obvious that the code
isn't falling through.

------------------------------------------------------------------------
r39209 | etxrab | 2011-10-01 01:11:06 -0700 (Sat, 01 Oct 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Set encoding.
Should 
hf_smb_server_guid
hf_smb_dfs_referral_server_guid
be FT_GUIDS?
------------------------------------------------------------------------
r39208 | wmeier | 2011-09-30 19:51:28 -0700 (Fri, 30 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

Fix checkAPI error:
Error: the blurb for field "Flags" ("smb2.ses_req_flags") matches the field name in packet-smb2.c

------------------------------------------------------------------------
r39207 | wmeier | 2011-09-30 19:13:15 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

Fix "unused_but_set_variable" GCC warning: Remove apparently unneeded code.

------------------------------------------------------------------------
r39206 | wmeier | 2011-09-30 19:04:54 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Update entry for Stefan Metzmacher re SMB/SMB2 dissector enhancements.

------------------------------------------------------------------------
r39205 | wmeier | 2011-09-30 18:57:38 -0700 (Fri, 30 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

From Stefan Metzmacher: Support for SMB 2.22 features;

"Patches to add most things for SMB 2.22"

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6394

------------------------------------------------------------------------
r39204 | cmaynard | 2011-09-30 14:36:13 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

Fix Coverity CID 1204: CONSTANT EXPRESSION RESULT according to feedback from Roland Knall.  See http://www.wireshark.org/lists/wireshark-dev/201109/msg00160.html.  Also, convert the relatively few tabs to 4-spaces to match the rest of this dissector's white space choice and add modelines.

------------------------------------------------------------------------
r39203 | cmaynard | 2011-09-30 13:51:10 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-erf.c

Add a few more raw link types to be up to date with the current ERF format spec.  Patch provided by Andrew Kampjes via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6410.

------------------------------------------------------------------------
r39202 | guy | 2011-09-30 12:39:43 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/docbook/Makefile.am
   M /trunk/docbook/Makefile.nmake

More tpo fixes.

------------------------------------------------------------------------
r39201 | gerald | 2011-09-30 10:39:32 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/docbook/Makefile.nmake

graphhics → graphics

------------------------------------------------------------------------
r39200 | stig | 2011-09-30 10:04:30 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/asn1/credssp

Fixed svn:ignore targets.

------------------------------------------------------------------------
r39199 | gerald | 2011-09-30 09:55:41 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/docbook/Makefile.am
   M /trunk/docbook/Makefile.nmake

s/wsug_/wsdg_/g in the Developer's Guide targets.

------------------------------------------------------------------------
r39198 | gal | 2011-09-30 09:37:28 -0700 (Fri, 30 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Add packet-credssp.h


------------------------------------------------------------------------
r39197 | gal | 2011-09-30 08:54:32 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/asn1/Makefile.am

Add credssp to subdirs list

------------------------------------------------------------------------
r39196 | gal | 2011-09-30 08:21:16 -0700 (Fri, 30 Sep 2011) | 5 lines
Changed paths:
   A /trunk/asn1/credssp
   A /trunk/asn1/credssp/CredSSP.asn
   A /trunk/asn1/credssp/Makefile.am
   A /trunk/asn1/credssp/Makefile.common
   A /trunk/asn1/credssp/Makefile.nmake
   A /trunk/asn1/credssp/credssp.cnf
   A /trunk/asn1/credssp/packet-credssp-template.c
   A /trunk/asn1/credssp/packet-credssp-template.h
   M /trunk/configure.in
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-credssp.c
   A /trunk/epan/dissectors/packet-credssp.h
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-ssl.c

Microsoft Credential Security Support Provider (CredSSP) support. 
Used by direct approach RDP for NTLMSSP authentication under SSL. 



------------------------------------------------------------------------
r39195 | alagoutte | 2011-09-30 08:14:33 -0700 (Fri, 30 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

Fix checkhf 
* Remove hf_bgp_cluster_identifier never use ! (Add in Revision #7546)

------------------------------------------------------------------------
r39194 | alagoutte | 2011-09-30 08:08:52 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

Enhance extended communities when RD Type 2

------------------------------------------------------------------------
r39193 | alagoutte | 2011-09-30 07:49:23 -0700 (Fri, 30 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Clemix via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6408
Dissector for ieee802.11e QoS Info field of QoS Capability Element(46) is missed

From me :
* Fix checkAPIs error (Found non-ASCII characters)

------------------------------------------------------------------------
r39192 | alagoutte | 2011-09-30 07:39:09 -0700 (Fri, 30 Sep 2011) | 15 lines
Changed paths:
   M /trunk/radius/dictionary.aruba

From ArubaOS 6.x : new Aruba RADIUS attributes (9 & 10)

(Aruba) #show aaa radius-attributes | include Aruba
Aruba-Location-Id               6      String   Aruba      14823
Aruba-Template-User             8      String   Aruba      14823
Aruba-User-Role                 1      String   Aruba      14823
Aruba-Port-Id                   7      String   Aruba      14823
Aruba-Priv-Admin-User           3      Integer  Aruba      14823
Aruba-User-Vlan                 2      Integer  Aruba      14823
Aruba-Essid-Name                5      String   Aruba      14823
Aruba-AP-Group                  10     String   Aruba      14823
Aruba-Named-User-Vlan           9      String   Aruba      14823
Aruba-Admin-Role                4      String   Aruba      14823


------------------------------------------------------------------------
r39191 | alagoutte | 2011-09-30 07:26:43 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

FT_EUI64 need also to specifies encoding !

------------------------------------------------------------------------
r39190 | guy | 2011-09-29 15:40:32 -0700 (Thu, 29 Sep 2011) | 3 lines
Changed paths:
   M /trunk/doc/README.developer

Update README.developer to take into account the disappearance of
FT_EBCDIC and the addition of support for character encodings.

------------------------------------------------------------------------
r39189 | wmeier | 2011-09-29 15:15:43 -0700 (Thu, 29 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mysql.c

Whitespace cleanup.

------------------------------------------------------------------------
r39188 | wmeier | 2011-09-29 14:47:01 -0700 (Thu, 29 Sep 2011) | 8 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-mysql.c

From András Veres-Szentkirályi: Added cursor type decoding to MySQL dissector

"The current MySQL dissector treats the exec_flags field as unused, however
since MySQL 5.0, this field is used to indicate the type of the cursor as it
can be read at
http://forge.mysql.com/wiki/MySQL_Internals_ClientServer_Protocol#Execute_Packet_.28Tentative_Description.29


------------------------------------------------------------------------
r39187 | guy | 2011-09-29 13:03:51 -0700 (Thu, 29 Sep 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

Clean up white space.

The appropriate encoding for a string is ENC_BIG_ENDIAN or
ENC_LITTLE_ENDIAN, combined with a character encoding value; it is not
ENC_NA, as the character encoding is definitely applicable, and the byte
order is also applicable if it's a counted string or a UTF-16 or UCS-2
string.  Assume ASCII for now.

------------------------------------------------------------------------
r39186 | wmeier | 2011-09-29 12:57:52 -0700 (Thu, 29 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

When building w/o LIBZ: (Somewhat clunky) attempt to fix "unused variable" and "unused parameter" compile errors.

------------------------------------------------------------------------
r39185 | wmeier | 2011-09-29 11:26:57 -0700 (Thu, 29 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spice.c

Comment out two cases of code which caused GCC 4.6 "unused-but-set-variable" warning.

------------------------------------------------------------------------
r39184 | wmeier | 2011-09-29 11:10:14 -0700 (Thu, 29 Sep 2011) | 7 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-spice.c

From Yaniv Kaul: SPICE dissector

"It's not perfect, but has been in use for quite a while and dissects nicely most
of the messages."

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6373

------------------------------------------------------------------------
r39183 | etxrab | 2011-09-29 08:23:23 -0700 (Thu, 29 Sep 2011) | 1 line
Changed paths:
   M /trunk/asn1/gsm_map/GSMMAP.asn
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/asn1/gsm_map/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Make it possible to dissect proprietarry Opcodes.
------------------------------------------------------------------------
r39182 | etxrab | 2011-09-28 23:13:13 -0700 (Wed, 28 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
Address Coverty issues CID 1204, CID 1215, CID 1224, CID 1246, CID 1247

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6400
------------------------------------------------------------------------
r39181 | cmaynard | 2011-09-28 18:53:38 -0700 (Wed, 28 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-xmcp.c

Add heuristics in dissect_xmcp_message() to try to avoid dissecting TCP packets on port 4788 that aren't actually xmcp packets.  Also, removed the check for a NULL tree as there's more work to do whether tree is NULL or not.
------------------------------------------------------------------------
r39180 | gerald | 2011-09-28 13:58:56 -0700 (Wed, 28 Sep 2011) | 5 lines
Changed paths:
   M /trunk/gtk/drag_and_drop.c
   M /trunk/gtk/main_menubar.c

In drag_and_drop.c use accessor functions for GtkSelectionData. In
main_menubar.c use gtk_osxapplication_insert_app_menu_item instead of
gtk_osxapplication_add_app_menu_item. Fixes deprecation-related errors
when compiling with HAVE_GTKOSXAPPLICATION defined.

------------------------------------------------------------------------
r39179 | morriss | 2011-09-28 12:46:24 -0700 (Wed, 28 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3mg.c

The SRT/SRA test pattern is 16 bits in Japan, don't try to retrieve 32 bits of it.
------------------------------------------------------------------------
r39178 | cmaynard | 2011-09-28 12:40:34 -0700 (Wed, 28 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Add default modeline settings to the end of the skeleton code.

------------------------------------------------------------------------
r39177 | cmaynard | 2011-09-28 12:38:03 -0700 (Wed, 28 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-igmp.c

Add modeline.  For now, add it at the bottom with tabstop=8, as that's where and what most others are using.

------------------------------------------------------------------------
r39176 | guy | 2011-09-28 12:08:20 -0700 (Wed, 28 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Quit if we have a zero-length query, so we don't loop indefinitely. 
Should fix bug 6378.

------------------------------------------------------------------------
r39175 | cmaynard | 2011-09-28 07:50:07 -0700 (Wed, 28 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/tshark.pod
   M /trunk/tshark.c

Rather than complain and quit if -V is missing when -O <protocols> is used, do the user a favor and continue as if -V had been specified.  Add explicit documentation of the -O <protocols> option to the man page.

------------------------------------------------------------------------
r39174 | guy | 2011-09-27 17:15:48 -0700 (Tue, 27 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtnet.c

Link to the RTmac spec.

------------------------------------------------------------------------
r39173 | guy | 2011-09-27 16:48:34 -0700 (Tue, 27 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtnet.c

Update URL.

------------------------------------------------------------------------
r39172 | wmeier | 2011-09-27 13:41:45 -0700 (Tue, 27 Sep 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-uaudp.c

- check_col() no longer needed;
- Calls to col_str_str() and to subdissectors must not be under 'if(tree)';
- Remove unneeded #includes;
- Use tvb_reported_length();
- Use tvb_new_subset_remaining();
- Use val_to_str_const();

------------------------------------------------------------------------
r39171 | guy | 2011-09-27 12:52:19 -0700 (Tue, 27 Sep 2011) | 3 lines
Changed paths:
   M /trunk/tshark.c

The separator between packets is an output option, not a capture option,
so it should be present even when building without libpcap.

------------------------------------------------------------------------
r39170 | guy | 2011-09-27 12:43:54 -0700 (Tue, 27 Sep 2011) | 3 lines
Changed paths:
   M /trunk/doc/README.developer

Future tense -> present tense for the encoding argument to
proto_tree_add_item() having more than just a byte order.

------------------------------------------------------------------------
r39169 | alagoutte | 2011-09-27 12:43:31 -0700 (Tue, 27 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6359
IEEE 802.11 dissector shows duplicated proto item for Action category

Action frame dissecting is first adding hf_ieee80211_action (wlan_mgt.fixed.action) field before the category-based processing. Immediately after that, the per-category implementations are adding FIELD_CATEGORY_CODE (hf_ieee80211_ff_category_code, i.e., wlan_mgt.fixed.category_code) to the proto tree for the exact same octet. Remove hf_ieee80211_action to avoid the duplicated item in the tree. In addition, remove the now unused action_item and action_tree variables.

------------------------------------------------------------------------
r39168 | cmaynard | 2011-09-27 11:32:59 -0700 (Tue, 27 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/tshark.pod
   M /trunk/docbook/release-notes.xml
   M /trunk/docbook/wsug_src/WSUG_app_tools.xml
   M /trunk/tshark.c

Add a new tshark option for being able to specify an alternate line separator between packets.  The option chosen was "-S <separator>".  The former -S option was renamed to -P, and the former -P option, which was previously undocumented, was renamed to -2.  This fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5342.

------------------------------------------------------------------------
r39167 | alagoutte | 2011-09-27 11:21:57 -0700 (Tue, 27 Sep 2011) | 9 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ua.c
   A /trunk/epan/dissectors/packet-uaudp.c

From mtwire via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6060
New dissectors: (UA) Universal Alcatel Protocol and transport UAUDP

From me :
* Prefer proto_tree_add_item (when is possible)
* Use 4-space indenting
* Add Modeline information
* Fix Clang Warning

------------------------------------------------------------------------
r39166 | cmaynard | 2011-09-27 11:19:23 -0700 (Tue, 27 Sep 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Minor formatting changes to the dumpcap -h output.

------------------------------------------------------------------------
r39165 | cmaynard | 2011-09-27 10:18:25 -0700 (Tue, 27 Sep 2011) | 2 lines
Changed paths:
   M /trunk/rawshark.c

Minor formatting changes to the rawshark -h output.

------------------------------------------------------------------------
r39164 | etxrab | 2011-09-27 05:05:32 -0700 (Tue, 27 Sep 2011) | 1 line
Changed paths:
   M /trunk/asn1/q932/packet-q932-template.c
   M /trunk/asn1/rnsap/packet-rnsap-template.c
   M /trunk/asn1/rnsap/rnsap.cnf
   M /trunk/asn1/rtse/rtse.cnf
   M /trunk/asn1/t38/packet-t38-template.c
   M /trunk/asn1/t38/t38.cnf
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/asn1/tcap/tcap.cnf
   M /trunk/asn1/tetra/packet-tetra-template.c
   M /trunk/asn1/tetra/tetra.cnf
   M /trunk/epan/dissectors/packet-gsm_bssmap_le.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-h263.c
   M /trunk/epan/dissectors/packet-h264.c
   M /trunk/epan/dissectors/packet-iua.c
   M /trunk/epan/dissectors/packet-iuup.c
   M /trunk/epan/dissectors/packet-q932.c
   M /trunk/epan/dissectors/packet-rnsap.c
   M /trunk/epan/dissectors/packet-rtse.c
   M /trunk/epan/dissectors/packet-t38.c
   M /trunk/epan/dissectors/packet-tcap.c
   M /trunk/epan/dissectors/packet-tetra.c

Get rid of check_col, while at it set ENC.
------------------------------------------------------------------------
r39163 | etxrab | 2011-09-27 05:04:29 -0700 (Tue, 27 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h

In proto_tree_add_bits... use const guint encoding to be consistent with proto_tree_add_item().
------------------------------------------------------------------------
r39162 | guy | 2011-09-26 14:48:54 -0700 (Mon, 26 Sep 2011) | 6 lines
Changed paths:
   M /trunk/plugins/profinet/packet-pn-rt.c

More white space cleanup.

We need the PDU length to find stuff at the end; use
tvb_reported_length(), *not* tvb_length(), to get it, so we're not
confused by a snapshot length.  Rename it "pdu_len" to make that clear.

------------------------------------------------------------------------
r39161 | etxrab | 2011-09-26 14:06:55 -0700 (Mon, 26 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/tvbuff.c

Yet another bug fix from Pascal.
------------------------------------------------------------------------
r39160 | guy | 2011-09-26 13:46:09 -0700 (Mon, 26 Sep 2011) | 3 lines
Changed paths:
   M /trunk/plugins/profinet/packet-pn-rt.c

The fragment data is almost certainly not a text string, so don't make
it an FT_STRING.

------------------------------------------------------------------------
r39159 | cmaynard | 2011-09-26 13:34:33 -0700 (Mon, 26 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-igmp.c

Some whitespace cleanup.  FALSE -> ENC_BIG_ENDIAN.  Remove most check_col()'s.

------------------------------------------------------------------------
r39158 | guy | 2011-09-26 13:33:35 -0700 (Mon, 26 Sep 2011) | 18 lines
Changed paths:
   M /trunk/plugins/profinet/packet-pn-rt.c

Use ENC_ values in proto_tree_add_item() calls.

Get rid of the code that attempts to deal with the FCS; if the
link-layer dissector hasn't removed the FCS, either:

	1) the link-layer dissector is buggy and should be fixed;

or

	2) the link-layer dissector doesn't know whether there's an FCS
	   and you have to tell it by setting a preference (and if there
	   is no such preference, one needs to be added).

The code in question was causing errors when the link-layer dissector
was removing the FCS when it's known to be present, as it should do.

Get rid of 4-space tabs in favor of spaces.

------------------------------------------------------------------------
r39157 | cmaynard | 2011-09-26 13:31:52 -0700 (Mon, 26 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xmcp.c

Fix modeline.

------------------------------------------------------------------------
r39156 | sfisher | 2011-09-26 12:24:47 -0700 (Mon, 26 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-igmp.c


From Thomas Morin via bug #6395: Improve display for IGMP


------------------------------------------------------------------------
r39155 | etxrab | 2011-09-26 11:56:27 -0700 (Mon, 26 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/tvbuff.c

Another bug fix from Pascal.
------------------------------------------------------------------------
r39154 | cmaynard | 2011-09-26 11:24:17 -0700 (Mon, 26 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sua.c

Make buildbots happy by adding back closing brace.

------------------------------------------------------------------------
r39153 | etxrab | 2011-09-26 10:50:54 -0700 (Mon, 26 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mtp2.c
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-mtp3mg.c
   M /trunk/epan/dissectors/packet-multipart.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-sccpmg.c
   M /trunk/epan/dissectors/packet-sigcomp.c
   M /trunk/epan/dissectors/packet-stun.c
   M /trunk/epan/dissectors/packet-sua.c
   M /trunk/epan/dissectors/packet-zrtp.c

Get rid of check_col() and use ENC.
------------------------------------------------------------------------
r39152 | etxrab | 2011-09-26 10:19:54 -0700 (Mon, 26 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.c

From Pascal Quantin:
When building the last byte, the remaining number of bits isn't masked.
------------------------------------------------------------------------
r39151 | etxrab | 2011-09-26 10:18:10 -0700 (Mon, 26 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dnp.c
   M /trunk/epan/dissectors/packet-dplay.c
   M /trunk/epan/dissectors/packet-dpnss-link.c
   M /trunk/epan/dissectors/packet-drda.c
   M /trunk/epan/dissectors/packet-per.h

Get rid of check_col() and use ENC.
------------------------------------------------------------------------
r39150 | etxrab | 2011-09-26 08:11:14 -0700 (Mon, 26 Sep 2011) | 1 line
Changed paths:
   M /trunk/asn1/rrc/rrc.cnf
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-per.h
   M /trunk/epan/dissectors/packet-rrc.c
   M /trunk/epan/dissectors/packet-umts_mac.c
   M /trunk/epan/libwireshark.def
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

Move tvb_new_octet_aligned() to tvbuff.c and use it.
------------------------------------------------------------------------
r39149 | etxrab | 2011-09-26 07:50:59 -0700 (Mon, 26 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-daap.c
   M /trunk/epan/dissectors/packet-dcp-etsi.c
   M /trunk/epan/dissectors/packet-dec-bpdu.c
   M /trunk/epan/dissectors/packet-dec-dnart.c
   M /trunk/epan/dissectors/packet-dhcp-failover.c
   M /trunk/epan/dissectors/packet-dis.c
   M /trunk/epan/dissectors/packet-distcc.c
   M /trunk/epan/dissectors/packet-dlm3.c
   M /trunk/epan/dissectors/packet-dlsw.c
   M /trunk/epan/dissectors/packet-dmp.c

Get rid of check_col, while at it set ENC.
------------------------------------------------------------------------
r39148 | etxrab | 2011-09-26 04:33:10 -0700 (Mon, 26 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-daytime.c
   M /trunk/epan/dissectors/packet-dccp.c
   M /trunk/epan/dissectors/packet-dcom-dispatch.c
   M /trunk/epan/dissectors/packet-dcom-oxid.c
   M /trunk/epan/dissectors/packet-dcom-remact.c
   M /trunk/epan/dissectors/packet-dcom-remunkn.c
   M /trunk/epan/dissectors/packet-dcom.c

Get rid of check_col, while at it set ENC.
------------------------------------------------------------------------
r39147 | etxrab | 2011-09-26 02:01:17 -0700 (Mon, 26 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-beep.c
   M /trunk/epan/dissectors/packet-bthci_cmd.c
   M /trunk/epan/dissectors/packet-calcappprotocol.c
   M /trunk/epan/dissectors/packet-cast.c
   M /trunk/epan/dissectors/packet-cfm.c
   M /trunk/epan/dissectors/packet-chdlc.c
   M /trunk/epan/dissectors/packet-cimd.c
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cisco-sm.c
   M /trunk/epan/dissectors/packet-cisco-wids.c
   M /trunk/epan/dissectors/packet-clnp.c
   M /trunk/epan/dissectors/packet-cmpp.c
   M /trunk/epan/dissectors/packet-cnip.c
   M /trunk/epan/dissectors/packet-componentstatus.c
   M /trunk/epan/dissectors/packet-cpfi.c
   M /trunk/epan/dissectors/packet-cpha.c
   M /trunk/epan/dissectors/packet-csm-encaps.c
   M /trunk/epan/dissectors/packet-ctdb.c
   M /trunk/epan/dissectors/packet-cups.c

Get rid of check_col, while at it set ENC.
------------------------------------------------------------------------
r39146 | etxrab | 2011-09-26 01:25:18 -0700 (Mon, 26 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-arp.c
   M /trunk/epan/dissectors/packet-artnet.c
   M /trunk/epan/dissectors/packet-atalk.c
   M /trunk/epan/dissectors/packet-atm.c
   M /trunk/epan/dissectors/packet-bat.c
   M /trunk/epan/dissectors/packet-batadv.c
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ber.h
   M /trunk/epan/dissectors/packet-bfd.c
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-bofl.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-bpdu.c
   M /trunk/epan/dissectors/packet-bssap.c
   M /trunk/epan/dissectors/packet-bthci_acl.c
   M /trunk/epan/dissectors/packet-bthci_evt.c
   M /trunk/epan/dissectors/packet-btrfcomm.c

Get rid of check_col, while at it set ENC.
------------------------------------------------------------------------
r39145 | etxrab | 2011-09-25 23:13:27 -0700 (Sun, 25 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-armagetronad.c

Make it build again.
------------------------------------------------------------------------
r39144 | etxrab | 2011-09-25 22:52:58 -0700 (Sun, 25 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-acap.c
   M /trunk/epan/dissectors/packet-adwin-config.c
   M /trunk/epan/dissectors/packet-ajp13.c
   M /trunk/epan/dissectors/packet-alcap.c
   M /trunk/epan/dissectors/packet-ans.c
   M /trunk/epan/dissectors/packet-aodv.c
   M /trunk/epan/dissectors/packet-aoe.c
   M /trunk/epan/dissectors/packet-app-pkix-cert.c
   M /trunk/epan/dissectors/packet-arcnet.c
   M /trunk/epan/dissectors/packet-armagetronad.c
   M /trunk/epan/dissectors/packet-aruba-adp.c
   M /trunk/epan/dissectors/packet-asap.c
   M /trunk/epan/dissectors/packet-asf.c
   M /trunk/epan/dissectors/packet-auto_rp.c

Get rid of check_col() and use ENC_BIG_ENDIAN.
------------------------------------------------------------------------
r39143 | etxrab | 2011-09-25 22:17:57 -0700 (Sun, 25 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
Implement the content control resource from the CI+
specification 1.2.

From me:
Change ENC_NA to ENC_BIG_ENDIAN as i suppose this is a big endian protocol and ENC_NA was erroneously used for irems bigger than i byte in some cases.
------------------------------------------------------------------------
r39142 | etxrab | 2011-09-25 21:56:24 -0700 (Sun, 25 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/capture_if_details_dlg_win32.c

Put in "#if 0":s to make it compile, these widgets are not vissible on my system so I have no idea what the GUI looks like with these changes.
------------------------------------------------------------------------
r39141 | jmayer | 2011-09-25 15:20:41 -0700 (Sun, 25 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile.nmake

gkvumeter got removed, don't try to build it.

------------------------------------------------------------------------
r39140 | wmeier | 2011-09-25 15:01:50 -0700 (Sun, 25 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

From Sylvain Munaut: Fix Bug #6351 (Buildbot fuzztest crash);

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6351


------------------------------------------------------------------------
r39139 | jmayer | 2011-09-25 14:54:04 -0700 (Sun, 25 Sep 2011) | 5 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/STATUS.gtk3
   M /trunk/gtk/capture_if_details_dlg_win32.c
   D /trunk/gtk/gtkvumeter.c
   D /trunk/gtk/gtkvumeter.h
   M /trunk/gtk/libui.vcproj

Remove gtkvumeter.[hc]
This may cause windows builds to fail. If nobody picks up the task
of getting it to compile again I'll start doing that tomorrow morning
with the help of the buildbot.

------------------------------------------------------------------------
r39138 | jmayer | 2011-09-25 14:27:19 -0700 (Sun, 25 Sep 2011) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt
   M /trunk/Makefile.nmake
   M /trunk/config.h.win32
   M /trunk/config.nmake
   M /trunk/configure.in
   M /trunk/gtk/CMakeLists.txt

Get rid of (hopefully) all configure options to enable MAIN_MENU_USE_UIMANAGER
as it is the only option left.

------------------------------------------------------------------------
r39137 | jmayer | 2011-09-25 14:19:45 -0700 (Sun, 25 Sep 2011) | 4 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/afp_stat.c
   M /trunk/gtk/ansi_a_stat.c
   M /trunk/gtk/ansi_map_stat.c
   M /trunk/gtk/bootp_stat.c
   M /trunk/gtk/camel_counter.c
   M /trunk/gtk/camel_srt.c
   M /trunk/gtk/compare_stat.c
   M /trunk/gtk/conversations_eth.c
   M /trunk/gtk/conversations_fc.c
   M /trunk/gtk/conversations_fddi.c
   M /trunk/gtk/conversations_ip.c
   M /trunk/gtk/conversations_ipv6.c
   M /trunk/gtk/conversations_ipx.c
   M /trunk/gtk/conversations_jxta.c
   M /trunk/gtk/conversations_ncp.c
   M /trunk/gtk/conversations_rsvp.c
   M /trunk/gtk/conversations_sctp.c
   M /trunk/gtk/conversations_tcpip.c
   M /trunk/gtk/conversations_tr.c
   M /trunk/gtk/conversations_udpip.c
   M /trunk/gtk/conversations_usb.c
   M /trunk/gtk/conversations_wlan.c
   M /trunk/gtk/dcerpc_stat.c
   M /trunk/gtk/diameter_stat.c
   M /trunk/gtk/expert_comp_dlg.c
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/flow_graph.c
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/gsm_a_stat.c
   M /trunk/gtk/gsm_map_stat.c
   M /trunk/gtk/gsm_map_summary.c
   M /trunk/gtk/gtp_stat.c
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/h225_counter.c
   M /trunk/gtk/h225_ras_srt.c
   M /trunk/gtk/hostlist_eth.c
   M /trunk/gtk/hostlist_fc.c
   M /trunk/gtk/hostlist_fddi.c
   M /trunk/gtk/hostlist_ip.c
   M /trunk/gtk/hostlist_ipv6.c
   M /trunk/gtk/hostlist_ipx.c
   M /trunk/gtk/hostlist_jxta.c
   M /trunk/gtk/hostlist_ncp.c
   M /trunk/gtk/hostlist_rsvp.c
   M /trunk/gtk/hostlist_sctp.c
   M /trunk/gtk/hostlist_tcpip.c
   M /trunk/gtk/hostlist_tr.c
   M /trunk/gtk/hostlist_udpip.c
   M /trunk/gtk/hostlist_usb.c
   M /trunk/gtk/hostlist_wlan.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/libui.vcproj
   M /trunk/gtk/mac_lte_stat_dlg.c
   M /trunk/gtk/main_filter_toolbar.c
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/mcast_stream_dlg.c
   M /trunk/gtk/megaco_stat.c
   D /trunk/gtk/menus.c
   M /trunk/gtk/mgcp_stat.c
   M /trunk/gtk/mtp3_stat.c
   M /trunk/gtk/mtp3_summary.c
   M /trunk/gtk/ncp_stat.c
   M /trunk/gtk/proto_help.c
   M /trunk/gtk/radius_stat.c
   M /trunk/gtk/rlc_lte_stat_dlg.c
   M /trunk/gtk/rpc_progs.c
   M /trunk/gtk/rpc_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_stream_dlg.c
   M /trunk/gtk/scsi_stat.c
   M /trunk/gtk/sctp_assoc_analyse.c
   M /trunk/gtk/sctp_chunk_stat.c
   M /trunk/gtk/sctp_stat.h
   M /trunk/gtk/sctp_stat_dlg.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/smb2_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/stats_tree_stat.c
   M /trunk/gtk/tap_param_dlg.c
   M /trunk/gtk/tap_param_dlg.h
   M /trunk/gtk/tcp_graph.c
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/gtk/wlan_stat_dlg.c
   M /trunk/gtk/wsp_stat.c

We now always build with MAIN_MENU_USE_UIMANAGER, so remove all code using
the old ways except the proto_help.c file, which is kept for now in case someone
is willing to reimplement the help menus using non-deprecated methods.

------------------------------------------------------------------------
r39136 | wmeier | 2011-09-25 14:10:04 -0700 (Sun, 25 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/prefs.c

vlan dissector has been restored;
pref "eth.qinq_ethertype" has been moved(restored) to "vlan.qinq_ethertype".

------------------------------------------------------------------------
r39135 | jmayer | 2011-09-25 12:56:42 -0700 (Sun, 25 Sep 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_if_dlg.c

Fix for
/home/jmayer/work/wireshark/svn/trunk/gtk/capture_if_dlg.c:522:3: error: ISO C90 forbids mixed declarations and code


------------------------------------------------------------------------
r39134 | wmeier | 2011-09-25 12:28:07 -0700 (Sun, 25 Sep 2011) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

Do some cleanup related to the reversion of SVN #34848 donr in SVN #39100.

1. Revert SVN #35830 (See Bug #5645);
   This patch is no longer needed given the reversion.

   https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5645

   http://anonsvn.wireshark.org/viewvc?revision=39100&view=revision

2. Restore 'col_set_str(pinfo->cinfo, COL_INFO, "Ethernet II");' just to
       be safe (altho it's possible that this line is not needed).

3. Remove several lines of no longer needed code.

------------------------------------------------------------------------
r39133 | stig | 2011-09-25 11:11:38 -0700 (Sun, 25 Sep 2011) | 1 line
Changed paths:
   M /trunk/AUTHORS

Added Glenn Matthews.
------------------------------------------------------------------------
r39132 | stig | 2011-09-25 10:30:29 -0700 (Sun, 25 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-xmcp.c

Try fixing the signed/unsigned mismatch issues.
------------------------------------------------------------------------
r39131 | stig | 2011-09-25 09:31:14 -0700 (Sun, 25 Sep 2011) | 10 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-classicstun.c
   A /trunk/epan/dissectors/packet-xmcp.c

From Glenn Matthews via bug 6319:
Add dissector for XMCP protocol.

From me:
- Fixed an obvious bug setting transaction_id_key[2].key = NULL,
  where transaction_id_key is defined with only 2 elements.
- Only register heur_dissector once.
- Only find media_type_dissector_table once.
- Added packet-xmcp.c to CMakeLists.txt

------------------------------------------------------------------------
r39130 | wmeier | 2011-09-25 08:25:33 -0700 (Sun, 25 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdp.c

Fix a compile error.

------------------------------------------------------------------------
r39129 | wmeier | 2011-09-25 08:09:44 -0700 (Sun, 25 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdp.c

Minor cleanup:
- Fix two cases of "set but unused" as reported by GCC 4.6;
- remove _U_ from parameters which are actually used;
- printf --> REPORT_DISSECTOR_BUG;
- define a function as static;

------------------------------------------------------------------------
r39126 | gerald | 2011-09-25 07:03:26 -0700 (Sun, 25 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-09-25]
------------------------------------------------------------------------
r39125 | gal | 2011-09-25 00:02:57 -0700 (Sun, 25 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdp.c

Bug 6369: 
Unprotected array write. 


------------------------------------------------------------------------
r39124 | tuexen | 2011-09-24 09:26:49 -0700 (Sat, 24 Sep 2011) | 2 lines
Changed paths:
   M /trunk/airpcap_loader.c

Fix syntax...

------------------------------------------------------------------------
r39123 | tuexen | 2011-09-24 09:24:09 -0700 (Sat, 24 Sep 2011) | 3 lines
Changed paths:
   M /trunk/airpcap_loader.c

Don't consider remote airpcap devices as airpcap devices, but as remote devices.
This makes the GUI consistent.

------------------------------------------------------------------------
r39122 | tuexen | 2011-09-24 07:16:37 -0700 (Sat, 24 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/capture_if_dlg.c

Use the new remote capturing icon also in the interfaces dialog box.

------------------------------------------------------------------------
r39121 | alagoutte | 2011-09-24 06:42:53 -0700 (Sat, 24 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smpp.c

Make buildbot happy

------------------------------------------------------------------------
r39120 | alagoutte | 2011-09-24 06:36:51 -0700 (Sat, 24 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

Fix a typo in RD offset

------------------------------------------------------------------------
r39119 | alagoutte | 2011-09-24 06:27:58 -0700 (Sat, 24 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smpp.c

From Abhik Sarkar via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=2384
SMPP+ which is customized by Huawei company can't be decoded

From me :
Convert "space tabs" to spaces

------------------------------------------------------------------------
r39118 | tuexen | 2011-09-24 05:39:09 -0700 (Sat, 24 Sep 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/main_welcome.c
   A /trunk/gtk/remote_icons.h

Use one of the new icons for remote interfaces.

------------------------------------------------------------------------
r39117 | guy | 2011-09-23 17:26:58 -0700 (Fri, 23 Sep 2011) | 4 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

Mark the "adjustment" argument to scroll callbacks as unused.  (Is
redrawing sufficient?  Could the adjustment be used to optimize what's
drawn?)

------------------------------------------------------------------------
r39116 | gerald | 2011-09-23 17:13:32 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   A /trunk/image/toolbar/pipe_16.png
   A /trunk/image/toolbar/remote_arrow_16.png
   A /trunk/image/toolbar/remote_globe_16.png
   A /trunk/image/toolbar/remote_sat_16.png

Network icons from Elliott Aldrich.

------------------------------------------------------------------------
r39115 | guy | 2011-09-23 16:56:21 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

Get rid of duplicate call.

------------------------------------------------------------------------
r39114 | gerald | 2011-09-23 15:44:28 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/asn1/snmp/snmp.asn
   M /trunk/epan/dissectors/packet-snmp.c

Change the case of "sNMPv2-Trap" to match RFC 3416. Reported by Qiyao.

------------------------------------------------------------------------
r39113 | cmaynard | 2011-09-23 14:24:22 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/dumpcap.pod

The -D, -L and -S options are mutually exclusive, so change "and" to "or".

------------------------------------------------------------------------
r39112 | etxrab | 2011-09-23 10:33:04 -0700 (Fri, 23 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Grr make it work if GTK < 2.22
------------------------------------------------------------------------
r39111 | etxrab | 2011-09-23 10:29:01 -0700 (Fri, 23 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Redraw when vertical scroll is used.
------------------------------------------------------------------------
r39110 | martinm | 2011-09-23 10:10:08 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Use val_to_str_const().

------------------------------------------------------------------------
r39109 | martinm | 2011-09-23 10:02:56 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Use val_to_str_const().

------------------------------------------------------------------------
r39108 | wmeier | 2011-09-23 08:36:26 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-vlan.c

dissector_(add|delete) ==> dissector_(add|delete)_uint: fixes checkapi error.

------------------------------------------------------------------------
r39107 | etxrab | 2011-09-23 07:55:26 -0700 (Fri, 23 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Update the draw area as well.
------------------------------------------------------------------------
r39106 | wmeier | 2011-09-23 07:47:18 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

Uh, "Fix the fix (in SVN #39105)" so it compiles.  

------------------------------------------------------------------------
r39105 | wmeier | 2011-09-23 07:39:23 -0700 (Fri, 23 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

Correction for SVN #39100:"Revert Revision 34838";
Fixes buildbot compile error.

------------------------------------------------------------------------
r39104 | wmeier | 2011-09-23 07:15:49 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Add packet-vlan.c

------------------------------------------------------------------------
r39103 | wmeier | 2011-09-23 07:10:52 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Put packet-vlan back into Makefile.common (to go with SVN #39100)

------------------------------------------------------------------------
r39102 | etxrab | 2011-09-23 04:35:37 -0700 (Fri, 23 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Remove duplicated code.
------------------------------------------------------------------------
r39101 | etxrab | 2011-09-23 04:22:48 -0700 (Fri, 23 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c

Remove code commited by misstake.
------------------------------------------------------------------------
r39100 | etxrab | 2011-09-23 04:01:13 -0700 (Fri, 23 Sep 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/epan/dissectors/packet-ieee8021ah.c
   A /trunk/epan/dissectors/packet-vlan.c
   A /trunk/epan/dissectors/packet-vlan.h
   M /trunk/epan/prefs.c

Revert Revision 34838 "Resolve bug #2254: Migrate the 802.1q VLAN dissector into the Ethernet II."
as this causes a lot of problems.
See 
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5680
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6305
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6366

Original bug:
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=2254
------------------------------------------------------------------------
r39099 | alagoutte | 2011-09-23 02:03:26 -0700 (Fri, 23 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-bgp.h

Convert "space tabs" to spaces
Add modeline information

------------------------------------------------------------------------
r39098 | alagoutte | 2011-09-23 01:44:53 -0700 (Fri, 23 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r39097 | alagoutte | 2011-09-23 01:41:23 -0700 (Fri, 23 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

From https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6128 : Wireshark doesn't decode BGP.MP_REACH_NLRI.NLRI when RD type is 2(defined in RFC4364:4.2)

Fix a wrong offset of RD Type 2 and display AS4 in asdot+ notation (Add a pref to chose the type of display for AS4 ?)

------------------------------------------------------------------------
r39096 | etxrab | 2011-09-22 23:55:10 -0700 (Thu, 22 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

Tighten the check on wheter a message really is chipered or not.
------------------------------------------------------------------------
r39095 | etxrab | 2011-09-22 23:19:47 -0700 (Thu, 22 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_ipa.c

From Daniel:
Add support for the osmo extension header to IP.a

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6371
While we are there
- Use ENC_BIG_ENDIAN
------------------------------------------------------------------------
r39094 | cmaynard | 2011-09-22 21:33:07 -0700 (Thu, 22 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/wireshark.pod.template

Trivial: Consistently use 2 spaces after a period terminating a sentence.

------------------------------------------------------------------------
r39093 | cmaynard | 2011-09-22 21:17:16 -0700 (Thu, 22 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/wireshark.pod.template

Trivial: Fix typo.

------------------------------------------------------------------------
r39092 | cmaynard | 2011-09-22 19:00:50 -0700 (Thu, 22 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/tshark.pod

Fix a couple of typos and use 2 spaces consistently after a period.

------------------------------------------------------------------------
r39091 | cmaynard | 2011-09-22 18:23:42 -0700 (Thu, 22 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/tshark.pod

Trivial: Add missing <interval> in one case of tshark -z io,stat usage.

------------------------------------------------------------------------
r39090 | stig | 2011-09-22 11:39:29 -0700 (Thu, 22 Sep 2011) | 3 lines
Changed paths:
   M /trunk/doc/wireshark.pod.template
   M /trunk/docbook/wsug_src/WSUG_chapter_customize.xml
   M /trunk/gtk/main.c

Add an option -d to specify display filter from the command line.

This was requested in bug 2463.
------------------------------------------------------------------------
r39089 | wmeier | 2011-09-22 08:57:41 -0700 (Thu, 22 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/reassemble.c

(Trivial) Fix a typo in a comment.

------------------------------------------------------------------------
r39088 | martinm | 2011-09-22 08:28:46 -0700 (Thu, 22 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Be careful about reporting number of missing SNs when wrapping around SN range.

------------------------------------------------------------------------
r39087 | etxrab | 2011-09-22 01:59:24 -0700 (Thu, 22 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

Show if per packet info is missing.
------------------------------------------------------------------------
r39086 | etxrab | 2011-09-22 01:46:09 -0700 (Thu, 22 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/graph_analysis.h

Store a pointer to frame_data rather than the time.
------------------------------------------------------------------------
r39085 | guy | 2011-09-21 20:10:30 -0700 (Wed, 21 Sep 2011) | 22 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afs.c
   M /trunk/epan/dissectors/packet-agentx.c
   M /trunk/epan/dissectors/packet-aim-location.c
   M /trunk/epan/dissectors/packet-aim-signon.c
   M /trunk/epan/dissectors/packet-aim-ssi.c
   M /trunk/epan/dissectors/packet-aim-userlookup.c
   M /trunk/epan/dissectors/packet-aim.c
   M /trunk/epan/dissectors/packet-ajp13.c

Use ENC_ values in proto_tree_add_item() calls.

In the AgentX dissector, make the "flags" arguments guint8, to match
what's passed in.

In the AIM dissector, use val_to_str() in col_add_str() calls - it gives
the same result if there's a match, and puts a note in the Info column
if there isn't, and is less complicated.

In the AJP13 dissector:

	update the URL for the protocol documentation;

	add #defines for message types, and use them;

	for "enumerated data type" fields, make the fields numerical
	rather than strings and give them the value_string tables;

	get rid of col_check() calls;

	make a Boolean item an FT_BOOLEAN.

------------------------------------------------------------------------
r39084 | wmeier | 2011-09-21 16:42:55 -0700 (Wed, 21 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-bpdu.c
   M /trunk/epan/dissectors/packet-dcerpc-browser.c
   M /trunk/epan/dissectors/packet-dcerpc-pnp.c
   M /trunk/epan/dissectors/packet-dcerpc-rras.c
   M /trunk/epan/dissectors/packet-dcerpc-svcctl.c
   M /trunk/epan/dissectors/packet-fcsb3.c
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_bssmap_le.c
   M /trunk/epan/dissectors/packet-ipvs-syncd.c
   M /trunk/epan/dissectors/packet-jpeg.c
   M /trunk/epan/dissectors/packet-linx.c
   M /trunk/epan/dissectors/packet-ltp.c
   M /trunk/epan/dissectors/packet-mq-pcf.c
   M /trunk/epan/dissectors/packet-mysql.c
   M /trunk/epan/dissectors/packet-nt-tpcp.c
   M /trunk/epan/dissectors/packet-pktgen.c
   M /trunk/epan/dissectors/packet-pppoe.c
   M /trunk/epan/dissectors/packet-pw-fr.c
   M /trunk/epan/dissectors/packet-rdp.c
   M /trunk/epan/dissectors/packet-rmp.c
   M /trunk/epan/dissectors/packet-rpl.c
   M /trunk/epan/dissectors/packet-scsi-osd.c
   M /trunk/epan/dissectors/packet-sgsap.c
   M /trunk/epan/dissectors/packet-sndcp-xid.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-synergy.c
   M /trunk/epan/dissectors/packet-usb-masstorage.c

(Trivial) Remove trailing whitespace from lines for a few files.

------------------------------------------------------------------------
r39083 | wmeier | 2011-09-21 14:07:07 -0700 (Wed, 21 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Use '%" G_GINT64_MODIFIER "u' iso '%llu'. Fixes checkapi fail and (presumably) compile errors.

------------------------------------------------------------------------
r39082 | wmeier | 2011-09-21 11:55:03 -0700 (Wed, 21 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dnp.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-h223.c
   M /trunk/epan/dissectors/packet-hdfs.c
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-ppi-vector.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-wifi-p2p.c
   M /trunk/epan/nstime.c
   M /trunk/epan/uat.c
   M /trunk/file.c
   M /trunk/gtk/filter_dlg.c
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/prefs_dlg.c
   M /trunk/gtk/proto_hier_stats_dlg.c

Whitespace cleanup:
 Use consistent indentation;
 Convert "4 space tabs" to spaces;
 Remove trailing whitespace.

------------------------------------------------------------------------
r39081 | wmeier | 2011-09-21 10:49:11 -0700 (Wed, 21 Sep 2011) | 3 lines
Changed paths:
   M /trunk/capture_wpcap_packet.c
   M /trunk/conditions.c
   M /trunk/epan/crypt/airpdcap.c
   M /trunk/epan/dissectors/packet-2dparityfec.c
   M /trunk/epan/dissectors/packet-banana.c
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-bjnp.c
   M /trunk/epan/dissectors/packet-bt-utp.c
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-db-lsp.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-dnp.c
   M /trunk/epan/dissectors/packet-esio.c
   M /trunk/epan/dissectors/packet-gtpv2.c
   M /trunk/epan/dissectors/packet-h223.c
   M /trunk/epan/dissectors/packet-hdfs.c
   M /trunk/epan/dissectors/packet-hdfsdata.c
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-memcache.c
   M /trunk/epan/dissectors/packet-mongo.c
   M /trunk/epan/dissectors/packet-nat-pmp.c
   M /trunk/epan/dissectors/packet-netflow.c
   M /trunk/epan/dissectors/packet-p_mul.c
   M /trunk/epan/dissectors/packet-packetlogger.c
   M /trunk/epan/dissectors/packet-pflog.c
   M /trunk/epan/dissectors/packet-ppi-antenna.c
   M /trunk/epan/dissectors/packet-ppi-geolocation-common.c
   M /trunk/epan/dissectors/packet-ppi-geolocation-common.h
   M /trunk/epan/dissectors/packet-ppi-gps.c
   M /trunk/epan/dissectors/packet-ppi-sensor.c
   M /trunk/epan/dissectors/packet-ppi-vector.c
   M /trunk/epan/dissectors/packet-ppi.c
   M /trunk/epan/dissectors/packet-rpc.c
   M /trunk/epan/dissectors/packet-rpcap.c
   M /trunk/epan/dissectors/packet-sbus.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-vuze-dht.c
   M /trunk/epan/dissectors/packet-wbxml.c
   M /trunk/epan/dissectors/packet-wifi-p2p.c
   M /trunk/epan/dissectors/packet-wps.c
   M /trunk/epan/dissectors/packet-wsp.c
   M /trunk/epan/emem.c
   M /trunk/epan/frequency-utils.c
   M /trunk/epan/frequency-utils.h
   M /trunk/epan/nstime.c
   M /trunk/epan/oids.c
   M /trunk/epan/uat.c
   M /trunk/file.c
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/filter_dlg.c
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/prefs_dlg.c
   M /trunk/gtk/proto_hier_stats_dlg.c
   M /trunk/rawshark.c
   M /trunk/version_info.c
   M /trunk/win32/file_dlg_win32.c
   M /trunk/wiretap/wtap-int.h
   M /trunk/wsutil/privileges.c

Fix ex "modeline" so it works;
 See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5748

------------------------------------------------------------------------
r39080 | cmaynard | 2011-09-21 10:41:12 -0700 (Wed, 21 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/export_object.c

Don't pop up an error dialog box for every file that can't be saved.  Before, this could have potentially meant having to manually close far too many of them.

------------------------------------------------------------------------
r39079 | wmeier | 2011-09-21 10:32:35 -0700 (Wed, 21 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/geoip_db.c
   M /trunk/gtk/airpcap_dlg.c

Fix ex "modeline" so it works;
 See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5748

Convert "4 space tabs" to spaces;
Use consistent indentation.

------------------------------------------------------------------------
r39078 | wmeier | 2011-09-21 10:14:14 -0700 (Wed, 21 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/filesystem.c

Fix ex "modeline" so it works;
 See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5748

Convert '4 space tabs' to spaces;

------------------------------------------------------------------------
r39077 | martinm | 2011-09-21 09:45:03 -0700 (Wed, 21 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Report as expert/malformed if the same SN appears as ACK and NACK in same status PDU.

------------------------------------------------------------------------
r39076 | wmeier | 2011-09-21 09:44:10 -0700 (Wed, 21 Sep 2011) | 4 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/gtk/airpcap_gui_utils.c

Fix vi "modeline" so it works;
See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5748


------------------------------------------------------------------------
r39075 | wmeier | 2011-09-21 09:41:14 -0700 (Wed, 21 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-pcre.c

Convert "4 space tabs" to spaces;
Fix vi edtor modeline so it works.

------------------------------------------------------------------------
r39074 | wmeier | 2011-09-21 09:28:53 -0700 (Wed, 21 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-atalk.c
   M /trunk/epan/dissectors/packet-atmtcp.c
   M /trunk/epan/dissectors/packet-dvbci.c
   M /trunk/epan/dissectors/packet-giop.c
   M /trunk/epan/dissectors/packet-gopher.c
   M /trunk/epan/dissectors/packet-gtp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-lisp-data.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-rtmpt.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-tftp.c
   M /trunk/epan/dissectors/packet-v52.c

Fix vi "modeline" so it works;
 See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5748

------------------------------------------------------------------------
r39073 | wmeier | 2011-09-21 09:14:18 -0700 (Wed, 21 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.h

Explicit #include <epan/value_string.h> not required.

------------------------------------------------------------------------
r39072 | gal | 2011-09-21 03:10:00 -0700 (Wed, 21 Sep 2011) | 3 lines
Changed paths:
   M /trunk/asn1/t124/packet-t124-template.c
   M /trunk/asn1/t124/t124.cnf
   M /trunk/epan/dissectors/packet-t124.c

Fix and suppress some warnings


------------------------------------------------------------------------
r39071 | stig | 2011-09-21 01:44:49 -0700 (Wed, 21 Sep 2011) | 3 lines
Changed paths:
   M /trunk/asn1/t124
   D /trunk/asn1/t124/Makefile.in

Remove Makefile.in
Set default svn:ignore targets.

------------------------------------------------------------------------
r39070 | etxrab | 2011-09-21 01:33:38 -0700 (Wed, 21 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c
   M /trunk/epan/dissectors/packet-umts_mac.c

Remove check_col and use ENC_BIG_ENDIAN.
------------------------------------------------------------------------
r39069 | gal | 2011-09-21 01:16:33 -0700 (Wed, 21 Sep 2011) | 2 lines
Changed paths:
   D /trunk/asn1/t124/Makefile
   M /trunk/configure.in

Add asn/t124/Makefile to configure.in and remove it from the repository.

------------------------------------------------------------------------
r39068 | gal | 2011-09-21 01:09:04 -0700 (Wed, 21 Sep 2011) | 2 lines
Changed paths:
   M /trunk/asn1/t124/packet-t124-template.c
   M /trunk/epan/dissectors/packet-t124.c

Fix for unary minus warning on Windows

------------------------------------------------------------------------
r39067 | etxrab | 2011-09-21 00:36:26 -0700 (Wed, 21 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Make query_length a gint as the lenght argument to proto_tree_add_text() is a gint.
------------------------------------------------------------------------
r39066 | gal | 2011-09-21 00:35:51 -0700 (Wed, 21 Sep 2011) | 8 lines
Changed paths:
   M /trunk/asn1/Makefile.am
   A /trunk/asn1/t124
   A /trunk/asn1/t124/GCC-PROTOCOL.asn
   A /trunk/asn1/t124/Makefile
   A /trunk/asn1/t124/Makefile.am
   A /trunk/asn1/t124/Makefile.common
   A /trunk/asn1/t124/Makefile.in
   A /trunk/asn1/t124/Makefile.nmake
   A /trunk/asn1/t124/packet-t124-template.c
   A /trunk/asn1/t124/packet-t124-template.h
   A /trunk/asn1/t124/t124.cnf
   M /trunk/asn1/t125/packet-t125-template.c
   M /trunk/asn1/t125/t125.cnf
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-rdp.c
   A /trunk/epan/dissectors/packet-rdp.h
   M /trunk/epan/dissectors/packet-ses.c
   A /trunk/epan/dissectors/packet-t124.c
   A /trunk/epan/dissectors/packet-t124.h
   M /trunk/epan/dissectors/packet-t125.c
   M /trunk/epan/dissectors/packet-tpkt.c

Basic RDP dissection, which can dissect the connection sequence. 
A work in progress.
Can be used with the SSL dissector to decrypt Enhanced RDP Security SSL.
With Standard RDP Security (e.g those on Wiki), the PDUs are all encrypted 
after the SecurityExchange PDU.
Wiki to be updated with an example SSL protected capture and associated
key material.

------------------------------------------------------------------------
r39065 | guy | 2011-09-20 12:24:07 -0700 (Tue, 20 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

From Frank Lahm: Complete dissection of AFP FPSpotlightRPC function.

From me: don't use global variables in FPSpotlightRPC dissection.

------------------------------------------------------------------------
r39064 | guy | 2011-09-20 10:42:27 -0700 (Tue, 20 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/proto.h

Add an ENC_ASCII; right now, it's the same as ENC_UTF_8, but it should
eventually cause all bytes with the 8th bit set to be displayed as error
indications.

------------------------------------------------------------------------
r39063 | guy | 2011-09-20 10:23:16 -0700 (Tue, 20 Sep 2011) | 17 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Use ENC_ values in proto_tree_add_item() calls.  Use ENC_UTF_8 for
strings, and note that, for older AFP clients and servers, we might need
a way to say to use some Mac encoding instead.

Use tvb_strsize() rather than tvb_get_ephemeral_stringz() to just get
the length of a null-terminated string.

Use FT_GUID for UUIDs.

The low-order bit in the MessageBitmap in the FPGetSrvrMsg reply does
not, at least according to the current AFP spec, specify whether there's
a message at all, it specifies whether it's a server message or a login
message.  The spec *does* now mention the "message is UTF-8" bit; use
it.

Fix a blurb.

------------------------------------------------------------------------
r39062 | cmaynard | 2011-09-20 09:42:22 -0700 (Tue, 20 Sep 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Add DeCount for his contribution in bug 6362.

------------------------------------------------------------------------
r39061 | cmaynard | 2011-09-20 09:28:21 -0700 (Tue, 20 Sep 2011) | 3 lines
Changed paths:
   M /trunk/gtk/export_object.c

From DeCount via bug 6362: Increase maximum allowable number of duplicate filesi from 10 to 1000.  I modified his patch to avoid appending anything to the first filename, and other minor changes.
Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6362

------------------------------------------------------------------------
r39060 | etxrab | 2011-09-20 04:29:53 -0700 (Tue, 20 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/proto.c

From Sylvain Munaut:
Add support for signed types in _proto_tree_add_bits_ret_val

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6363
------------------------------------------------------------------------
r39059 | stig | 2011-09-20 03:15:09 -0700 (Tue, 20 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/geoip_db.c
   M /trunk/epan/oids.c

From Dirk via bug 6361:
Use File/Directory Dialog as a field type for UAT preferences.
------------------------------------------------------------------------
r39058 | stig | 2011-09-20 03:14:58 -0700 (Tue, 20 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/uat.c
   M /trunk/epan/uat.h
   M /trunk/gtk/uat_gui.c

From Dirk via bug 6361:
Add a File/Directory Dialog as a field type for UAT preferences.
------------------------------------------------------------------------
r39057 | cmaynard | 2011-09-19 13:49:28 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c

Since the call to expert_add_info_format() was commented out, 'ti' isn't needed, so get rid of it.  Fixes Coverity CID's 1260 and 1261.

------------------------------------------------------------------------
r39056 | cmaynard | 2011-09-19 13:41:17 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-clv.c

Don't assign the return value of proto_tree_add_text() if it's not going to be used.  Fixes Coverity CID 1232.

------------------------------------------------------------------------
r39055 | cmaynard | 2011-09-19 13:37:20 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cisco-wids.c

Since the call to proto_tree_add_text() was #if 0'd out, there's no need to assign the return value of tvb_new_subset to wlan_tvb.  Actually, there's probably no need to call tvb_new_subset() in the first place, but for now let's just tackle the unused value warning and leave the FIXME for someone who knows more about this.  Fixes Coverity CID 864.

------------------------------------------------------------------------
r39054 | cmaynard | 2011-09-19 13:28:10 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c

Don't assign return value of proto_tree_add_text() to rrsc_item if it's not going to be used.  Fixes Coverity CID 863.

------------------------------------------------------------------------
r39053 | cmaynard | 2011-09-19 13:19:43 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/decode_as_dlg.c

Move the return out of the for() loop so all values are freed.  Fixes Coverity CID 1277 (loop increment j++ is unreachable).

------------------------------------------------------------------------
r39052 | cmaynard | 2011-09-19 13:09:31 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nlsp.c

The change in r37371 fixed the clv_tree unused assignment and pointless use, but caused another unused assignment to 'ti'.  Fixed.  (Coverity CID 1233)

------------------------------------------------------------------------
r39051 | cmaynard | 2011-09-19 12:59:00 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mim.c

Don't assign the return value of proto_tree_add_item() if it's not going to be used.  Fixes Coverity CID's 1278-1280 (UNUSED VALUE).

------------------------------------------------------------------------
r39050 | cmaynard | 2011-09-19 12:49:06 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-amqp.c

Delete duplicate line of code.  Fixes Coverity CID 1281 (UNUSED VALUE).

------------------------------------------------------------------------
r39049 | cmaynard | 2011-09-19 12:32:46 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

Close fp before checking if private_key is NULL to avoid memory leak.  Fixes Coverity 597.

------------------------------------------------------------------------
r39048 | cmaynard | 2011-09-19 12:14:41 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dmp.c

Fix static overrun bug introduced in r37506.  Fixes Coverity CID 1216.

------------------------------------------------------------------------
r39047 | wmeier | 2011-09-19 12:13:34 -0700 (Mon, 19 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pgsql.c

Various Cleanups...
- Don't use 'l' as a variable name;
- Use 'tvb_strsize();proto_tree_add_item();' iso 'tvb_get_ephemeral_stringz(); proto_tree_add_string();'
- Use ENC_NA/ENC_BIG_ENDIAN iso FALSE as appropriate for proto_tree_add_item().

------------------------------------------------------------------------
r39046 | wmeier | 2011-09-19 10:59:20 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/tap-expert.c

Fix compile error: just link to expert_group_vals[] in expert.c (no need for a copy in tap-expert.c).

------------------------------------------------------------------------
r39045 | martinm | 2011-09-19 06:53:29 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/tap-expert.c

Add expert 'Group' to output.

------------------------------------------------------------------------
r39044 | guy | 2011-09-19 04:02:35 -0700 (Mon, 19 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-acn.c

Use ENC_NA and ENC_BIG_ENDIAN rather than FALSE in proto_tree_add_item()
calls and tvb_get_guid() calls.

For strings, add ENC_UTF_8.

------------------------------------------------------------------------
r39043 | tuexen | 2011-09-19 03:23:36 -0700 (Mon, 19 Sep 2011) | 5 lines
Changed paths:
   M /trunk/gtk/sctp_graph_dlg.c

Fix a crash when zooming into a TSN plot.

Provided by Irene Ruengeler.
From me: remove tailing whitespaces.

------------------------------------------------------------------------
r39042 | guy | 2011-09-19 03:17:27 -0700 (Mon, 19 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

RFC 4282 says the NAI is UTF-8.

------------------------------------------------------------------------
r39041 | guy | 2011-09-19 03:10:14 -0700 (Mon, 19 Sep 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-9p.c

Use ENC_NA and ENC_LITTLE_ENDIAN rather than TRUE or FALSE in
proto_tree_add_item() calls.

For strings, add ENC_UTF_8.  (Yes, the byte order is irrelevant for
those - but they should arguably be FT_UINT_STRING, as they're counted
strings, and the byte order *is* relevant for FT_UINT_STRING.)

------------------------------------------------------------------------
r39040 | guy | 2011-09-19 02:55:36 -0700 (Mon, 19 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Some probably-erroneous TRUEs as the last argument to
proto_tree_add_item(); the items were one byte long, so the byte order
is irrelevant.

------------------------------------------------------------------------
r39039 | guy | 2011-09-19 02:52:37 -0700 (Mon, 19 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Use ENC_BIG_ENDIAN instead of FALSE in proto_tree_add_item() calls for
integral values.

For the Network Access Identifier, use ENC_UTF_8.

------------------------------------------------------------------------
r39038 | etxrab | 2011-09-19 01:37:59 -0700 (Mon, 19 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Move stuff inside if(tree)
------------------------------------------------------------------------
r39037 | etxrab | 2011-09-19 01:37:10 -0700 (Mon, 19 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ Application MMI version 2

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6352
------------------------------------------------------------------------
r39036 | etxrab | 2011-09-18 22:15:58 -0700 (Sun, 18 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/column-utils.c
   M /trunk/epan/column-utils.h
   M /trunk/epan/libwireshark.def

Make it possiblwe to creare a trime string from frame data.
------------------------------------------------------------------------
r39035 | etxrab | 2011-09-18 22:13:06 -0700 (Sun, 18 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Remove debug code.
------------------------------------------------------------------------
r39032 | gerald | 2011-09-18 07:03:28 -0700 (Sun, 18 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-09-18]
------------------------------------------------------------------------
r39031 | cmaynard | 2011-09-16 20:58:41 -0700 (Fri, 16 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pcep.c

Update sub-object types of XRO to match RFC 5521.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3778.

------------------------------------------------------------------------
r39030 | wmeier | 2011-09-16 13:08:46 -0700 (Fri, 16 Sep 2011) | 26 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pgsql.c

From Pierre-Marie de Rodat: PostgreSQL Startup message not properly supported by the PostgreSQL dissector.

"The PostgreSQL dissector do not fully support the frontend StartupMessage (see
"StartupMessage" in
http://developer.postgresql.org/pgdocs/postgres/protocol-message-formats.html).
The couples parameter name/parameter value in this kind of message are reported
as a block of text ("name: value") by the dissector whereas reporting them as
parameter name/parameter value would be more appropriate.

I've fixed it, so now the username and the database sent by the frontend can be
handled in, for instance, the CSV output of TShark.

I've also added a "val_count" field to contain the number of values (row
descriptions or row data) included in RowDescription/DataRow messages. This
information is useful when analyzing the CSV of TShark since in a CSV row, many
row descriptions or row data may be packed together."


Patch changes from me:
- No need to fetch ephemeral string anymore so just use tvb_strsize()
  to get string length;
- Change field-filtername from pgsql.val.count to pgsql.field.count

See: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6343


------------------------------------------------------------------------
r39029 | cmaynard | 2011-09-16 12:23:26 -0700 (Fri, 16 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Add dissection of router address(R) flag.  Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6350.

------------------------------------------------------------------------
r39028 | tuexen | 2011-09-16 08:32:28 -0700 (Fri, 16 Sep 2011) | 4 lines
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c

Fix a crash when analysing SCTP TSNs.

Provided by Irene Ruengeler.

------------------------------------------------------------------------
r39027 | etxrab | 2011-09-16 07:25:50 -0700 (Fri, 16 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/column-utils.c

set_abs_time and friends always return 1.
------------------------------------------------------------------------
r39026 | etxrab | 2011-09-15 23:12:12 -0700 (Thu, 15 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/proto.c

From Sylvain Munaut:
proto: Use fill_label_xxx helpers in _proto_tree_add_bits_ret_val

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6329
------------------------------------------------------------------------
r39025 | etxrab | 2011-09-15 22:36:48 -0700 (Thu, 15 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Change encoding type from TRUE/FALSE to ENC_LITTLE_ENDIAN/ ENC_BIG_ENDIAN
------------------------------------------------------------------------
r39024 | etxrab | 2011-09-15 22:16:18 -0700 (Thu, 15 Sep 2011) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
If the GAS Query Request/Response Length field is incorrect, the
dissector function may return a value that is larger than the remaining
packet buffer. This results in a Tagged parameters item being added with
-1 byte length since tvb_reported_length_remaining() reports -1 once the
offset goes beyond the end of the packet. Clicking on that item results
in Wireshark dying on Gtk-ERROR. Note: this does not show up in tshark
and as such, cannot apparently be triggered with fuzz-test.sh.

Fix this by refusing to dissect GAS frames that have too large length
field value. In addition, verify that tvb_reported_length_remaining() is
returning a value larger than 0 instead of non-zero (which could be -1)
to make the IEEE 802.11 dissector more robust against this type of
issues.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6345
------------------------------------------------------------------------
r39023 | etxrab | 2011-09-15 22:10:37 -0700 (Thu, 15 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
- Dissect ANQP Network Authentication Type
- Dissect ANQP Domain Name List
- Dissect Interworking element
- Dissect Roaming Consortium element
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39022 | etxrab | 2011-09-15 21:55:58 -0700 (Thu, 15 Sep 2011) | 4 lines
Changed paths:
   M /trunk/asn1/h245/h245.cnf
   M /trunk/epan/dissectors/packet-h245.c

From Liam Sharp:
In VoIP calls flow/graph display replace GR/GI etc with presentationTokenRequest/Response etc

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6321
------------------------------------------------------------------------
r39021 | guy | 2011-09-15 17:21:21 -0700 (Thu, 15 Sep 2011) | 3 lines
Changed paths:
   M /trunk/docbook/Makefile.am
   M /trunk/docbook/Makefile.nmake

wsdg_graphics/toolbar is a directory; fix the rules that weren't already
fixed to cope with that.

------------------------------------------------------------------------
r39020 | guy | 2011-09-15 17:13:08 -0700 (Thu, 15 Sep 2011) | 2 lines
Changed paths:
   A /trunk/docbook/wsdg_graphics/toolbar/dummy.dummy

Well, that wasn't it.  Put the dummy file back.

------------------------------------------------------------------------
r39019 | guy | 2011-09-15 16:32:44 -0700 (Thu, 15 Sep 2011) | 3 lines
Changed paths:
   D /trunk/docbook/wsdg_graphics/toolbar/dummy.dummy

Delete a dummy file to see if it makes building the docbook stuff with
nmake on Windows work again.

------------------------------------------------------------------------
r39018 | etxrab | 2011-09-15 13:11:12 -0700 (Thu, 15 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mysql.c

From Pierre-Marie de Rodat:
MySQL’s response for a “prepare statement” command not supported by the MySQL dissector

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6342
------------------------------------------------------------------------
r39017 | etxrab | 2011-09-15 13:02:19 -0700 (Thu, 15 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

From Pascal Quantin:
Incorrect decoding of BIT STRING type

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6347
------------------------------------------------------------------------
r39016 | etxrab | 2011-09-15 12:54:02 -0700 (Thu, 15 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
-Dissect ANQP Roaming Consortium list
-Dissect ANQP IP Address Type Availability
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39015 | etxrab | 2011-09-15 12:49:37 -0700 (Thu, 15 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
Dissect ANQP Capability List
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39014 | etxrab | 2011-09-15 12:46:24 -0700 (Thu, 15 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
Dissect ANQP Venue Name info
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39013 | etxrab | 2011-09-15 12:44:08 -0700 (Thu, 15 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
Dissect ANQP Query List
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39012 | etxrab | 2011-09-15 12:41:53 -0700 (Thu, 15 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
Append ANQP information to COL_INFO
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39011 | etxrab | 2011-09-15 12:38:23 -0700 (Thu, 15 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
Remove unnecessary Action subtree
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39010 | martinm | 2011-09-15 03:30:57 -0700 (Thu, 15 Sep 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.common
   M /trunk/doc/tshark.pod
   A /trunk/tap-expert.c

Add a tap for showing all expert items.

------------------------------------------------------------------------
r39009 | guy | 2011-09-14 23:56:57 -0700 (Wed, 14 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/tshark.pod

Alphabetical order, please.

------------------------------------------------------------------------
r39008 | etxrab | 2011-09-14 23:53:42 -0700 (Wed, 14 Sep 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
ieee80211: Support multiple ANQP info elements in response

ANQP Query Response may include multiple ANQP info elements. Parse each
one of these separately. In addition, clean up three ANQP subtrees to
avoid the unnecessary subtree at higher layer and instead, use a
separate subtree for each ANQP info elements.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39007 | etxrab | 2011-09-14 23:50:26 -0700 (Wed, 14 Sep 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
ieee80211: Show ANQP adv proto on subtree title line

This makes it easier to get the most significant information from the
Advertisement Protocol element in GAS messages without having to expand
subtrees.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39006 | etxrab | 2011-09-14 23:46:57 -0700 (Wed, 14 Sep 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
ieee80211: Do not add duplicate tag number/len for adv proto

dissect_advertisement_protocol() is used both for ANQP and for parsing
IEs. The tag number/length fields need to be added only for ANQP to
avoid adding duplicate entries in the proto tree.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39005 | etxrab | 2011-09-14 23:44:20 -0700 (Wed, 14 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
ieee80211: Verify ANQP info header

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39004 | etxrab | 2011-09-14 23:41:19 -0700 (Wed, 14 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
preparation for adding new dissectors for various ANQP info

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39003 | etxrab | 2011-09-14 23:34:25 -0700 (Wed, 14 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
ieee80211: Update ANQP info ID per P802.11-REVmb/D10.0

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39002 | etxrab | 2011-09-14 23:31:48 -0700 (Wed, 14 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
IEEE 802.11u: Add Element IDs

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39001 | etxrab | 2011-09-14 23:26:51 -0700 (Wed, 14 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
IEEE 802.11u: Add new Extended Capabilities

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r39000 | etxrab | 2011-09-14 23:23:49 -0700 (Wed, 14 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Jouni Malinen:
improvements for IEEE Std 802.11u-2011 dissection.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6339
------------------------------------------------------------------------
r38999 | etxrab | 2011-09-14 22:59:09 -0700 (Wed, 14 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/graph_analysis.h

Store frame_data_t instead of nstime_t, now it should be possible
to implement using the same time format as chosen in the packetlist.
------------------------------------------------------------------------
r38998 | jmayer | 2011-09-14 14:36:29 -0700 (Wed, 14 Sep 2011) | 3 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3
   M /trunk/gtk/tcp_graph.c

Trivial fix that would create one of the three GDK_DEPRECATED errors.
Use the #define instead of "font"

------------------------------------------------------------------------
r38997 | wmeier | 2011-09-14 11:45:06 -0700 (Wed, 14 Sep 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-radius.h
   M /trunk/gtk/radius_stat.c
   M /trunk/tap-radiusstat.c

Update based upon latest names "packet-type-codes" list from the IANA:
- Change some type-code names to match IANA list;
- Handle additional type-codes as given in the IANA list;
- Don't consider certain "attribute types" to be valid packet-type codes
  See Bug 6335: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6335
- Minor code cleanup.

------------------------------------------------------------------------
r38996 | gerald | 2011-09-14 10:39:19 -0700 (Wed, 14 Sep 2011) | 2 lines
Changed paths:
   M /trunk/image/toolbar/network_usb.svg

Make the network_usb.svg image public domain.

------------------------------------------------------------------------
r38995 | stig | 2011-09-14 07:53:49 -0700 (Wed, 14 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/in_cksum.h

Add #define guard.

This fixes bug 6341.
------------------------------------------------------------------------
r38994 | martinm | 2011-09-14 06:32:42 -0700 (Wed, 14 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rlc_lte_stat_dlg.c

Show total ACKs/UE in UE table.

------------------------------------------------------------------------
r38993 | jmayer | 2011-09-14 06:23:10 -0700 (Wed, 14 Sep 2011) | 2 lines
Changed paths:
   A /trunk/docbook/wsdg_graphics/toolbar
   A /trunk/docbook/wsdg_graphics/toolbar/dummy.dummy

Add a dummy file so building the docbook stuff with cmake actually works.

------------------------------------------------------------------------
r38992 | guy | 2011-09-14 00:16:26 -0700 (Wed, 14 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-amqp.c

Close up space between ENC_BIG_ENDIAN) and ;.

------------------------------------------------------------------------
r38991 | etxrab | 2011-09-14 00:04:45 -0700 (Wed, 14 Sep 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-amqp.c

From Aaron Schrab:
AMQP dissector support for Exchange Bind method.
- From me simplify writing to column.
- remove deprecated check_col
- Use ENC_BIG_ENDIAN.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6327
------------------------------------------------------------------------
r38990 | guy | 2011-09-13 14:17:45 -0700 (Tue, 13 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

Always pass the FCS length to dissect_802_3() and ethertype(), so it
will process the FCS if it's known to be present and will attempt to
guess whether it's present if it's not known not to be present.

------------------------------------------------------------------------
r38989 | stig | 2011-09-13 11:36:46 -0700 (Tue, 13 Sep 2011) | 1 line
Changed paths:
   M /trunk/wsutil/airpdcap_wep.c

Don't include files from epan in wsutil.
------------------------------------------------------------------------
r38988 | gerald | 2011-09-13 10:10:12 -0700 (Tue, 13 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/menus.c

Fix a typo in a comment.

------------------------------------------------------------------------
r38987 | guy | 2011-09-13 09:39:17 -0700 (Tue, 13 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-coap.c

As the man said, ports are unsigned.

------------------------------------------------------------------------
r38986 | sfisher | 2011-09-13 09:14:28 -0700 (Tue, 13 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-coap.c


The "Uri-Port" option is an unsigned, not signed, integer according to
its hf definition and deraft-ietf-core-coap-04 for example.


------------------------------------------------------------------------
r38985 | sfisher | 2011-09-13 08:52:07 -0700 (Tue, 13 Sep 2011) | 5 lines
Changed paths:
   M /trunk/tools/test-fuzzed-cap.sh


Set WIRESHARK_ABORT_ON_DISSECTOR_BUG when running test-fuzzed-cap.sh
to get a stack trace/core dump on dissector bugs.


------------------------------------------------------------------------
r38984 | etxrab | 2011-09-13 05:39:11 -0700 (Tue, 13 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/flow_graph.c
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/graph_analysis.h
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls_dlg.c

Use Frame_data also in graph_analysis_item_t, this should ultimately
make it possible to use absolute time in the graph.
------------------------------------------------------------------------
r38983 | martinm | 2011-09-13 05:14:24 -0700 (Tue, 13 Sep 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/catapult_dct2000.c

Skip extra info if present (IP with LTE PDCP threading info).

------------------------------------------------------------------------
r38982 | etxrab | 2011-09-12 22:29:56 -0700 (Mon, 12 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h
   M /trunk/gtk/voip_calls_dlg.c

Store a pointer to frame_data which holds the timing and frame number info rather than making copies. Move a structure only used internaly from voip_calls.h to .c
------------------------------------------------------------------------
r38981 | etxrab | 2011-09-12 12:32:49 -0700 (Mon, 12 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h

Store a pointer to frame_data which holds the timing and frame number info rather than making copies.
------------------------------------------------------------------------
r38978 | etxrab | 2011-09-12 09:09:36 -0700 (Mon, 12 Sep 2011) | 1 line
Changed paths:
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-ranap.c

Fix a typo
------------------------------------------------------------------------
r38977 | wmeier | 2011-09-12 08:44:45 -0700 (Mon, 12 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

From Danny Breton: Property name time-synchronization-interval(204) is incorrectly shown as time-synchronization-recipents.

See: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6336

------------------------------------------------------------------------
r38976 | etxrab | 2011-09-12 07:30:41 -0700 (Mon, 12 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-frsrpc.c

Leading white space in the field descriptive name is not allowed.
------------------------------------------------------------------------
r38975 | tuexen | 2011-09-12 06:39:14 -0700 (Mon, 12 Sep 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Use the correct name for the airpcap interface.
While there, clean up some whitespaces.

------------------------------------------------------------------------
r38974 | tuexen | 2011-09-12 06:13:08 -0700 (Mon, 12 Sep 2011) | 5 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix the wireless settings button for AirPCap devices in the
Edit Interface dialog box.

Obtained from Irene Ruengeler.

------------------------------------------------------------------------
r38973 | etxrab | 2011-09-12 06:07:54 -0700 (Mon, 12 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt
   M /trunk/wsutil/CMakeLists.txt

Move airpcap_wep.c to /wsutil CMakefile changes
------------------------------------------------------------------------
r38972 | etxrab | 2011-09-12 06:00:11 -0700 (Mon, 12 Sep 2011) | 1 line
Changed paths:
   M /trunk/asn1/ranap/RANAP-CommonDataTypes.asn
   M /trunk/asn1/ranap/RANAP-Constants.asn
   M /trunk/asn1/ranap/RANAP-Containers.asn
   M /trunk/asn1/ranap/RANAP-IEs.asn
   M /trunk/asn1/ranap/RANAP-PDU-Contents.asn
   M /trunk/asn1/ranap/RANAP-PDU-Descriptions.asn
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-ranap.c

Update to V10.2.0 (2011-06)
------------------------------------------------------------------------
r38971 | etxrab | 2011-09-12 05:48:00 -0700 (Mon, 12 Sep 2011) | 1 line
Changed paths:
   M /trunk/asn1/ranap/RANAP-CommonDataTypes.asn
   M /trunk/asn1/ranap/RANAP-Constants.asn
   M /trunk/asn1/ranap/RANAP-Containers.asn
   M /trunk/asn1/ranap/RANAP-IEs.asn
   M /trunk/asn1/ranap/RANAP-PDU-Contents.asn
   M /trunk/asn1/ranap/RANAP-PDU-Descriptions.asn
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-ranap.c

Update to  V9.6.0 (2011-06)
------------------------------------------------------------------------
r38970 | etxrab | 2011-09-12 01:37:36 -0700 (Mon, 12 Sep 2011) | 4 lines
Changed paths:
   M /trunk/asn1/h245/h245.cnf
   M /trunk/epan/dissectors/packet-h245.c

From Liam Sharp:
VoIP Calls->Graph TCS and OLC display corruption.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6318
------------------------------------------------------------------------
r38969 | etxrab | 2011-09-12 01:23:15 -0700 (Mon, 12 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/crypt/Makefile.common
   M /trunk/epan/crypt/airpdcap_int.h
   M /trunk/epan/crypt/airpdcap_system.h
   M /trunk/epan/crypt/airpdcap_tkip.c
   D /trunk/epan/crypt/airpdcap_wep.c
   M /trunk/wsutil/Makefile.common
   A /trunk/wsutil/airpdcap_wep.c (from /trunk/epan/crypt/airpdcap_wep.c:38950)
   M /trunk/wsutil/crc32.c
   M /trunk/wsutil/crc32.h
   M /trunk/wsutil/libwsutil.def

Move airpcap_wep.c to /wsutil
------------------------------------------------------------------------
r38968 | etxrab | 2011-09-11 23:02:43 -0700 (Sun, 11 Sep 2011) | 6 lines
Changed paths:
   M /trunk/asn1/h245/h245.cnf
   M /trunk/epan/dissectors/packet-h245.c

from Liam Sharp:
Info column to show subMessageIdentifier type strings for H245/H.239 packets

With a change to remove "subMessageIdentifer=" as I think that clutters up the Infocol.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6315
------------------------------------------------------------------------
r38967 | etxrab | 2011-09-11 12:54:11 -0700 (Sun, 11 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtn.c

From Michael Mann:
Extend 64-bit SDNV decoding to Administrative Records.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=4109
------------------------------------------------------------------------
r38966 | etxrab | 2011-09-11 12:16:54 -0700 (Sun, 11 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ Specific Application Support (SAS) resource
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6334
------------------------------------------------------------------------
r38965 | etxrab | 2011-09-11 12:13:27 -0700 (Sun, 11 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ Application MMI resource.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6332
------------------------------------------------------------------------
r38964 | etxrab | 2011-09-11 12:09:02 -0700 (Sun, 11 Sep 2011) | 4 lines
Changed paths:
   M /trunk/asn1/lte-rrc/EUTRA-InterNodeDefinitions.asn
   M /trunk/asn1/lte-rrc/EUTRA-RRC-Definitions.asn
   M /trunk/asn1/lte-rrc/EUTRA-UE-Variables.asn
   M /trunk/asn1/lte-rrc/lte-rrc.cnf
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/asn1/rrc/Class-definitions.asn
   M /trunk/asn1/rrc/Constant-definitions.asn
   M /trunk/asn1/rrc/InformationElements.asn
   M /trunk/asn1/rrc/Internode-definitions.asn
   M /trunk/asn1/rrc/PDU-definitions.asn
   M /trunk/asn1/rrc/packet-rrc-template.c
   M /trunk/asn1/rrc/rrc.cnf
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-lte-rrc.c
   M /trunk/epan/dissectors/packet-nas_eps.c
   M /trunk/epan/dissectors/packet-rrc.c
   M /trunk/epan/dissectors/packet-rrc.h
   M /trunk/epan/epan.h

From Pascal Quantin:
Update of 3GPP RRC and LTE RRC dissectors.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6333
------------------------------------------------------------------------
r38961 | gerald | 2011-09-11 07:03:28 -0700 (Sun, 11 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf

[Automatic manuf, services and enterprise-numbers update for 2011-09-11]
------------------------------------------------------------------------
r38960 | martinm | 2011-09-10 16:46:49 -0700 (Sat, 10 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Update some comments.

------------------------------------------------------------------------
r38959 | guy | 2011-09-10 09:33:51 -0700 (Sat, 10 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-mgmt.c

Get rid of redundant blurbs.

------------------------------------------------------------------------
r38958 | sahlberg | 2011-09-10 04:15:20 -0700 (Sat, 10 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-frsrpc.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/pidl/frsrpc.cnf
   M /trunk/epan/dissectors/pidl/frsrpc.idl

DCE/RPC: FRSRPC: updates to the FRS dissector

From: Matthieu Patou <mat@matws.net>


------------------------------------------------------------------------
r38957 | sahlberg | 2011-09-10 04:04:42 -0700 (Sat, 10 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-mgmt.c

DCE/RPC MGMT: Add dissection of INQ_PRINC_NAME procedure

From: Matthieu Patou <mat@matws.net>


------------------------------------------------------------------------
r38956 | wmeier | 2011-09-09 14:23:27 -0700 (Fri, 09 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

Fix compile error: remove forward declaration.

------------------------------------------------------------------------
r38955 | wmeier | 2011-09-09 14:20:17 -0700 (Fri, 09 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

Revert SVN #38954; Correct fix to follow.

------------------------------------------------------------------------
r38954 | wmeier | 2011-09-09 14:15:05 -0700 (Fri, 09 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

Fix compile error: remove forward declaration.

------------------------------------------------------------------------
r38953 | wmeier | 2011-09-09 13:37:49 -0700 (Fri, 09 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

Don't do heuristic check for 'dstport being even' if checking for rtp over stun.
See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6322

------------------------------------------------------------------------
r38952 | wmeier | 2011-09-09 13:19:05 -0700 (Fri, 09 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-stun.c

Cleanup & simplify some code;
Rework code so it should work better with captured_length < reported_length;
Remove unused #defines.

------------------------------------------------------------------------
r38951 | stig | 2011-09-09 10:29:20 -0700 (Fri, 09 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

From Sylvain Munaut via bug 6328:
Fix bug in CSN_CHOICE implentation preventing subtree processing
------------------------------------------------------------------------
r38950 | etxrab | 2011-09-08 22:23:43 -0700 (Thu, 08 Sep 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

	/* Get the fields in the second octet */
	octet2 = tvb_get_guint8( tvb, offset + 1 );
	payload_type = RTP_PAYLOAD_TYPE( octet2 );

	/* Check for a sensible payload type
	   (recognised static and preferred dynamic ranges) */
	if ((payload_type <= PT_H263) ||
		/* Alex Lindberg - Modified range to use RTP Type Names */
	    (payload_type >= PT_UNDF_96 && payload_type <= PT_UNDF_127)) {

evaluates to allways trye as far as I can tell.
------------------------------------------------------------------------
r38949 | etxrab | 2011-09-08 22:16:39 -0700 (Thu, 08 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-stun.c

From Ken Cox:
The change causes dissect_stun_message() to pass control to subdissectors when 'tree' is NULL.
Part of the patch from
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6322
------------------------------------------------------------------------
r38948 | cmaynard | 2011-09-08 19:11:53 -0700 (Thu, 08 Sep 2011) | 3 lines
Changed paths:
   M /trunk/gtk/conversations_table.c

Fix locale problem with "Rel Start" time, both with display and copy to CSV, by replacing rel_time_to_secs_str() with nstime_to_sec().  Problem reported on ask by packethunter.
Ref: http://ask.wireshark.org/questions/6207/decimal-point-vs-decimal-comma

------------------------------------------------------------------------
r38947 | wmeier | 2011-09-08 18:39:16 -0700 (Thu, 08 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mim.c

Use tvb_new_subset_remaining() iso tvb_new_subset();
Minor whitespace cleanup.

------------------------------------------------------------------------
r38946 | gerald | 2011-09-08 17:12:20 -0700 (Thu, 08 Sep 2011) | 2 lines
Changed paths:
   M /trunk/help/faq.py

Run 2to3 on faq.py.

------------------------------------------------------------------------
r38941 | gerald | 2011-09-08 09:30:20 -0700 (Thu, 08 Sep 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Update some email addresses.

------------------------------------------------------------------------
r38940 | wmeier | 2011-09-08 09:19:35 -0700 (Thu, 08 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

From Stefan Metzmacher: Fix flags in packet-smb
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6320

------------------------------------------------------------------------
r38939 | stig | 2011-09-08 04:16:18 -0700 (Thu, 08 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/filter_expression_save_dlg.c

Add syntax check and autocompletion to "Save Filter as".
------------------------------------------------------------------------
r38938 | stig | 2011-09-08 03:38:58 -0700 (Thu, 08 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/help_dlg.c

Avoid crash when pressing the help button in the "Save Filter" dialog.
Documentation TBD.
------------------------------------------------------------------------
r38937 | stig | 2011-09-08 02:35:10 -0700 (Thu, 08 Sep 2011) | 6 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/Makefile.common
   A /trunk/epan/filter_expressions.c
   A /trunk/epan/filter_expressions.h
   M /trunk/epan/libwireshark.def
   M /trunk/epan/prefs.c
   M /trunk/epan/prefs.h
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/Makefile.common
   A /trunk/gtk/filter_expression_save_dlg.c
   A /trunk/gtk/filter_expression_save_dlg.h
   M /trunk/gtk/help_dlg.h
   M /trunk/gtk/main.c
   M /trunk/gtk/main_filter_toolbar.c
   M /trunk/gtk/main_filter_toolbar.h
   M /trunk/gtk/prefs_dlg.c
   A /trunk/gtk/prefs_filter_expressions.c
   A /trunk/gtk/prefs_filter_expressions.h
   M /trunk/services

From Edwin Groothuis via bug 6207:
Added Filter Toolbar Save functionality.

From me:
Removed unused code.

------------------------------------------------------------------------
r38936 | stig | 2011-09-08 02:26:32 -0700 (Thu, 08 Sep 2011) | 1 line
Changed paths:
   M /trunk/AUTHORS

Remove duplicate entry.
------------------------------------------------------------------------
r38935 | etxrab | 2011-09-08 01:48:00 -0700 (Thu, 08 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mim.c

packet-mim.c:220: warning: 'dst_addr' may be used uninitialized in this function
------------------------------------------------------------------------
r38934 | etxrab | 2011-09-08 01:14:49 -0700 (Thu, 08 Sep 2011) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-mim.c

from Leonard Tracy:
Cisco FabricPath protocol dissector.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6017
------------------------------------------------------------------------
r38933 | morriss | 2011-09-07 18:53:41 -0700 (Wed, 07 Sep 2011) | 22 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/make-version.pl

Revert rev 38340 (which was itself a reversion of 34807): if we can't find the
SVN version, indicate that the SVN version is unknown.  This puts back the fix
for bug 1413.

Add a new version.conf option for make-version which tell is "this is a build
from a release tarball."  When that option is present do not try to use SVN
to determine the SVN version, just use whatever SVN information shipped in the
tarball.

If version.conf is present in the source tree (as it is only in the release
branches), deliver it in the source tarball but only after setting the "this
is a release tarball" option.


All of this means that that builds from release-branch tarballs will report
the SVN version of the release tarball rather than "unknown."  This addresses
the issue reported in
http://ask.wireshark.org/questions/5376/wireshark-161-title-shows-svn-rev-unknown-from-unknown

Builds from trunk (including the source tarballs) will continue to report that
the SVN version is unknown.  (Maybe that, too, should be changed?)

------------------------------------------------------------------------
r38928 | gerald | 2011-09-07 16:20:42 -0700 (Wed, 07 Sep 2011) | 2 lines
Changed paths:
   M /trunk/help/faq.py

Update the help question.

------------------------------------------------------------------------
r38925 | wmeier | 2011-09-07 12:35:55 -0700 (Wed, 07 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Fix a 'set but not used' gcc warning; Mark param arg as _U_;
Whitespace cleanup: trailing blanks & "4 space tabs".

------------------------------------------------------------------------
r38921 | wmeier | 2011-09-07 11:25:54 -0700 (Wed, 07 Sep 2011) | 19 lines
Changed paths:
   M /trunk/dumpcap.c

Windows: GetTickCount() returns a DWORD (not a time_t);
Fixes a problem on Windows wherein specifying a capture file
time duration for autostop or file-switching would stop
working after some period of time.

The reason:
GetTickCount returns DWORD (unsigned int) which
 wraps "every 49.7 days";

and: The GetTickCount() return value was being stored in a time_t which is
 int64 on Windows;

thus:
 The test for elapsed time (using signed integers) didn't work correctly after
 the time had wrapped.

Fixes Bug #6280: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6280


------------------------------------------------------------------------
r38920 | jmayer | 2011-09-07 10:26:03 -0700 (Wed, 07 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

"Fix" an unjustified gcc might-be-used-unused warning.

------------------------------------------------------------------------
r38919 | etxrab | 2011-09-07 07:42:08 -0700 (Wed, 07 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

From Lori Tribble:
Fix problem with the decoding of the exception schedule.  It was eating one
too many closing tags before exiting and causing the rest of the information to
fail to decode correctly.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6178
------------------------------------------------------------------------
r38918 | etxrab | 2011-09-07 06:03:05 -0700 (Wed, 07 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt

Add ftype-ipv6.c
------------------------------------------------------------------------
r38917 | etxrab | 2011-09-07 04:19:25 -0700 (Wed, 07 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/ipv6-utils.h

From Jakub Zawadzki :
Add support for prefix in IPv6 address filter.
 
+ missed file
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5538
------------------------------------------------------------------------
r38916 | etxrab | 2011-09-07 04:03:47 -0700 (Wed, 07 Sep 2011) | 4 lines
Changed paths:
   M /trunk/epan/dfilter/scanner.l
   M /trunk/epan/ftypes/Makefile.common
   M /trunk/epan/ftypes/ftype-bytes.c
   A /trunk/epan/ftypes/ftype-ipv6.c
   M /trunk/epan/ftypes/ftypes-int.h
   M /trunk/epan/ftypes/ftypes.c
   M /trunk/epan/ftypes/ftypes.h

From Jakub Zawadzki :
Add support for prefix in IPv6 address filter.
 
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5538
------------------------------------------------------------------------
r38915 | etxrab | 2011-09-07 04:01:59 -0700 (Wed, 07 Sep 2011) | 1 line
Changed paths:
   M /trunk/wsutil/crc16-plain.c

Add Id tag
------------------------------------------------------------------------
r38914 | etxrab | 2011-09-07 03:35:44 -0700 (Wed, 07 Sep 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

From Lori Tribble:
Fixes log-status and status-flags plus other BACnet decoding bugs

This patch fixes the log-status and status-flag decoding issues described in
this bug report.  This patch also fixes the following items:
1) date-list decoding
2) time-synchronization-recipients decoding
3) decoding of UTF-8 character strings (when using character set 0)
4) event-parameter decoding

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5120
------------------------------------------------------------------------
r38913 | etxrab | 2011-09-07 02:02:09 -0700 (Wed, 07 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Add notes and links on SSDP
------------------------------------------------------------------------
r38912 | etxrab | 2011-09-07 01:26:36 -0700 (Wed, 07 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/epan/etypes.h

Add ethertype #8903
------------------------------------------------------------------------
r38911 | etxrab | 2011-09-07 00:49:20 -0700 (Wed, 07 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Lei Chen:
Implement 'IAR Rest Octets', 'IAX Rest Octets' and
'Multislot Allocation'

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6314
------------------------------------------------------------------------
r38910 | etxrab | 2011-09-06 22:02:43 -0700 (Tue, 06 Sep 2011) | 7 lines
Changed paths:
   M /trunk/epan/gcp.c

From Václav Horčák:
When context id is reused by another termination, initial packet containing $
(=choose one) is not added to context but belongs to context 0xfffffffe(context
id value used in wireshark for choose one). This affects context listing in
MEGACO packet contents and Telephony->Voip Calls listings for MEGACO.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6311
------------------------------------------------------------------------
r38909 | etxrab | 2011-09-06 21:54:19 -0700 (Tue, 06 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

From Lei Chen:
upgrade PCCF/PMR/PEMR in packet-gsm_rlcmac.c
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6313
------------------------------------------------------------------------
r38908 | etxrab | 2011-09-06 21:46:43 -0700 (Tue, 06 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ CAM upgrade resource
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6309
------------------------------------------------------------------------
r38907 | etxrab | 2011-09-06 21:35:41 -0700 (Tue, 06 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ Host language and country resource.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6308
------------------------------------------------------------------------
r38906 | etxrab | 2011-09-06 21:29:34 -0700 (Tue, 06 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI / CI+ appinfo v3 apdus.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6307
------------------------------------------------------------------------
r38905 | guy | 2011-09-06 16:36:18 -0700 (Tue, 06 Sep 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/erf.c

Don't synthesize a CRC if the packet already has one.

------------------------------------------------------------------------
r38900 | stig | 2011-09-06 09:18:09 -0700 (Tue, 06 Sep 2011) | 1 line
Changed paths:
   M /trunk/AUTHORS

Use TAB.
------------------------------------------------------------------------
r38899 | stig | 2011-09-06 08:36:11 -0700 (Tue, 06 Sep 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/docbook/wsug_graphics/ws-decode-as-show.png
   M /trunk/docbook/wsug_src/WSUG_chapter_customize.xml

From Kurnia Hendrawan:
Update the user's guide.
------------------------------------------------------------------------
r38898 | etxrab | 2011-09-06 08:28:07 -0700 (Tue, 06 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/decode_as_dlg.c

Try to improve the tooltip a bit.
------------------------------------------------------------------------
r38897 | etxrab | 2011-09-06 08:05:26 -0700 (Tue, 06 Sep 2011) | 4 lines
Changed paths:
   M /trunk/asn1/h245/h245.cnf
   M /trunk/asn1/h245/packet-h245-template.c
   M /trunk/epan/dissectors/packet-h245.c

From Liam Sharp:
(Standard)H.239 – subMessageIdentifier value strings missing from H245 dissector.
Modified to be filterable.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6312
------------------------------------------------------------------------
r38896 | martinm | 2011-09-06 06:18:26 -0700 (Tue, 06 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Use correct hf item, and add reassembled length into subtree summary.

------------------------------------------------------------------------
r38895 | martinm | 2011-09-06 05:01:28 -0700 (Tue, 06 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

First stab at RLC re-assembly.

------------------------------------------------------------------------
r38894 | stig | 2011-09-06 02:18:09 -0700 (Tue, 06 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Check for valid tcpd, as it may be NULL.
------------------------------------------------------------------------
r38893 | stig | 2011-09-06 02:09:36 -0700 (Tue, 06 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/epan.c
   M /trunk/epan/packet.c

Whitespace cleanup.
------------------------------------------------------------------------
r38892 | stig | 2011-09-06 00:25:37 -0700 (Tue, 06 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/CMakeLists.txt

Rename Jabber -> XMPP
------------------------------------------------------------------------
r38891 | etxrab | 2011-09-05 22:56:17 -0700 (Mon, 05 Sep 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Rename Jabber -> XMPP
..and the makefile...
Ref http://xmpp.org/

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5992
------------------------------------------------------------------------
r38890 | etxrab | 2011-09-05 22:47:57 -0700 (Mon, 05 Sep 2011) | 4 lines
Changed paths:
   D /trunk/epan/dissectors/packet-jabber.c
   A /trunk/epan/dissectors/packet-xmpp.c (from /trunk/epan/dissectors/packet-jabber.c:38882)

Rename Jabber -> XMPP
Ref http://xmpp.org/

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5992
------------------------------------------------------------------------
r38887 | gerald | 2011-09-05 13:22:47 -0700 (Mon, 05 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf

[Automatic manuf, services and enterprise-numbers update for 2011-09-05]
------------------------------------------------------------------------
r38886 | stig | 2011-09-05 13:03:03 -0700 (Mon, 05 Sep 2011) | 2 lines
Changed paths:
   M /trunk/doc/text2pcap.pod
   M /trunk/text2pcap.c

From Pascal Quantin via bug 1723:
Make ASCII text dump identification optional.
------------------------------------------------------------------------
r38885 | guy | 2011-09-05 12:39:34 -0700 (Mon, 05 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/decode_as_dlg.c

g_slist_free_full() didn't appear until GLib 2.28.

------------------------------------------------------------------------
r38884 | stig | 2011-09-05 12:12:31 -0700 (Mon, 05 Sep 2011) | 1 line
Changed paths:
   M /trunk/text2pcap.c

Change malloc -> g_malloc and free -> g_free.
------------------------------------------------------------------------
r38883 | stig | 2011-09-05 12:05:14 -0700 (Mon, 05 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/decode_as_dlg.c
   M /trunk/gtk/decode_as_dlg.h
   M /trunk/gtk/main.c

From Kurnia Hendrawan via bug 2931:
Added an option to save "decode as" entries.
------------------------------------------------------------------------
r38882 | etxrab | 2011-09-05 06:48:54 -0700 (Mon, 05 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/dissector_tables_dlg.c

Try to fix the buildbot.
------------------------------------------------------------------------
r38881 | etxrab | 2011-09-05 06:04:23 -0700 (Mon, 05 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/libwireshark.def
   M /trunk/epan/packet.c
   M /trunk/epan/packet.h
   M /trunk/gtk/dissector_tables_dlg.c

List heuristic tables in Internals->Disscetor tables menu.
------------------------------------------------------------------------
r38880 | alagoutte | 2011-09-04 13:01:48 -0700 (Sun, 04 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mongo.c

Update insert flags
KeepGoing -> ContinueOnError

------------------------------------------------------------------------
r38879 | alagoutte | 2011-09-04 12:55:56 -0700 (Sun, 04 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Reorder 802.11 Tag ID

------------------------------------------------------------------------
r38878 | alagoutte | 2011-09-04 12:16:20 -0700 (Sun, 04 Sep 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Daniel Smith via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6264
Wireshark improperly parsing 802.11 Beacon Country Information tag

From me:
Fix this issue (miss the optionnal Pad field for Country Tag)

------------------------------------------------------------------------
r38877 | stig | 2011-09-03 14:22:42 -0700 (Sat, 03 Sep 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Remove unused code.

This fixes CID 1273 & 1274.
------------------------------------------------------------------------
r38876 | stig | 2011-09-03 13:47:58 -0700 (Sat, 03 Sep 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/erf.c

Check return value from wtap_dump_file_write.

This fixes CID 1272.
------------------------------------------------------------------------
r38875 | stig | 2011-09-03 07:21:07 -0700 (Sat, 03 Sep 2011) | 1 line
Changed paths:
   M /trunk/make-version.pl

Fetch svn revision using git-svn also when building out-of-tree.
------------------------------------------------------------------------
r38874 | guy | 2011-09-02 16:20:27 -0700 (Fri, 02 Sep 2011) | 3 lines
Changed paths:
   M /trunk/version_info.c

Update some comments, including a new URL, and add an additional
comment.

------------------------------------------------------------------------
r38868 | wmeier | 2011-09-02 12:04:39 -0700 (Fri, 02 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

Use NULL in pace of a few "blurbs" which are redundant; Enhance a few blurbs.

------------------------------------------------------------------------
r38867 | guy | 2011-09-02 11:33:02 -0700 (Fri, 02 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

Get rid of trailing space in blurbs.

------------------------------------------------------------------------
r38866 | wmeier | 2011-09-02 11:29:50 -0700 (Fri, 02 Sep 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtps2.c

Add a link to protocol specification.

------------------------------------------------------------------------
r38865 | wmeier | 2011-09-02 11:00:10 -0700 (Fri, 02 Sep 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtps2.c

Increase MAX_BITMAP_SIZE from 200 to 256.
See: Bug 6276: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6276

Verified in the Spec:

The Real-time Publish-Subscribe Wire Protocol
DDS Interoperability Wire Protocol
Specification
Version 2.1


------------------------------------------------------------------------
r38864 | gerald | 2011-09-02 09:07:36 -0700 (Fri, 02 Sep 2011) | 2 lines
Changed paths:
   M /trunk/tools/make-manuf
   M /trunk/tools/make-sminmpec.pl

Enable proxies in make-manuf and make-sminmpec.pl as well.

------------------------------------------------------------------------
r38863 | gerald | 2011-09-02 09:03:03 -0700 (Fri, 02 Sep 2011) | 2 lines
Changed paths:
   M /trunk/tools/make-services.pl

Enable the use of proxies.

------------------------------------------------------------------------
r38862 | stig | 2011-09-02 04:46:33 -0700 (Fri, 02 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/column-utils.c

Support negative nsecs when viewing seconds with hours and minutes.
------------------------------------------------------------------------
r38861 | guy | 2011-09-01 23:27:56 -0700 (Thu, 01 Sep 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hdfs.c

Quick hack to squelch compiler warnings.  This code seriously
misunderstands what tcp_dissect_pdus() is all about, and, absent a spec
for the HDFS wire protocol:

	http://mail-archives.apache.org/mod_mbox/hadoop-hdfs-issues/201005.mbox/%3C1593830.7251272825300344.JavaMail.jira@thor%3E

there's not much I can do to handle it correctly.

------------------------------------------------------------------------
r38860 | etxrab | 2011-09-01 22:56:34 -0700 (Thu, 01 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-hdfs.c

From Allison:
HDFS dissector enhancement
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6293
------------------------------------------------------------------------
r38859 | etxrab | 2011-09-01 22:52:10 -0700 (Thu, 01 Sep 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c

Use ENC_BIG_ENDIAN
------------------------------------------------------------------------
r38858 | etxrab | 2011-09-01 22:48:29 -0700 (Thu, 01 Sep 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c

From Eric Wustrow:
TLS Diffie-Hellman key exchange dissection support.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6277
------------------------------------------------------------------------
r38857 | guy | 2011-09-01 17:48:05 -0700 (Thu, 01 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

No libpcap, no capturing, no interfaces on which to capture.

------------------------------------------------------------------------
r38849 | martinm | 2011-09-01 15:02:46 -0700 (Thu, 01 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Add missing guard around access to interface_row.buffer.

------------------------------------------------------------------------
r38847 | guy | 2011-09-01 14:09:55 -0700 (Thu, 01 Sep 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

No pcap_create(), no monitor-mode APIs, no monitor-mode support.

------------------------------------------------------------------------
r38845 | tuexen | 2011-09-01 13:43:47 -0700 (Thu, 01 Sep 2011) | 5 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_dlg.h
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/main_welcome.h

When double clicking on an interface in the main welcome menu opens the edit interfaces
dialog box.
This was suggested by stig.
The patch was obtained by Irene Ruengeler.

------------------------------------------------------------------------
r38844 | guy | 2011-09-01 12:58:25 -0700 (Thu, 01 Sep 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/pcap-common.h
   M /trunk/wiretap/pcapng.c

Merge pcap_fill_in_pseudo_header() into pcap_read_post_process().

------------------------------------------------------------------------
r38843 | etxrab | 2011-09-01 08:35:09 -0700 (Thu, 01 Sep 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c

Make it possible to add menus and menuitems from outside of main_menubar.c.
------------------------------------------------------------------------
r38842 | wmeier | 2011-09-01 07:30:42 -0700 (Thu, 01 Sep 2011) | 2 lines
Changed paths:
   M /trunk/docbook/wsluarm.xml

Fix a typo.

------------------------------------------------------------------------
r38841 | morriss | 2011-09-01 07:30:16 -0700 (Thu, 01 Sep 2011) | 1 line
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-m2pa.c
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-mtp3mg.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-sccpmg.c
   M /trunk/epan/dissectors/packet-sscf-nni.c
   M /trunk/epan/dissectors/packet-syslog.c

Update my email address (the old one still works but I don't use it for Wireshark related stuff).
------------------------------------------------------------------------
r38840 | guy | 2011-09-01 02:43:10 -0700 (Thu, 01 Sep 2011) | 8 lines
Changed paths:
   M /trunk/wiretap/5views.c
   M /trunk/wiretap/airopeek9.c
   M /trunk/wiretap/btsnoop.c
   M /trunk/wiretap/buffer.c
   M /trunk/wiretap/buffer.h
   M /trunk/wiretap/catapult_dct2000.c
   M /trunk/wiretap/commview.c
   M /trunk/wiretap/daintree-sna.c
   M /trunk/wiretap/erf.c
   M /trunk/wiretap/etherpeek.c
   M /trunk/wiretap/eyesdn.c
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/i4btrace.c
   M /trunk/wiretap/ipfix.c
   M /trunk/wiretap/iptrace.c
   M /trunk/wiretap/k12.c
   M /trunk/wiretap/k12text.l
   M /trunk/wiretap/lanalyzer.c
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/mime_file.c
   M /trunk/wiretap/mpeg.c
   M /trunk/wiretap/netmon.c
   M /trunk/wiretap/netscaler.c
   M /trunk/wiretap/nettl.c
   M /trunk/wiretap/network_instruments.c
   M /trunk/wiretap/netxray.c
   M /trunk/wiretap/ngsniffer.c
   M /trunk/wiretap/packetlogger.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/pcap-common.h
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/radcom.c
   M /trunk/wiretap/snoop.c
   M /trunk/wiretap/visual.c
   M /trunk/wiretap/wtap-int.h
   M /trunk/wiretap/wtap.h

Use guint8 rather than guchar for raw octets and pointers to arrays of
same.

Add to wiretap/pcap-common.c a routine to fill in the pseudo-header for
ATM (by looking at the VPI, VCI, and packet data, and guessing) and
Ethernet (setting the FCS length appropriately).  Use it for both pcap
and pcap-ng files.

------------------------------------------------------------------------
r38839 | etxrab | 2011-08-31 22:15:41 -0700 (Wed, 31 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

From Andrey Rouskol:
patch for Ericsson NAT logging netflow fields
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6297
------------------------------------------------------------------------
r38838 | etxrab | 2011-08-31 22:06:42 -0700 (Wed, 31 Aug 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

From Lei Chen:
Upgrade 'Packet Cell Change Order', 'Packet Cell Change Notification' and
'Packet Measurement Order' to R10.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6300
------------------------------------------------------------------------
r38836 | guy | 2011-08-31 21:46:29 -0700 (Wed, 31 Aug 2011) | 6 lines
Changed paths:
   M /trunk/README

At least according to the saved ancient press release at

	http://www.omnitest.co.uk/cinco.html

it really was "NetXRay", not "NetXray".

------------------------------------------------------------------------
r38834 | etxrab | 2011-08-31 21:35:57 -0700 (Wed, 31 Aug 2011) | 3 lines
Changed paths:
   M /trunk/CPackConfig.txt
   M /trunk/README
   M /trunk/README.DECT
   M /trunk/README.bsd
   M /trunk/README.cmake
   M /trunk/README.hpux
   M /trunk/airpcap.h
   M /trunk/diameter/Cisco.xml
   M /trunk/diameter/chargecontrol.xml
   M /trunk/diameter/dictionary.xml
   M /trunk/diameter/etsie2e4.xml
   M /trunk/docbook/wsluarm.xml
   M /trunk/docbook/wsug_src/WSUG_chapter_introduction.xml

From John Bradshaw:
Spelling fixes
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6296
------------------------------------------------------------------------
r38833 | guy | 2011-08-31 21:14:54 -0700 (Wed, 31 Aug 2011) | 11 lines
Changed paths:
   M /trunk/wiretap/commview.c

Set eth.fcs_len in the pseudo-header for Ethernet packets.

Set the pseudo-header when doing the sequential read as well as when
doing random reads.

When writing packets to a CommView file, use a slightly less contorted
way to get the year/month/day/hour/minute/second values.

commview_dump() uses the pseudo_header argument; don't mark it as
unused.

------------------------------------------------------------------------
r38832 | guy | 2011-08-31 19:35:46 -0700 (Wed, 31 Aug 2011) | 5 lines
Changed paths:
   M /trunk/epan/filesystem.c

If we're running from the build directory, check the WIRESHARK_SRC_DIR
environment variable, and, if it's set, use it rather than the build
directory as the data file directory.  This is to handle
out-of-source-tree builds.

------------------------------------------------------------------------
r38829 | gerald | 2011-08-31 16:07:12 -0700 (Wed, 31 Aug 2011) | 4 lines
Changed paths:
   M /trunk/services
   M /trunk/tools/make-services.pl

Fix the format of the services file. The output from make-services.pl is
still uglier than a box of YouTube comments but transport name
resolution seems to work now. Fixes bug 6274.

------------------------------------------------------------------------
r38828 | guy | 2011-08-31 15:22:40 -0700 (Wed, 31 Aug 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/erf.c

Not ideal, but OK for now - alignbytes, at that point, is < 8, so we
know it'll fit in a gint16.  (alignbytes really shouldn't need to be 64
bits, as if we have 2^63-1 bytes of alignment, We Have A Problem; fixing
that may involve calculating it differently earlier in that routine.)

------------------------------------------------------------------------
r38827 | stig | 2011-08-31 14:16:18 -0700 (Wed, 31 Aug 2011) | 1 line
Changed paths:
   M /trunk/wiretap/erf.c

Try using gint64 for alignbytes.
------------------------------------------------------------------------
r38826 | stig | 2011-08-31 13:50:15 -0700 (Wed, 31 Aug 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/erf.c
   M /trunk/wiretap/erf.h
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.h

From Andrew Kampjes via bug 6260:
Added support for saving ERF files.

From me:
Use crc routines from libwsutil.
------------------------------------------------------------------------
r38825 | wmeier | 2011-08-31 10:02:54 -0700 (Wed, 31 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile_custom.common

Add svn:keywords & svn:eol-style properties

------------------------------------------------------------------------
r38824 | wmeier | 2011-08-31 09:34:14 -0700 (Wed, 31 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/Makefile_custom.common

Fix build (automake) error: WIRESHARK_CUSTOM_HEADERS is ng but WIRESHARK_CUSTOM_HDRS is OK ??

------------------------------------------------------------------------
r38823 | etxrab | 2011-08-31 07:03:34 -0700 (Wed, 31 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_stream_dlg.c

COPY as CSV to clipboard from RTP stream analysis only copies 1st line many times.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6279
------------------------------------------------------------------------
r38822 | etxrab | 2011-08-31 06:59:39 -0700 (Wed, 31 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/Makefile_custom.common

gtk/Makefile_custom.common:8: blank line following trailing backslash
------------------------------------------------------------------------
r38821 | etxrab | 2011-08-31 06:44:43 -0700 (Wed, 31 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.common
   A /trunk/gtk/Makefile_custom.common

Make it possible to add custom tap/GUI files
------------------------------------------------------------------------
r38820 | martinm | 2011-08-31 05:39:59 -0700 (Wed, 31 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/mac_lte_stat_dlg.c
   M /trunk/tap-macltestat.c

Add another DL CRC error - Duplicate NonZero RV.

------------------------------------------------------------------------
r38819 | stig | 2011-08-31 05:03:18 -0700 (Wed, 31 Aug 2011) | 1 line
Changed paths:
   M /trunk/wsutil/crc32.c
   M /trunk/wsutil/crc32.h

Lookup in correct tables.  Document functions.
------------------------------------------------------------------------
r38818 | stig | 2011-08-31 04:53:20 -0700 (Wed, 31 Aug 2011) | 1 line
Changed paths:
   M /trunk/wsutil/libwsutil.def

Add the new functions; crc32c_table_lookup and crc32_ccitt_table_lookup.
------------------------------------------------------------------------
r38817 | stig | 2011-08-31 04:47:27 -0700 (Wed, 31 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/crypt/airpdcap_wep.c
   M /trunk/wsutil/crc32.c
   M /trunk/wsutil/crc32.h
   M /trunk/wsutil/libwsutil.def

Make lookup functions for accessing crc32c_table and crc32_ccitt_table.
------------------------------------------------------------------------
r38816 | etxrab | 2011-08-31 03:25:57 -0700 (Wed, 31 Aug 2011) | 1 line
Changed paths:
   M /trunk/packaging/nsis/wireshark.nsi

Remove the obsolete files fom the installer
------------------------------------------------------------------------
r38815 | stig | 2011-08-31 03:01:45 -0700 (Wed, 31 Aug 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Remove tree-view-ui.xml and bytes-view-ui.xml

------------------------------------------------------------------------
r38814 | stig | 2011-08-31 02:56:25 -0700 (Wed, 31 Aug 2011) | 2 lines
Changed paths:
   M /trunk/wsutil/crc32.h

Try declaring tables with WS_VAR_IMPORT.

------------------------------------------------------------------------
r38813 | stig | 2011-08-31 02:27:25 -0700 (Wed, 31 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/Makefile.nmake

And fix distclean and maintainer-clean.

------------------------------------------------------------------------
r38812 | stig | 2011-08-31 02:22:40 -0700 (Wed, 31 Aug 2011) | 2 lines
Changed paths:
   M /trunk/wsutil/libwsutil.def

Add missing crc16_plain_update and crc_drm.

------------------------------------------------------------------------
r38811 | stig | 2011-08-31 02:11:16 -0700 (Wed, 31 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/Makefile.nmake

Fixed clean rule after crc move.

------------------------------------------------------------------------
r38810 | stig | 2011-08-31 02:00:54 -0700 (Wed, 31 Aug 2011) | 5 lines
Changed paths:
   M /trunk/configure.in
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.common
   M /trunk/epan/Makefile.nmake
   D /trunk/epan/crc
   D /trunk/epan/crc10.c
   D /trunk/epan/crc10.h
   A /trunk/epan/crc16-tvb.c (from /trunk/epan/crc16.c:38807)
   A /trunk/epan/crc16-tvb.h (from /trunk/epan/crc16.h:38807)
   D /trunk/epan/crc16.c
   D /trunk/epan/crc16.h
   A /trunk/epan/crc32-tvb.c (from /trunk/epan/crc32.c:38807)
   A /trunk/epan/crc32-tvb.h (from /trunk/epan/crc32.h:38807)
   D /trunk/epan/crc32.c
   D /trunk/epan/crc32.h
   D /trunk/epan/crc6.c
   D /trunk/epan/crc6.h
   A /trunk/epan/crc8-tvb.c (from /trunk/epan/crc8.c:38807)
   A /trunk/epan/crc8-tvb.h (from /trunk/epan/crc8.h:38807)
   D /trunk/epan/crc8.c
   D /trunk/epan/crc8.h
   D /trunk/epan/crcdrm.c
   D /trunk/epan/crcdrm.h
   M /trunk/epan/crypt/airpdcap.c
   M /trunk/epan/crypt/airpdcap_wep.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-dcp-etsi.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-eth.c
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fcoe.c
   M /trunk/epan/dissectors/packet-fcoib.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-iuup.c
   M /trunk/epan/dissectors/packet-iwarp-mpa.c
   M /trunk/epan/dissectors/packet-lapd.c
   M /trunk/epan/dissectors/packet-mtp2.c
   M /trunk/epan/dissectors/packet-mux27010.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-srp.c
   M /trunk/epan/dissectors/packet-synphasor.c
   M /trunk/epan/dissectors/packet-teamspeak2.c
   M /trunk/epan/dissectors/packet-zrtp.c
   M /trunk/epan/libwireshark.def
   M /trunk/epan/sigcomp-udvm.c
   M /trunk/gtk/text_import.c
   M /trunk/plugins/irda/packet-sir.c
   M /trunk/plugins/profinet/packet-pn-rt.c
   M /trunk/wsutil/CMakeLists.txt
   M /trunk/wsutil/Makefile.common
   A /trunk/wsutil/crc10.c (from /trunk/epan/crc10.c:38807)
   A /trunk/wsutil/crc10.h (from /trunk/epan/crc10.h:38807)
   A /trunk/wsutil/crc16-plain.c (from /trunk/epan/crc/crc-16-plain.c:38807)
   A /trunk/wsutil/crc16-plain.h (from /trunk/epan/crc/crc-16-plain.h:38807)
   A /trunk/wsutil/crc16.c (from /trunk/epan/crc16.c:38807)
   A /trunk/wsutil/crc16.h (from /trunk/epan/crc16.h:38807)
   A /trunk/wsutil/crc32.c (from /trunk/epan/crc32.c:38807)
   A /trunk/wsutil/crc32.h (from /trunk/epan/crc32.h:38807)
   A /trunk/wsutil/crc6.c (from /trunk/epan/crc6.c:38807)
   A /trunk/wsutil/crc6.h (from /trunk/epan/crc6.h:38807)
   A /trunk/wsutil/crcdrm.c (from /trunk/epan/crcdrm.c:38807)
   A /trunk/wsutil/crcdrm.h (from /trunk/epan/crcdrm.h:38807)
   M /trunk/wsutil/libwsutil.def

Second try to move crc routines to libwsutil.
This time keep the tvb routines in epan.

Now we can use common crc routines outside epan.

------------------------------------------------------------------------
r38809 | etxrab | 2011-08-31 01:59:09 -0700 (Wed, 31 Aug 2011) | 5 lines
Changed paths:
   M /trunk/gtk/main_menubar.c
   D /trunk/gtk/ui/bytes-view-ui.xml
   D /trunk/gtk/ui/tree-view-ui.xml

Only load the menubar UI description from file. 
Perhaps the treeview popup UI description should be loaded from file as well but currently I don't see the benefit.
Feel free to ad back that code :-)

The byte view UI description is so small so that's no use to load from file in my opinion.
------------------------------------------------------------------------
r38808 | tuexen | 2011-08-30 14:46:17 -0700 (Tue, 30 Aug 2011) | 5 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Improve the display of addresses in the Edit Interface Settings dialog
box.

Patch provided by Irene Ruengeler.

------------------------------------------------------------------------
r38807 | etxrab | 2011-08-30 11:34:19 -0700 (Tue, 30 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

From Lei Chen:
fix the wrong display of CSN_BIT under CSN_UNION.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6287
------------------------------------------------------------------------
r38806 | gerald | 2011-08-30 09:39:38 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   A /trunk/epan/crc (from /trunk/epan/crc:38799)

crc directory restoration step 2 of 2: Make a copy of epan/crc@38799.

------------------------------------------------------------------------
r38805 | gerald | 2011-08-30 09:37:32 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   D /trunk/epan/crc

crc directory restoration step 1 of 2: Delete the existing directory.

------------------------------------------------------------------------
r38804 | etxrab | 2011-08-30 07:55:52 -0700 (Tue, 30 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

How copy-paste can ruin your day; 
Use the right ui manager with the right description file.
handle LUA not present.
------------------------------------------------------------------------
r38803 | stig | 2011-08-30 07:17:40 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   M /trunk/configure.in
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.common
   M /trunk/epan/Makefile.nmake
   A /trunk/epan/crc
   A /trunk/epan/crc/Makefile.am
   A /trunk/epan/crc/Makefile.common
   A /trunk/epan/crc/Makefile.nmake
   A /trunk/epan/crc/crc-16-plain.c (from /trunk/wsutil/crc16-plain.c:38801)
   A /trunk/epan/crc/crc-16-plain.h (from /trunk/wsutil/crc16-plain.h:38801)
   A /trunk/epan/crc10.c (from /trunk/wsutil/crc10.c:38801)
   A /trunk/epan/crc10.h (from /trunk/wsutil/crc10.h:38801)
   A /trunk/epan/crc16.c (from /trunk/wsutil/crc16.c:38801)
   A /trunk/epan/crc16.h (from /trunk/wsutil/crc16.h:38801)
   A /trunk/epan/crc32.c (from /trunk/wsutil/crc32.c:38801)
   A /trunk/epan/crc32.h (from /trunk/wsutil/crc32.h:38801)
   A /trunk/epan/crc6.c (from /trunk/wsutil/crc6.c:38801)
   A /trunk/epan/crc6.h (from /trunk/wsutil/crc6.h:38801)
   A /trunk/epan/crc8.c (from /trunk/wsutil/crc8.c:38801)
   A /trunk/epan/crc8.h (from /trunk/wsutil/crc8.h:38801)
   A /trunk/epan/crcdrm.c (from /trunk/wsutil/crcdrm.c:38801)
   A /trunk/epan/crcdrm.h (from /trunk/wsutil/crcdrm.h:38801)
   M /trunk/epan/crypt/airpdcap.c
   M /trunk/epan/crypt/airpdcap_wep.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-dcp-etsi.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-eth.c
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fcoe.c
   M /trunk/epan/dissectors/packet-fcoib.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-iuup.c
   M /trunk/epan/dissectors/packet-iwarp-mpa.c
   M /trunk/epan/dissectors/packet-lapd.c
   M /trunk/epan/dissectors/packet-mtp2.c
   M /trunk/epan/dissectors/packet-mux27010.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-srp.c
   M /trunk/epan/dissectors/packet-synphasor.c
   M /trunk/epan/dissectors/packet-teamspeak2.c
   M /trunk/epan/dissectors/packet-zrtp.c
   M /trunk/epan/libwireshark.def
   M /trunk/epan/sigcomp-udvm.c
   M /trunk/gtk/text_import.c
   M /trunk/plugins/irda/packet-sir.c
   M /trunk/plugins/profinet/packet-pn-rt.c
   M /trunk/wsutil/CMakeLists.txt
   M /trunk/wsutil/Makefile.common
   D /trunk/wsutil/crc10.c
   D /trunk/wsutil/crc10.h
   D /trunk/wsutil/crc16-plain.c
   D /trunk/wsutil/crc16-plain.h
   D /trunk/wsutil/crc16.c
   D /trunk/wsutil/crc16.h
   D /trunk/wsutil/crc32.c
   D /trunk/wsutil/crc32.h
   D /trunk/wsutil/crc6.c
   D /trunk/wsutil/crc6.h
   D /trunk/wsutil/crc8.c
   D /trunk/wsutil/crc8.h
   D /trunk/wsutil/crcdrm.c
   D /trunk/wsutil/crcdrm.h
   M /trunk/wsutil/libwsutil.def

Revert r38800, as the crc routines contains some tvb functions.

------------------------------------------------------------------------
r38802 | jmayer | 2011-08-30 07:04:37 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Get rid of the last crc stuff

------------------------------------------------------------------------
r38801 | stig | 2011-08-30 06:47:40 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   D /trunk/epan/crc

Remove the empty epan/crc directory.

------------------------------------------------------------------------
r38800 | stig | 2011-08-30 06:46:42 -0700 (Tue, 30 Aug 2011) | 3 lines
Changed paths:
   M /trunk/configure.in
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.common
   M /trunk/epan/Makefile.nmake
   D /trunk/epan/crc/Makefile.am
   D /trunk/epan/crc/Makefile.common
   D /trunk/epan/crc/Makefile.nmake
   D /trunk/epan/crc/crc-16-plain.c
   D /trunk/epan/crc/crc-16-plain.h
   D /trunk/epan/crc10.c
   D /trunk/epan/crc10.h
   D /trunk/epan/crc16.c
   D /trunk/epan/crc16.h
   D /trunk/epan/crc32.c
   D /trunk/epan/crc32.h
   D /trunk/epan/crc6.c
   D /trunk/epan/crc6.h
   D /trunk/epan/crc8.c
   D /trunk/epan/crc8.h
   D /trunk/epan/crcdrm.c
   D /trunk/epan/crcdrm.h
   M /trunk/epan/crypt/airpdcap.c
   M /trunk/epan/crypt/airpdcap_wep.c
   M /trunk/epan/dissectors/packet-assa_r3.c
   M /trunk/epan/dissectors/packet-dcp-etsi.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-eth.c
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fcoe.c
   M /trunk/epan/dissectors/packet-fcoib.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-iuup.c
   M /trunk/epan/dissectors/packet-iwarp-mpa.c
   M /trunk/epan/dissectors/packet-lapd.c
   M /trunk/epan/dissectors/packet-mtp2.c
   M /trunk/epan/dissectors/packet-mux27010.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-srp.c
   M /trunk/epan/dissectors/packet-synphasor.c
   M /trunk/epan/dissectors/packet-teamspeak2.c
   M /trunk/epan/dissectors/packet-zrtp.c
   M /trunk/epan/libwireshark.def
   M /trunk/epan/sigcomp-udvm.c
   M /trunk/gtk/text_import.c
   M /trunk/plugins/irda/packet-sir.c
   M /trunk/plugins/profinet/packet-pn-rt.c
   M /trunk/wsutil/CMakeLists.txt
   M /trunk/wsutil/Makefile.common
   A /trunk/wsutil/crc10.c (from /trunk/epan/crc10.c:38790)
   A /trunk/wsutil/crc10.h (from /trunk/epan/crc10.h:38790)
   A /trunk/wsutil/crc16-plain.c (from /trunk/epan/crc/crc-16-plain.c:38790)
   A /trunk/wsutil/crc16-plain.h (from /trunk/epan/crc/crc-16-plain.h:38790)
   A /trunk/wsutil/crc16.c (from /trunk/epan/crc16.c:38790)
   A /trunk/wsutil/crc16.h (from /trunk/epan/crc16.h:38790)
   A /trunk/wsutil/crc32.c (from /trunk/epan/crc32.c:38790)
   A /trunk/wsutil/crc32.h (from /trunk/epan/crc32.h:38790)
   A /trunk/wsutil/crc6.c (from /trunk/epan/crc6.c:38790)
   A /trunk/wsutil/crc6.h (from /trunk/epan/crc6.h:38790)
   A /trunk/wsutil/crc8.c (from /trunk/epan/crc8.c:38790)
   A /trunk/wsutil/crc8.h (from /trunk/epan/crc8.h:38790)
   A /trunk/wsutil/crcdrm.c (from /trunk/epan/crcdrm.c:38790)
   A /trunk/wsutil/crcdrm.h (from /trunk/epan/crcdrm.h:38790)
   M /trunk/wsutil/libwsutil.def

Move all crc routines to libwsutil.

This way we can use the crc routines in wiretap.
------------------------------------------------------------------------
r38799 | jmayer | 2011-08-30 05:47:24 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

No need to make an almost empty column extra wide.

------------------------------------------------------------------------
r38798 | martinm | 2011-08-30 05:09:07 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Add a #ifdef NEW_MENU_CODE around a static function that is only used on that path.

------------------------------------------------------------------------
r38797 | jmayer | 2011-08-30 04:46:40 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

Current status of gtk2/gtk3

------------------------------------------------------------------------
r38796 | etxrab | 2011-08-30 04:44:24 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Get the path right when running from build environment.
gui from file currently broken.
------------------------------------------------------------------------
r38795 | jmayer | 2011-08-30 04:44:21 -0700 (Tue, 30 Aug 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt

Make it possible to disable building with libpcap.

------------------------------------------------------------------------
r38794 | etxrab | 2011-08-30 03:25:58 -0700 (Tue, 30 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

I don't know...perhaps this will satisfy the OS X buildbot
------------------------------------------------------------------------
r38793 | etxrab | 2011-08-30 02:00:31 -0700 (Tue, 30 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Make the capture_if callbacks HAVE_LIBPCAP agnostic.
------------------------------------------------------------------------
r38792 | guy | 2011-08-30 01:09:40 -0700 (Tue, 30 Aug 2011) | 6 lines
Changed paths:
   M /trunk/wiretap/pcap-common.c

Handle multiple extension headers when calculating the pseudo-header
length, and actually write out the extension headers when writing out
the pseudo-header.

Fixes bug 6265.

------------------------------------------------------------------------
r38791 | etxrab | 2011-08-30 00:33:24 -0700 (Tue, 30 Aug 2011) | 1 line
Changed paths:
   M /trunk/globals.h
   M /trunk/gtk/gtkglobals.h

Do as the comment says - move the variable to gtkglobals.
------------------------------------------------------------------------
r38790 | guy | 2011-08-29 23:01:44 -0700 (Mon, 29 Aug 2011) | 7 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

A zero snaplen means "snaplen unknown", as in "the file format from
which we read the data to be written doesn't record the snapshot
length".  A snapshot length of 0 in a pcap or pcap-ng file is not
handled well by many programs reading those files; for pcap files, we
write out WTAP_MAX_PACKET_SIZE as the snapshot length in that case, so
do so for pcap-ng files as well.

------------------------------------------------------------------------
r38789 | etxrab | 2011-08-29 22:20:37 -0700 (Mon, 29 Aug 2011) | 4 lines
Changed paths:
   M /trunk/globals.h
   M /trunk/gtk/capture_if_dlg.h
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/stock_icons.c
   M /trunk/gtk/stock_icons.h

Path from Joerg Mayer, I'm committing it as I think the right thing to do is to have all menus defined in the GUI and then hide the ones
not available/usable and thuss get rid of a lot of #ifdefs.

As for the icons we should load all of them even if some are not needed in all configurations.
------------------------------------------------------------------------
r38788 | guy | 2011-08-29 20:58:12 -0700 (Mon, 29 Aug 2011) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-erf.c
   M /trunk/epan/dissectors/packet-erf.h

Endace ERF channelisation and "New BFS" extension header support, from
Andrew Kampjes.

------------------------------------------------------------------------
r38787 | guy | 2011-08-29 16:25:29 -0700 (Mon, 29 Aug 2011) | 3 lines
Changed paths:
   M /trunk/doc/wireshark.pod.template

I'm not sure -Q/WIRESHARK_QUIT_AFTER_CAPTURE is actually useful in batch
mode; in batch mode, you probably want to use TShark or dumpcap.

------------------------------------------------------------------------
r38786 | gerald | 2011-08-29 16:16:57 -0700 (Mon, 29 Aug 2011) | 2 lines
Changed paths:
   M /trunk/doc/wireshark.pod.template

-Q → WIRESHARK_QUIT_AFTER_CAPTURE.

------------------------------------------------------------------------
r38785 | sfisher | 2011-08-29 14:36:48 -0700 (Mon, 29 Aug 2011) | 5 lines
Changed paths:
   M /trunk/dumpcap.c


Attempt to fix coverity id 1212: MISSING_BREAK by inserting "FALLTHROUGH"
comment.


------------------------------------------------------------------------
r38784 | gerald | 2011-08-29 14:16:29 -0700 (Mon, 29 Aug 2011) | 2 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/docbook/wsug_src/WSUG_chapter_customize.xml
   M /trunk/gtk/main.c
   M /trunk/test/config.sh
   M /trunk/test/suite-capture.sh

Replace "-Q" with "WIRESHARK_QUIT_AFTER_CAPTURE" as discussed in bug 6256.

------------------------------------------------------------------------
r38783 | sfisher | 2011-08-29 12:56:11 -0700 (Mon, 29 Aug 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-babel.c


From Juliusz Chroboczek via bug #6273:

IANA has reallocated the Babel port; it is now 6696.  The attached patch makes
wireshark grok both the old and new ports.


------------------------------------------------------------------------
r38782 | sfisher | 2011-08-29 12:47:50 -0700 (Mon, 29 Aug 2011) | 19 lines
Changed paths:
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/stock_icons.c


Fix compilation when compiling without libpcap (configure script parameter
"--without-pcap")

Note: Generates run-time warnings still:

(wireshark:66065): Gtk-WARNING **: CaptureFilters: missing action /Capture/CaptureFilters

(wireshark:66065): Gtk-WARNING **: Interfaces: missing action /Capture/Interfaces

(wireshark:66065): Gtk-WARNING **: Options: missing action /Capture/Options

(wireshark:66065): Gtk-WARNING **: Start: missing action /Capture/Start

(wireshark:66065): Gtk-WARNING **: Stop: missing action /Capture/Stop

(wireshark:66065): Gtk-WARNING **: Restart: missing action /Capture/Restart 


------------------------------------------------------------------------
r38781 | gerald | 2011-08-29 12:22:42 -0700 (Mon, 29 Aug 2011) | 4 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/tools/win-setup.sh

Add "--windowsonly" and "--cygwinonly" options to win-setup.sh
--appverify.  Make sure "mt" is only found in a normaly Windows path and
"find" is only found in a Cygwin path.

------------------------------------------------------------------------
r38780 | jmayer | 2011-08-29 12:18:28 -0700 (Mon, 29 Aug 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

Only build rawshark and dumpcap if we have libpcap

------------------------------------------------------------------------
r38779 | jmayer | 2011-08-29 12:10:54 -0700 (Mon, 29 Aug 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Fix a comment

------------------------------------------------------------------------
r38778 | jmayer | 2011-08-29 11:20:43 -0700 (Mon, 29 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt

Install the new menu files.

------------------------------------------------------------------------
r38777 | gerald | 2011-08-29 09:45:48 -0700 (Mon, 29 Aug 2011) | 3 lines
Changed paths:
   M /trunk/win32/file_dlg_win32.c

Add a comment about using IFileOpenDialog and IFileSaveDialog on newer
versions of Windows.

------------------------------------------------------------------------
r38776 | etxrab | 2011-08-29 07:47:20 -0700 (Mon, 29 Aug 2011) | 2 lines
Changed paths:
   M /trunk/asn1/x2ap/x2ap.cnf
   M /trunk/epan/dissectors/packet-x2ap.c

From Fredrik Kuivinen:
Fix a problem with dissection of HandoverRequest.
------------------------------------------------------------------------
r38775 | jmayer | 2011-08-29 07:39:22 -0700 (Mon, 29 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Make loading the menu code from file a compile option: NEW_MENU_CODE
Will not work right now unless the xml files have been installed into
the run time directory.

------------------------------------------------------------------------
r38774 | jmayer | 2011-08-29 06:43:23 -0700 (Mon, 29 Aug 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

rtp-player now compiles with gtk3

------------------------------------------------------------------------
r38773 | etxrab | 2011-08-29 06:05:17 -0700 (Mon, 29 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/stock_icons.c

Register all icons regardless of HAVE_LIBPCAP.
------------------------------------------------------------------------
r38772 | etxrab | 2011-08-29 04:54:36 -0700 (Mon, 29 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Remove #ifdef's from UIDescription.
------------------------------------------------------------------------
r38771 | stig | 2011-08-29 03:01:36 -0700 (Mon, 29 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Add an expert info warning for integers encoded with too many octets.
------------------------------------------------------------------------
r38770 | stig | 2011-08-29 00:35:53 -0700 (Mon, 29 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rpcap.c

Dissect some op codes.
------------------------------------------------------------------------
r38769 | stig | 2011-08-29 00:35:44 -0700 (Mon, 29 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpcap.c

Improved heuristics.

Corrected check for absurdly large values in for-loops,
as remaining data may be 0.
------------------------------------------------------------------------
r38768 | jmayer | 2011-08-29 00:08:55 -0700 (Mon, 29 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/ui/bytes-view-ui.xml
   M /trunk/gtk/ui/main-menubar-ui.xml
   M /trunk/gtk/ui/tree-view-ui.xml

Fix a tpyo, remove trailing whitespace while at it.

------------------------------------------------------------------------
r38767 | etxrab | 2011-08-28 22:35:51 -0700 (Sun, 28 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
correct the filter names
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6239
------------------------------------------------------------------------
r38766 | etxrab | 2011-08-28 22:32:21 -0700 (Sun, 28 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI dissector: reassembly on the transport layer.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6221
------------------------------------------------------------------------
r38765 | etxrab | 2011-08-28 22:24:10 -0700 (Sun, 28 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Lei Chen:
Support E-UTRAN neighbor cells in Enhanced Measurement Report.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6275
------------------------------------------------------------------------
r38764 | guy | 2011-08-28 12:28:17 -0700 (Sun, 28 Aug 2011) | 3 lines
Changed paths:
   M /trunk/packaging/ws-manifest.pl

I guess this is the right thing to do with the "ui" directory to put it
into the U3 package.

------------------------------------------------------------------------
r38763 | guy | 2011-08-28 12:26:03 -0700 (Sun, 28 Aug 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Escape the newlines in the definition of ui_DATA.

------------------------------------------------------------------------
r38762 | etxrab | 2011-08-28 11:34:52 -0700 (Sun, 28 Aug 2011) | 1 line
Changed paths:
   M /trunk/Makefile.am
   A /trunk/gtk/ui/main-menubar-ui.xml
   M /trunk/packaging/nsis/wireshark.nsi

Add the main menubar UI description.
------------------------------------------------------------------------
r38761 | etxrab | 2011-08-28 11:28:29 -0700 (Sun, 28 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Unify windows and non windows menu_bar a bit.
------------------------------------------------------------------------
r38760 | etxrab | 2011-08-28 09:18:58 -0700 (Sun, 28 Aug 2011) | 1 line
Changed paths:
   M /trunk/Makefile.am
   A /trunk/gtk/ui/tree-view-ui.xml
   M /trunk/packaging/nsis/wireshark.nsi

Add the treeView popup UI description.
------------------------------------------------------------------------
r38757 | gerald | 2011-08-28 08:34:37 -0700 (Sun, 28 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-08-28]
------------------------------------------------------------------------
r38756 | etxrab | 2011-08-28 08:08:31 -0700 (Sun, 28 Aug 2011) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi

Install the GUI xml files. I'm not sure about the Makefile.am changes pkease check.
------------------------------------------------------------------------
r38755 | etxrab | 2011-08-28 08:00:02 -0700 (Sun, 28 Aug 2011) | 1 line
Changed paths:
   A /trunk/gtk/ui
   A /trunk/gtk/ui/bytes-view-ui.xml

Add directory for xml UI descriptions and a UI description for the byte View popup.
------------------------------------------------------------------------
r38754 | jmayer | 2011-08-27 04:06:50 -0700 (Sat, 27 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpcap.c

Stengthen the heuristics a bit (aka don't misclassify some of
my capture data as rpcap). Someone with more knowledge of the
format might want to look at this (I added FIXMEs).

------------------------------------------------------------------------
r38753 | stig | 2011-08-27 02:43:27 -0700 (Sat, 27 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/new_packet_list.h

Removed unused argument to new_packet_list_copy_summary_cb().
Mark unused argument to help_menu_cont_cb().
Whitespace cleanup in colorize_conversation_cb() calls.
------------------------------------------------------------------------
r38752 | stig | 2011-08-27 02:34:18 -0700 (Sat, 27 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Fix all occurrences of the color2 bug 6269.
------------------------------------------------------------------------
r38751 | etxrab | 2011-08-27 02:29:44 -0700 (Sat, 27 Aug 2011) | 6 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Colorize conversation color 2 not working from right-click menu

Typo in packet_list_menu_color_conv_tcp_color2_cb()
While at it change the signature of callbacks.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6269
------------------------------------------------------------------------
r38750 | jmayer | 2011-08-27 02:23:12 -0700 (Sat, 27 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-skinny.c
   M /trunk/epan/dissectors/packet-vines.h

Unify my address entry

------------------------------------------------------------------------
r38749 | stig | 2011-08-27 02:22:22 -0700 (Sat, 27 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Enable and disable toolbar buttons when having packets.
Set correct sensitivity for Go -> Go to Packet.

This fixes bug 6268.
------------------------------------------------------------------------
r38748 | jmayer | 2011-08-27 02:21:04 -0700 (Sat, 27 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntp.h

Remove some useless/wrong comments

------------------------------------------------------------------------
r38747 | guy | 2011-08-26 12:07:40 -0700 (Fri, 26 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_player.c

No semicolons after #endif, please.

------------------------------------------------------------------------
r38746 | jmayer | 2011-08-26 10:02:33 -0700 (Fri, 26 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c
   M /trunk/epan/dissectors/packet-airopeek.c
   M /trunk/epan/dissectors/packet-cisco-erspan.c
   M /trunk/epan/dissectors/packet-cisco-wids.c
   M /trunk/epan/dissectors/packet-extreme.c
   M /trunk/epan/dissectors/packet-glbp.c
   M /trunk/epan/dissectors/packet-ipsec-tcp.c
   M /trunk/epan/dissectors/packet-mndp.c
   M /trunk/epan/dissectors/packet-skinny.c
   M /trunk/epan/dissectors/packet-tapa.c
   M /trunk/epan/dissectors/packet-telkonet.c
   M /trunk/epan/dissectors/packet-tftp.c
   M /trunk/epan/dissectors/packet-vines.c
   M /trunk/epan/dissectors/packet-wassp.c
   M /trunk/epan/dissectors/packet-wlccp.c

Replace TRUE/FALSE with the new ENCAP stuff where appropriate

------------------------------------------------------------------------
r38745 | etxrab | 2011-08-26 08:25:14 -0700 (Fri, 26 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

CSN_LEFT_ALIGNED_VAR_BMP didn't handle more than 8 bits.

(CSN Ack/Nack Description wrongly handled in gsm_rlcmac_dl dissector )
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6101
------------------------------------------------------------------------
r38744 | etxrab | 2011-08-26 08:15:20 -0700 (Fri, 26 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/rtp_player.c

Missing ; in the < GTK 2.22 branch
------------------------------------------------------------------------
r38743 | etxrab | 2011-08-26 07:28:46 -0700 (Fri, 26 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/rtp_player.c

Use cairo_surface_t
------------------------------------------------------------------------
r38740 | etxrab | 2011-08-26 01:25:38 -0700 (Fri, 26 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/main_menubar.c

Fix LUA labels in the  UI_MANAGER case.
------------------------------------------------------------------------
r38739 | etxrab | 2011-08-25 23:22:20 -0700 (Thu, 25 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Make dissection of AVP: 3GPP-User-Location-Info(22) l=15 f=V-- vnd=TGPP val=303231 more robust.
------------------------------------------------------------------------
r38738 | etxrab | 2011-08-25 22:54:00 -0700 (Thu, 25 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Use ENC_BIG_ENDIAN.
------------------------------------------------------------------------
r38737 | stig | 2011-08-25 12:01:05 -0700 (Thu, 25 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/wslua/init_wslua.c

Do case insensitive search for lua scripts to load.
Skip files starting with . also on windows, as the home directory
may be mounted from a server with a proper filesystem.
------------------------------------------------------------------------
r38736 | stig | 2011-08-25 11:52:54 -0700 (Thu, 25 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Add a method to fetch protocol description.
------------------------------------------------------------------------
r38735 | etxrab | 2011-08-25 11:35:22 -0700 (Thu, 25 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c
   M /trunk/tap-funnel.c

Put LUA back in the menu_bar.
------------------------------------------------------------------------
r38734 | martinm | 2011-08-25 07:15:20 -0700 (Thu, 25 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/mac_lte_stat_dlg.c
   M /trunk/gtk/rlc_lte_stat_dlg.c

Trivial formatting differences (removed tabs, added newline between functions).

------------------------------------------------------------------------
r38733 | etxrab | 2011-08-25 06:23:20 -0700 (Thu, 25 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Correct action names.
------------------------------------------------------------------------
r38732 | etxrab | 2011-08-25 03:26:35 -0700 (Thu, 25 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

- Remove expert Warning not relevant to all GTP variants.
- use proto_add_item() in a couple of places.
- Fix a hf length.
------------------------------------------------------------------------
r38731 | etxrab | 2011-08-25 01:11:29 -0700 (Thu, 25 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Typo
------------------------------------------------------------------------
r38730 | etxrab | 2011-08-25 01:05:40 -0700 (Thu, 25 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

GTK3 make the tcp_graph work.
------------------------------------------------------------------------
r38729 | etxrab | 2011-08-25 00:45:32 -0700 (Thu, 25 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Simplify the ciode a bit.
------------------------------------------------------------------------
r38728 | cmaynard | 2011-08-24 17:50:39 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ndmp.c

"Bytes left to read" is an unsigned quantity.  Changed FT_INT64 to FT_UINT64 as suggested by Rui Loura via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6262.

------------------------------------------------------------------------
r38727 | alagoutte | 2011-08-24 15:18:24 -0700 (Wed, 24 Aug 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.h

From Olivier Montanuy via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5458
BGP add-path (Additional Paths) support for IPv4 unicast

From me:
Fix some whitespace/tab...

------------------------------------------------------------------------
r38726 | guy | 2011-08-24 15:10:04 -0700 (Wed, 24 Aug 2011) | 3 lines
Changed paths:
   M /trunk/README.macos

The guide.macports.org page points you to the other page, so just cite
it.

------------------------------------------------------------------------
r38725 | guy | 2011-08-24 15:08:50 -0700 (Wed, 24 Aug 2011) | 7 lines
Changed paths:
   M /trunk/README.macos

Update the information about getting Xcode, and note that
PKG_CONFIG_PATH must include /usr/X11/lib/pkgconfig (the man page for
pkg-config 0.26 seems to indicate that pkg-config searches the
directories in PKG_CONFIG_PATH *in addition to* the standard
directories, so it *might* be sufficient to set PKG_CONFIG_PATH to
/usr/X11/lib/pkgconfig).

------------------------------------------------------------------------
r38724 | alagoutte | 2011-08-24 14:58:14 -0700 (Wed, 24 Aug 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

From Olivier Montanuy via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5458
BGP add-path (Additional Paths) support for IPv4 unicast

From me:
Fix some whitespace/tab...

------------------------------------------------------------------------
r38723 | alagoutte | 2011-08-24 14:37:37 -0700 (Wed, 24 Aug 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

From astramax57 via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6188
In some BGP captures the AS_PATH attribute was decode wrong, if the asn length determines automatically

From me:
Fix some whitespace...
Fix error: ‘for’ loop initial declarations are only allowed in C99 mode
Replace unsigned by guint

------------------------------------------------------------------------
r38722 | guy | 2011-08-24 13:58:10 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Mark another widget argument as unused.

------------------------------------------------------------------------
r38721 | stig | 2011-08-24 13:53:25 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/filter_autocomplete.c

Corrected position of filter autocompletion window when using GTK3.
------------------------------------------------------------------------
r38720 | etxrab | 2011-08-24 12:45:33 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Put back the experimental GTK3 code. To be tested tomorrow :-)
------------------------------------------------------------------------
r38719 | etxrab | 2011-08-24 12:34:27 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Argh, forgot the _U_:s
------------------------------------------------------------------------
r38718 | etxrab | 2011-08-24 12:26:07 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Use user data rather than setting object data.
------------------------------------------------------------------------
r38717 | etxrab | 2011-08-24 12:05:06 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Back out the previous commits, the graph blows up - at least in the GTK2 version.
------------------------------------------------------------------------
r38716 | sfisher | 2011-08-24 11:57:10 -0700 (Wed, 24 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c


Mark widget parameter as unused a number of times


------------------------------------------------------------------------
r38715 | etxrab | 2011-08-24 11:19:25 -0700 (Wed, 24 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

GTK3 expose_event -> draw

Not compiled/tested
------------------------------------------------------------------------
r38714 | sfisher | 2011-08-24 08:35:32 -0700 (Wed, 24 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c


Mark length parameter as unused


------------------------------------------------------------------------
r38713 | etxrab | 2011-08-24 08:22:29 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Use elm_len for the length.
------------------------------------------------------------------------
r38712 | guy | 2011-08-24 03:18:25 -0700 (Wed, 24 Aug 2011) | 7 lines
Changed paths:
   M /trunk/macosx-setup.sh

Xcode 4 isn't available on DVD, but is available for download from
developer.apple.com, and the current version is available, at least for
Lion, from the Mac App Store.

While we're at it, make sure the X11 SDK is present, by checking for
/usr/X11/include.

------------------------------------------------------------------------
r38711 | martinm | 2011-08-24 02:41:17 -0700 (Wed, 24 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Call gdk_cairo_create() for earlier versions of gtk.
Is this correct?

------------------------------------------------------------------------
r38710 | etxrab | 2011-08-24 01:48:19 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Code clean up as draw_arc works with cairo now.
------------------------------------------------------------------------
r38709 | etxrab | 2011-08-24 01:32:14 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Paths changed for UI_MANAGER
------------------------------------------------------------------------
r38708 | stig | 2011-08-24 01:28:39 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_statusbar.c
   M /trunk/gtk/packet_list_store.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/tcp_graph.c

Simplified some GTK_CHECK_VERSION to improve readability.
------------------------------------------------------------------------
r38707 | etxrab | 2011-08-24 01:12:08 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_statusbar.c
   M /trunk/gtk/rtp_player.c

GTK3 Remove gtk_window_set_has_resize_grip() as it creates
warning "invalid cast from GtkStatusbar to GtkWindow".
------------------------------------------------------------------------
r38706 | etxrab | 2011-08-24 01:02:37 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_statusbar.c
   M /trunk/gtk/rtp_player.c

GTK3 Remove gtk_window_set_has_resize_grip() as it creates
warning "invalid cast from GtkStatusbar to GtkWindow".
------------------------------------------------------------------------
r38705 | stig | 2011-08-24 00:26:20 -0700 (Wed, 24 Aug 2011) | 5 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Several Time Shift menu improvements:
- Added shortcut Shift-Control-T
- Set inactive when no loaded packets
- Add stock time icon
- Moved below time reference functions
------------------------------------------------------------------------
r38704 | etxrab | 2011-08-24 00:26:11 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_graph_dlg.c

GTK3 expose_event -> draw
------------------------------------------------------------------------
r38703 | stig | 2011-08-23 23:57:14 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/text2pcap.c

Yet another cast.
------------------------------------------------------------------------
r38702 | stig | 2011-08-23 23:42:40 -0700 (Tue, 23 Aug 2011) | 5 lines
Changed paths:
   M /trunk/text2pcap.c

Fix a warning by changing a pointer type.

text2pcap.c: In function ‘parse_token’:
text2pcap.c:1076: warning: cast from pointer to integer of different size
text2pcap.c:1076: warning: cast from pointer to integer of different size
------------------------------------------------------------------------
r38701 | jmayer | 2011-08-23 22:48:26 -0700 (Tue, 23 Aug 2011) | 7 lines
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

GTK3 typo fixes:
Change iso->surface -> ios->surface
Rename draw_area_draw -> on_draw_area_draw_event
Change callback on_draw -> on_draw_area_draw_event
Remove trailing whitespace.


------------------------------------------------------------------------
r38700 | jmayer | 2011-08-23 22:37:51 -0700 (Tue, 23 Aug 2011) | 5 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

GTK3:
Rename the function parameter from usr_data -> data.
Use allocation instead of allocationarea in one place.
Remove trailing whitespace.

------------------------------------------------------------------------
r38699 | etxrab | 2011-08-23 22:25:04 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Fix a typo.
------------------------------------------------------------------------
r38698 | etxrab | 2011-08-23 22:04:30 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

GTK3 expose_event -> draw
------------------------------------------------------------------------
r38697 | etxrab | 2011-08-23 21:53:50 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

GTK3 expose_event -> draw
------------------------------------------------------------------------
r38696 | guy | 2011-08-23 19:37:36 -0700 (Tue, 23 Aug 2011) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

Fix prematurely-terminated comment.

------------------------------------------------------------------------
r38695 | guy | 2011-08-23 19:25:08 -0700 (Tue, 23 Aug 2011) | 3 lines
Changed paths:
   M /trunk/capture_sync.c

Fix a comment; this includes describing an additional way in which we
could fail to open the capture file.

------------------------------------------------------------------------
r38694 | tuexen | 2011-08-23 16:10:50 -0700 (Tue, 23 Aug 2011) | 3 lines
Changed paths:
   M /trunk/capture_sync.c

Hopefully fix
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6256.

------------------------------------------------------------------------
r38693 | stig | 2011-08-23 13:40:34 -0700 (Tue, 23 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/io_stat.c

From Akos Lukovics:
Bugfix moving averages.
------------------------------------------------------------------------
r38692 | etxrab | 2011-08-23 09:39:40 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_proto_draw.c

Make the byte highlighting work in GTK3
------------------------------------------------------------------------
r38691 | jmayer | 2011-08-23 07:53:18 -0700 (Tue, 23 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

Status update.

The lua menu items do work in the ItemFactory code.

------------------------------------------------------------------------
r38690 | etxrab | 2011-08-23 07:48:05 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Missed backing out one line...
------------------------------------------------------------------------
r38689 | etxrab | 2011-08-23 07:17:30 -0700 (Tue, 23 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/tcp_graph.c

Make colors work on GTK3 take 2
Revert tcp_graph commit by mistake, typo etc
------------------------------------------------------------------------
r38688 | jmayer | 2011-08-23 07:13:34 -0700 (Tue, 23 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c

Fix build in the non gtk3 case: Add gpointer data to the
  parameter list.
Remove some trailing spaces.

------------------------------------------------------------------------
r38687 | etxrab | 2011-08-23 06:49:37 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/tcp_graph.c

Make colors work on GTK3
------------------------------------------------------------------------
r38686 | stig | 2011-08-23 06:16:44 -0700 (Tue, 23 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/stat_cmd_args.h

From Gisle Vanem:
Rename header guard.
------------------------------------------------------------------------
r38685 | etxrab | 2011-08-23 04:18:35 -0700 (Tue, 23 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/io_stat.c

Make the IO-grph work in GTK3.
The "expose-event" needs to be changed to "draw" in all files.
------------------------------------------------------------------------
r38684 | jmayer | 2011-08-23 02:31:25 -0700 (Tue, 23 Aug 2011) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt

GTK3 only  builds if portaudio is disabled (rtp player is not
yet gtk3 ready).

------------------------------------------------------------------------
r38683 | stig | 2011-08-23 02:25:06 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt
   M /trunk/Makefile.am
   M /trunk/acinclude.m4
   D /trunk/cmake/modules/FindPCRE.cmake
   M /trunk/cmakeconfig.h.in
   M /trunk/configure.in
   M /trunk/debian/control
   M /trunk/doc/README.developer
   M /trunk/docbook/wsdg_src/WSDG_chapter_libraries.xml
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/dfilter/Makefile.nmake
   M /trunk/epan/dissectors/Makefile.nmake
   M /trunk/epan/epan.c
   M /trunk/epan/ftypes/Makefile.am
   M /trunk/epan/ftypes/Makefile.nmake
   M /trunk/epan/ftypes/ftype-bytes.c
   M /trunk/epan/ftypes/ftype-pcre.c
   M /trunk/epan/ftypes/ftype-string.c
   M /trunk/epan/ftypes/ftype-tvbuff.c
   M /trunk/epan/ftypes/ftypes-int.h
   M /trunk/epan/ftypes/ftypes.h
   M /trunk/version_info.c

Remove support for libpcre, we use GRegex in GLib.
------------------------------------------------------------------------
r38682 | etxrab | 2011-08-23 00:36:41 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_welcome.c

Fix colors in GTK3
------------------------------------------------------------------------
r38681 | etxrab | 2011-08-22 22:06:54 -0700 (Mon, 22 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

"fix":
Error: Found non-ASCII characters on line 4135 of packet-bacapp.c
Error: Found non-ASCII characters on line 4163 of packet-bacapp.c
Error: Found non-ASCII characters on line 4198 of packet-bacapp.c
------------------------------------------------------------------------
r38680 | etxrab | 2011-08-22 21:49:24 -0700 (Mon, 22 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btl2cap.c

From Andrei Emeltchenko via Chris Maynard:
btl2cap extended window shows wrong bit.
Patch would not apply cleanly so added by hand.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6257
------------------------------------------------------------------------
r38679 | etxrab | 2011-08-22 21:36:37 -0700 (Mon, 22 Aug 2011) | 3 lines
Changed paths:
   M /trunk/text2pcap.c

From Jack Yu modified by Chris Maynard:
Enhancement of text2cap for parsing flexibility.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=1723
------------------------------------------------------------------------
r38678 | etxrab | 2011-08-22 21:26:01 -0700 (Mon, 22 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

From Steve Karg:
BACnet Dissector latest enumerations for properties, states, error codes, and vendor ids.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6249
------------------------------------------------------------------------
r38677 | cmaynard | 2011-08-22 18:54:13 -0700 (Mon, 22 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/conversations_table.c

From Gisle Vanem via http://www.wireshark.org/lists/wireshark-dev/201108/msg00377.html: In follow_stream_cb(), if ct is NULL, bail out.  It was noted in a follow-up post by Guy that the "Follow stream" button should be grayed out if there are no conversations.  Until that is fixed, let's at least not crash.

------------------------------------------------------------------------
r38676 | cmaynard | 2011-08-22 18:08:32 -0700 (Mon, 22 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

Removed the call to g_warning() in proto_reg_handoff_opensafety(), as I didn't care to see the "openSAFETY - Profinet IO heuristic dissector cannot be registered, openSAFETY/PNIO native dissection." message when I ran, "tshark -v".

------------------------------------------------------------------------
r38675 | jmayer | 2011-08-22 09:35:53 -0700 (Mon, 22 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/menus.c

Get the build working with GTK3 for real.
Remove the check whether to disable the GTK_DEPRECATED stuff from menus.c,
  as it is only used for the deprecated code.

------------------------------------------------------------------------
r38674 | jmayer | 2011-08-22 09:16:16 -0700 (Mon, 22 Aug 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

Missed (at least) one place where to rename UI_MANAGER -> ENABLE_UI_MANAGER

------------------------------------------------------------------------
r38673 | etxrab | 2011-08-22 07:22:50 -0700 (Mon, 22 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/io_stat.c

From Akos Lukovics:
Calculate moving averages in IO Graphs.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6236
------------------------------------------------------------------------
r38672 | tuexen | 2011-08-22 07:15:57 -0700 (Mon, 22 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

gtk_action_get_label() is available in gtk+ 2.16 and higher...

------------------------------------------------------------------------
r38671 | etxrab | 2011-08-22 06:30:45 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

gtk_action_get_label() is GTK 2.16
------------------------------------------------------------------------
r38670 | etxrab | 2011-08-22 06:01:53 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/hostlist_fddi.c

Typo
------------------------------------------------------------------------
r38669 | etxrab | 2011-08-22 05:34:41 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Add conversation filter menu
------------------------------------------------------------------------
r38668 | tuexen | 2011-08-22 04:27:39 -0700 (Mon, 22 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

#if 0 in a consistent way. This should unbreak the Mac OS builders.

------------------------------------------------------------------------
r38667 | tuexen | 2011-08-22 04:25:59 -0700 (Mon, 22 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

merge_all_tap_menus() has been moved to menus.c.

------------------------------------------------------------------------
r38666 | tuexen | 2011-08-22 04:25:00 -0700 (Mon, 22 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

our_menu_callback() is only used when MAIN_MENU_USE_UIMANAGER
is not defined.

------------------------------------------------------------------------
r38665 | etxrab | 2011-08-22 03:36:04 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

More code cleanup.
------------------------------------------------------------------------
r38664 | etxrab | 2011-08-22 03:22:18 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/funnel_stat.c

funnel_stat.c:606: warning: unused parameter 'group'
------------------------------------------------------------------------
r38663 | jmayer | 2011-08-22 01:42:52 -0700 (Mon, 22 Aug 2011) | 2 lines
Changed paths:
   M /trunk/CMakeOptions.txt

Fix a typo

------------------------------------------------------------------------
r38662 | etxrab | 2011-08-22 01:37:32 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c

Don't export register_stat_menu_item_stock().(UI_MANAGER).
------------------------------------------------------------------------
r38661 | etxrab | 2011-08-22 01:16:14 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

walk_menu_tree_for_selected_packet() and walk_menu_tree_for_selected_tree_row does not work as we no longer get the path. Leave those menus enabled by default.
------------------------------------------------------------------------
r38660 | etxrab | 2011-08-22 01:09:09 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/dcerpc_stat.c

dcerpc_stat.c:525: warning: unused parameter 'action'
------------------------------------------------------------------------
r38659 | jmayer | 2011-08-22 01:08:38 -0700 (Mon, 22 Aug 2011) | 7 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/proto_help.c

Rename UI_MANAGER to ENABLE_UI_MANAGER, put it into
  CMakeOptions and enable it by default.
Update comment in proto_help that this feature is no
  longer built by default.
Enable PYTHON by default.


------------------------------------------------------------------------
r38658 | etxrab | 2011-08-22 00:46:10 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c

Remove register_stat_menu_item() if MAIN_MENU_USE_UIMANAGER 1
------------------------------------------------------------------------
r38657 | etxrab | 2011-08-22 00:44:56 -0700 (Mon, 22 Aug 2011) | 1 line
Changed paths:
   M /trunk/configure.in

make MAIN_MENU_USE_UIMANAGER the default.
------------------------------------------------------------------------
r38656 | etxrab | 2011-08-21 22:22:00 -0700 (Sun, 21 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Remove remaining gtk_item_factory (#ifdef HAVE_GTKOSXAPPLICATION) some one with OSX needs to test it.
I'm not sure if it will work.
------------------------------------------------------------------------
r38655 | etxrab | 2011-08-21 22:14:08 -0700 (Sun, 21 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/dcerpc_stat.c
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/hostlist_fddi.c
   M /trunk/gtk/main_menubar.c

Add missing menus.
------------------------------------------------------------------------
r38652 | gerald | 2011-08-21 15:34:50 -0700 (Sun, 21 Aug 2011) | 8 lines
Changed paths:
   M /trunk/services
   M /trunk/tools/make-services.pl

The canonical IANA port number URL now returns XML. Update
make-services.pl to to use the old-style text URL and add a comment
about parsing the XML instead.

Update the services file. Due to format changes it generates a lot of
text that should be commented out, but it's apparently been doing that
for a while now.

------------------------------------------------------------------------
r38651 | etxrab | 2011-08-21 14:29:52 -0700 (Sun, 21 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Fix a bunch of copy paste errors:
ui_manager_tree_view_menu -> ui_manager_main_menubar
------------------------------------------------------------------------
r38650 | etxrab | 2011-08-21 13:39:58 -0700 (Sun, 21 Aug 2011) | 1 line
Changed paths:
   M /trunk/config.nmake

Make MAIN_MENU_USE_UIMANAGER the default.
------------------------------------------------------------------------
r38649 | etxrab | 2011-08-21 13:28:49 -0700 (Sun, 21 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/bootp_stat.c
   M /trunk/gtk/compare_stat.c
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/stats_tree_stat.c

Add the remaining menus when MAIN_MENU_USE_UIMANAGER.
------------------------------------------------------------------------
r38648 | stig | 2011-08-21 11:06:53 -0700 (Sun, 21 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_pinfo.c

Add some NSTime methods: add, sub and unm.
------------------------------------------------------------------------
r38647 | stig | 2011-08-21 11:06:42 -0700 (Sun, 21 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def
   M /trunk/epan/nstime.c
   M /trunk/epan/nstime.h

Removed nstime_diff() in favour of nstime_delta().
Use nstime_delta() in nstime_subtract().
------------------------------------------------------------------------
r38646 | stig | 2011-08-21 11:06:19 -0700 (Sun, 21 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/io_stat.c

Use nstime_delta() to calculate time difference.
------------------------------------------------------------------------
r38645 | jmayer | 2011-08-21 09:07:41 -0700 (Sun, 21 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/rtp_player.c

Fix the remaining places that GDK_DISABLE_DEPRECATED complained about
(mostly just comment in already present code).

------------------------------------------------------------------------
r38643 | etxrab | 2011-08-21 09:03:13 -0700 (Sun, 21 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/stats_tree_stat.c

Make register_gtk_stats_tree_tap() work with MAIN_MENU_USE_UIMANAGER
------------------------------------------------------------------------
r38642 | jmayer | 2011-08-21 08:12:50 -0700 (Sun, 21 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt

Build gtkvumeter only on win32

------------------------------------------------------------------------
r38640 | gerald | 2011-08-21 07:03:33 -0700 (Sun, 21 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-08-21]
------------------------------------------------------------------------
r38639 | jmayer | 2011-08-21 06:03:44 -0700 (Sun, 21 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/gtkvumeter.c
   M /trunk/gtk/rtp_player.c

Somehow I forgot to commit the patch to disable GDK_DISABLE_DEPRECATED
for these files.

------------------------------------------------------------------------
r38638 | jmayer | 2011-08-21 06:01:41 -0700 (Sun, 21 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt

Compile with GDK_DISABLE_DEPRECATED (the files that fail with this
option disable it locally).

------------------------------------------------------------------------
r38637 | jmayer | 2011-08-21 05:54:54 -0700 (Sun, 21 Aug 2011) | 7 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Get the replacement for the arc drawing working.
Fix the crash by removing the call to gdk_cairo_set_source_color
  which for some reason caused the crash.
Remove the 3.0 hack and use the new code instead.
Always unset GDK_DEPRECATED compile flag as there are remaining 
  errors.

------------------------------------------------------------------------
r38636 | tuexen | 2011-08-21 05:52:58 -0700 (Sun, 21 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_menubar.c

Fix a typo.

------------------------------------------------------------------------
r38635 | jmayer | 2011-08-21 04:20:31 -0700 (Sun, 21 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Missed one instance of arc -> ellipse renaming.

------------------------------------------------------------------------
r38634 | jmayer | 2011-08-21 04:11:11 -0700 (Sun, 21 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

The arc function was only used to draw filled ellipses. Change code to
reflect this.

------------------------------------------------------------------------
r38633 | jmayer | 2011-08-21 02:11:04 -0700 (Sun, 21 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Small whitespace changes.

------------------------------------------------------------------------
r38632 | stig | 2011-08-21 01:03:22 -0700 (Sun, 21 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/diameter_stat.c
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/gtp_stat.c
   M /trunk/gtk/h225_counter.c
   M /trunk/gtk/h225_ras_srt.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/megaco_stat.c
   M /trunk/gtk/ncp_stat.c
   M /trunk/gtk/scsi_stat.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/smb2_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/wsp_stat.c

Add missing newline at the end of the file.
------------------------------------------------------------------------
r38631 | guy | 2011-08-21 00:07:56 -0700 (Sun, 21 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/camel_srt.c

Put a newline at the end of the file.

------------------------------------------------------------------------
r38630 | stig | 2011-08-20 12:42:15 -0700 (Sat, 20 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/capture_dlg.h
   M /trunk/gtk/main_welcome.h

Fixed build withouth HAVE_PCAP_REMOTE.
------------------------------------------------------------------------
r38629 | guy | 2011-08-20 12:30:35 -0700 (Sat, 20 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.h

The remote_options structure is not used if we don't have remote capture
support in pcap, so don't declare it if HAVE_PCAP_REMOTE isn't defined.

------------------------------------------------------------------------
r38628 | jmayer | 2011-08-20 06:40:25 -0700 (Sat, 20 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/tap_param_dlg.c

Fix unused parameter warning (turned error) in the ui-manager case.

------------------------------------------------------------------------
r38627 | etxrab | 2011-08-20 04:04:38 -0700 (Sat, 20 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/mgcp_stat.c
   M /trunk/gtk/ncp_stat.c
   M /trunk/gtk/radius_stat.c
   M /trunk/gtk/rlc_lte_stat_dlg.c
   M /trunk/gtk/scsi_stat.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/smb2_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/wsp_stat.c

Add more register_dfilter_stat  driven menus to MAIN_MENU_USE_UIMANAGER
------------------------------------------------------------------------
r38626 | etxrab | 2011-08-20 02:55:32 -0700 (Sat, 20 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/afp_stat.c
   M /trunk/gtk/bootp_stat.c
   M /trunk/gtk/camel_counter.c
   M /trunk/gtk/camel_srt.c
   M /trunk/gtk/diameter_stat.c
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/gtp_stat.c
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/h225_counter.c
   M /trunk/gtk/h225_ras_srt.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/mac_lte_stat_dlg.c
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/megaco_stat.c
   M /trunk/gtk/sctp_chunk_stat.c
   M /trunk/gtk/tap_param_dlg.c
   M /trunk/gtk/tap_param_dlg.h

Make register_dfilter_stat work for MAIN_MENU_USE_UIMANAGER
and add a bunch of menus.
------------------------------------------------------------------------
r38625 | jmayer | 2011-08-19 09:53:07 -0700 (Fri, 19 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/CMakeLists.txt

Add main_menubar.c
------------------------------------------------------------------------
r38624 | etxrab | 2011-08-19 08:40:02 -0700 (Fri, 19 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_stat.h

Try to fix the build bot.
------------------------------------------------------------------------
r38623 | etxrab | 2011-08-19 07:46:47 -0700 (Fri, 19 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/sctp_assoc_analyse.c
   M /trunk/gtk/sctp_stat.h
   M /trunk/gtk/sctp_stat_dlg.c

Add a few more menu items.
------------------------------------------------------------------------
r38622 | etxrab | 2011-08-19 07:12:55 -0700 (Fri, 19 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/rtp_stream_dlg.c

Add one more menu item.
------------------------------------------------------------------------
r38621 | etxrab | 2011-08-19 06:53:20 -0700 (Fri, 19 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_menubar.c

Add UTC timeformats to the menu.
------------------------------------------------------------------------
r38620 | etxrab | 2011-08-19 06:38:03 -0700 (Fri, 19 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/main_menubar.c
   M /trunk/gtk/mtp3_stat.c
   M /trunk/gtk/mtp3_summary.c
   M /trunk/gtk/rtp_analysis.c

Add a few more menu items.
------------------------------------------------------------------------
r38619 | etxrab | 2011-08-19 05:40:51 -0700 (Fri, 19 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/Makefile.common
   A /trunk/gtk/main_menubar.c
   M /trunk/gtk/menus.c

Put the UIManager menubar code in a separate file.
------------------------------------------------------------------------
r38618 | etxrab | 2011-08-19 05:15:54 -0700 (Fri, 19 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Mark length as U(nsused)
------------------------------------------------------------------------
r38617 | etxrab | 2011-08-19 05:02:49 -0700 (Fri, 19 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Fix MM Context for E-UTRAN SRVCC elment lengths
------------------------------------------------------------------------
r38616 | stig | 2011-08-19 01:36:02 -0700 (Fri, 19 Aug 2011) | 6 lines
Changed paths:
   M /trunk/epan/wslua/wslua.h
   M /trunk/epan/wslua/wslua_field.c
   M /trunk/epan/wslua/wslua_pinfo.c
   M /trunk/epan/wslua/wslua_proto.c
   M /trunk/epan/wslua/wslua_tree.c
   M /trunk/epan/wslua/wslua_tvb.c

Introduce NSTime Lua object to handle nstime_t.

This object can be used to retreive other absolute and relative time fields,
create and modify nstime_t values and put generated time values in the tree.

Also added ProtoField.absolute_time and ProtoField.relative_time.
------------------------------------------------------------------------
r38615 | etxrab | 2011-08-19 01:13:48 -0700 (Fri, 19 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

GTK 3.0
Make tcp_graph.c build on GTK3 without breaking GTK2.
Cross and Window scaling graph is not working in GTK 3.
------------------------------------------------------------------------
r38614 | etxrab | 2011-08-18 21:36:40 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/rtp_analysis.c

GTK 3.0 "Comment out" GTK 2 code for now. Functionality needs to be restored on GTK 3.
------------------------------------------------------------------------
r38613 | sfisher | 2011-08-18 17:01:11 -0700 (Thu, 18 Aug 2011) | 6 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/tcp_graph.c


Back out previous commit (38612) which was the brutal patch to build with
GTK 3 because not all of it is contained within #if statements for GTK 3
builds and could affect GTK 2 builds as well.


------------------------------------------------------------------------
r38612 | sfisher | 2011-08-18 16:55:01 -0700 (Thu, 18 Aug 2011) | 13 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/tcp_graph.c


From Anders on -dev:

Brutal patch to build with GTK 3.0 

With the enclosed patch Wireshark builds on GTK3.0. Colors are messed up etc but
it should be possible to start to fix things and actually see what's happening.
I wouldn't be surprised if many patches leading up to this are faulty. Color
handling should probably be rewritten to use GdkRGBA in many places etc.

  http://www.wireshark.org/lists/wireshark-dev/201108/msg00383.html 


------------------------------------------------------------------------
r38611 | sfisher | 2011-08-18 16:48:46 -0700 (Thu, 18 Aug 2011) | 4 lines
Changed paths:
   M /trunk/configure.in


Change || in an "if test" statement to "-o"


------------------------------------------------------------------------
r38610 | gerald | 2011-08-18 16:04:23 -0700 (Thu, 18 Aug 2011) | 5 lines
Changed paths:
   M /trunk/airpcap_loader.c
   M /trunk/gtk/prefs_dlg.c

Update the AirPcap code in prefs_dlg.c to match the changes made to
airpcap_dlg.c long ago in r28350. Re-enable GTK_DISABLE_DEPRECATED. Add
a comment to airpcap_loader.c about moving functionality to
packet-ieee80211.c.

------------------------------------------------------------------------
r38609 | tuexen | 2011-08-18 15:50:35 -0700 (Thu, 18 Aug 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Get --enable-ui-manager working.

------------------------------------------------------------------------
r38608 | gerald | 2011-08-18 14:46:28 -0700 (Thu, 18 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Add "WPA" to the 802.11 decryption key preference text.

------------------------------------------------------------------------
r38607 | jmayer | 2011-08-18 13:38:25 -0700 (Thu, 18 Aug 2011) | 3 lines
Changed paths:
   M /trunk/configure.in

When building with GTK3 we *must* use the ui-manager interface,
the ItemFactory stuff doesn't exists any more.

------------------------------------------------------------------------
r38606 | sfisher | 2011-08-18 09:15:23 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/prefs_dlg.c

Temporary fix to get Windows build going again: undefine GTK_DISABLE_DEPRECATED if building on Windows.  See: http://www.wireshark.org/lists/wireshark-dev/201108/msg00373.html
------------------------------------------------------------------------
r38605 | etxrab | 2011-08-18 08:28:25 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_welcome.c

GTK 3.0 Typo.
------------------------------------------------------------------------
r38604 | etxrab | 2011-08-18 06:59:53 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_welcome.c

GTK 3.0 Fix colors(?)
------------------------------------------------------------------------
r38603 | etxrab | 2011-08-18 06:44:27 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/color_dlg.c
   M /trunk/gtk/dcerpc_stat.c
   M /trunk/gtk/main_proto_draw.c

GTK 3.0 fix a couple of gtk_style_context_get().
------------------------------------------------------------------------
r38602 | etxrab | 2011-08-18 06:43:59 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/rtp_player.c

Draw the cursor line using ccairo
------------------------------------------------------------------------
r38601 | alagoutte | 2011-08-18 06:43:24 -0700 (Thu, 18 Aug 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

From Ryan Hoffman via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6122
Malformed Packet in decode for BGP-AD (autodiscovery) update (RFC6074)

From me:
Add support of RFC6074 (BGP-AD) in BGP dissector.
Both BGP-AD and VPLS-BGP (RFC4761) use the same AFI/SAFI, The NLRI length must be used as a demultiplexer. (See RFC6074  Section 7 : BGP-AD and VPLS-BGP Interoperability)

------------------------------------------------------------------------
r38600 | alagoutte | 2011-08-18 05:51:30 -0700 (Thu, 18 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

Enhance support of RD Type 2 (FORMAT_AS4_LOC) (RFC4364)

------------------------------------------------------------------------
r38599 | etxrab | 2011-08-18 05:20:11 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Use cairo_surface_t instead of axis_pixmap.
------------------------------------------------------------------------
r38598 | etxrab | 2011-08-18 04:02:38 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Use cairo_surface_t instead of title_pixmap.
------------------------------------------------------------------------
r38597 | jmayer | 2011-08-18 03:54:55 -0700 (Thu, 18 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/dcerpc_stat.c

Fix a typo in the gtk3 case

------------------------------------------------------------------------
r38596 | etxrab | 2011-08-18 01:58:29 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/dcerpc_stat.c

GTK 3.0 version of modify forground.
------------------------------------------------------------------------
r38595 | jmayer | 2011-08-18 01:49:05 -0700 (Thu, 18 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

Fix two typos in the gtk3 case

------------------------------------------------------------------------
r38594 | etxrab | 2011-08-17 23:43:35 -0700 (Wed, 17 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_welcome.c

Copy-paste errors.
------------------------------------------------------------------------
r38593 | etxrab | 2011-08-17 23:37:28 -0700 (Wed, 17 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_proto_draw.c
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/packet_list_store.c

More GTK 3.0 changes.
------------------------------------------------------------------------
r38592 | stig | 2011-08-17 12:46:13 -0700 (Wed, 17 Aug 2011) | 2 lines
Changed paths:
   M /trunk/wsutil/file_util.c

From Gisle Vanem:
Patch for a missing WINAPI.
------------------------------------------------------------------------
r38591 | etxrab | 2011-08-17 12:39:34 -0700 (Wed, 17 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/main_proto_draw.c
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/supported_protos_dlg.c
   M /trunk/gtk/text_page_utils.c

Use gtk_widget_override_font() in GTK 3.0 ( Untested on GTK 3.0)
------------------------------------------------------------------------
r38590 | jmayer | 2011-08-17 11:13:25 -0700 (Wed, 17 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_airpcap_toolbar.c

Replace deprecated functions/macros

------------------------------------------------------------------------
r38589 | alagoutte | 2011-08-17 11:09:27 -0700 (Wed, 17 Aug 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

From Sergey V. Lobanov via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6128
Wireshark doesn't decode BGP.MP_REACH_NLRI.NLRI when RD type is 2(defined in
RFC4364:4.2)

From me:
 Add RD type 2 (FORMAT_AS4_LOC) (not tested... based only on RFC spec..)

------------------------------------------------------------------------
r38588 | jmayer | 2011-08-17 10:34:56 -0700 (Wed, 17 Aug 2011) | 4 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/configure.in
   M /trunk/gtk/CMakeLists.txt

Always build with -DGTK_DISABLE_DEPRECATED. The files that
fail when built in specific configurations will disable this
option when required.

------------------------------------------------------------------------
r38587 | jmayer | 2011-08-17 10:29:27 -0700 (Wed, 17 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/menus.c
   M /trunk/gtk/proto_help.c

These two files cannot be compiled with GTK_DISABLE_DEPRECATED
as long as they are still using the non MAIN_MENU_USE_UIMANAGER
case.

------------------------------------------------------------------------
r38586 | jmayer | 2011-08-17 10:27:50 -0700 (Wed, 17 Aug 2011) | 5 lines
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/menus.c

Use gpointer instead of GtkItemFactoryCallback for functions
register_stat_menu_item and register_stat_menu_item_stock in
the non MAIN_MENU_USE_UIMANAGER case. This is in preparation
for the next patch.

------------------------------------------------------------------------
r38585 | jmayer | 2011-08-17 10:24:49 -0700 (Wed, 17 Aug 2011) | 6 lines
Changed paths:
   M /trunk/gtk/menus.c
   M /trunk/gtk/menus.h

Unifiy parameters to menu_open_recent_file_cmd for the
MAIN_MENU_USE_UIMANAGER and on MAIN_MENU_USE_UIMANAGER case
(use gpointer instead of GtkWidget*/GetAction*).
In at least some cases the calling paramter is of
type gpointer anyway.

------------------------------------------------------------------------
r38584 | gerald | 2011-08-17 09:54:24 -0700 (Wed, 17 Aug 2011) | 3 lines
Changed paths:
   M /trunk/packaging/u3/win32/u3util.c
   M /trunk/tools/checkAPIs.pl
   M /trunk/win32/file_dlg_win32.c

The MSDN page for ZeroMemory recommends using SecureZeroMemory instead,
so do so. Add ZeroMemory to checkAPIs.pl.

------------------------------------------------------------------------
r38583 | gerald | 2011-08-17 09:47:04 -0700 (Wed, 17 Aug 2011) | 5 lines
Changed paths:
   M /trunk/wsutil/privileges.c

From Gisle Vanem: Make sure our SetProcessDEPPolicyHandler typedef
matches the documentation.

I also verified that DEP is still enabled on Win32 using Process Explorer.

------------------------------------------------------------------------
r38582 | sfisher | 2011-08-17 08:52:12 -0700 (Wed, 17 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/menus.c


Fix compilation on when not using MAIN_MENU_USE_UIMANAGER


------------------------------------------------------------------------
r38581 | etxrab | 2011-08-17 08:29:15 -0700 (Wed, 17 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/main_proto_draw.c

More GTK 3.0 changes:
- In main skipp RC for now
- main_proto_draw incomplete fix.(#if 0)
------------------------------------------------------------------------
r38580 | jmayer | 2011-08-17 07:35:32 -0700 (Wed, 17 Aug 2011) | 8 lines
Changed paths:
   M /trunk/gtk/main_filter_toolbar.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/menus.h

menus.[hc]:
  set_menu_object_data_old has identical parameters to set_menu_object_data,
  and one was used only in the MAIN_MENU_USE_UIMANAGER case, the other in the
  non MAIN_MENU_USE_UIMANAGER case. Differentiate inside the function code and
  not via the function name.
main_filter_toolbar.c: Unify the set_menu_object_data and
  set_menu_object_data_old as the only difference was the function name.

------------------------------------------------------------------------
r38579 | jmayer | 2011-08-17 07:19:25 -0700 (Wed, 17 Aug 2011) | 6 lines
Changed paths:
   M /trunk/gtk/main_filter_toolbar.c
   M /trunk/gtk/menus.h

Move #defines for MENU_BAR_PATH_* and PACKET_LIST_POPUP_PATH_* out of
menus.h to main_filter_toolbar.c, that's the only place where they are
used.
The #defines for PACKET_LIST_POPUP_PATH_* seem to be unused, so #if 0 them.


------------------------------------------------------------------------
r38578 | etxrab | 2011-08-17 07:05:54 -0700 (Wed, 17 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/filter_dlg.c
   M /trunk/gtk/graph_analysis.c

Fix a typo and  size_request.
------------------------------------------------------------------------
r38577 | etxrab | 2011-08-17 06:55:58 -0700 (Wed, 17 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/color_edit_dlg.c
   M /trunk/gtk/filter_autocomplete.c

Fix a typo and  size_request.
------------------------------------------------------------------------
r38576 | etxrab | 2011-08-17 06:49:47 -0700 (Wed, 17 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/color_dlg.c
   M /trunk/gtk/color_edit_dlg.c
   M /trunk/gtk/color_utils.c
   M /trunk/gtk/color_utils.h
   M /trunk/gtk/fileset_dlg.c
   M /trunk/gtk/filter_autocomplete.c
   M /trunk/gtk/filter_dlg.c

Get further with compiling with GTK 3.0
(No functional testing done yet)
------------------------------------------------------------------------
r38575 | etxrab | 2011-08-17 04:41:23 -0700 (Wed, 17 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/color_utils.c

Try to make tge build bot happy.
------------------------------------------------------------------------
r38574 | etxrab | 2011-08-17 03:53:46 -0700 (Wed, 17 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/color_dlg.c
   M /trunk/gtk/color_edit_dlg.c
   M /trunk/gtk/color_utils.c
   M /trunk/gtk/color_utils.h
   M /trunk/gtk/main_proto_draw.c
   M /trunk/gtk/main_welcome.c

Get rid of get_color() it looks like we do not need allocated collors.
The code is #if 0:ed out in case there is any ill side effects.
------------------------------------------------------------------------
r38573 | etxrab | 2011-08-17 00:10:33 -0700 (Wed, 17 Aug 2011) | 1 line
Changed paths:
   M /trunk/color_filters.c

Fix indentation.
------------------------------------------------------------------------
r38572 | stig | 2011-08-16 12:25:29 -0700 (Tue, 16 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Initialize trunc.

Fix CID 1229.
------------------------------------------------------------------------
r38571 | cmaynard | 2011-08-16 12:20:25 -0700 (Tue, 16 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iax2.c

From Jakub Ruzicka via bug 6240: Show data for trunked packets.  Some typo fixes by me.
Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6240

------------------------------------------------------------------------
r38570 | stig | 2011-08-16 11:51:11 -0700 (Tue, 16 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/time_shift_dlg.c

Small fix in a error message.
------------------------------------------------------------------------
r38569 | stig | 2011-08-16 10:51:38 -0700 (Tue, 16 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/time_shift_dlg.c

Removed usage of localtime_r().
------------------------------------------------------------------------
r38568 | stig | 2011-08-16 10:37:04 -0700 (Tue, 16 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/time_shift_dlg.c

Remove unused code.
------------------------------------------------------------------------
r38567 | guy | 2011-08-16 10:23:39 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/time_shift_dlg.c

Casts to squelch warnings.

------------------------------------------------------------------------
r38566 | stig | 2011-08-16 09:54:41 -0700 (Tue, 16 Aug 2011) | 11 lines
Changed paths:
   M /trunk/gtk/time_shift_dlg.c

From Edwin Groothuis:
1. Add tooltip helps for the input and buttons.
2. Change the buttons from Apply OK Cancel to Apply Close.
3. Fixed the strange extrapolate behaviour by splitting the double float
   maths from the integer maths.
4. Also update the other three time fields: Seconds since first packet,
   seconds since previous captured packet, seconds since previous
   displayed packet.

From me:
Changed location for sanity checks.
------------------------------------------------------------------------
r38565 | guy | 2011-08-16 09:26:50 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/dcerpc/drsuapi/drsuapi.idl
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-dcerpc-drsuapi.c
   M /trunk/epan/dissectors/packet-dcerpc-drsuapi.h
   M /trunk/epan/dissectors/packet-homeplug-av.c
   M /trunk/epan/dissectors/packet-ppi-sensor.c
   M /trunk/epan/dissectors/packet-sita.c

More misspellings of "unknown", for bug 6244.

------------------------------------------------------------------------
r38564 | cmaynard | 2011-08-16 07:54:59 -0700 (Tue, 16 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

Use col_append_sep_str() to comma-separate info column text.  Fixes bug 6186.
Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6186

------------------------------------------------------------------------
r38563 | stig | 2011-08-16 06:42:08 -0700 (Tue, 16 Aug 2011) | 3 lines
Changed paths:
   M /trunk/print.c

Check for valid filename in write_pdml_preamble().

Part of fix for bug 6245.
------------------------------------------------------------------------
r38562 | stig | 2011-08-16 06:27:41 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/tshark.c

From Yann via bug 6245:
Fixed crash in write_preamble().
------------------------------------------------------------------------
r38561 | morriss | 2011-08-16 06:16:33 -0700 (Tue, 16 Aug 2011) | 5 lines
Changed paths:
   M /trunk/asn1/tetra/packet-tetra-template.c
   M /trunk/epan/dissectors/packet-dcom.c
   M /trunk/epan/dissectors/packet-fix.h
   M /trunk/epan/dissectors/packet-giop.c
   M /trunk/epan/dissectors/packet-gvcp.c
   M /trunk/epan/dissectors/packet-lldp.c
   M /trunk/epan/dissectors/packet-olsr.c
   M /trunk/epan/dissectors/packet-ospf.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-tetra.c
   M /trunk/fix/FIX.xml
   M /trunk/fix/FIX42.xml
   M /trunk/fix/FIX43.xml
   M /trunk/fix/FIX44.xml
   M /trunk/wiretap/README.airmagnet

Based on patch from Denis Ovsienko via
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6244 :

Fix typo: s/unkown/unknown/

------------------------------------------------------------------------
r38560 | gal | 2011-08-16 05:28:17 -0700 (Tue, 16 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Allow the dissection of BER/DER carried over a TCP transport using
"Decode As..."


------------------------------------------------------------------------
r38559 | guy | 2011-08-16 04:11:17 -0700 (Tue, 16 Aug 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

At least for the Provider Service Table items, they're part of 802.11,
so precede their field names with "wlan.".  Fix some of their long names
and descriptions (no need to spell out "Internet Protocol" or "Medium
Access Control", for example).

Give the "Number of Channels" field a more reasonable name (and one that
avoids the problem of spelling "unknown" incorrectly).

------------------------------------------------------------------------
r38558 | gal | 2011-08-16 03:57:52 -0700 (Tue, 16 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/prefs.c
   M /trunk/epan/prefs.h
   M /trunk/gtk/main_proto_draw.c
   M /trunk/gtk/prefs_gui.c

An option to autoscroll the expanded item in the details view to a fixed 
position (percentage) within the details view. 


------------------------------------------------------------------------
r38557 | jmayer | 2011-08-16 03:35:42 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/flow_graph.c

For GTK3: Change type of unused parameter GtkObject -> GObject

------------------------------------------------------------------------
r38556 | jmayer | 2011-08-16 03:31:38 -0700 (Tue, 16 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/packet_win.c

With gtk3, gtk_adjustment_new changed the return type:
  GtkObject -> GtkAdjustment

------------------------------------------------------------------------
r38555 | tuexen | 2011-08-16 03:03:49 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Using enabled/disabled instead of yes/no seems to be more descriptive.

------------------------------------------------------------------------
r38554 | tuexen | 2011-08-16 02:35:14 -0700 (Tue, 16 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/main_welcome.c

Handle the case in the capture options dialog box
where no interfaces are available.

------------------------------------------------------------------------
r38553 | stig | 2011-08-16 02:08:36 -0700 (Tue, 16 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-imf.c

Don't prefix description with imf.
------------------------------------------------------------------------
r38551 | gerald | 2011-08-15 15:00:21 -0700 (Mon, 15 Aug 2011) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake

Add libwireshark.lib, libwsutil.lib, and wiretap-1.7.0.lib to the PDB
archive. Add libwsutil.pdb and sort a few items while we're here.

------------------------------------------------------------------------
r38550 | sfisher | 2011-08-15 14:20:59 -0700 (Mon, 15 Aug 2011) | 5 lines
Changed paths:
   M /trunk/gtk/about_dlg.c


Mark parent parameter to about_wireshark() as unused because its use
was commented out in r38549.


------------------------------------------------------------------------
r38549 | etxrab | 2011-08-15 13:56:00 -0700 (Mon, 15 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/about_dlg.c
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/gui_utils.h
   M /trunk/gtk/main_welcome.c

gdk_pixbuf_render_pixmap_and_mask_for_colormap() used in xpm_to_widget_from_parent is gone in GTK 3.0. 
Rather tan trying to replace it go for the simpler xpm_to_widget() The
result looks the same to me.
------------------------------------------------------------------------
r38548 | tuexen | 2011-08-15 13:39:44 -0700 (Mon, 15 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_dlg.h

Use better names.
Make sure that the dlt is always set.

------------------------------------------------------------------------
r38547 | sfisher | 2011-08-15 09:17:36 -0700 (Mon, 15 Aug 2011) | 6 lines
Changed paths:
   M /trunk/gtk/gui_utils.c


Fix trivial compilation error:

  gui_utils.c:1880:39: error: no newline at end of file


------------------------------------------------------------------------
r38546 | etxrab | 2011-08-15 07:42:01 -0700 (Mon, 15 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/follow_stream.c

gtk_quit_add_destroy() is deprecated in GTK 3.0.
(I hope tis is the right thing to do).
------------------------------------------------------------------------
r38545 | etxrab | 2011-08-15 07:36:58 -0700 (Mon, 15 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/firewall_dlg.c

Hmm try this instead.
------------------------------------------------------------------------
r38544 | etxrab | 2011-08-15 07:30:14 -0700 (Mon, 15 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/firewall_dlg.c

gtk_quit_add_destroy() is deprecated in GTK 3.0.
(I hope tis is the right thing to do).
------------------------------------------------------------------------
r38543 | etxrab | 2011-08-14 22:36:48 -0700 (Sun, 14 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/rtp_analysis.c

Save graph GTK =< 2.22
------------------------------------------------------------------------
r38542 | etxrab | 2011-08-14 21:39:30 -0700 (Sun, 14 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Jeremy Quirke:
misdecoding 3G Neighbour Cell Information Element in SI2quater message due to a coding typo

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6237
------------------------------------------------------------------------
r38541 | etxrab | 2011-08-14 14:40:25 -0700 (Sun, 14 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/gui_utils.h
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/pixmap_save.c
   M /trunk/gtk/pixmap_save.h

Make save IO graph work, I had to make a local copy of
GTK 3.0 function gdk_pixbuf_get_from_surface() put in gui_util.c
------------------------------------------------------------------------
r38540 | stig | 2011-08-14 13:31:16 -0700 (Sun, 14 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/prefs.c

Check arguments to prefs_find_preference().

Fix CID 1259.
------------------------------------------------------------------------
r38539 | stig | 2011-08-14 13:21:12 -0700 (Sun, 14 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/menus.c

Added extra argument check in rebuild_protocol_prefs_menu().

Fix CID 1258.
------------------------------------------------------------------------
r38538 | stig | 2011-08-14 12:55:10 -0700 (Sun, 14 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/time_shift_dlg.c

Use correct arguments in simple_dialog().
------------------------------------------------------------------------
r38537 | stig | 2011-08-14 12:35:18 -0700 (Sun, 14 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/time_shift_dlg.c

Use simple_dialog() for error messages.

Fix CID 1266.
------------------------------------------------------------------------
r38536 | stig | 2011-08-14 11:53:28 -0700 (Sun, 14 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/time_shift_dlg.c

Use floorl() instead of truncl() on all platforms.
------------------------------------------------------------------------
r38535 | guy | 2011-08-14 10:14:52 -0700 (Sun, 14 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

gtk_combo_box_set_active() takes a GtkComboBox *, not a GtkComboBoxText
*, as its argument.

------------------------------------------------------------------------
r38532 | gerald | 2011-08-14 07:03:42 -0700 (Sun, 14 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-08-14]
------------------------------------------------------------------------
r38531 | tuexen | 2011-08-14 06:05:08 -0700 (Sun, 14 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Being loopback is an interface property, not an address property.
Display it as such.

------------------------------------------------------------------------
r38530 | tuexen | 2011-08-14 05:37:35 -0700 (Sun, 14 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main.c

Take the interface description into account when looking up the preferred
interface to capture from.

------------------------------------------------------------------------
r38529 | tuexen | 2011-08-14 04:58:05 -0700 (Sun, 14 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Preserve previous selected capture filters when opening the Edit Interface Settings
dialog box. This fixes a bug reported by Chris.

------------------------------------------------------------------------
r38528 | tuexen | 2011-08-14 03:35:05 -0700 (Sun, 14 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Get rid of unused code.

------------------------------------------------------------------------
r38527 | tuexen | 2011-08-14 03:22:31 -0700 (Sun, 14 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Use address counter...

------------------------------------------------------------------------
r38526 | tuexen | 2011-08-14 02:54:52 -0700 (Sun, 14 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Improve handling of remote interfaces.

------------------------------------------------------------------------
r38525 | stig | 2011-08-14 02:29:47 -0700 (Sun, 14 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_dlg.h

Count number of ip addresses and use this count to determine if we shall
print the addresses string in the devices list.
------------------------------------------------------------------------
r38524 | tuexen | 2011-08-14 01:54:53 -0700 (Sun, 14 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Improve the resizing of the capture options dialog box.
This was suggested by Stig.

------------------------------------------------------------------------
r38523 | stig | 2011-08-14 01:03:25 -0700 (Sun, 14 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/menus.c

Use correct callback for time shift.
Don't use <control>A for time shift.
------------------------------------------------------------------------
r38522 | guy | 2011-08-13 16:34:28 -0700 (Sat, 13 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Don't map "no interfaces" to "none" and then back to an empty string;
just map it to an empty string.

------------------------------------------------------------------------
r38521 | guy | 2011-08-13 15:33:14 -0700 (Sat, 13 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-coap.c

Do more checking of the TLV length.  Yes, the length can be zero or
negative in a malformed packet.  Should fix bug 6238.

------------------------------------------------------------------------
r38520 | tuexen | 2011-08-13 13:47:48 -0700 (Sat, 13 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Don't print "none" if no addresses are available to save space.
Patch provided by Stig.

------------------------------------------------------------------------
r38519 | tuexen | 2011-08-13 13:21:25 -0700 (Sat, 13 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix warnings reported by Bill.

------------------------------------------------------------------------
r38518 | tuexen | 2011-08-13 13:12:27 -0700 (Sat, 13 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Some cleanup.

------------------------------------------------------------------------
r38517 | guy | 2011-08-13 12:46:40 -0700 (Sat, 13 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

Make the description of -I match the description in dumpcap and TShark.

------------------------------------------------------------------------
r38516 | tuexen | 2011-08-13 12:33:23 -0700 (Sat, 13 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_dlg.h

Honor command line options in the capture options dialog.

------------------------------------------------------------------------
r38515 | guy | 2011-08-13 12:21:02 -0700 (Sat, 13 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c

Say "none" rather than "unknown" if there are no IP addresses; in most
if not all cases, it's not that we don't know the IP addresses, it's
that there are no IP addresses to know.

------------------------------------------------------------------------
r38514 | guy | 2011-08-13 12:09:18 -0700 (Sat, 13 Aug 2011) | 6 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Call the column giving the link-layer header type "Link-layer header",
to describe it a bit more completely.  (Note that it indicates what type
of link -layer headers you'll get, which isn't necessarily what type of
interface you have - an 802.11 interface might have a link-layer header
type of "Ethernet", for example.)

------------------------------------------------------------------------
r38513 | tuexen | 2011-08-13 11:26:19 -0700 (Sat, 13 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Minor cleanup.

------------------------------------------------------------------------
r38512 | stig | 2011-08-13 10:55:44 -0700 (Sat, 13 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/time_shift_dlg.c
   M /trunk/gtk/time_shift_dlg.h

Set correct svn properties.

------------------------------------------------------------------------
r38511 | stig | 2011-08-13 10:54:43 -0700 (Sat, 13 Aug 2011) | 1 line
Changed paths:
   M /trunk/AUTHORS

Fixed an email address.
------------------------------------------------------------------------
r38510 | stig | 2011-08-13 10:39:38 -0700 (Sat, 13 Aug 2011) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/frame_data.c
   M /trunk/epan/frame_data.h
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/help_dlg.c
   M /trunk/gtk/help_dlg.h
   M /trunk/gtk/menus.c
   A /trunk/gtk/time_shift_dlg.c
   A /trunk/gtk/time_shift_dlg.h

From Edwin Groothuis via bug 6179:
Added Time Shift functionality.

From me:
Renamed to use "Time Shift" everywhere + some other minor cleanups.
------------------------------------------------------------------------
r38509 | stig | 2011-08-13 10:39:25 -0700 (Sat, 13 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def
   M /trunk/epan/nstime.c
   M /trunk/epan/nstime.h

From Edwin Groothuis via bug 6179:
Add nstime_copy.
------------------------------------------------------------------------
r38508 | tuexen | 2011-08-13 10:13:50 -0700 (Sat, 13 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Improve handling of snaplen in capture options window.


------------------------------------------------------------------------
r38507 | tuexen | 2011-08-13 09:57:46 -0700 (Sat, 13 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix Windows builds (hopefully).

------------------------------------------------------------------------
r38506 | tuexen | 2011-08-13 08:49:24 -0700 (Sat, 13 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_dlg.h

Make the monitor mode selectable only when supported by the interface.
This fixes a bug reported by Stig.

------------------------------------------------------------------------
r38505 | tuexen | 2011-08-13 05:25:05 -0700 (Sat, 13 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

Add description of -I option in -h output.

------------------------------------------------------------------------
r38504 | jmayer | 2011-08-12 13:51:53 -0700 (Fri, 12 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

Revert 38500 - compiling with gtk2.12 and gtk2.22 and gtk3.0 obviously
wasn't enough.

------------------------------------------------------------------------
r38503 | jmayer | 2011-08-12 13:02:19 -0700 (Fri, 12 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_statusbar.c
   M /trunk/gtk/rtp_player.c

Replace 2.x only gtk_statusbar_set_has_resize_grip by 3.x only
gtk_window_set_has_resize_grip

------------------------------------------------------------------------
r38502 | jmayer | 2011-08-12 12:33:09 -0700 (Fri, 12 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main.c

In gtk3, gtk_set_locale is gone without replacement or
even deprecation. As it basically just did a setlocale
put that call in directly.

------------------------------------------------------------------------
r38501 | jmayer | 2011-08-12 11:04:36 -0700 (Fri, 12 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/gtkvumeter.c

OK, that search and replace took in a wrong object.
Unfortunately gcc 4.5.1 on linux didn't complain.

------------------------------------------------------------------------
r38500 | jmayer | 2011-08-12 10:52:48 -0700 (Fri, 12 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

Replace GDK_IS_DRAWABLE by gtk_widget_is_drawable(). All occurrences
seem to be in the GTK < 2.22 path, so it didn't really matter.

------------------------------------------------------------------------
r38499 | jmayer | 2011-08-12 10:26:20 -0700 (Fri, 12 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/gtkvumeter.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/rtp_player.c

Replace almost all occurances of GTK_OBJECT by G_OBJECT.
The remaining uses are inside calls to functions that are deprecated
in gtk3.

------------------------------------------------------------------------
r38498 | etxrab | 2011-08-12 06:48:32 -0700 (Fri, 12 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Fix a typo
------------------------------------------------------------------------
r38497 | etxrab | 2011-08-12 06:30:10 -0700 (Fri, 12 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/rtp_analysis.c

- Use cairo_surface_t
- rename variables refering to the surface.
------------------------------------------------------------------------
r38496 | etxrab | 2011-08-12 06:04:47 -0700 (Fri, 12 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c

- Use cairo_surface_t
- rename variables refering to the surface.
------------------------------------------------------------------------
r38495 | etxrab | 2011-08-12 05:32:18 -0700 (Fri, 12 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/graph_analysis.h

- Use cairo_surface_t
- rename variables refering to the surface.
------------------------------------------------------------------------
r38494 | jmayer | 2011-08-12 03:48:04 -0700 (Fri, 12 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

Update status again, the result for GDK_DISABLE_DEPRECATE is
close, thanks to Anders' work.

------------------------------------------------------------------------
r38493 | etxrab | 2011-08-12 02:11:16 -0700 (Fri, 12 Aug 2011) | 5 lines
Changed paths:
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/sctp_stat.h

SCTP graphs:
- Use cairo_surface_t
- rename variables refering to the surface.
IOgraph
- rename variables refering to the surface.
------------------------------------------------------------------------
r38492 | morriss | 2011-08-11 14:59:02 -0700 (Thu, 11 Aug 2011) | 19 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

From Anish Bhatt via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6113 :

The standard iscsi dissector only recognizes iscsi traffic to and from port
3260 as specified. However, it doesn't understand traffic in MPIO/MCS
connections where the iscsi target runs on a range of ports (3260-3270 for
eg.); or rather it will ignore all iscsi traffic not on the specified port.

Attached patch adds ability to recognize iscsi traffic over a range of ports.
Default range is set to 3260-3260, so it behaves exactly like the current
dissector.


From me:

Don't surround a bunch of code in proto_register_iscsi() with braces just to
allow a new variable to be declared (without incurring the wrath of
non-C99-compliant compilers): just declare the variable at the top of the
function.

------------------------------------------------------------------------
r38491 | morriss | 2011-08-11 14:42:37 -0700 (Thu, 11 Aug 2011) | 13 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

From Hanspeter via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6229 :

If an EnhancedPacketBlock in a pcapng file contains a comment option the
content isn't displayed. Instead "Malformed packet" is displayed with the
reason Exception occurred.

The reason for the problem is a bug in the pcapng.c, where for enhanced packet
blocks, interface description blocks and interface statistics blocks the wrong
union members are used to set the comment. This way required fields in the
structures are overwritten.

The attached patch solves the problem.

------------------------------------------------------------------------
r38490 | etxrab | 2011-08-11 13:49:07 -0700 (Thu, 11 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/io_stat.c

Remove remaining GDK deprecated functons.
(Use cairo_surface_t).
------------------------------------------------------------------------
r38489 | guy | 2011-08-11 10:46:02 -0700 (Thu, 11 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-frsrpc.c

Leading white space in the field descriptive name is not allowed.

------------------------------------------------------------------------
r38488 | tuexen | 2011-08-11 10:10:30 -0700 (Thu, 11 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.h

Whitespace changes.

------------------------------------------------------------------------
r38487 | gerald | 2011-08-11 09:38:45 -0700 (Thu, 11 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

From Dirk Jagdmann: Protect the RTS info column.

------------------------------------------------------------------------
r38486 | etxrab | 2011-08-11 08:51:41 -0700 (Thu, 11 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-text-media.c

Check if the embedded text is xml, if it is call the xml dissector.
------------------------------------------------------------------------
r38485 | morriss | 2011-08-11 06:45:42 -0700 (Thu, 11 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_tvb.c

Clarify that Tvb_reported_length_remaining may return -1
------------------------------------------------------------------------
r38484 | tuexen | 2011-08-11 05:58:37 -0700 (Thu, 11 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix some warnings reported by Bill.


------------------------------------------------------------------------
r38483 | tuexen | 2011-08-11 05:30:03 -0700 (Thu, 11 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix another issues related to the activity of the start button
in the capture options dialog.

------------------------------------------------------------------------
r38482 | tuexen | 2011-08-11 05:06:35 -0700 (Thu, 11 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix a bug where the Start button of the capture options dialog
box was not activated when it should an vice versa.
Reported by Stig.

------------------------------------------------------------------------
r38481 | etxrab | 2011-08-11 04:35:37 -0700 (Thu, 11 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Remove unused variables.
------------------------------------------------------------------------
r38480 | tuexen | 2011-08-11 03:55:30 -0700 (Thu, 11 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix a bug which show up when enabling the snaplen.

------------------------------------------------------------------------
r38479 | etxrab | 2011-08-11 03:00:52 -0700 (Thu, 11 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Get rid of no longer neded GdkGC:s
------------------------------------------------------------------------
r38478 | etxrab | 2011-08-11 02:25:37 -0700 (Thu, 11 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dhcpv6.c

from Joe McEachern:
patch for DHCPv6 DS-Lite AFTR Option RFC 6334

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6222
------------------------------------------------------------------------
r38477 | etxrab | 2011-08-11 01:59:43 -0700 (Thu, 11 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Use Cairo in more places.
The #if 0 code in draw_element_arc() currently crashes
and the arc coordinates should be fixed to work with Cairo, any help apreciated :-)
------------------------------------------------------------------------
r38476 | sahlberg | 2011-08-11 01:17:21 -0700 (Thu, 11 Aug 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-frsrpc.c
   M /trunk/epan/dissectors/packet-dcerpc-frsrpc.h

Regenerate a new updated FRSRPC dissector.
This dissectors now dissects a whole lot more of the FRS protocol.



------------------------------------------------------------------------
r38475 | sahlberg | 2011-08-11 01:14:23 -0700 (Thu, 11 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dcerpc-misc.h
   M /trunk/epan/dissectors/pidl/Makefile.am

Generate the MISC definitions for dcerpc and include the header file in the build


------------------------------------------------------------------------
r38474 | sahlberg | 2011-08-11 00:59:12 -0700 (Thu, 11 Aug 2011) | 6 lines
Changed paths:
   A /trunk/epan/dissectors/pidl/misc.idl

From Matthieu Patou <mat@matws.net>

Add a new misc.idl interface to host some definiteions to share across 
multiple interfaces


------------------------------------------------------------------------
r38473 | sahlberg | 2011-08-11 00:57:00 -0700 (Thu, 11 Aug 2011) | 6 lines
Changed paths:
   A /trunk/epan/dissectors/pidl/frsrpc.cnf
   A /trunk/epan/dissectors/pidl/frsrpc.idl

From  Matthieu Patou <mat@matws.net>

Add significantly improved FRSRPC definition and CNF file
Do not compile/regenerate the dissector just yet. More patches needed first


------------------------------------------------------------------------
r38472 | sahlberg | 2011-08-11 00:48:02 -0700 (Thu, 11 Aug 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.h

From Matthieu Patou <mat@matws.net>

Add new helper function for DCE/RPC NDR data blobs


------------------------------------------------------------------------
r38471 | sahlberg | 2011-08-11 00:42:25 -0700 (Thu, 11 Aug 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.h

From Matthieu Patou <mat@matws.net>

Add two helper functions to dissect null terminated ascii and wchar strings in dcerpc



------------------------------------------------------------------------
r38470 | sahlberg | 2011-08-10 23:12:39 -0700 (Wed, 10 Aug 2011) | 3 lines
Changed paths:
   M /trunk/tools/pidl/idl.yp
   M /trunk/tools/pidl/lib/Parse/Pidl/Expr.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/IDL.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/ClientNDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/ServerNDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/Header.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Client.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Parser.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Server.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/Python.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Typelist.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Wireshark/NDR.pm

Sync up to the latest PIDL with Mathieu's wireshark patches


------------------------------------------------------------------------
r38469 | wmeier | 2011-08-10 20:10:11 -0700 (Wed, 10 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dtd_parse.l

Replace use of deprecated g_strdown() by g_ascii_strdown();

Found when compiling with -DG_DISABLE_DEPRECATED

------------------------------------------------------------------------
r38468 | guy | 2011-08-10 19:41:39 -0700 (Wed, 10 Aug 2011) | 8 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/docbook/Makefile.nmake

Add "distclean" and "maintainer-clean" rules to the docbook directory
Makefile.nmake.

Have "clean", "distclean", and "maintainer-clean" in the top-level
Makefile.nmake file clean out the docbook directory.

Add a "docbook" target to the top-level Makefile.nmake file.

------------------------------------------------------------------------
r38467 | wmeier | 2011-08-10 19:14:20 -0700 (Wed, 10 Aug 2011) | 5 lines
Changed paths:
   M /trunk/configure.in

Use  '-D_FORTIFY_SOURCE=2' when compiling with GCC or CLang.

For info see: http://gcc.gnu.org/ml/gcc-patches/2004-09/msg02055.html


------------------------------------------------------------------------
r38466 | wmeier | 2011-08-10 19:08:30 -0700 (Wed, 10 Aug 2011) | 4 lines
Changed paths:
   M /trunk/configure.in

Add -DG_DISABLE_SINGLE_INCLUDES to CFLAGS
Also: Move the addition of -DG_DISABLE_DEPRECATED to CFLAGS
      so that it actually takes effect.

------------------------------------------------------------------------
r38465 | morriss | 2011-08-10 18:11:37 -0700 (Wed, 10 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/plugins.c

Define plugins_dump_all() even when we do not HAVE_PLUGINS.
------------------------------------------------------------------------
r38464 | morriss | 2011-08-10 17:49:43 -0700 (Wed, 10 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/wslua/wslua_tvb.c

From Alexander Stein via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6175 :

The attached patch adds the method reported_length_remaining to tvb.

------------------------------------------------------------------------
r38463 | wmeier | 2011-08-10 15:49:50 -0700 (Wed, 10 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/follow_stream.c

Reformat two long lines....

------------------------------------------------------------------------
r38462 | wmeier | 2011-08-10 15:44:16 -0700 (Wed, 10 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/follow_stream.c

(Trivial) Whitespace cleanup.

------------------------------------------------------------------------
r38461 | morriss | 2011-08-10 14:45:53 -0700 (Wed, 10 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/wslua/wslua_tvb.c

Add a Tvb_reported_len Lua API; this may help satisfy bug 6175.
------------------------------------------------------------------------
r38460 | morriss | 2011-08-10 14:27:55 -0700 (Wed, 10 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-coap.c

strlen returns a size_t
------------------------------------------------------------------------
r38459 | morriss | 2011-08-10 13:54:44 -0700 (Wed, 10 Aug 2011) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-coap.c

From Shoichi Sakane  via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5270 :

Update COAP dissector to the latest drafts:
- corresponded to coap-07, block-04, observe-02 and link-format-06.
- improved the option handler.

From me:
Update the comment to indicate that the port is now IANA-assigned.

There's no need to memset a string to initialize it; just set the first byte
to 0.

------------------------------------------------------------------------
r38458 | tuexen | 2011-08-10 13:30:34 -0700 (Wed, 10 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Use only one line for the headers in the capture options dialog box.
Improvement suggested by Stig.

------------------------------------------------------------------------
r38457 | gerald | 2011-08-10 13:02:31 -0700 (Wed, 10 Aug 2011) | 1 line
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/packaging/u3/tools/Makefile.nmake

Add some distclean / clean targets.
------------------------------------------------------------------------
r38456 | tuexen | 2011-08-10 12:49:41 -0700 (Wed, 10 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Use appropriate tooltip text for the OK button on the Edit Interface Settings dialog box.
Thanks to Stig for reporting the bug.

------------------------------------------------------------------------
r38455 | tuexen | 2011-08-10 12:13:48 -0700 (Wed, 10 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix CID 1255.

------------------------------------------------------------------------
r38454 | tuexen | 2011-08-10 12:05:15 -0700 (Wed, 10 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix CID 1250.

------------------------------------------------------------------------
r38453 | tuexen | 2011-08-10 10:52:44 -0700 (Wed, 10 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix CID 1253.

------------------------------------------------------------------------
r38452 | tuexen | 2011-08-10 10:49:06 -0700 (Wed, 10 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix CID 1254.

------------------------------------------------------------------------
r38451 | tuexen | 2011-08-10 10:38:10 -0700 (Wed, 10 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix CID 1256.

------------------------------------------------------------------------
r38450 | tuexen | 2011-08-10 10:31:21 -0700 (Wed, 10 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix CID 1257.
While there clean up the code a bit.

------------------------------------------------------------------------
r38449 | wmeier | 2011-08-10 10:15:08 -0700 (Wed, 10 Aug 2011) | 2 lines
Changed paths:
   M /trunk/text2pcap.c

Test return value from fwrite(); If an error occurred then exit with a message.

------------------------------------------------------------------------
r38448 | morriss | 2011-08-10 08:52:52 -0700 (Wed, 10 Aug 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtn.c

From Johannes via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5440 :

Metadata Blocks in the bundle protocol (DTN) can contain EID references. These
are not considered by the current implementation and following blocks are
parsed wrong. The attached patch solves this bug and increment the offset as
much as needed to skip the EID references.

------------------------------------------------------------------------
r38447 | morriss | 2011-08-10 08:28:29 -0700 (Wed, 10 Aug 2011) | 9 lines
Changed paths:
   M /trunk/autogen.sh

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5737 :

Python does have a way to check its version: -V (in all versions) and
--version (in 2.5 and higher).  Use the former, at least until we require a
version greater than 2.5.

This will make it easier in the future if we need to check the Python version
before continuing (I could not find a minimum version that we need).

------------------------------------------------------------------------
r38446 | etxrab | 2011-08-10 07:47:52 -0700 (Wed, 10 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

More Cairo conversion.
------------------------------------------------------------------------
r38445 | stig | 2011-08-10 01:00:01 -0700 (Wed, 10 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/filter_autocomplete.c

Simplified previous enter-fix.
------------------------------------------------------------------------
r38444 | stig | 2011-08-10 00:39:18 -0700 (Wed, 10 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/filter_autocomplete.c

Apply filter if pressing enter when having a auto completion window
and nothing is selected.

This fixes bug 6228.
------------------------------------------------------------------------
r38443 | etxrab | 2011-08-09 22:25:34 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Use Cairo for drawing in more places.
------------------------------------------------------------------------
r38442 | etxrab | 2011-08-09 21:53:21 -0700 (Tue, 09 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c

 Remove duplicate line-of-code.
(Copy change to rtp_analysis)
------------------------------------------------------------------------
r38441 | wmeier | 2011-08-09 21:42:42 -0700 (Tue, 09 Aug 2011) | 7 lines
Changed paths:
   M /trunk/gtk/prefs_dlg.c

Update a comment about hack used to prevent gcc "unused_result" warning for strtoul() call.

Specifically: The following hack prevents a gcc "unused_result" warning and
is not flagged (currently) by either Coverity or CLang.
   if (strtoul(...){}


------------------------------------------------------------------------
r38440 | wmeier | 2011-08-09 19:01:49 -0700 (Tue, 09 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c

Test fwrite() return values to see if a write error.
Fixes Bug #6227.

------------------------------------------------------------------------
r38439 | wmeier | 2011-08-09 16:45:54 -0700 (Tue, 09 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c

Remove duplicate line-of-code.

------------------------------------------------------------------------
r38438 | jmayer | 2011-08-09 14:26:33 -0700 (Tue, 09 Aug 2011) | 2 lines
Changed paths:
   M /trunk/ConfigureChecks.cmake
   M /trunk/cmakeconfig.h.in

Copy over the commit 38437 to cmake.

------------------------------------------------------------------------
r38437 | morriss | 2011-08-09 14:02:10 -0700 (Tue, 09 Aug 2011) | 12 lines
Changed paths:
   M /trunk/capinfos.c
   M /trunk/configure.in
   M /trunk/dumpcap.c
   M /trunk/editcap.c
   M /trunk/gtk/main.c
   M /trunk/mergecap.c
   M /trunk/randpkt.c
   M /trunk/rawshark.c
   M /trunk/text2pcap.c
   M /trunk/tshark.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5608 :

getopt() can/should normally be found in unistd.h, so:

- When testing for getopt(), define that we HAVE_GETOPT instead of
  HAVE_GETOPT_H (to avoid confusion).
- Don't attempt to include getopt.h: not all OS's have it (for example,
  Solaris 9 does not).
- (All the places which need getopt already include unistd.h (if we have it).)

If this breaks things on some OS, we might need (a real) HAVE_GETOPT_H check.

------------------------------------------------------------------------
r38436 | etxrab | 2011-08-09 13:42:06 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-hdfsdata.c

Add a cast.
------------------------------------------------------------------------
r38435 | etxrab | 2011-08-09 13:38:41 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Use Cairo for drawing in more places.
------------------------------------------------------------------------
r38434 | morriss | 2011-08-09 12:49:08 -0700 (Tue, 09 Aug 2011) | 7 lines
Changed paths:
   M /trunk/acinclude.m4

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5607 :

When testing if we can add things to LDFLAGS, don't set LDFLAGS to CFLAGS
if the test determines that the flag cannot be added to LDFLAGS.

(Simple typo: LDFLAGS_saved was being set to CFLAGS instead of LDFLAGS.)

------------------------------------------------------------------------
r38433 | etxrab | 2011-08-09 11:29:19 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Start using Cairo for drawing.
------------------------------------------------------------------------
r38432 | alagoutte | 2011-08-09 09:38:15 -0700 (Tue, 09 Aug 2011) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-hdfsdata.c

From Allison via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6157
Add Dissector for HDFS Data

------------------------------------------------------------------------
r38431 | alagoutte | 2011-08-09 09:34:04 -0700 (Tue, 09 Aug 2011) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-hdfs.c

From Allison via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6156
Add Dissector for HDFS

------------------------------------------------------------------------
r38430 | morriss | 2011-08-09 08:43:42 -0700 (Tue, 09 Aug 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

Fix the fuzz failure reported in
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6139 :

Properly initialize the CSN_DESCR type before recursively calling
csnStreamDissector().

------------------------------------------------------------------------
r38429 | etxrab | 2011-08-09 07:53:20 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Get rid of deprecated gdk_pixmap_create_from_xpm_d().
------------------------------------------------------------------------
r38428 | alagoutte | 2011-08-09 07:42:33 -0700 (Tue, 09 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6220
DVB-CI dissector: fix buildbot warnings

------------------------------------------------------------------------
r38427 | etxrab | 2011-08-09 07:36:00 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Remove no longer used include.
------------------------------------------------------------------------
r38426 | etxrab | 2011-08-09 07:32:41 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/graph_analysis.h

Use cairo for the background colors, invert text color when selected.
------------------------------------------------------------------------
r38425 | etxrab | 2011-08-09 06:08:20 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Use Cairo for the column headers.
------------------------------------------------------------------------
r38424 | etxrab | 2011-08-09 05:17:06 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Use cairo in a couple of more places.
------------------------------------------------------------------------
r38423 | martinm | 2011-08-09 02:00:00 -0700 (Tue, 09 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

'color_div_line' is not being used.

------------------------------------------------------------------------
r38422 | etxrab | 2011-08-09 01:15:04 -0700 (Tue, 09 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/graph_analysis.h

Use cairo in a couple of more places.
------------------------------------------------------------------------
r38421 | kukosa | 2011-08-09 01:00:06 -0700 (Tue, 09 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lte-rrc.c
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-per.h
   M /trunk/epan/libwireshark.def
   M /trunk/tools/asn2wrs.py

Support for Extension Addition Group in PER encoding
Fix for bug 6196 https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6199
------------------------------------------------------------------------
r38420 | jmayer | 2011-08-08 13:35:36 -0700 (Mon, 08 Aug 2011) | 6 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/configure.in
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/menus.c
   M /trunk/gtk/proto_help.c

MAIN_MENU_USE_UIMANAGER is also used in some includes, not only
in .c files, so the aproach to #undef GTK_DISABLE_DEPRECATED was
wrong.
Only enable GTK_DISABLE_DEPRECATED if MAIN_MENU_USE_UIMANAGER is
defined.

------------------------------------------------------------------------
r38419 | cmaynard | 2011-08-08 13:34:18 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sflow.c

From Andrew Feren via bug 6219: Offset calculated incorrectly for sFlow extended data.

------------------------------------------------------------------------
r38418 | cmaynard | 2011-08-08 13:16:45 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xtp.c

Fix Coverity CID 1242: Pointer "ti" returned by proto_tree_add_uint64() is never used.

------------------------------------------------------------------------
r38417 | cmaynard | 2011-08-08 13:08:24 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-usb.c

No need to check that usb_trans_info is not NULL here.  The only way it could have been NULL is if se_alloc0() returned NULL, but then it would have already been dereferenced before now.  Fixes Coverity CID 612, "REVERSE INULL".

------------------------------------------------------------------------
r38416 | cmaynard | 2011-08-08 12:27:14 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tftp.c

Fix Coverity CID 1062: Pointer "ti" returned by proto_tree_add_item() is never used.

------------------------------------------------------------------------
r38415 | wmeier | 2011-08-08 12:20:07 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/proto_dlg.c
   M /trunk/gtk/supported_protos_dlg.c

Remove 2 usages of deprecated gtk_quit_add_destroy() which, AFAIKT, weren't needed.

------------------------------------------------------------------------
r38414 | gerald | 2011-08-08 12:10:19 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/wslua/template-init.lua

Load console.lua and dtd-gen.lua from an explicit path.

------------------------------------------------------------------------
r38413 | wmeier | 2011-08-08 10:59:32 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-actrace.c
   M /trunk/epan/dissectors/packet-adwin-config.c
   M /trunk/epan/dissectors/packet-adwin.c
   M /trunk/epan/dissectors/packet-amqp.c
   M /trunk/epan/dissectors/packet-amr.c
   M /trunk/epan/dissectors/packet-ans.c
   M /trunk/epan/dissectors/packet-btobex.c
   M /trunk/epan/dissectors/packet-btrfcomm.c
   M /trunk/epan/dissectors/packet-btsdp.c
   M /trunk/epan/dissectors/packet-catapult-dct2000.c
   M /trunk/epan/dissectors/packet-csm-encaps.c
   M /trunk/epan/dissectors/packet-ctdb.c
   M /trunk/epan/dissectors/packet-diameter_3gpp.c
   M /trunk/epan/dissectors/packet-dpnss-link.c
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/dissectors/packet-h264.c
   M /trunk/epan/dissectors/packet-homeplug.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-ismacryp.c
   M /trunk/epan/dissectors/packet-iuup.c
   M /trunk/epan/dissectors/packet-lge_monitor.c
   M /trunk/epan/dissectors/packet-lmp.c
   M /trunk/epan/dissectors/packet-mdshdr.c
   M /trunk/epan/dissectors/packet-mgcp.c
   M /trunk/epan/dissectors/packet-mp4ves.c
   M /trunk/epan/dissectors/packet-opensafety.c
   M /trunk/epan/dissectors/packet-pana.c
   M /trunk/epan/dissectors/packet-pgm.c
   M /trunk/epan/dissectors/packet-q708.c
   M /trunk/epan/dissectors/packet-redback.c
   M /trunk/epan/dissectors/packet-rohc.c
   M /trunk/epan/dissectors/packet-roofnet.c
   M /trunk/epan/dissectors/packet-rsl.c
   M /trunk/epan/dissectors/packet-rsvp.c
   M /trunk/epan/dissectors/packet-slsk.c
   M /trunk/epan/dissectors/packet-tte.c
   M /trunk/epan/dissectors/packet-zbee-nwk.c

Remove unneeded #includes: proto.h,tvbuff.h,value_string.h,stdlib.h,...

------------------------------------------------------------------------
r38412 | cmaynard | 2011-08-08 10:47:05 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   M /trunk/tools/checkfiltername.pl

Fix SVN Id.

------------------------------------------------------------------------
r38411 | cmaynard | 2011-08-08 10:42:26 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   A /trunk/tools/checkfiltername.pl

From Michael Mann via bug 2794: A Perl script to expose "questionable" display filter field names.

------------------------------------------------------------------------
r38410 | gerald | 2011-08-08 10:25:35 -0700 (Mon, 08 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/packet.c

Make sure our root tvb is initialized in case its creation fails.
Untested fix for bug 6135.

------------------------------------------------------------------------
r38409 | wmeier | 2011-08-08 08:41:09 -0700 (Mon, 08 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-acn.c
   M /trunk/epan/dissectors/packet-amqp.c
   M /trunk/epan/dissectors/packet-ansi_801.c
   M /trunk/epan/dissectors/packet-epl_v1.c
   M /trunk/epan/dissectors/packet-fmp_notify.c
   M /trunk/epan/dissectors/packet-ieee802154.c
   M /trunk/epan/dissectors/packet-lldp.c
   M /trunk/epan/dissectors/packet-msnlb.c
   M /trunk/epan/dissectors/packet-paltalk.c
   M /trunk/epan/dissectors/packet-s5066.c
   M /trunk/epan/dissectors/packet-srp.c
   M /trunk/epan/dissectors/packet-zbee-nwk.c
   M /trunk/epan/dissectors/packet-zbee-zdp-binding.c
   M /trunk/epan/dissectors/packet-zbee-zdp-discovery.c
   M /trunk/epan/dissectors/packet-zbee-zdp.c
   M /trunk/epan/dissectors/packet-zep.c

Dissectors don't need to #include <gmodule.h>
Also: #include <stdlib.h> not req'd in some cases.

------------------------------------------------------------------------
r38408 | cmaynard | 2011-08-08 08:27:59 -0700 (Mon, 08 Aug 2011) | 3 lines
Changed paths:
   M /trunk/doc/wireshark.pod.template
   M /trunk/gtk/prefs_gui.c

From Jim Young via bug 3196: Add preference for displaying expert infos LEDs.
Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3196

------------------------------------------------------------------------
r38407 | etxrab | 2011-08-08 07:57:11 -0700 (Mon, 08 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/sctp_graph_dlg.c

Use GTK's G_PI
------------------------------------------------------------------------
r38406 | jmayer | 2011-08-08 07:06:12 -0700 (Mon, 08 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/proto_help.c

Proto help also doesn't like GTK_DISABLE_DEPRECATED


------------------------------------------------------------------------
r38405 | jmayer | 2011-08-08 07:03:53 -0700 (Mon, 08 Aug 2011) | 3 lines
Changed paths:
   M /trunk/config.nmake

Looks like the Windows code isn't as clean as the Unix path:
Comment out GTK_DISABLE_DEPRECATED

------------------------------------------------------------------------
r38404 | jmayer | 2011-08-08 06:39:21 -0700 (Mon, 08 Aug 2011) | 7 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/configure.in
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/STATUS.gtk3
   M /trunk/gtk/menus.c

GTK3 stuff:
- Update Status file
- configure.in: start GSEALing with 2.20 and not 2.22
- configure.in/config.nmake/CMakeLists.txt: enable GTK_DISABLE_SINGLE_INCLUDE
    and GTK_DISABLE_DEPRECATED
- menus.c: If not building with UI_MANAGER, disable GTK_DISABLE_DEPRECATED

------------------------------------------------------------------------
r38403 | jmayer | 2011-08-08 02:39:30 -0700 (Mon, 08 Aug 2011) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate.h

Add a comment about the uncommented glib deprecated warnings.

------------------------------------------------------------------------
r38402 | etxrab | 2011-08-08 01:55:42 -0700 (Mon, 08 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/expert_comp_table.c
   M /trunk/gtk/follow_ssl.c
   M /trunk/gtk/follow_tcp.c
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/main_toolbar.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c

Don't include color.h
------------------------------------------------------------------------
r38401 | etxrab | 2011-08-07 23:08:27 -0700 (Sun, 07 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/main.c

Include Cairo and Pango version in "compiled with"
------------------------------------------------------------------------
r38400 | etxrab | 2011-08-07 23:01:58 -0700 (Sun, 07 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

#include "../color.h" not needed.
------------------------------------------------------------------------
r38399 | cmaynard | 2011-08-07 13:50:31 -0700 (Sun, 07 Aug 2011) | 3 lines
Changed paths:
   M /trunk/asn1/h225/h225.cnf
   M /trunk/epan/dissectors/packet-h225.c

Fix bug 5848, "https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5848", which was apparently introduced with r27287 (http://anonsvn.wireshark.org/viewvc/trunk/epan/dissectors/packet-h225.c?r1=26698&r2=27287).  Regenerate the packet-h225.c dissector.  Patch from ericn1234@yahoo.com.
Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5848

------------------------------------------------------------------------
r38398 | stig | 2011-08-07 13:18:51 -0700 (Sun, 07 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/gcp.c

Untabify.
------------------------------------------------------------------------
r38397 | etxrab | 2011-08-07 13:08:08 -0700 (Sun, 07 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/gcp.c

g_ascii_strdown Returns a newly-allocated string.
------------------------------------------------------------------------
r38396 | etxrab | 2011-08-07 12:58:13 -0700 (Sun, 07 Aug 2011) | 1 line
Changed paths:
   M /trunk/config.nmake
   M /trunk/epan/dtd_grammar.lemon


------------------------------------------------------------------------
r38395 | etxrab | 2011-08-07 12:15:17 -0700 (Sun, 07 Aug 2011) | 6 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/epan/dtd_grammar.lemon

Revert previous commit.
(Note to self read the description first)

"Returns :
 
a newly-allocated string, with all the upper case characters in str converted to lower case, with semantics that exactly match g_ascii_tolower(). (Note that this is unlike the old g_strdown(), which modified the string in place.)"
------------------------------------------------------------------------
r38394 | etxrab | 2011-08-07 12:08:41 -0700 (Sun, 07 Aug 2011) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/epan/dtd_grammar.lemon

 Replace deprecated glib functions.
set DG_DISABLE_DEPRECATED for windows build.
------------------------------------------------------------------------
r38393 | jmayer | 2011-08-07 11:35:36 -0700 (Sun, 07 Aug 2011) | 11 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/configure.in
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_grammar.lemon
   M /trunk/plugins/mate/mate_parser.l

mate_grammar.lemon:
- Fix a bug my previous patch introduced.

mate/:
- Unset G_DISABLE_DEPRECATED for the mate files.

CMakeLists.txt
configure.in:
- Build with -DG_DISABLE_DEPRECATED so further usage of
  deprecated glib functions will be detected.

------------------------------------------------------------------------
r38392 | jmayer | 2011-08-07 11:15:45 -0700 (Sun, 07 Aug 2011) | 5 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/epan/crypt/airpdcap.c
   M /trunk/epan/radius_dict.l
   M /trunk/epan/wslua/wslua_proto.c
   M /trunk/plugins/mate/mate_grammar.lemon

Replace deprecated glib functions.
In order to compile the whole project with -DG_DISABLE_DEPRECATED
the mate plugin needs to replace its usage of GMemChunk.
All other places should be clean.

------------------------------------------------------------------------
r38390 | wmeier | 2011-08-07 08:16:35 -0700 (Sun, 07 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sbus.c

Remove some unused 'GMemChunk *' variables and se_alloc() to same.

(Found by using -DG_DISABLE_DEPRECATED when compiling dissectors).

------------------------------------------------------------------------
r38388 | tuexen | 2011-08-07 08:01:10 -0700 (Sun, 07 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Use "%" G_GINT64_MODIFIER "u" instead of G_GINT64_MODIFIER "%u".

------------------------------------------------------------------------
r38387 | cmaynard | 2011-08-07 07:49:49 -0700 (Sun, 07 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Life duration is a variable length TLV, and not always a 2 byte value.  Hopefully fixes bug 6206 (no relevant capture file available to test).
Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6206

------------------------------------------------------------------------
r38386 | wmeier | 2011-08-07 07:36:19 -0700 (Sun, 07 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38385 | cmaynard | 2011-08-07 07:07:52 -0700 (Sun, 07 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/expert_comp_table.c

Expand summary column.  Fixed bug 6209.
Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6209

------------------------------------------------------------------------
r38384 | gerald | 2011-08-07 07:03:28 -0700 (Sun, 07 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/manuf
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-08-07]
------------------------------------------------------------------------
r38383 | guy | 2011-08-07 01:26:29 -0700 (Sun, 07 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

If you have a loop that iterates over packet contents, you absolutely
must not just do a "continue" if the offset into the packet has not been
advanced, as you will get an infinite loop if you do.

------------------------------------------------------------------------
r38382 | guy | 2011-08-06 12:12:31 -0700 (Sat, 06 Aug 2011) | 5 lines
Changed paths:
   M /trunk/cmakeconfig.h.in

Get rid of HAVE_PCAP_SET_BUFFER_SIZE - nobody checks for
pcap_set_buffer_size() (if *pcap has pcap_create() it has
pcap_set_buffer_size(), as they were both introduced in libpcap 1.0.0),
and nobody looks at HAVE_PCAP_SET_BUFFER_SIZE.

------------------------------------------------------------------------
r38381 | guy | 2011-08-06 12:10:25 -0700 (Sat, 06 Aug 2011) | 4 lines
Changed paths:
   M /trunk/ConfigureChecks.cmake

Set svn:keywords and svn:eol-style.  Fix the EOL style.

Add the copyright comment and give it an SVN ID.

------------------------------------------------------------------------
r38380 | guy | 2011-08-06 11:36:46 -0700 (Sat, 06 Aug 2011) | 4 lines
Changed paths:
   M /trunk/config.h.win32

Move the *pcap stuff together.  Add an item for
HAVE_PCAP_GET_SELECTABLE_FD to make it clear that it is never defined on
Windows.

------------------------------------------------------------------------
r38379 | jmayer | 2011-08-06 08:39:50 -0700 (Sat, 06 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

- Resolve a GTK_CHECK_VERSION(2,6,0) check. It's always true.
- Fix defined but not used warnings (turned errors) by surrounding
  the code with HAVE_PCAP_REMOTE_NEVERTRUE. Let's see what breaks.

------------------------------------------------------------------------
r38378 | cmaynard | 2011-08-06 08:05:08 -0700 (Sat, 06 Aug 2011) | 2 lines
Changed paths:
   M /trunk/tools/make-manuf

Update cavebear link.

------------------------------------------------------------------------
r38377 | tuexen | 2011-08-06 06:22:51 -0700 (Sat, 06 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Some whitespace cleanups.

------------------------------------------------------------------------
r38376 | tuexen | 2011-08-06 05:40:19 -0700 (Sat, 06 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Take out unused functions as reported by Joerg.

------------------------------------------------------------------------
r38375 | tuexen | 2011-08-06 05:34:15 -0700 (Sat, 06 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

This should fix the "else without previous if" error reported by Joerg.

------------------------------------------------------------------------
r38374 | jmayer | 2011-08-06 02:16:00 -0700 (Sat, 06 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Whitespace fixes:
- Remove trailing whitespace
- Remove leading space then tab

------------------------------------------------------------------------
r38373 | stig | 2011-08-05 14:56:31 -0700 (Fri, 05 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/capture_dlg.c

Set the activate signal for the capture filter to the ok button.
------------------------------------------------------------------------
r38372 | gerald | 2011-08-05 11:52:53 -0700 (Fri, 05 Aug 2011) | 4 lines
Changed paths:
   M /trunk/cmake/modules/FindGTK2.cmake
   M /trunk/cmake/modules/FindPCAP.cmake

FindGTK2: Add a check for pangocairo. It has to be linked explicitly, at
least for MacPorts.
FindPCAP: Define HAVE_PCAP_CREATE if we have pcap_create.

------------------------------------------------------------------------
r38371 | cmaynard | 2011-08-05 11:10:05 -0700 (Fri, 05 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/libwireshark.def

From John Thacker via bug 1831: Export proto_tree_set_appendix.
Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=1831

------------------------------------------------------------------------
r38370 | tuexen | 2011-08-05 10:58:06 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Try to make the clang buildbot happy...

------------------------------------------------------------------------
r38369 | tuexen | 2011-08-05 10:41:31 -0700 (Fri, 05 Aug 2011) | 6 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Use the fix from Joerg to get the airpcap icon also for remote
interface.
This is a misuse of the icon, but we don't have an icon
for remote interfaces yet and I'm the wrong one for
creating one...

------------------------------------------------------------------------
r38368 | tuexen | 2011-08-05 10:33:47 -0700 (Fri, 05 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Fix the compile issue reported by Joerg.
This does not fix the icon issue.

------------------------------------------------------------------------
r38367 | tuexen | 2011-08-05 09:37:17 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Try to make the Mac OS X PPC builder happy.

------------------------------------------------------------------------
r38366 | jmayer | 2011-08-05 08:43:28 -0700 (Fri, 05 Aug 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pflog.c

Make buildbot OSX-10.5-x86 happy:
Work around a spurius warning where gcc was unable to find out that two variables
would only be used initialized.



------------------------------------------------------------------------
r38365 | martinm | 2011-08-05 07:40:47 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Show in info line if predefined contents lines are truncated.

------------------------------------------------------------------------
r38364 | alagoutte | 2011-08-05 07:33:53 -0700 (Fri, 05 Aug 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-pflog.c
   D /trunk/epan/dissectors/packet-pflog.h

Update pflog dissector via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6115
* Update pflog dissector to the last header format (OpenBSD 4.9)
* Dissect all new field (uid, pid, saddr, daddr...)
* Replace proto_tree_add_xxx(uint/string...) by proto_tree_add_item
* Remove not needed packet-pflog.h file

------------------------------------------------------------------------
r38363 | tuexen | 2011-08-05 06:17:41 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix one instance of strdup() -> g_strdup().

------------------------------------------------------------------------
r38362 | tuexen | 2011-08-05 06:11:11 -0700 (Fri, 05 Aug 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Try to make the Mac OS PPC builder happy.


------------------------------------------------------------------------
r38361 | jmayer | 2011-08-05 05:25:54 -0700 (Fri, 05 Aug 2011) | 3 lines
Changed paths:
   M /trunk/cmake/modules/FindGLIB2.cmake

Add call to FindPackageHandleStandardArgs


------------------------------------------------------------------------
r38360 | jmayer | 2011-08-05 05:21:46 -0700 (Fri, 05 Aug 2011) | 1 line
Changed paths:
   M /trunk/cmake/modules/FindGLIB2.cmake
   M /trunk/wsutil/CMakeLists.txt

Attempt to properly fix the missing path information for glib libraries
------------------------------------------------------------------------
r38359 | jmayer | 2011-08-05 04:10:26 -0700 (Fri, 05 Aug 2011) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt

We can always add ${GTHREAD2_LIBRARIES} - this variable will be empty
if not building with the gthread library.

------------------------------------------------------------------------
r38358 | jmayer | 2011-08-05 03:43:03 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix typo

------------------------------------------------------------------------
r38357 | jmayer | 2011-08-05 03:40:45 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/tools/checkAPIs.pl

Using gtk_tree_view_column_get_cell_renderers is an error now.

------------------------------------------------------------------------
r38356 | jmayer | 2011-08-05 03:38:58 -0700 (Fri, 05 Aug 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/new_packet_list.c

Replace the deprecated call to gtk_tree_view_column_get_cell_renderers by
gtk_cell_layout_get_cells, which is available since 2.12 (according to docs)
and not 2.18 as one guard indicated.

------------------------------------------------------------------------
r38355 | tuexen | 2011-08-05 03:24:36 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix API issues.

------------------------------------------------------------------------
r38354 | tuexen | 2011-08-05 03:19:26 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix the Mac OS buildbot.

------------------------------------------------------------------------
r38353 | tuexen | 2011-08-05 03:13:48 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Whitespace changes.

------------------------------------------------------------------------
r38352 | tuexen | 2011-08-05 01:26:07 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

Fix Windows build.

------------------------------------------------------------------------
r38351 | tuexen | 2011-08-05 01:11:27 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

Simplification suggested by Guy.

------------------------------------------------------------------------
r38350 | tuexen | 2011-08-05 00:19:17 -0700 (Fri, 05 Aug 2011) | 3 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture_ifinfo.c
   M /trunk/capture_ifinfo.h
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_dlg.h
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/capture_if_dlg.h
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/main_welcome.h
   M /trunk/gtk/menus.c
   M /trunk/gtk/menus.h

Add support for multiple interfaces to the capture options dialog.
Obtained from Irene Ruengeler.

------------------------------------------------------------------------
r38349 | tuexen | 2011-08-05 00:10:20 -0700 (Fri, 05 Aug 2011) | 3 lines
Changed paths:
   M /trunk/capture_sync.c

Generate the capure sync pipe correctly.
Fix obtained from Irene Ruengeler.

------------------------------------------------------------------------
r38348 | etxrab | 2011-08-05 00:02:22 -0700 (Fri, 05 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

From Lei Chen:
patch to support gsm rr decoding of Immediate Assignment rest octet
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6119
------------------------------------------------------------------------
r38347 | etxrab | 2011-08-04 22:16:37 -0700 (Thu, 04 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Typo
------------------------------------------------------------------------
r38346 | etxrab | 2011-08-04 22:13:42 -0700 (Thu, 04 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c

Free the PangoLayout.
------------------------------------------------------------------------
r38345 | gerald | 2011-08-04 17:25:02 -0700 (Thu, 04 Aug 2011) | 4 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/wsutil/CMakeLists.txt

Use GLIB2_LDFLAGS instead of GLIB2_LIBRARIES for wsutil, since it
includes the path to the libraries. Add gthread to wireshark_LIBS if
threads are enabled.

------------------------------------------------------------------------
r38344 | jmayer | 2011-08-04 15:56:36 -0700 (Thu, 04 Aug 2011) | 5 lines
Changed paths:
   M /trunk/gtk/mcast_stream_dlg.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/packet_win.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/rtp_stream_dlg.c
   M /trunk/gtk/sctp_assoc_analyse.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_chunk_stat_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/voip_calls_dlg.c

Replace almost all uses of GtkObject (which no longer exists
in GTK3) by GObject (which does).
These were the trivial cases, the two remaining uses in packet_win.c
are left for someone who understands the code.

------------------------------------------------------------------------
r38343 | jmayer | 2011-08-04 15:40:31 -0700 (Thu, 04 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/pixmap_save.c

Remove usage of GDK_DRAWABLE macro.

------------------------------------------------------------------------
r38342 | jmayer | 2011-08-04 15:38:44 -0700 (Thu, 04 Aug 2011) | 6 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

The macros GDK_DRAWABLE, GDK_IS_DRAWABLE, GTK_OBJECT are no longer
present and can probably just be removed without any ill effects or,
if there are problems, these should be solvable by using casts.



------------------------------------------------------------------------
r38341 | morriss | 2011-08-04 14:38:31 -0700 (Thu, 04 Aug 2011) | 1 line
Changed paths:
   M /trunk/configure.in

As suggested by Anders: only compile with GSEAL_ENABLE if we're using GTK 2.22 or higher (and not GTK3)
------------------------------------------------------------------------
r38340 | cmaynard | 2011-08-04 13:20:51 -0700 (Thu, 04 Aug 2011) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Don't report svn version if not building from svn.  Change prompted by http://ask.wireshark.org/questions/5376/wireshark-161-title-shows-svn-rev-unknown-from-unknown.

------------------------------------------------------------------------
r38339 | cmaynard | 2011-08-04 10:49:57 -0700 (Thu, 04 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Don't call expert_add_info_format() from within an "if (tree)" block.  Fixes bug 6198.  Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6198

------------------------------------------------------------------------
r38338 | wmeier | 2011-08-04 09:51:21 -0700 (Thu, 04 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wsp.c

Remove unneeded #includes.

------------------------------------------------------------------------
r38337 | wmeier | 2011-08-04 09:42:32 -0700 (Thu, 04 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wsp.c

Whitespace cleanup: convert mixture of "4 space" and "8 space" tabs to spaces.

------------------------------------------------------------------------
r38336 | etxrab | 2011-08-04 09:02:09 -0700 (Thu, 04 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/decode_as_dlg.c

Put src and dst ports in the option of "Both" decorate with arrows.
------------------------------------------------------------------------
r38335 | wmeier | 2011-08-04 08:59:23 -0700 (Thu, 04 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wsp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38334 | etxrab | 2011-08-04 07:41:45 -0700 (Thu, 04 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/rtp_player.c

- Get rid of some deprecated functions.
------------------------------------------------------------------------
r38333 | etxrab | 2011-08-04 04:53:50 -0700 (Thu, 04 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/decode_as_dlg.c

Change the default to "Both"
------------------------------------------------------------------------
r38332 | tuexen | 2011-08-04 04:24:15 -0700 (Thu, 04 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/Makefile.nmake

gtkvumeter.[ch] seems to be used only on Windows. So only build it there...

------------------------------------------------------------------------
r38331 | stig | 2011-08-04 03:02:37 -0700 (Thu, 04 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Removed a debug printf.
------------------------------------------------------------------------
r38330 | stig | 2011-08-04 01:54:13 -0700 (Thu, 04 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/io_stat.c

Corrected position of FBAR and DOT.
------------------------------------------------------------------------
r38329 | guy | 2011-08-03 17:04:53 -0700 (Wed, 03 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tds.c

Update some references.

------------------------------------------------------------------------
r38328 | wmeier | 2011-08-03 14:14:04 -0700 (Wed, 03 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Convert "4 space tabs" to spaces + do other whitespace cleaup.

------------------------------------------------------------------------
r38327 | wmeier | 2011-08-03 13:31:51 -0700 (Wed, 03 Aug 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Minor cleanup
[benign] Remove _U_ from param arg when param is actually used;
[benign] Use 'item' (not 'tree') arg for proto_item_append_text()
Whitespace

------------------------------------------------------------------------
r38326 | gerald | 2011-08-03 12:11:07 -0700 (Wed, 03 Aug 2011) | 15 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

From Dirk Jagdmann via bug 6194:

The attachted patch fixes and enhances the SCPS TCP option dissection. Changes
are:

- fix order of reserved Bit 1,2,3
- fix minimum TCP option length
- fix proto items
- add proto item for Connection ID
- removed the verify_scps() function. It's logic was broken, because it did
reset the scps_capable flag on both flows if one of them did not have it.
However sometimes that flag is only enabled in one flow direction and that flow
direction could see TCP options later on, which would get dissected as invalid.
See the attachted capture file for an example.

------------------------------------------------------------------------
r38325 | etxrab | 2011-08-03 11:49:35 -0700 (Wed, 03 Aug 2011) | 1 line
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c

Get rid of gdk_draw_layout().
------------------------------------------------------------------------
r38324 | cmaynard | 2011-08-03 11:45:06 -0700 (Wed, 03 Aug 2011) | 4 lines
Changed paths:
   M /trunk/epan/prefs.c
   M /trunk/epan/prefs.h
   M /trunk/gtk/expert_comp_dlg.c

From Jim Young via bug 3196: Enhancement to Expert Info Composite Tab Labels

Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3196

------------------------------------------------------------------------
r38323 | wmeier | 2011-08-03 11:38:23 -0700 (Wed, 03 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

AFAICT, the item for 'hf_gtpv2_stn_sr' should be used as the parent tree-item in dissect_gtpv2_stn_sr().
This is a different fix for Coverity 1248 than that committed in SVN 38314.  

------------------------------------------------------------------------
r38322 | martinm | 2011-08-03 10:05:30 -0700 (Wed, 03 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Fix the SR state report for when get SR following SR with no grant or failure in-between.

------------------------------------------------------------------------
r38321 | wmeier | 2011-08-03 09:06:00 -0700 (Wed, 03 Aug 2011) | 2 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38320 | sfisher | 2011-08-03 08:39:16 -0700 (Wed, 03 Aug 2011) | 6 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c


Fix compiler warning turned error:

    graph_analysis.c:1363: warning: unused parameter 'widget'


------------------------------------------------------------------------
r38319 | etxrab | 2011-08-03 08:25:57 -0700 (Wed, 03 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

Try to make the builbot happy
#	define gtk_widget_is_drawable(x) GDK_IS_DRAWABLE(x)
------------------------------------------------------------------------
r38318 | wmeier | 2011-08-03 08:24:06 -0700 (Wed, 03 Aug 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

'-Wno-error=unused-but-set-parameter' not req'd since no such warnings in Wireshark compile.

------------------------------------------------------------------------
r38317 | etxrab | 2011-08-03 07:54:03 -0700 (Wed, 03 Aug 2011) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/gtk/graph_analysis.c

- Get rid of deprecated functions.
- Include pangocairo.
------------------------------------------------------------------------
r38316 | gerald | 2011-08-02 14:23:00 -0700 (Tue, 02 Aug 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/cmakeconfig.h.in

Define PACKAGE in config.h.

------------------------------------------------------------------------
r38315 | cmaynard | 2011-08-02 13:39:53 -0700 (Tue, 02 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

Fix 45 occurrences of unused values reported under Coverity CID's 1235-1241.

------------------------------------------------------------------------
r38314 | cmaynard | 2011-08-02 12:29:51 -0700 (Tue, 02 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Fix Coverity CID 1248: unused value.

------------------------------------------------------------------------
r38313 | gerald | 2011-08-02 11:13:16 -0700 (Tue, 02 Aug 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

Add tap-hosts.c.

------------------------------------------------------------------------
r38312 | etxrab | 2011-08-02 09:47:37 -0700 (Tue, 02 Aug 2011) | 3 lines
Changed paths:
   M /trunk/asn1/ranap/packet-ranap-template.c
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-ranap.c

 Bug 6146 - Malformed RANAP packets when HandOver procedure on iuh 

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6146
------------------------------------------------------------------------
r38311 | wmeier | 2011-08-02 09:17:25 -0700 (Tue, 02 Aug 2011) | 11 lines
Changed paths:
   M /trunk/configure.in

For now: treat GCC 4.6 'unused-but-set' reports as just warnings (i.e., when -Werror).

GCC 4.6 has added 'unused but set' reports so this change allows builds to proceed without
erroring out for those building from SVN with GCC 4.6.

(AFAIK Wireshark source distributions do not enable -Werror).

This change can be removed (at least globally) once the code as been fixed.



------------------------------------------------------------------------
r38310 | etxrab | 2011-08-02 05:52:59 -0700 (Tue, 02 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c

Channel Description includes the element identifier.
------------------------------------------------------------------------
r38309 | martinm | 2011-08-02 03:35:22 -0700 (Tue, 02 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntp.c

Show version and mode in protocol root.  Now dissects details whether tree is NULL or not.

------------------------------------------------------------------------
r38307 | etxrab | 2011-08-01 22:30:59 -0700 (Mon, 01 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
openSAFETY: Cleaning up, removing multiple implementations and cleaning up code
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6180
------------------------------------------------------------------------
r38306 | etxrab | 2011-08-01 22:18:58 -0700 (Mon, 01 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

From Jeremy Jones:
Add support for decoding NFSv4.1 OP_BIND_CONN_TO_SESSION.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6182
------------------------------------------------------------------------
r38305 | etxrab | 2011-08-01 22:12:53 -0700 (Mon, 01 Aug 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI dissector, packet reassembly on the link layer.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6075
------------------------------------------------------------------------
r38304 | etxrab | 2011-08-01 21:17:45 -0700 (Mon, 01 Aug 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-snmp.c

Gnenerate the dissector for previous commit.
------------------------------------------------------------------------
r38303 | cmaynard | 2011-08-01 18:54:03 -0700 (Mon, 01 Aug 2011) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/asn1/snmp/packet-snmp-template.c

From Paul Stath via bug 5731:  The check for engineID length should only occur if the engineID has a non-zero length.

Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5731

------------------------------------------------------------------------
r38302 | sfisher | 2011-08-01 09:56:45 -0700 (Mon, 01 Aug 2011) | 5 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3


Update documentation to reflect configure option being "--with-gtk3" not
"--enable-gtk3"


------------------------------------------------------------------------
r38301 | jmayer | 2011-08-01 07:48:19 -0700 (Mon, 01 Aug 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def

Add tvb_get_bits

------------------------------------------------------------------------
r38300 | tuexen | 2011-08-01 07:34:16 -0700 (Mon, 01 Aug 2011) | 2 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

gtk_widget_get_sensitive() seems to be available on gtk 2.18

------------------------------------------------------------------------
r38299 | stig | 2011-08-01 05:38:58 -0700 (Mon, 01 Aug 2011) | 4 lines
Changed paths:
   M /trunk/config.h.win32
   M /trunk/epan/except.c
   M /trunk/gtk/main.c

Another fix for building with MSVC2005.

The previous fixes in r37728 and r37730 did build a wireshark which was
unable to use the native windows file dialog (GetOpenFileName).
------------------------------------------------------------------------
r38298 | wmeier | 2011-07-31 18:09:04 -0700 (Sun, 31 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warning.

------------------------------------------------------------------------
r38297 | wmeier | 2011-07-31 16:41:20 -0700 (Sun, 31 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-6lowpan.c
   M /trunk/epan/dissectors/packet-capwap.c
   M /trunk/epan/dissectors/packet-netbios.c
   M /trunk/epan/dissectors/packet-tds.c

Restore saved 'pinfo->fragmented' as appropriate;
 Fixes gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38296 | etxrab | 2011-07-31 14:54:46 -0700 (Sun, 31 Jul 2011) | 8 lines
Changed paths:
   M /trunk/gtk/sctp_graph_dlg.c

Try to fix:
cc1: warnings being treated as errors
../../gtk/sctp_graph_dlg.c: In function ‘draw_tsn_graph’:
../../gtk/sctp_graph_dlg.c:511: error: ‘cr’ may be used uninitialized in this function
../../gtk/sctp_graph_dlg.c: In function ‘draw_sack_graph’:
../../gtk/sctp_graph_dlg.c:163: error: ‘cr’ may be used uninitialized in this function
../../gtk/sctp_graph_dlg.c: In function ‘draw_nr_sack_graph’:
../../gtk/sctp_graph_dlg.c:341: error: ‘cr’ may be used uninitialized in this function
------------------------------------------------------------------------
r38294 | etxrab | 2011-07-31 13:23:59 -0700 (Sun, 31 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_graph_dlg.c

This circle should not be filled.
------------------------------------------------------------------------
r38293 | etxrab | 2011-07-31 13:20:30 -0700 (Sun, 31 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Add comment.
------------------------------------------------------------------------
r38292 | etxrab | 2011-07-31 13:20:05 -0700 (Sun, 31 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Code cleanup.
------------------------------------------------------------------------
r38291 | etxrab | 2011-07-31 13:19:33 -0700 (Sun, 31 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_graph_dlg.c

Use Cairo for drawing.
------------------------------------------------------------------------
r38288 | gerald | 2011-07-31 07:03:28 -0700 (Sun, 31 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-07-31]
------------------------------------------------------------------------
r38287 | jmayer | 2011-07-31 06:32:05 -0700 (Sun, 31 Jul 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Configuring with --enable-ui-manager would not work - fix this.

------------------------------------------------------------------------
r38286 | etxrab | 2011-07-31 06:25:13 -0700 (Sun, 31 Jul 2011) | 2 lines
Changed paths:
   M /trunk/tap-rtp-common.c

Use pinfo->iphdrlen rather than a fixed vaue of 20 to make
the calculation correct for IPv6 too.
------------------------------------------------------------------------
r38285 | jmayer | 2011-07-31 05:07:23 -0700 (Sun, 31 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

GdkDrawable is also used in one place.

------------------------------------------------------------------------
r38284 | jmayer | 2011-07-31 04:32:15 -0700 (Sun, 31 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

Update status file. Special mention is given to removed structs in GDK3.

------------------------------------------------------------------------
r38283 | wmeier | 2011-07-30 12:00:43 -0700 (Sat, 30 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn5250.c

Whitespace cleanup.

------------------------------------------------------------------------
r38282 | wmeier | 2011-07-30 11:15:39 -0700 (Sat, 30 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tn5250.c

Remove unneeded #includes

------------------------------------------------------------------------
r38281 | alagoutte | 2011-07-30 08:47:47 -0700 (Sat, 30 Jul 2011) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ieee80211.c

From Brian Cavagnolo via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6173
Update 802.11s packet dissecting to the ratified standard (v12.0)

[PATCH 8/9] add support for Root Announcement (RANN) IEs

------------------------------------------------------------------------
r38280 | alagoutte | 2011-07-30 08:36:47 -0700 (Sat, 30 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Brian Cavagnolo via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6173
Update 802.11s packet dissecting to the ratified standard (v12.0)

[PATCH 8/9] add support for Root Announcement (RANN) IEs

------------------------------------------------------------------------
r38279 | alagoutte | 2011-07-30 08:31:59 -0700 (Sat, 30 Jul 2011) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Brian Cavagnolo via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6173
Update 802.11s packet dissecting to the ratified standard (v12.0)

[PATCH 7/9] update parsing of mesh control field

During development of the 80211s standard, a "mesh header" was conceived. This mesh header has been renamed the "mesh control field". Further, the conditions under which it is expected to appear have also changed. Specifically, the mesh control field appears in multihop action frames and mesh data frames. In the former case, it appears after the action category and action code, so no special header parsing is required to parse it.

The latter case is a bit more complicated. We know the mesh control field is present if the data frame was transmitted by a mesh STA, AND the new "Mesh Control Present" bit in the QoS control field is set.  This second thing is easy enough to check. But the first thing is not. So we continue to rely on heuristics.  Specifically, we only expect the mesh control field for valid from-ds/to-ds settings, and if the mesh control field itself is valid.

Other relevant changes in this patch include:

-- rename mesh_header to mesh_control as appropriate
-- consider the mesh control field to be part of the header when accounting for payload padding.
-- parse some of the qos fields earlier so they can be used to determine if the mesh control field is present.
-- use existing mesh control parsing code instead of duplicating it.

------------------------------------------------------------------------
r38278 | alagoutte | 2011-07-30 08:29:09 -0700 (Sat, 30 Jul 2011) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Brian Cavagnolo via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6173
Update 802.11s packet dissecting to the ratified standard (v12.0)

[PATCH 6/9] update mesh path discovery (hwmp) IEs to 802.11s v12

This includes adding the new mesh reason codes

From me
Fix checkAPI Errors (the blurb field matches the field name)

------------------------------------------------------------------------
r38277 | alagoutte | 2011-07-30 08:23:33 -0700 (Sat, 30 Jul 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Brian Cavagnolo via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6173
Update 802.11s packet dissecting to the ratified standard (v12.0)

[PATCH 5/9] make pre-80211s marvell mesh use its own data structures

The pre-80211s legacy mesh networking developed by marvell has some similarities to the latest 80211s mesh networking. However, there are enough differences in naming and convention that they should have their own data.  For clarity, we break up the marvell and 80211s mesh dissection.

Note that as of this patch, 80211s parsing uses the legacy data structures. That will change in subsequent patches in this set.

------------------------------------------------------------------------
r38276 | alagoutte | 2011-07-30 08:20:40 -0700 (Sat, 30 Jul 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Brian Cavagnolo via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6173
Update 802.11s packet dissecting to the ratified standard (v12.0)

Subject: [PATCH 4/9] eliminate obsolete non-standard 80211s peer link action frame code

The peer link action frame no longer exists.  Its data now appears in the self-protected action frame and the peering management IE.

Note that this leaves a gap in the internal field codes that is addressed in a subsequent patch.

------------------------------------------------------------------------
r38275 | alagoutte | 2011-07-30 08:19:10 -0700 (Sat, 30 Jul 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Brian Cavagnolo via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6173
Update 802.11s packet dissecting to the ratified standard (v12.0)

[PATCH 3/9] add support for 802.11s v12.0 mesh peering management IE

The v12.0 mesh peering management IE replaces the exiting mesh peer link management IE and has a slightly different format.

From me
Fix checkAPI Errors (the blurb field matches the field name)
Remove unused hf_ieee80211_mesh_mgt_pl_reason_code

------------------------------------------------------------------------
r38274 | alagoutte | 2011-07-30 08:16:30 -0700 (Sat, 30 Jul 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Brian Cavagnolo via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6173
Update 802.11s packet dissecting to the ratified standard (v12.0)

[PATCH 2/9] add support for 802.11s v12.0 action frame fixed fields

From me
Fix checkAPI Errors (the blurb field matches the field name)

------------------------------------------------------------------------
r38273 | alagoutte | 2011-07-30 08:14:19 -0700 (Sat, 30 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Brian Cavagnolo via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6173
Update 802.11s packet dissecting to the ratified standard (v12.0)

[PATCH 1/9] update mesh ID and mesh config IEs to latest 80211s draft (v12)

------------------------------------------------------------------------
r38272 | alagoutte | 2011-07-30 07:11:08 -0700 (Sat, 30 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

* Replace FALSE by ENC_BIG_ENDIAN for encoding parameter
* Remove some whitespace...

------------------------------------------------------------------------
r38271 | etxrab | 2011-07-30 07:05:55 -0700 (Sat, 30 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_common.h
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c

Add 3GPP Sv interface.
------------------------------------------------------------------------
r38270 | etxrab | 2011-07-30 07:05:31 -0700 (Sat, 30 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Add 3GPP Sv interface.
------------------------------------------------------------------------
r38269 | stig | 2011-07-30 02:52:40 -0700 (Sat, 30 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Fix a typo.
------------------------------------------------------------------------
r38268 | etxrab | 2011-07-30 02:33:10 -0700 (Sat, 30 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

CCRSI is not included in 3GPP 29.274 R8.
Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6183
------------------------------------------------------------------------
r38267 | jmayer | 2011-07-30 02:17:08 -0700 (Sat, 30 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/sip_stat.c

Fix the problem in the .c file.

------------------------------------------------------------------------
r38266 | jmayer | 2011-07-30 01:49:18 -0700 (Sat, 30 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt

The last commit contained a change too much. Revert it.

------------------------------------------------------------------------
r38265 | jmayer | 2011-07-30 01:48:20 -0700 (Sat, 30 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/old-gtk-compat.h
   M /trunk/gtk/sip_stat.c

Macros aren't functions: Back out rev 38264 and wait for someone who knows what he is doing to fix this
------------------------------------------------------------------------
r38264 | jmayer | 2011-07-30 01:33:33 -0700 (Sat, 30 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h
   M /trunk/gtk/sip_stat.c

- Put gtk_table_get_size into old-gtk-compat.h
- Shorten comment about sealing bug.

------------------------------------------------------------------------
r38263 | jmayer | 2011-07-29 15:29:31 -0700 (Fri, 29 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

Looks like ->column was sealed during the gtk 2.13 development cycle.

------------------------------------------------------------------------
r38262 | stig | 2011-07-29 12:35:16 -0700 (Fri, 29 Jul 2011) | 3 lines
Changed paths:
   M /trunk/configure.in

Print a more correct error message when missing gtk3.

This fixes bug 6181.
------------------------------------------------------------------------
r38261 | stig | 2011-07-29 10:00:59 -0700 (Fri, 29 Jul 2011) | 1 line
Changed paths:
   M /trunk/configure.in

Try build with GSEAL_ENABLE if not gtk3 again.
------------------------------------------------------------------------
r38260 | jmayer | 2011-07-29 09:50:35 -0700 (Fri, 29 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

Looks like button was deprecated with version 20, not 22

------------------------------------------------------------------------
r38259 | wmeier | 2011-07-29 09:07:00 -0700 (Fri, 29 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppi-antenna.c
   M /trunk/epan/dissectors/packet-ppi-geolocation-common.c
   M /trunk/epan/dissectors/packet-ppi-geolocation-common.h
   M /trunk/epan/dissectors/packet-ppi-gps.c
   M /trunk/epan/dissectors/packet-ppi-sensor.c
   M /trunk/epan/dissectors/packet-ppi-vector.c
   M /trunk/epan/dissectors/packet-ppi.c

Remove unneeded #includes and do other minor cleanup.

------------------------------------------------------------------------
r38258 | alagoutte | 2011-07-29 07:26:41 -0700 (Fri, 29 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-6lowpan.c

From Owen Kirby via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6147
6LoWPAN: Support for IP-in-IP tunnelingy

------------------------------------------------------------------------
r38257 | alagoutte | 2011-07-29 06:19:16 -0700 (Fri, 29 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pana.c

From Colin O'Flynn & Robert Craige via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6109
Add support for PANA Relay

------------------------------------------------------------------------
r38256 | stig | 2011-07-29 05:06:24 -0700 (Fri, 29 Jul 2011) | 1 line
Changed paths:
   M /trunk/configure.in

Removed building with GSEAL_ENABLE, does not work yet.
------------------------------------------------------------------------
r38255 | stig | 2011-07-29 04:04:58 -0700 (Fri, 29 Jul 2011) | 1 line
Changed paths:
   M /trunk/configure.in

Build with GSEAL_ENABLE if not gtk3.
------------------------------------------------------------------------
r38254 | stig | 2011-07-29 03:53:51 -0700 (Fri, 29 Jul 2011) | 1 line
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

Make it compile.
------------------------------------------------------------------------
r38253 | guy | 2011-07-29 03:28:29 -0700 (Fri, 29 Jul 2011) | 6 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

Get rid of non-ASCII characters.

Clean up white space.

Clean up capitalization a bit.

------------------------------------------------------------------------
r38252 | etxrab | 2011-07-29 03:12:48 -0700 (Fri, 29 Jul 2011) | 1 line
Changed paths:
   M /trunk/config.nmake

 - Always build with GSEAL_ENABLE
------------------------------------------------------------------------
r38251 | etxrab | 2011-07-29 03:11:24 -0700 (Fri, 29 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/capture_file_dlg.c
   M /trunk/gtk/export_sslkeys.c
   M /trunk/gtk/gsm_a_stat.c
   M /trunk/gtk/main_proto_draw.c
   M /trunk/gtk/print_dlg.c

Remove remaining direct access to GTK structs in Windows.
------------------------------------------------------------------------
r38250 | tuexen | 2011-07-29 00:24:15 -0700 (Fri, 29 Jul 2011) | 2 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c
   M /trunk/plugins/profinet/packet-pn.c

Get it compiling.

------------------------------------------------------------------------
r38249 | etxrab | 2011-07-28 22:36:57 -0700 (Thu, 28 Jul 2011) | 4 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c
   M /trunk/plugins/profinet/packet-pn.c
   M /trunk/plugins/profinet/packet-pn.h

From Wido Kelling:
Add Dissection of newly released PNIO IEC 61158 Version 2.3.
From me use ENC_BIG_ENDIAN.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6154
------------------------------------------------------------------------
r38248 | etxrab | 2011-07-28 22:19:29 -0700 (Thu, 28 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

From Lei Chen:
support PSI5 and PSI13 in packet-gsm_rlcmac.c
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6177
------------------------------------------------------------------------
r38247 | stig | 2011-07-28 15:19:46 -0700 (Thu, 28 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Avoid a possible infinite loop in dissect_delete().

This may fix the "Malformed IKE Packet DoS" bug.
------------------------------------------------------------------------
r38246 | wmeier | 2011-07-28 11:17:16 -0700 (Thu, 28 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warning.

------------------------------------------------------------------------
r38245 | wmeier | 2011-07-28 10:57:11 -0700 (Thu, 28 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppi.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warning.

------------------------------------------------------------------------
r38244 | wmeier | 2011-07-28 10:05:56 -0700 (Thu, 28 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fmp_notify.c

 Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warning;
 Also:
   Return same 'offset' from functions whether or not 'if(tree)'

------------------------------------------------------------------------
r38243 | wmeier | 2011-07-28 09:54:42 -0700 (Thu, 28 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fmp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warning;
Also:
  Return same 'offset' from functions whether or not 'if(tree)'

------------------------------------------------------------------------
r38242 | martinm | 2011-07-28 09:52:02 -0700 (Thu, 28 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Make links forward from DL tx to retx frames.

------------------------------------------------------------------------
r38241 | wmeier | 2011-07-28 08:34:18 -0700 (Thu, 28 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcdns.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warning;
Also:
  Use -1 iso tvb_[reported_]length() as 'len' arg in proto_tree_add_...();
  Use tvb_reported_length_remaining() where appropriate.

------------------------------------------------------------------------
r38240 | etxrab | 2011-07-28 07:25:09 -0700 (Thu, 28 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Use cairo for drawing.
------------------------------------------------------------------------
r38239 | jmayer | 2011-07-28 07:21:29 -0700 (Thu, 28 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt

- Always build with GSEAL_ENABLE
- Enable the extra warnings only when building with GTK2 (but not GTK3
  directly).

------------------------------------------------------------------------
r38238 | jmayer | 2011-07-28 07:11:21 -0700 (Thu, 28 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

Commit a hack^wworkaround for the missing accessor function to the column
element in GtkTreeView when building with GSEAL.

------------------------------------------------------------------------
r38237 | cmaynard | 2011-07-28 05:28:06 -0700 (Thu, 28 Jul 2011) | 2 lines
Changed paths:
   M /trunk/packaging/u3/tools/utest.c

Add a cast to avoid "conversion from size_t to int, possible loss of data" warning found when attempting to create the U3 package on Windows 7-x64.  Hmm, why doesn't the Window 7-x64 buildbot build U3 or portableapps packages?

------------------------------------------------------------------------
r38236 | etxrab | 2011-07-28 04:45:47 -0700 (Thu, 28 Jul 2011) | 3 lines
Changed paths:
   M /trunk/diameter/dictionary.xml
   M /trunk/diameter/imscxdx.xml

Diameter dissector does not decode User-Authorization-Type AVP properly and add AVP 651.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6174
------------------------------------------------------------------------
r38235 | etxrab | 2011-07-28 03:04:12 -0700 (Thu, 28 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-xml.c

application/simservs+xml
------------------------------------------------------------------------
r38234 | etxrab | 2011-07-28 02:21:43 -0700 (Thu, 28 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Replace gdk_draw_rectangle() with cairo equivalents
------------------------------------------------------------------------
r38233 | etxrab | 2011-07-27 22:49:47 -0700 (Wed, 27 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-time.c

From Dirk:
support ISO style date and time for frame.time filter

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6086
------------------------------------------------------------------------
r38232 | etxrab | 2011-07-27 22:42:25 -0700 (Wed, 27 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

From Edwin Groothuis:
Add preference to Mute noise of TCP Timestamp Option in the summary line.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6162
------------------------------------------------------------------------
r38231 | etxrab | 2011-07-27 22:38:07 -0700 (Wed, 27 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

From Lei Chen:
support 'Packet System Information Type 3' in packet-gsm_rlcmac.c
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6170
------------------------------------------------------------------------
r38230 | etxrab | 2011-07-27 13:28:07 -0700 (Wed, 27 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

Try to fix
../gtk/old-gtk-compat.h:42:48: error: "(" may not appear in macro parameter list
------------------------------------------------------------------------
r38229 | etxrab | 2011-07-27 13:25:31 -0700 (Wed, 27 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Replace the remaining gdk_draw_pixmap().
------------------------------------------------------------------------
r38228 | etxrab | 2011-07-27 12:44:35 -0700 (Wed, 27 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h
   M /trunk/gtk/packet_win.c

(dialog)->vbox can be replaced by gtk_dialog_get_content_area()
in gtk 2.14.
------------------------------------------------------------------------
r38227 | alagoutte | 2011-07-27 08:19:17 -0700 (Wed, 27 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

From Eric Zhu via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5846
Wireshark cannot display Reachable time & Retrans timer in IPv6 RA messages

------------------------------------------------------------------------
r38226 | etxrab | 2011-07-27 06:17:58 -0700 (Wed, 27 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter_3gpp.c

Use tvb_length when adding MSISDN.
------------------------------------------------------------------------
r38225 | etxrab | 2011-07-27 05:27:39 -0700 (Wed, 27 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

from T. Loebner:
Dissector for XR IDMS from ETSI TS 182 063 v3.5.2 Annex W 

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6163
------------------------------------------------------------------------
r38224 | etxrab | 2011-07-27 04:43:45 -0700 (Wed, 27 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/io_stat.c

Define M_PI and protect it
(http://ubuntuforums.org/showthread.php?t=583094)
------------------------------------------------------------------------
r38223 | etxrab | 2011-07-27 04:05:34 -0700 (Wed, 27 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/io_stat.c

Define M_PI
------------------------------------------------------------------------
r38222 | etxrab | 2011-07-27 03:05:09 -0700 (Wed, 27 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/old-gtk-compat.h
   M /trunk/gtk/profile_dlg.c
   M /trunk/gtk/uat_gui.c

gtk_tree_view_column_get_button ()
is available in GTK 3.0 use that.
------------------------------------------------------------------------
r38221 | stig | 2011-07-27 02:49:35 -0700 (Wed, 27 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/io_stat.c

Use correct color for impulse, filled bar and dot.
Draw dot as a circle.
------------------------------------------------------------------------
r38220 | etxrab | 2011-07-27 00:13:09 -0700 (Wed, 27 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/gsm_map_stat.c

Add include
------------------------------------------------------------------------
r38219 | etxrab | 2011-07-26 22:46:15 -0700 (Tue, 26 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/gsm_map_stat.c

Use gtk_widget_get_window.
------------------------------------------------------------------------
r38218 | jmayer | 2011-07-26 14:25:50 -0700 (Tue, 26 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

Update numbers

------------------------------------------------------------------------
r38217 | jmayer | 2011-07-26 12:44:06 -0700 (Tue, 26 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c

Part 2 of the cleanup. fix some compile errors in previous patch.

------------------------------------------------------------------------
r38216 | jmayer | 2011-07-26 12:24:19 -0700 (Tue, 26 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_player.c

Remove some more GTK_WIDGET_STATE

------------------------------------------------------------------------
r38215 | jmayer | 2011-07-26 12:01:01 -0700 (Tue, 26 Jul 2011) | 6 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/old-gtk-compat.h
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/tcp_graph.c

Replace access to ...->allocation by gtk_widget_get_allocation +
  using the return val - part 1
Maybe the call needs to be done more often.

Replace GTK_WIDGET_STATE by gtk_widget_get_state

------------------------------------------------------------------------
r38214 | gerald | 2011-07-26 10:46:19 -0700 (Tue, 26 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/tap_param_dlg.c

Don't free a string which will be used later on.

------------------------------------------------------------------------
r38213 | cmaynard | 2011-07-26 09:19:48 -0700 (Tue, 26 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

Avoid a crash reported in bug 6138 by never allowing frame1Size < dataLength.
Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6138

------------------------------------------------------------------------
r38212 | etxrab | 2011-07-26 08:19:12 -0700 (Tue, 26 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Use Cairo for drawing, step 2.
------------------------------------------------------------------------
r38211 | etxrab | 2011-07-26 04:21:14 -0700 (Tue, 26 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Use Cairo for drawing, step 1.
------------------------------------------------------------------------
r38210 | etxrab | 2011-07-26 04:20:30 -0700 (Tue, 26 Jul 2011) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Update 3GPP AVP:s
------------------------------------------------------------------------
r38209 | etxrab | 2011-07-26 04:18:46 -0700 (Tue, 26 Jul 2011) | 4 lines
Changed paths:
   M /trunk/diameter/Cisco.xml

From Asmita:
Diameter AVP patch for Cisco.xml

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6169
------------------------------------------------------------------------
r38208 | martinm | 2011-07-26 03:16:02 -0700 (Tue, 26 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Don't attach sequence analysis results to control/data PDUs when not appropriate.  The problem is that I use the frame number in the result hash table - I may end up adding more info (e.g. channel, SN) to further avoid attaching reports to wrong PDUs.

------------------------------------------------------------------------
r38207 | etxrab | 2011-07-25 22:35:19 -0700 (Mon, 25 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/rtp_analysis.c

Code cleanup.
------------------------------------------------------------------------
r38206 | etxrab | 2011-07-25 21:20:39 -0700 (Mon, 25 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

From Lei Chen:
This patch tries to support 'Packet System Information Type 2' in gsm rlcmac
dissector.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6167
------------------------------------------------------------------------
r38205 | etxrab | 2011-07-25 20:52:29 -0700 (Mon, 25 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

From Lei Chen:
CSN_RECURSIVE_TARRAY should count the last '0' bit.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6166
------------------------------------------------------------------------
r38204 | wmeier | 2011-07-25 13:54:13 -0700 (Mon, 25 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isns.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warning.
Also: various minor cleanup and a few minor bug fixes:

------------------------------------------------------------------------
r38203 | etxrab | 2011-07-25 13:00:04 -0700 (Mon, 25 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/iax2_analysis.c

Use cairo for drawing to avoid deprecated functions.
------------------------------------------------------------------------
r38202 | etxrab | 2011-07-25 08:55:27 -0700 (Mon, 25 Jul 2011) | 1 line
Changed paths:
   M /trunk/tools/checkAPIs.pl

Update comments.
------------------------------------------------------------------------
r38201 | etxrab | 2011-07-25 08:54:57 -0700 (Mon, 25 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/rtp_analysis.c

Use Cairo for drawing.
------------------------------------------------------------------------
r38200 | etxrab | 2011-07-25 08:54:21 -0700 (Mon, 25 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/io_stat.c

Code cleanup.
------------------------------------------------------------------------
r38199 | martinm | 2011-07-25 06:47:26 -0700 (Mon, 25 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c

From Pascal Quantin (bug 6159).
When decoding drb payload, call IPv4, IPv6 or data dissector as appropriate.

Am slightly concerned that we always dereference the first byte of the frame - is it safe to assume that the length can't be 0?

------------------------------------------------------------------------
r38198 | martinm | 2011-07-25 06:34:40 -0700 (Mon, 25 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c

Fix bug 6160.
Use correct string to search for RRC BCH dissectors.

------------------------------------------------------------------------
r38197 | guy | 2011-07-24 23:40:01 -0700 (Sun, 24 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/old-gtk-compat.h
   M /trunk/tools/checkAPIs.pl

Use gtk_widget_get_has_window() as a wrapper around
GTK_WIDGET_NO_WINDOW() in pre-2.18 versions of GTK+.  Treat calls to
GTK_WIDGET_NO_WINDOW() as an error in checkAPIs.pl.

------------------------------------------------------------------------
r38196 | etxrab | 2011-07-24 21:13:46 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_utils.c
   M /trunk/tools/checkAPIs.pl

Fix a couple of typos and 'E'' mark functions mapped in old-gtk-compat.h
------------------------------------------------------------------------
r38195 | guy | 2011-07-24 18:38:11 -0700 (Sun, 24 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/old-gtk-compat.h

Fix typo, get rid of #if no longer necessary with the typo fixed.

------------------------------------------------------------------------
r38194 | guy | 2011-07-24 18:33:15 -0700 (Sun, 24 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

gtk_widget_get_visible() is only available in GTK+ 2.18 and later.

------------------------------------------------------------------------
r38193 | etxrab | 2011-07-24 14:34:52 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_utils.c

Use gtk_window_set_icon_list isof gdk_pixmap_create_from_xpm_d.
------------------------------------------------------------------------
r38192 | wmeier | 2011-07-24 14:03:01 -0700 (Sun, 24 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Fix a benign bug in the patch from Bug #5795.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5795

------------------------------------------------------------------------
r38191 | wmeier | 2011-07-24 13:50:00 -0700 (Sun, 24 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/ip_opts.h

(Trivial) Whitespace changes and reformatting ...

------------------------------------------------------------------------
r38190 | wmeier | 2011-07-24 13:48:57 -0700 (Sun, 24 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Commit missing parts of Bug #5795 patch (those not committed in SVN 38175 & 38176).
 (See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5795)


------------------------------------------------------------------------
r38189 | etxrab | 2011-07-24 13:09:08 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_utils.c

Remove unused variables.
------------------------------------------------------------------------
r38188 | etxrab | 2011-07-24 12:39:21 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/main.c
   M /trunk/gtk/old-gtk-compat.h

Replace deprecated functions.
------------------------------------------------------------------------
r38187 | etxrab | 2011-07-24 11:03:53 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/tap_param_dlg.c
   M /trunk/gtk/uat_gui.c

Replace deprecated functions.
------------------------------------------------------------------------
r38186 | etxrab | 2011-07-24 10:25:52 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_filter_toolbar.c
   M /trunk/gtk/manual_addr_resolv.c
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/pixmap_save.c
   M /trunk/gtk/prefs_capture.c
   M /trunk/gtk/prefs_column.c
   M /trunk/gtk/prefs_dlg.c
   M /trunk/gtk/prefs_stream.c

Replace deprecated functions.
------------------------------------------------------------------------
r38185 | etxrab | 2011-07-24 09:50:55 -0700 (Sun, 24 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/find_dlg.c
   M /trunk/gtk/firewall_dlg.c
   M /trunk/gtk/follow_stream.c
   M /trunk/gtk/main_airpcap_toolbar.c
   M /trunk/tools/checkAPIs.pl

Replace deprecated functions.
Udate comments in CheckAPIs
------------------------------------------------------------------------
r38183 | etxrab | 2011-07-24 08:22:21 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/airpcap_gui_utils.c

Replace deprecated functions.
------------------------------------------------------------------------
r38181 | gerald | 2011-07-24 07:03:33 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-07-24]
------------------------------------------------------------------------
r38180 | etxrab | 2011-07-24 04:35:51 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/io_stat.c

Replace depricated gdk_draw_drawable().
------------------------------------------------------------------------
r38179 | etxrab | 2011-07-24 04:11:38 -0700 (Sun, 24 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/io_stat.c

Try to fix "The graph is not updated when changing settings or adding new graphs.".
We need to find non deperecated equivalents...
------------------------------------------------------------------------
r38178 | jmayer | 2011-07-24 00:59:34 -0700 (Sun, 24 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/old-gtk-compat.h

Fix some compile errors when building with real gtk-3.

------------------------------------------------------------------------
r38177 | jmayer | 2011-07-24 00:58:21 -0700 (Sun, 24 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/io_stat.c

The guards for 2,22,0 are not needed, tested on a debian system with gtk 2.12.

------------------------------------------------------------------------
r38176 | alagoutte | 2011-07-23 09:31:10 -0700 (Sat, 23 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Wrong patch commit in Rev38175...
Fix :
packet-tcp.c:3337: error: ‘dissect_tcpopt_maxseg’ undeclared here (not in a function)
packet-tcp.c:2264: error: ‘dissec_tcpopt_exp’ defined but not used

------------------------------------------------------------------------
r38175 | alagoutte | 2011-07-23 09:13:05 -0700 (Sat, 23 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

From Edwin Groothuis via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5795
Add TCP Options support for #253, #254 (experimental), expand MSS / SACKPERM view, add hidden TCP Option Kind/Length to all

------------------------------------------------------------------------
r38174 | alagoutte | 2011-07-23 08:53:19 -0700 (Sat, 23 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Update last IANA Parameters
RFC-ietf-ipsecme-failure-detection-08.txt => RFC6290
RFC-ietf-ipsecme-ipsecha-protocol-06.txt => RFC6311

------------------------------------------------------------------------
r38173 | etxrab | 2011-07-23 07:02:20 -0700 (Sat, 23 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/io_stat.c

Fix a copy-paste error.
------------------------------------------------------------------------
r38172 | etxrab | 2011-07-23 04:27:57 -0700 (Sat, 23 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/io_stat.c

Use cairo for drawing to avoid deprecated functions.
I'm unsure if the #if GTK_CHECK_VERSION(2,22,0) guards are realy
needed but I don't have a GTK 2.12 system to verify with.
------------------------------------------------------------------------
r38171 | cmaynard | 2011-07-22 17:30:24 -0700 (Fri, 22 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Avoid potential midday problems by narrowing the midnight rollover test.

------------------------------------------------------------------------
r38170 | wmeier | 2011-07-22 11:33:44 -0700 (Fri, 22 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk/epan/dissectors/packet-gsm_a_rr.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38169 | cmaynard | 2011-07-22 08:32:59 -0700 (Fri, 22 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def

Add tvb_find_tvb

------------------------------------------------------------------------
r38168 | jmayer | 2011-07-22 03:17:58 -0700 (Fri, 22 Jul 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Back out my last changes to configure.in - they broke too much

------------------------------------------------------------------------
r38167 | jmayer | 2011-07-22 02:50:30 -0700 (Fri, 22 Jul 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

When moving stuff around, move it all.

------------------------------------------------------------------------
r38166 | etxrab | 2011-07-22 01:24:48 -0700 (Fri, 22 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

From Ludovic Haessler:
Add 3GPP LLC/SNDCP protocols management in GSMTAP dissecto.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6145
------------------------------------------------------------------------
r38165 | etxrab | 2011-07-22 01:18:59 -0700 (Fri, 22 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c

From Lei Chen:
Support "Packet System Information Type 1" in packet-gsm_rlcmac.c

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6152
------------------------------------------------------------------------
r38164 | etxrab | 2011-07-22 01:10:25 -0700 (Fri, 22 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c

From Lei Chen:
pDescr should not step on until proto_tree_add_text() has been called.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6151
------------------------------------------------------------------------
r38163 | jmayer | 2011-07-21 22:50:45 -0700 (Thu, 21 Jul 2011) | 3 lines
Changed paths:
   M /trunk/configure.in

Fix the order of tests: the test for wireshark needs to run after
the test for gtk.

------------------------------------------------------------------------
r38162 | jmayer | 2011-07-21 22:03:40 -0700 (Thu, 21 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

Missed gtk_orientable_set_orientation
------------------------------------------------------------------------
r38161 | wmeier | 2011-07-21 18:14:10 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

Use correct definition for gtk_combo_box_text_new(): Fixes compile errors.

------------------------------------------------------------------------
r38160 | jmayer | 2011-07-21 16:58:08 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/dfilter_expr_dlg.c
   M /trunk/gtk/gtkvumeter.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/main_filter_toolbar.c
   M /trunk/gtk/main_toolbar.c
   M /trunk/gtk/old-gtk-compat.h

Handle more stuff in old-gtk-compat.h to avoid guarding in the code.

------------------------------------------------------------------------
r38159 | etxrab | 2011-07-21 15:46:07 -0700 (Thu, 21 Jul 2011) | 3 lines
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.asn
   M /trunk/epan/dissectors/packet-ansi_map.c

Try to do a more syntactically correct import.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6150
------------------------------------------------------------------------
r38158 | wmeier | 2011-07-21 15:34:50 -0700 (Thu, 21 Jul 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lon.c

From Daniel Willmann: packet-lon.c: Fix Multicast decoding when M_Length is zero.

In case M_Length is 0 the M_List field does not exist.
The attached patch fixes this and it also changes the names of the M_List and
M_List length field to more general names.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6149

------------------------------------------------------------------------
r38157 | wmeier | 2011-07-21 15:24:46 -0700 (Thu, 21 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lon.c

From Daniel Willmann: Visual improvements for the LON (EIA-709.1) dissector.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6148

------------------------------------------------------------------------
r38156 | wmeier | 2011-07-21 14:54:09 -0700 (Thu, 21 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-epl.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
Also: In various places: compute 'offset' whether or not 'if(tree)'.

------------------------------------------------------------------------
r38155 | morriss | 2011-07-21 14:19:18 -0700 (Thu, 21 Jul 2011) | 3 lines
Changed paths:
   M /trunk/editcap.c

Remove the snaplen check added in r37633: the change in r37634 makes it
unnecessary.

------------------------------------------------------------------------
r38154 | jmayer | 2011-07-21 13:57:10 -0700 (Thu, 21 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/Makefile.common

Add new old-gtk-compat.h to the distribution
------------------------------------------------------------------------
r38153 | jmayer | 2011-07-21 13:50:51 -0700 (Thu, 21 Jul 2011) | 3 lines
Changed paths:
   M /trunk/Makefile.am

Add missing FindGTK3.cmake
Reorder cmake modules to match directory listing order

------------------------------------------------------------------------
r38152 | jmayer | 2011-07-21 13:22:16 -0700 (Thu, 21 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/STATUS.gtk3

Update GSEAL errors
------------------------------------------------------------------------
r38151 | jmayer | 2011-07-21 13:12:08 -0700 (Thu, 21 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/afp_stat.c
   M /trunk/gtk/ansi_a_stat.c
   M /trunk/gtk/ansi_map_stat.c
   M /trunk/gtk/bootp_stat.c
   M /trunk/gtk/camel_counter.c
   M /trunk/gtk/camel_srt.c
   M /trunk/gtk/compare_stat.c
   M /trunk/gtk/dcerpc_stat.c
   M /trunk/gtk/diameter_stat.c
   M /trunk/gtk/expert_comp_dlg.c
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/gsm_a_stat.c
   M /trunk/gtk/gtp_stat.c
   M /trunk/gtk/h225_counter.c
   M /trunk/gtk/h225_ras_srt.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/mac_lte_stat_dlg.c
   M /trunk/gtk/megaco_stat.c
   M /trunk/gtk/mgcp_stat.c
   M /trunk/gtk/mtp3_stat.c
   M /trunk/gtk/radius_stat.c
   M /trunk/gtk/rlc_lte_stat_dlg.c
   M /trunk/gtk/rpc_progs.c
   M /trunk/gtk/rpc_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/scsi_stat.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/sctp_stat_dlg.c
   M /trunk/gtk/simple_dialog.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/smb2_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/stats_tree_stat.c
   M /trunk/gtk/tap_param_dlg.c
   M /trunk/gtk/tcp_graph.c
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/gtk/wlan_stat_dlg.c

Fix almost all accesses to ->window
------------------------------------------------------------------------
r38150 | wmeier | 2011-07-21 12:10:10 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/plugins/gryphon/packet-gryphon.c
   M /trunk/plugins/wimax/mac_hd_generic_decoder.c
   M /trunk/plugins/wimax/msg_dcd.c
   M /trunk/plugins/wimax/msg_dlmap.c
   M /trunk/plugins/wimax/msg_dreg.c
   M /trunk/plugins/wimax/msg_dsc.c
   M /trunk/plugins/wimax/msg_sbc.c
   M /trunk/plugins/wimax/wimax_compact_ulmap_ie_decoder.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38149 | jmayer | 2011-07-21 12:00:55 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

Another one I missed.

------------------------------------------------------------------------
r38148 | jmayer | 2011-07-21 11:36:17 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/old-gtk-compat.h

Fix for buildbot failure. Hopefully I didn't miss too many more.

------------------------------------------------------------------------
r38147 | jmayer | 2011-07-21 10:44:02 -0700 (Thu, 21 Jul 2011) | 7 lines
Changed paths:
   M /trunk/gtk/color_edit_dlg.c
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/drag_and_drop.c
   M /trunk/gtk/expert_comp_table.c
   M /trunk/gtk/filter_autocomplete.c
   M /trunk/gtk/filter_dlg.c
   M /trunk/gtk/filter_utils.c
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/gtkvumeter.c
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/main.c
   M /trunk/gtk/new_packet_list.c
   A /trunk/gtk/old-gtk-compat.h
   M /trunk/gtk/pixmap_save.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/wsp_stat.c

Create a file containing macros to provide the access-functions
when the gtk version is too old (for the 2,14,0 case).

Remove all old access methods that were guarded by 2,14,0 tests.

Feel free to do the same for newer guards :-)

------------------------------------------------------------------------
r38146 | tuexen | 2011-07-21 10:30:42 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/test/suite-clopts.sh

Undo the checking of command line interfaces. It might the a pipe...

------------------------------------------------------------------------
r38145 | tuexen | 2011-07-21 09:06:52 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/test/suite-clopts.sh

Adopt test to new error handling.

------------------------------------------------------------------------
r38144 | tuexen | 2011-07-21 09:00:38 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix issue reported by Joerg.

------------------------------------------------------------------------
r38143 | martinm | 2011-07-21 08:55:58 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/tap-rlcltestat.c

Fix a label, and make sure all counters are initialised to 0.

------------------------------------------------------------------------
r38142 | tuexen | 2011-07-21 08:23:46 -0700 (Thu, 21 Jul 2011) | 5 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main_welcome.c

Make sure that the interfaces listed in ifaces really exist.
Some protection code in capture / options.
Obtained from Irene Ruengeler.


------------------------------------------------------------------------
r38141 | tuexen | 2011-07-21 05:06:18 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

strdup -> g_strdup.

------------------------------------------------------------------------
r38140 | tuexen | 2011-07-21 04:28:16 -0700 (Thu, 21 Jul 2011) | 7 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/menus.h

Add some temporary protection code to support the current capture
options dialog box. It will be removed as soon as the capture options
dialog box supports multiple interfaces.

Received from Irene Ruengeler.


------------------------------------------------------------------------
r38139 | jmayer | 2011-07-20 17:16:05 -0700 (Wed, 20 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/tcp_graph.c

Replace references to style by  gtk_widget_get_style (according to
http://developer.gnome.org/gtk/2.24/GtkWidget.html#gtk-widget-get-style
this doesn't require a minimum version)

------------------------------------------------------------------------
r38138 | jmayer | 2011-07-20 17:13:14 -0700 (Wed, 20 Jul 2011) | 1 line
Changed paths:
   M /trunk/cmakeconfig.h.in

Make USE_THREADS actually work with cmake
------------------------------------------------------------------------
r38137 | etxrab | 2011-07-20 15:34:57 -0700 (Wed, 20 Jul 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
Add support for the ca_pmt_reply apdu as defined in section 8.4.3.5 of the DVB-CI standard (EN 50221).

Also some new apdu tags and their descriptions are added for completeness.
After applying this patch, DVB-CI support is complete except for reassembly

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6132
------------------------------------------------------------------------
r38136 | etxrab | 2011-07-20 15:07:31 -0700 (Wed, 20 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

From Lei Chen:
patch to support "Additional MS Radio Access Capability" and "Packet Pause" in packet-gsm_rlcmac.c
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6133
------------------------------------------------------------------------
r38135 | etxrab | 2011-07-20 07:09:19 -0700 (Wed, 20 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-amr.c
   M /trunk/epan/dissectors/packet-gsm_a_common.c
   M /trunk/epan/dissectors/packet-gsm_a_dtap.c
   M /trunk/epan/dissectors/packet-gsm_a_rr.c

Use ENC_BIG_ENDIAN.
------------------------------------------------------------------------
r38134 | etxrab | 2011-07-20 06:53:00 -0700 (Wed, 20 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_welcome.c

strdup -> g_strdup
------------------------------------------------------------------------
r38133 | tuexen | 2011-07-20 05:51:57 -0700 (Wed, 20 Jul 2011) | 6 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/capture_if_dlg.h
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/main_welcome.h

Synchronize the selection of interfaces between the main welcome
window, the capture/interface dialog box and the capture / start
menu item.
Obtained from Irene Ruengeler.


------------------------------------------------------------------------
r38132 | martinm | 2011-07-20 05:24:41 -0700 (Wed, 20 Jul 2011) | 2 lines
Changed paths:
   M /trunk/editcap.c

Don't sanity-check snaplen against frame length if snaplen is 0.

------------------------------------------------------------------------
r38131 | martinm | 2011-07-20 05:19:22 -0700 (Wed, 20 Jul 2011) | 2 lines
Changed paths:
   M /trunk/asn1/lte-rrc/packet-lte-rrc-template.c
   M /trunk/epan/dissectors/packet-lte-rrc.c
   M /trunk/epan/dissectors/packet-mac-lte.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-rlc-lte.c

Register nicer entry points for LTE RRC BCH messages, and use them in RLC, MAC, PDCP.

------------------------------------------------------------------------
r38130 | guy | 2011-07-19 22:49:24 -0700 (Tue, 19 Jul 2011) | 6 lines
Changed paths:
   M /trunk/configure.in

Regularize style a bit in help messages.

Clean up capitalization.

Fix a comment.

------------------------------------------------------------------------
r38129 | cmaynard | 2011-07-19 17:22:31 -0700 (Tue, 19 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Apply some endian heuristics when dissecting ICMP originate, receive and transmit timestamps.  Fixes bug 6114.

Ref: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6114

------------------------------------------------------------------------
r38128 | guy | 2011-07-19 16:02:02 -0700 (Tue, 19 Jul 2011) | 20 lines
Changed paths:
   M /trunk/epan/dissectors/dcerpc/drsuapi/packet-dcerpc-drsuapi-template.c
   M /trunk/epan/dissectors/packet-dcerpc-drsuapi.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcerpc-spoolss.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcerpc.h
   M /trunk/epan/dissectors/packet-dcom.c
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

Add a DREP_LITTLE_ENDIAN for the DCE RPC endianness bit in the data
representation.  Use it rather than a raw 0x10.

Add a DREP_ENC_INTEGER() macro that takes a pointer to the data
representation and returns either ENC_LITTLE_ENDIAN or ENC_BIG_ENDIAN;
use it for the encoding argument to proto_tree_add_item(), rather than
just the AND of drep[0] and DREP_LITTLE_ENDIAN, as it's not a boolean
any more, and for string values we'll be supporting character encodings
as well and thus won't be able to trust that the 0x10 bit will mean
"little endian".

Use ENC_NA for some other encoding values, i.e. for FT_BYTES and the
like.

Fix a couple of places in the DCOM dissector where we were passing the
byte-order bit rather than the field value to
proto_tree_add_uint_format().

Clean up white space.

------------------------------------------------------------------------
r38127 | gerald | 2011-07-19 15:38:28 -0700 (Tue, 19 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/sip_stat.c

The GTK+ documentation says we can pass NULL to gtk_table_get_size(). Do
that instead of using a dummy variable.

------------------------------------------------------------------------
r38125 | stig | 2011-07-19 12:37:58 -0700 (Tue, 19 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/expert.c

Use ENC_NA for FT_PROTOCOL.
------------------------------------------------------------------------
r38124 | stig | 2011-07-19 12:37:45 -0700 (Tue, 19 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/reassemble.c

Use ENC_NA for hf_fragments (FT_NONE).
------------------------------------------------------------------------
r38123 | jmayer | 2011-07-19 12:36:26 -0700 (Tue, 19 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/rlc_lte_stat_dlg.c

Reenable the commented out code. I was able to reproducably break
the compilation but after a complete removal of the build directory
and a rebuild the problem is gone.

------------------------------------------------------------------------
r38122 | stig | 2011-07-19 11:48:31 -0700 (Tue, 19 Jul 2011) | 1 line
Changed paths:
   M /trunk/asn1/acse/packet-acse-template.c
   M /trunk/asn1/cdt/packet-cdt-template.c
   M /trunk/asn1/dap/dap.cnf
   M /trunk/asn1/disp/packet-disp-template.c
   M /trunk/asn1/dop/packet-dop-template.c
   M /trunk/asn1/dsp/packet-dsp-template.c
   M /trunk/asn1/ftam/packet-ftam-template.c
   M /trunk/asn1/p1/packet-p1-template.c
   M /trunk/asn1/p22/packet-p22-template.c
   M /trunk/asn1/p772/packet-p772-template.c
   M /trunk/asn1/pres/packet-pres-template.c
   M /trunk/asn1/ros/packet-ros-template.c
   M /trunk/asn1/rtse/packet-rtse-template.c
   M /trunk/epan/dissectors/packet-acse.c
   M /trunk/epan/dissectors/packet-bjnp.c
   M /trunk/epan/dissectors/packet-cdt.c
   M /trunk/epan/dissectors/packet-dap.c
   M /trunk/epan/dissectors/packet-db-lsp.c
   M /trunk/epan/dissectors/packet-disp.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-dop.c
   M /trunk/epan/dissectors/packet-dsp.c
   M /trunk/epan/dissectors/packet-ftam.c
   M /trunk/epan/dissectors/packet-memcache.c
   M /trunk/epan/dissectors/packet-nat-pmp.c
   M /trunk/epan/dissectors/packet-p1.c
   M /trunk/epan/dissectors/packet-p22.c
   M /trunk/epan/dissectors/packet-p772.c
   M /trunk/epan/dissectors/packet-packetlogger.c
   M /trunk/epan/dissectors/packet-pres.c
   M /trunk/epan/dissectors/packet-ros.c
   M /trunk/epan/dissectors/packet-rpcap.c
   M /trunk/epan/dissectors/packet-rtse.c

Use ENC_NA as encoding for FT_PROTOCOL, FT_NONE and FT_BYTES.
------------------------------------------------------------------------
r38119 | gerald | 2011-07-19 11:22:46 -0700 (Tue, 19 Jul 2011) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/docbook/wsdg_src/WSDG_chapter_libraries.xml
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/portableapps/win32/Makefile.nmake

Instead of overloading WIRESHARK_LIBS / wireshark_LIBS in Makefile.nmake
use WIRESHARK_LIB_DIR for the location of our external libraries.

------------------------------------------------------------------------
r38118 | jmayer | 2011-07-19 11:00:08 -0700 (Tue, 19 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/rlc_lte_stat_dlg.c

There are some undefined symbols in the code: comment out
the problematic code parts.

------------------------------------------------------------------------
r38117 | jmayer | 2011-07-19 10:40:23 -0700 (Tue, 19 Jul 2011) | 10 lines
Changed paths:
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/profile_dlg.c
   M /trunk/gtk/uat_gui.c

Back out parts of 38112, as pointed out by Stig Bj\370rlykke:

The changes in profile_dlg.c, uat_gui.c and new_packet_list.c does not
work.  The tooltip is not displayed, and it's not possible to get the
context menu from a column header in the packet list.
...
I guess gtk_tree_view_column_get_widget() does not return
column->button, which is the widget we use.


------------------------------------------------------------------------
r38116 | jmayer | 2011-07-19 10:29:27 -0700 (Tue, 19 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/sip_stat.c

Martin Mathieson: gtk_table_get_size() was only introduced in gtk 2.22

------------------------------------------------------------------------
r38115 | martinm | 2011-07-19 09:41:56 -0700 (Tue, 19 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c
   M /trunk/epan/dissectors/packet-rlc-lte.h
   M /trunk/gtk/rlc_lte_stat_dlg.c
   M /trunk/tap-rlcltestat.c

From Pradip Biswas, bug 6127 - Added Decode for RRC BCCH (BCH and DL_SCH) messages on RLC-over-UDP.

Add separate codes/cases for BCH-over-BCH and BCH-over-DLSCH.

------------------------------------------------------------------------
r38114 | gerald | 2011-07-19 09:26:42 -0700 (Tue, 19 Jul 2011) | 2 lines
Changed paths:
   M /trunk/config.nmake

Pull WIRESHARK_LIBS from the system environment if it's available.

------------------------------------------------------------------------
r38113 | jmayer | 2011-07-19 09:02:16 -0700 (Tue, 19 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/prefs_nameres.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/tcp_graph.c

Get rid of direct access to struct GtkToggleButton

------------------------------------------------------------------------
r38112 | jmayer | 2011-07-19 08:13:36 -0700 (Tue, 19 Jul 2011) | 5 lines
Changed paths:
   M /trunk/gtk/menus.c
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/profile_dlg.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/uat_gui.c

Fix access to the following stuctures:
GtkCheckMenuItem
GtkTable
GtkTreeViewColumn

------------------------------------------------------------------------
r38111 | jmayer | 2011-07-19 07:33:50 -0700 (Tue, 19 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_player.c

Get rid of all GtkAdjustment element accesses. Fix a bug
introduced when fixing this stuff for rtp_player.c

------------------------------------------------------------------------
r38110 | cmaynard | 2011-07-19 06:19:49 -0700 (Tue, 19 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Based on the information provided by Steve Karg via -dev, change all occurrences of ENC_LITTLE_ENDIAN to ENC_BIG_ENDIAN.

Ref: http://www.wireshark.org/lists/wireshark-dev/201107/msg00305.html


------------------------------------------------------------------------
r38109 | tuexen | 2011-07-19 05:42:18 -0700 (Tue, 19 Jul 2011) | 5 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/capture_if_dlg.h
   M /trunk/gtk/main_welcome.c

Get the interfaces list from the Capture / Interfaces list in sync
when using the capture / start menu item.

Obtained from Irene Ruengeler.

------------------------------------------------------------------------
r38108 | jmayer | 2011-07-19 04:02:26 -0700 (Tue, 19 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_player.c

Fix some errors when compiling with -DGSEAL_ENABLE.

------------------------------------------------------------------------
r38107 | stig | 2011-07-19 03:51:12 -0700 (Tue, 19 Jul 2011) | 1 line
Changed paths:
   M /trunk/asn1/acse/packet-acse-template.c
   M /trunk/asn1/cdt/packet-cdt-template.c
   M /trunk/asn1/disp/packet-disp-template.c
   M /trunk/asn1/dop/packet-dop-template.c
   M /trunk/asn1/dsp/packet-dsp-template.c
   M /trunk/asn1/ftam/packet-ftam-template.c
   M /trunk/asn1/p1/p1.cnf
   M /trunk/asn1/p1/packet-p1-template.c
   M /trunk/asn1/p22/packet-p22-template.c
   M /trunk/asn1/p772/packet-p772-template.c
   M /trunk/asn1/ros/packet-ros-template.c
   M /trunk/asn1/rtse/packet-rtse-template.c
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-acse.c
   M /trunk/epan/dissectors/packet-bjnp.c
   M /trunk/epan/dissectors/packet-cdt.c
   M /trunk/epan/dissectors/packet-db-lsp.c
   M /trunk/epan/dissectors/packet-disp.c
   M /trunk/epan/dissectors/packet-dmp.c
   M /trunk/epan/dissectors/packet-dop.c
   M /trunk/epan/dissectors/packet-dsp.c
   M /trunk/epan/dissectors/packet-ftam.c
   M /trunk/epan/dissectors/packet-memcache.c
   M /trunk/epan/dissectors/packet-nat-pmp.c
   M /trunk/epan/dissectors/packet-p1.c
   M /trunk/epan/dissectors/packet-p22.c
   M /trunk/epan/dissectors/packet-p772.c
   M /trunk/epan/dissectors/packet-p_mul.c
   M /trunk/epan/dissectors/packet-packetlogger.c
   M /trunk/epan/dissectors/packet-ros.c
   M /trunk/epan/dissectors/packet-rpcap.c
   M /trunk/epan/dissectors/packet-rtse.c
   M /trunk/epan/dissectors/packet-snmp.c

Use correct encoding for proto_tree_add_item().
------------------------------------------------------------------------
r38106 | guy | 2011-07-18 20:20:02 -0700 (Mon, 18 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Use ENC_LITTLE_ENDIAN rather than TRUE in proto_tree_add_item() calls. 
(Yes, that means that all but one call uses ENC_LITTLE_ENDIAN, and one
uses ENC_BIG_ENDIAN.  I guess that's how the protocol works....)

------------------------------------------------------------------------
r38105 | cmaynard | 2011-07-18 19:47:12 -0700 (Mon, 18 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

From Michael Mann via bug 5769:  In fDevice_Instance(), add field in proper
big-endian byte order.

Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5769

------------------------------------------------------------------------
r38104 | guy | 2011-07-18 19:29:31 -0700 (Mon, 18 Jul 2011) | 4 lines
Changed paths:
   M /trunk/macosx-setup.sh

Work around an annoying problem caused by the collision of GNU gettext's
configure script's attempts to deal with AIX 4 and Lion and/or Xcode 4's
dealings with Fortify.

------------------------------------------------------------------------
r38103 | cmaynard | 2011-07-18 18:46:16 -0700 (Mon, 18 Jul 2011) | 4 lines
Changed paths:
   M /trunk/CMakeLists.txt

At the request of Tony Trinh on -dev, set(CMAKE_VERBOSE_MAKEFILE OFF)

Ref: http://www.wireshark.org/lists/wireshark-dev/201107/msg00156.html

------------------------------------------------------------------------
r38098 | jmayer | 2011-07-18 13:49:35 -0700 (Mon, 18 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/proto_help.c

Add instructions how to use the database offline (taken from
an explanation by Chris Maynard)

------------------------------------------------------------------------
r38097 | jmayer | 2011-07-18 13:44:01 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/proto_help.c

Add a comment how to actually use the protocol help.

------------------------------------------------------------------------
r38095 | wmeier | 2011-07-18 12:11:32 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-pppoe.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-rdt.c
   M /trunk/epan/dissectors/packet-rpcap.c
   M /trunk/epan/dissectors/packet-rsvp.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-rtmpt.c
   M /trunk/epan/dissectors/packet-rtps.c
   M /trunk/epan/dissectors/packet-rtps2.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38093 | jmayer | 2011-07-18 11:24:22 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

Update status file to current state and statistics

------------------------------------------------------------------------
r38092 | jmayer | 2011-07-18 11:16:36 -0700 (Mon, 18 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/tcp_graph.c

Fix some trivial cases of gdk-deprecated warnings. The remaining
ones have to be fixed by someone who understands the code.

------------------------------------------------------------------------
r38091 | tuexen | 2011-07-18 10:44:26 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Ignore interfaces without a name.

------------------------------------------------------------------------
r38090 | tuexen | 2011-07-18 10:15:45 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_if_dlg.c

Make a check a bit more pedantic.

------------------------------------------------------------------------
r38087 | tuexen | 2011-07-18 09:20:19 -0700 (Mon, 18 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/main_welcome.h

Make sure that the Capture/Start menue item will always use the
same interfaces as selected in the Main Welcome Window.

------------------------------------------------------------------------
r38086 | wmeier | 2011-07-18 08:54:25 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sasp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38085 | wmeier | 2011-07-18 08:52:16 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sbus.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-sgsap.c
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/dissectors/packet-tipc.c
   M /trunk/epan/dissectors/packet-v5ua.c
   M /trunk/epan/dissectors/packet-wtls.c
   M /trunk/epan/dissectors/packet-xtp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38084 | tuexen | 2011-07-18 06:36:11 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Get --enable-ui-manager working.

------------------------------------------------------------------------
r38083 | jmayer | 2011-07-18 06:19:34 -0700 (Mon, 18 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/proto_help.c

Small comment update: GtkItemFactory has been deprecated as of gtk 2.4
(aka close to forever).

------------------------------------------------------------------------
r38082 | wmeier | 2011-07-18 05:50:26 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-zbee-zcl.c
   M /trunk/epan/dissectors/packet-zbee-zdp-binding.c
   M /trunk/epan/dissectors/packet-zbee-zdp-discovery.c
   M /trunk/epan/dissectors/packet-zbee-zdp-management.c
   M /trunk/epan/dissectors/packet-zbee-zdp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38081 | jmayer | 2011-07-18 05:49:16 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Add option --enable-uimanager to mimic cmake -DUI_MANAGER=ON

------------------------------------------------------------------------
r38080 | jmayer | 2011-07-18 05:44:19 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Add instructions how to work with "git svn" instead of "svn"

------------------------------------------------------------------------
r38079 | jmayer | 2011-07-18 05:40:40 -0700 (Mon, 18 Jul 2011) | 7 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/STATUS.gtk3
   M /trunk/gtk/proto_help.c

Update STATUS.gtk3
Make linking with stubbed out proto_help functions really work.
Add a comment to proto_help that its functionality will be lost
  once we make the ui-manager code default unless someone cares
  enough to fix it.
Enable -DGTK_DISABLE_DEPRECATED iff building with ui-manager.

------------------------------------------------------------------------
r38078 | jmayer | 2011-07-18 05:18:00 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/proto_help.c

Prevent error about undefined function while linking.

------------------------------------------------------------------------
r38077 | martinm | 2011-07-18 04:57:38 -0700 (Mon, 18 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

For UL retx, show links forward to next Tx as well as backwards to previous.


------------------------------------------------------------------------
r38076 | martinm | 2011-07-18 03:40:57 -0700 (Mon, 18 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Add a generated field for the number of NACKs in an AM status PDU.

------------------------------------------------------------------------
r38075 | guy | 2011-07-17 16:47:10 -0700 (Sun, 17 Jul 2011) | 2 lines
Changed paths:
   M /trunk/packaging/macosx/osx-app.sh

We don't have an "--enable-osxapp" configure option; update a comment.

------------------------------------------------------------------------
r38074 | guy | 2011-07-17 13:40:13 -0700 (Sun, 17 Jul 2011) | 2 lines
Changed paths:
   M /trunk/packaging/macosx/Makefile.am

Get rid of the .pkg and .dmg with "make clean".

------------------------------------------------------------------------
r38073 | guy | 2011-07-17 13:36:17 -0700 (Sun, 17 Jul 2011) | 2 lines
Changed paths:
   M /trunk/packaging/macosx

Add the .pkg and .dmg to the list of files to ignore.

------------------------------------------------------------------------
r38072 | guy | 2011-07-17 13:23:07 -0700 (Sun, 17 Jul 2011) | 2 lines
Changed paths:
   M /trunk/packaging/macosx/osx-app.sh

Handle versions of GTK+ where gdk-pixbuf is a separate library.

------------------------------------------------------------------------
r38071 | stig | 2011-07-17 10:56:57 -0700 (Sun, 17 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/wspython/Makefile.am

Cleanup and indent in Makefile.
------------------------------------------------------------------------
r38070 | stig | 2011-07-17 10:56:42 -0700 (Sun, 17 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/wspython/register-dissector.py

Check for a valid wspy_dissectors disectory to avoid a warning if missing.
------------------------------------------------------------------------
r38067 | gerald | 2011-07-17 07:03:36 -0700 (Sun, 17 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-07-17]
------------------------------------------------------------------------
r38066 | etxrab | 2011-07-17 06:18:55 -0700 (Sun, 17 Jul 2011) | 1 line
Changed paths:
   M /trunk/config.nmake

Include Cairo lib to be able to use caro functions.
------------------------------------------------------------------------
r38065 | sake | 2011-07-17 04:08:02 -0700 (Sun, 17 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/follow.c

Repair "Follow TCP Stream" which got broken by my change in SVN 38056

Mental note: Try to not do half work ;-)


------------------------------------------------------------------------
r38064 | stig | 2011-07-16 11:30:57 -0700 (Sat, 16 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/prefs.c

Improved check for valid custom column in preferences.

This fixes bug 6131.
------------------------------------------------------------------------
r38063 | tuexen | 2011-07-16 10:04:48 -0700 (Sat, 16 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Remove redundant code.

------------------------------------------------------------------------
r38062 | tuexen | 2011-07-16 07:19:43 -0700 (Sat, 16 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

Use correct plausability check.

------------------------------------------------------------------------
r38061 | tuexen | 2011-07-16 06:05:46 -0700 (Sat, 16 Jul 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt

Add option for USE_THREADS.

------------------------------------------------------------------------
r38060 | tuexen | 2011-07-16 06:02:44 -0700 (Sat, 16 Jul 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Use threads per default. Same as on Windows.

------------------------------------------------------------------------
r38059 | tuexen | 2011-07-16 05:45:47 -0700 (Sat, 16 Jul 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Use the threads based workaround only on windows (with thread support enabled),
since the workaround is only intended to work on windows.

------------------------------------------------------------------------
r38058 | tuexen | 2011-07-16 05:19:57 -0700 (Sat, 16 Jul 2011) | 2 lines
Changed paths:
   M /trunk/version_info.c

Provide information regarding thred support.

------------------------------------------------------------------------
r38057 | tuexen | 2011-07-16 04:07:32 -0700 (Sat, 16 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main_welcome.c

Don't allow capturing from multiple interface when compiled with multiple thread
support.

------------------------------------------------------------------------
r38056 | sake | 2011-07-15 16:40:16 -0700 (Fri, 15 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tcp.h

Stop using the conversation index for tcp stream values as the gaps in the numbering is causing to many questions. Also, numbering could be different for the same file when viewed on different Wireshark versions, which could lead to confusion too.

(see also: http://ask.wireshark.org/questions/5056/how-does-wireshark-calculate-the-tcp-stream-index)

------------------------------------------------------------------------
r38055 | guy | 2011-07-15 16:26:22 -0700 (Fri, 15 Jul 2011) | 7 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/macosx-setup.sh
   A /trunk/macosx-support-lib-patches/gnutls-pkgconfig.patch

Patch GnuTLS's pkg-config file; it says "requires zlib", but OS X, while
it supplies zlib, doesn't supply a pkgconfig file for it, so we don't
want it to say "requires zlib".

This script is part of the Wireshark source, so giving "download
Wireshark source" as the next step doesn't make sense.

------------------------------------------------------------------------
r38054 | sfisher | 2011-07-15 15:50:53 -0700 (Fri, 15 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dec-dnart.c


Update URL addition in r37899 with an "original" site instead of a mirror.


------------------------------------------------------------------------
r38053 | guy | 2011-07-15 14:48:02 -0700 (Fri, 15 Jul 2011) | 8 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/README.macos
   A /trunk/macosx-setup.sh
   A /trunk/macosx-support-lib-patches
   A /trunk/macosx-support-lib-patches/glib-gconvert.patch
   A /trunk/macosx-support-lib-patches/glib-pkgconfig.patch

Add Joerg Mayer's macos-setup.sh script, modified to add an "x" after
"macos", to fix some bugs, to use "sudo" if necessary when installing,
to make the library version numbers variables, and to download the
optional libraries, by default, as well.  Also add his patches to make
GLib build and work.

Update README.macos to reflect that.

------------------------------------------------------------------------
r38052 | tuexen | 2011-07-15 14:26:43 -0700 (Fri, 15 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/menus.c

Get rid of two gtk runtime warnings.

------------------------------------------------------------------------
r38051 | tuexen | 2011-07-15 13:45:28 -0700 (Fri, 15 Jul 2011) | 2 lines
Changed paths:
   M /trunk/summary.c
   M /trunk/summary.h

Don't show interface info when loading a capture file.

------------------------------------------------------------------------
r38050 | stig | 2011-07-15 12:35:46 -0700 (Fri, 15 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def

From bug 6129:
Added proto_tree_add_uint_bits_format_value to libwireshark.def.
------------------------------------------------------------------------
r38049 | wmeier | 2011-07-15 12:07:25 -0700 (Fri, 15 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc
   M /trunk/epan/dissectors/packet-netflow.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-opensafety.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38048 | wmeier | 2011-07-15 10:44:24 -0700 (Fri, 15 Jul 2011) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Update ptvcursor API description to reflect 'endianness' --> 'encoding' parameter change.

------------------------------------------------------------------------
r38047 | wmeier | 2011-07-15 09:59:18 -0700 (Fri, 15 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
Whitespace changes: "4 space tabs" --> spaces.

------------------------------------------------------------------------
r38046 | tuexen | 2011-07-15 07:59:42 -0700 (Fri, 15 Jul 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Ensure that USE_THREADS is defined when --enable-threads is specified.

------------------------------------------------------------------------
r38045 | tuexen | 2011-07-15 07:58:45 -0700 (Fri, 15 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

You can't create a mutex without initializing the thread system.
So #ifdef the code with USE_THREADS.

------------------------------------------------------------------------
r38044 | tuexen | 2011-07-15 07:31:27 -0700 (Fri, 15 Jul 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/gtk/prefs_taps.c

Fix compilation on non-windows platforms defining USE_THREADS.

------------------------------------------------------------------------
r38043 | tuexen | 2011-07-15 05:20:00 -0700 (Fri, 15 Jul 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Handle the case where dumpcap is compiled without thread support, which
is the default.

------------------------------------------------------------------------
r38042 | jmayer | 2011-07-15 04:14:41 -0700 (Fri, 15 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Add a missing ( in the UI_MANAGER case

------------------------------------------------------------------------
r38041 | sake | 2011-07-15 01:57:59 -0700 (Fri, 15 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

* If first 8 bytes in icmp data do not look like a timestamp in BE, try LE representation.

* Change field title to not confuse people when the clocks of the pinging system and the capturing system are not in sync.


------------------------------------------------------------------------
r38040 | stig | 2011-07-15 01:23:49 -0700 (Fri, 15 Jul 2011) | 2 lines
Changed paths:
   M /trunk/asn1/hnbap
   M /trunk/asn1/rua

Set default svn:ignore targets on rua and hnbap.

------------------------------------------------------------------------
r38039 | cmaynard | 2011-07-14 21:40:03 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Fix "comparison between signed and unsigned" warning.

------------------------------------------------------------------------
r38038 | cmaynard | 2011-07-14 19:39:53 -0700 (Thu, 14 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Be sure there's enough bytes in the ICMP payload before trying to access it in
order to try to determine if it contains a timestamp.  Added some FIXME notes.

------------------------------------------------------------------------
r38037 | cmaynard | 2011-07-14 18:30:06 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/config.h.win32

No need to define USE_THREADS twice.

------------------------------------------------------------------------
r38036 | wmeier | 2011-07-14 17:15:01 -0700 (Thu, 14 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lwres.c
   M /trunk/epan/dissectors/packet-mstp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
Also: whitespace cleanup.

------------------------------------------------------------------------
r38035 | wmeier | 2011-07-14 17:13:59 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mikey.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r38034 | wmeier | 2011-07-14 17:08:45 -0700 (Thu, 14 Jul 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-msrp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
Also:
 - Move proto_reg_handoff_msrp() to the end of the file;
 - Define a function and a global variable as static;


------------------------------------------------------------------------
r38033 | gerald | 2011-07-14 16:18:02 -0700 (Thu, 14 Jul 2011) | 4 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.h.win32
   M /trunk/dumpcap.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/main_welcome.h
   M /trunk/gtk/menus.c

On Windows enable threads everywhere instead of just in dumpcap. If
threads are enabled use them to check the recent file list. Fixes bug
3810.

------------------------------------------------------------------------
r38032 | wmeier | 2011-07-14 15:17:17 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/tap-rtp-common.c

Add a note re possible issues when 'info_all_data_present == FALSE'

------------------------------------------------------------------------
r38031 | etxrab | 2011-07-14 15:08:15 -0700 (Thu, 14 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/menus.c

Fix trunk/gtk/menus.c:4427:9: error: âsep_entryâ undeclared (first use in this function)
------------------------------------------------------------------------
r38030 | sake | 2011-07-14 15:03:13 -0700 (Thu, 14 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

Make windows buildbot happy (hopefully!)


------------------------------------------------------------------------
r38029 | wmeier | 2011-07-14 14:37:39 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/asn1/tetra/tetra.asn

Fix a property name typo: svn:keyworrds --> svn:keywords

------------------------------------------------------------------------
r38028 | sake | 2011-07-14 14:27:17 -0700 (Thu, 14 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmp.c

If the first 8 bytes of the icmp echo/echo-reply data look like a timestamp, dissect it as a timestmap and calculate the time since the icmp packet was created.


------------------------------------------------------------------------
r38027 | jmayer | 2011-07-14 14:25:33 -0700 (Thu, 14 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Remove trailing whitespace
Replace a deprecated gdk function

------------------------------------------------------------------------
r38026 | wmeier | 2011-07-14 14:24:37 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/tap-rtspstat.c

Fix property name typo:   svn:eol-syle --> svn:eol-style

------------------------------------------------------------------------
r38025 | wmeier | 2011-07-14 13:58:14 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/tap-rlcltestat.c

Use correct property name: svn.keywords --> svn:keywords

------------------------------------------------------------------------
r38024 | etxrab | 2011-07-14 13:36:00 -0700 (Thu, 14 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/menus.c
   M /trunk/gtk/proto_help.c

Remove GtkItemFactoryEntry code in MAIN_MENU_USE_UIMANAGER
code path.
Don't build and don't use protocol help if MAIN_MENU_USE_UIMANAGER is defined.
------------------------------------------------------------------------
r38023 | wmeier | 2011-07-14 12:51:53 -0700 (Thu, 14 Jul 2011) | 6 lines
Changed paths:
   M /trunk/gtk/rtp_player.c

Fix a crash when doing Telephony ! RTP ! Stream Analysis with capture files with truncated frames.
(That is: the capture files were created with a snapshot length less than the maximum).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6120


------------------------------------------------------------------------
r38019 | martinm | 2011-07-14 10:07:41 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.common
   M /trunk/doc/tshark.pod
   A /trunk/tap-rlcltestat.c

Add LTE RLC stats tap to tshark.

------------------------------------------------------------------------
r38018 | tuexen | 2011-07-14 09:54:44 -0700 (Thu, 14 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Add back r37749, which was taken out by accident.
Thanks to Stephen Fisher for pointing it out.

------------------------------------------------------------------------
r38017 | gal | 2011-07-14 06:47:13 -0700 (Thu, 14 Jul 2011) | 3 lines
Changed paths:
   M /trunk/asn1/pkcs1/Makefile.common
   D /trunk/asn1/pkcs1/PKCS1.asn
   A /trunk/asn1/pkcs1/PKIXAlgs-2009.asn
   M /trunk/asn1/pkcs1/packet-pkcs1-template.c
   M /trunk/asn1/pkcs1/pkcs1.cnf
   M /trunk/epan/dissectors/packet-pkcs1.c
   M /trunk/epan/dissectors/packet-pkcs1.h

Update the algorithms in line with RFC 5912 including support for eliptic curve algorithms.


------------------------------------------------------------------------
r38016 | martinm | 2011-07-14 06:39:02 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.common
   M /trunk/doc/tshark.pod
   A /trunk/tap-macltestat.c

Add LTE MAC statistics to tshark.

------------------------------------------------------------------------
r38015 | jmayer | 2011-07-14 02:43:53 -0700 (Thu, 14 Jul 2011) | 18 lines
Changed paths:
   M /trunk/gtk/main_filter_toolbar.c
   M /trunk/gtk/main_toolbar.c

Fix the last non-gtkitemfactory stuff for use with -DGTK_DISABLE_DEPRECATED.
Left are:

gtk/menus.c:4382:5: error: ‘GtkItemFactoryEntry’ undeclared (first use in this function)
gtk/menus.c:4382:26: error: ‘sep_entry’ undeclared (first use in this function)
gtk/proto_help.c:79:16: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
gtk/proto_help.c:166:2: error: ‘g_ph_menu_factory’ undeclared (first use in this function)
gtk/proto_help.c:166:2: error: implicit declaration of function ‘gtk_item_factory_from_widget’
gtk/proto_help.c:181:6: error: ‘g_ph_menu_factory’ undeclared (first use in this function)
gtk/proto_help.c:183:2: error: implicit declaration of function ‘gtk_item_factory_get_widget’
gtk/proto_help.c:191:2: error: implicit declaration of function ‘gtk_item_factory_get_item’
gtk/proto_help.c:216:2: error: ‘GtkItemFactoryEntry’ undeclared (first use in this function)
gtk/proto_help.c:216:23: error: ‘menu_entry’ undeclared (first use in this function)
gtk/proto_help.c:217:2: error: ISO C90 forbids mixed declarations and code
gtk/proto_help.c:222:6: error: ‘g_ph_menu_factory’ undeclared (first use in this function)
gtk/proto_help.c:258:4: error: implicit declaration of function ‘gtk_item_factory_create_item’


------------------------------------------------------------------------
r38014 | gal | 2011-07-14 01:47:05 -0700 (Thu, 14 Jul 2011) | 5 lines
Changed paths:
   M /trunk/asn1/pkixac/PKIXAttributeCertificate.asn
   M /trunk/asn1/pkixac/packet-pkixac-template.c
   M /trunk/asn1/pkixac/pkixac.cnf
   M /trunk/epan/dissectors/packet-pkixac.c

Update to correct the definition of the clearance attribute used in certificates.
RFC3281 erroneously defined the Clearance attribute to be different to that defined in X.509. This has been recognised and corrected in RFC5755.
The RFC3281 syntax is retained and registered as the "RFC3281Clearance" syntax, which can be used to override the correct syntax in the BER oidtables if necessary.


------------------------------------------------------------------------
r38013 | etxrab | 2011-07-14 01:11:16 -0700 (Thu, 14 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/tcp_graph.c
   M /trunk/tools/checkAPIs.pl

Replace deprecated gdk_pixmap_unref() with g_object_unref().
Update checkAPIs.
------------------------------------------------------------------------
r38012 | etxrab | 2011-07-14 01:02:32 -0700 (Thu, 14 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/menus.c

From Joerg Mayer:
Patch fixes most of the remaining errors when compiling with
GTK_DISABLE_DEPRECATED.
------------------------------------------------------------------------
r38011 | guy | 2011-07-13 20:15:09 -0700 (Wed, 13 Jul 2011) | 8 lines
Changed paths:
   M /trunk/docbook/Makefile.nmake

As with Makefile.am, so with Makefile.nmake.  To quote the comment for
rev 37866:

  Removed empty directory docbook/wsluarm_src.  It's generated during 'make',
  and now removed during 'make clean'.

so we have to generate it now during nmake as well.

------------------------------------------------------------------------
r38007 | jmayer | 2011-07-13 17:16:14 -0700 (Wed, 13 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/STATUS.gtk3

Update status of compile with -DGTK_DISABLE_DEPRECATED

------------------------------------------------------------------------
r38006 | jmayer | 2011-07-13 17:04:37 -0700 (Wed, 13 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/flow_graph.c
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/gtkvumeter.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/mcast_stream_dlg.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/rtp_stream_dlg.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/sctp_stat_dlg.c
   M /trunk/gtk/voip_calls_dlg.c

Fix some compiler errors with -DGTK_DISABLE_DEPRECATED
------------------------------------------------------------------------
r38005 | jmayer | 2011-07-13 15:49:38 -0700 (Wed, 13 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/packet_list_store.c

make compiling with -DGTK_DISABLE_DEPRECATED work
------------------------------------------------------------------------
r38004 | jmayer | 2011-07-13 15:32:05 -0700 (Wed, 13 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/dlg_utils.c
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/hostlist_table.c

make compiling with -DGTK_DISABLE_DEPRECATED work
------------------------------------------------------------------------
r38001 | wmeier | 2011-07-13 12:48:58 -0700 (Wed, 13 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-m3ua.c
   M /trunk/epan/dissectors/packet-megaco.c
   M /trunk/epan/dissectors/packet-mgcp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings

------------------------------------------------------------------------
r37999 | wmeier | 2011-07-13 11:42:40 -0700 (Wed, 13 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-spoolss.c
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-giop.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings

------------------------------------------------------------------------
r37998 | wmeier | 2011-07-13 10:04:55 -0700 (Wed, 13 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-amqp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings

------------------------------------------------------------------------
r37997 | etxrab | 2011-07-13 07:47:31 -0700 (Wed, 13 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/tcp_graph.c

Remove two deprecated functions.
------------------------------------------------------------------------
r37996 | etxrab | 2011-07-13 01:48:13 -0700 (Wed, 13 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/expert_comp_dlg.c
   M /trunk/gtk/flow_graph.c
   M /trunk/gtk/mac_lte_stat_dlg.c
   M /trunk/gtk/main_toolbar.c
   M /trunk/gtk/mcast_stream_dlg.c
   M /trunk/gtk/prefs_capture.c
   M /trunk/gtk/prefs_dlg.c
   M /trunk/gtk/prefs_dlg.h
   M /trunk/gtk/prefs_gui.c
   M /trunk/gtk/prefs_layout.c
   M /trunk/gtk/prefs_nameres.c
   M /trunk/gtk/prefs_protocols.c
   M /trunk/gtk/prefs_taps.c
   M /trunk/gtk/range_utils.c
   M /trunk/gtk/rlc_lte_stat_dlg.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/rtp_stream_dlg.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/uat_gui.c
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/gtk/wlan_stat_dlg.c

Fix more tooltips fixes.
------------------------------------------------------------------------
r37995 | tuexen | 2011-07-12 14:33:11 -0700 (Tue, 12 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Display interface stuff only when interfaces are available.

------------------------------------------------------------------------
r37994 | jmayer | 2011-07-12 14:24:15 -0700 (Tue, 12 Jul 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt

Copy over behaviour of commit 37967 for configure.in

------------------------------------------------------------------------
r37993 | jmayer | 2011-07-12 14:21:13 -0700 (Tue, 12 Jul 2011) | 2 lines
Changed paths:
   M /trunk/cmake/modules/FindGTK2.cmake

Remote trailing whitespace

------------------------------------------------------------------------
r37992 | guy | 2011-07-12 10:19:17 -0700 (Tue, 12 Jul 2011) | 3 lines
Changed paths:
   M /trunk/CMakeOptions.txt

Add a comment noting why AirPcap support cannot be unconditionally
enabled by default (i.e., it's Windows-only).  InterCap the name.

------------------------------------------------------------------------
r37991 | tuexen | 2011-07-12 04:10:57 -0700 (Tue, 12 Jul 2011) | 2 lines
Changed paths:
   M /trunk/CMakeOptions.txt

Disable airpcap by default. This matches the configure script.

------------------------------------------------------------------------
r37990 | tuexen | 2011-07-12 04:06:44 -0700 (Tue, 12 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

This fixes the compile issue reported in
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6111


------------------------------------------------------------------------
r37989 | martinm | 2011-07-12 03:49:22 -0700 (Tue, 12 Jul 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/catapult_dct2000.c

Speed up (slightly) reading of long text lines.

------------------------------------------------------------------------
r37988 | etxrab | 2011-07-11 23:54:01 -0700 (Mon, 11 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/prefs_column.c
   M /trunk/gtk/print_dlg.c
   M /trunk/gtk/profile_dlg.c

Fix more tooltips.
------------------------------------------------------------------------
r37987 | etxrab | 2011-07-11 23:15:24 -0700 (Mon, 11 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/main_airpcap_toolbar.c
   M /trunk/gtk/main_filter_toolbar.c
   M /trunk/gtk/main_statusbar.c
   M /trunk/gtk/manual_addr_resolv.c
   M /trunk/gtk/menus.c

Fix more tooltips.
------------------------------------------------------------------------
r37986 | guy | 2011-07-11 17:14:37 -0700 (Mon, 11 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/charsets.c

Add a bunch of URLs for character encoding information.

------------------------------------------------------------------------
r37983 | gerald | 2011-07-11 15:51:46 -0700 (Mon, 11 Jul 2011) | 2 lines
Changed paths:
   M /trunk/capture_opts.c

Having a non-NULL capture_opts->save_file might make us crash less.

------------------------------------------------------------------------
r37982 | gerald | 2011-07-11 15:41:53 -0700 (Mon, 11 Jul 2011) | 2 lines
Changed paths:
   M /trunk/test/suite-capture.sh

Use the proper function name.

------------------------------------------------------------------------
r37980 | etxrab | 2011-07-11 14:29:47 -0700 (Mon, 11 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/firewall_dlg.c
   M /trunk/gtk/follow_stream.c

Fix more tooltips.
------------------------------------------------------------------------
r37978 | gerald | 2011-07-11 13:32:19 -0700 (Mon, 11 Jul 2011) | 7 lines
Changed paths:
   M /trunk/doc/README.developer
   M /trunk/epan/Makefile.common
   M /trunk/epan/dfilter/semcheck.c
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-synphasor.c
   M /trunk/epan/emem.h
   M /trunk/epan/epan.c
   M /trunk/epan/except.h
   M /trunk/epan/filesystem.c
   M /trunk/epan/ftypes/ftype-bytes.c
   M /trunk/epan/ftypes/ftype-pcre.c
   M /trunk/epan/ftypes/ftype-string.c
   M /trunk/epan/ftypes/ftype-tvbuff.c
   M /trunk/epan/ftypes/ftypes-int.h
   M /trunk/epan/ftypes/ftypes.h
   D /trunk/epan/g_gnuc.h
   M /trunk/epan/packet.c
   M /trunk/epan/proto.h
   M /trunk/epan/reassemble.c
   M /trunk/epan/reassemble.h
   M /trunk/epan/reassemble_test.c
   M /trunk/epan/tvbtest.c
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h
   M /trunk/gtk/expert_comp_table.c
   M /trunk/wsutil/file_util.c
   M /trunk/wsutil/file_util.h

More GLIB_CHECK_VERSION cleanups. Update the minimum GLib/GTK+ versions
in README.devloper. Remove g_gnuc.h since it's no longer needed. Remove
tvbuff_init(), tvbuff_cleanup(), reassemble_init(), and
reassemble_cleanup() since they were only used for older GLib versions
which didn't support GSlices. Assume we always support the "matches"
operator.

------------------------------------------------------------------------
r37976 | etxrab | 2011-07-11 13:01:28 -0700 (Mon, 11 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/fileset_dlg.c
   M /trunk/gtk/filter_dlg.c
   M /trunk/gtk/find_dlg.c
   M /trunk/tools/checkAPIs.pl

Fix more tooltips, mark gtk_tooltips_new with 'E' in checkapi.
------------------------------------------------------------------------
r37975 | etxrab | 2011-07-11 12:34:57 -0700 (Mon, 11 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/gtk/decode_as_dlg.c
   M /trunk/gtk/export_object.c

Fix a couple of tooltips.
------------------------------------------------------------------------
r37974 | gerald | 2011-07-11 12:15:57 -0700 (Mon, 11 Jul 2011) | 4 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/version_info.c

In version_info.c, assume we always have the "matches" operator. In
capture_opts.c, assume our output filename has been passed through
arg_list_utf_16to8().

------------------------------------------------------------------------
r37973 | gerald | 2011-07-11 12:10:57 -0700 (Mon, 11 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/about_dlg.c
   M /trunk/gtk/airpcap_gui_utils.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_file_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/color_dlg.c
   M /trunk/gtk/color_edit_dlg.c
   M /trunk/gtk/color_utils.c
   M /trunk/gtk/color_utils.h
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/dfilter_expr_dlg.c
   M /trunk/gtk/dissector_tables_dlg.c
   M /trunk/gtk/expert_comp_dlg.c
   M /trunk/gtk/expert_comp_table.c
   M /trunk/gtk/export_object_smb.c
   M /trunk/gtk/export_sslkeys.c

Remaining GLIB_CHECK_VERSION and GTK_CHECK_VERSION in the gtk directory.

------------------------------------------------------------------------
r37972 | etxrab | 2011-07-11 11:54:49 -0700 (Mon, 11 Jul 2011) | 1 line
Changed paths:
   M /trunk/gtk/about_dlg.c
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/airpcap_gui_utils.c
   M /trunk/gtk/ansi_a_stat.c
   M /trunk/gtk/ansi_map_stat.c

GTK_CHECK_VERSION cleanup.
------------------------------------------------------------------------
r37971 | gerald | 2011-07-11 11:35:36 -0700 (Mon, 11 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/file_import_dlg.c
   M /trunk/gtk/filter_autocomplete.c
   M /trunk/gtk/filter_dlg.c
   M /trunk/gtk/firewall_dlg.c
   M /trunk/gtk/follow_stream.c
   M /trunk/gtk/gsm_a_stat.c
   M /trunk/gtk/gsm_map_stat.c
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/io_stat.c

More GLIB_CHECK_VERSION and GTK_CHECK_VERSION cleanup.

------------------------------------------------------------------------
r37970 | gerald | 2011-07-11 11:18:35 -0700 (Mon, 11 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_proto_draw.c
   M /trunk/gtk/manual_addr_resolv.c
   M /trunk/gtk/mcast_stream_dlg.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/mtp3_stat.c
   M /trunk/gtk/mtp3_summary.c
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/pixmap_save.c
   M /trunk/gtk/prefs_capture.c
   M /trunk/gtk/prefs_column.c
   M /trunk/gtk/proto_help.c
   M /trunk/gtk/proto_hier_stats_dlg.c

More GLIB_CHECK_VERSION, GTK_CHECK_VERSION, and related whitespace
cleanup.

------------------------------------------------------------------------
r37969 | gerald | 2011-07-11 11:08:08 -0700 (Mon, 11 Jul 2011) | 3 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_stream_dlg.c
   M /trunk/gtk/sctp_assoc_analyse.c
   M /trunk/gtk/sctp_chunk_stat_dlg.c
   M /trunk/gtk/sctp_error_dlg.c
   M /trunk/gtk/sctp_stat_dlg.c
   M /trunk/gtk/simple_dialog.c
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/gtk/wlan_stat_dlg.c

Remove a lot of instances of GTK_CHECK_VERSION. Clean up whitespace in a
couple of places.

------------------------------------------------------------------------
r37967 | gerald | 2011-07-11 10:49:59 -0700 (Mon, 11 Jul 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

Make the minimum GLib version 2.14 and the minimum GTK+ version 2.12.

------------------------------------------------------------------------
r37963 | etxrab | 2011-07-11 06:44:29 -0700 (Mon, 11 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-msrp.c

Change encoding type from FALSE to ENC_BIG_ENDIAN.
------------------------------------------------------------------------
r37962 | etxrab | 2011-07-11 06:43:12 -0700 (Mon, 11 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-capwap.c

From qgj:
when dissect the capwap control header,the sequence's value is decoded
improperly,it tooks the wrong offset value,so the control messages' sequence is
showed improperly.
Changed to uset proto_add_item and encoding type changed from FALSE to ENC_BIG_ENDIAN.
------------------------------------------------------------------------
r37961 | etxrab | 2011-07-11 06:41:19 -0700 (Mon, 11 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Change encoding type from FALSE to ENC_BIG_ENDIAN.
------------------------------------------------------------------------
r37960 | etxrab | 2011-07-11 06:32:04 -0700 (Mon, 11 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsmtap.c

From Ludovic Haessler:
Add 3GPP TS44.060 RLC/MAC control blocks management in GSMTAP dissector.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6103
------------------------------------------------------------------------
r37959 | etxrab | 2011-07-11 03:42:16 -0700 (Mon, 11 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Make sure consumed is set.
------------------------------------------------------------------------
r37958 | etxrab | 2011-07-11 03:12:40 -0700 (Mon, 11 Jul 2011) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

From Michael Mann:
Added filters for BOOTP options of "basic" types (modeled after packet-wssap.c)

"bootp.option.length" only used when specific option filter can't be found.
"bootp.option.value" expanded to support multiple types

Converted "custom options string" to UAT

replacing many proto_tree_add_text() calls with
proto_tree_add_item(), so the BOOTP dissector is considerably more filterable
------------------------------------------------------------------------
r37957 | cmaynard | 2011-07-10 17:17:08 -0700 (Sun, 10 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-giop.c

As noted by Jaap Keuter on -dev, be sure to use message_size instead of
header->message_size for a correct host endianness comparison.


------------------------------------------------------------------------
r37956 | guy | 2011-07-10 15:57:59 -0700 (Sun, 10 Jul 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/lanalyzer.c
   M /trunk/wiretap/lanalyzer.h

Move the definitions of LANalyzer records to lanalyzer.c.

Use LA_RecordHeaderSize rather than sizeof, to squelch some compiler
complaints.

------------------------------------------------------------------------
r37955 | etxrab | 2011-07-10 15:13:03 -0700 (Sun, 10 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-msrp.c

From Jaap:
Limit the search to the line.
------------------------------------------------------------------------
r37954 | guy | 2011-07-10 15:10:07 -0700 (Sun, 10 Jul 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/lanalyzer.c

Define a structure for the record header, and read into that, and then
extract values from it.

------------------------------------------------------------------------
r37953 | guy | 2011-07-10 14:05:19 -0700 (Sun, 10 Jul 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/lanalyzer.c

At that point in the code, bytes_read isn't the total number of record
header bytes read, as we're reading the two header fields separately and
checking the byte count for each read.  We *do*, however, know that the
record header is 4 bytes long, so we can just seek back 4 bytes.

------------------------------------------------------------------------
r37952 | guy | 2011-07-10 11:34:15 -0700 (Sun, 10 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Add port 2710 for the XBT BitTorrent tracker (and note why it's added;
the other unusual ports should be mentioned as well).

------------------------------------------------------------------------
r37951 | guy | 2011-07-10 10:57:39 -0700 (Sun, 10 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c

Make sure the SID string attached to a dcerpc_call_value has session
duration, just as the dcerpc_call_value itself does.

------------------------------------------------------------------------
r37948 | gerald | 2011-07-10 08:03:37 -0700 (Sun, 10 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-07-10]
------------------------------------------------------------------------
r37947 | guy | 2011-07-09 12:58:19 -0700 (Sat, 09 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mbtcp.c

Put Modbus/UDP support back.

------------------------------------------------------------------------
r37946 | guy | 2011-07-09 11:56:21 -0700 (Sat, 09 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c

If the reply length is < 32, that's an overflow, not a bug in the
dissector (unless you consider the calculation not being done in 64 bits
as a bug).  For now, toss a ReportedBoundsError.

------------------------------------------------------------------------
r37945 | cmaynard | 2011-07-08 19:04:48 -0700 (Fri, 08 Jul 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gre.c

Per README.developer, we must call subdissectors regardless of whether "tree"
is NULL or not.  With this change, GRE-encapsulated packets (such as IP)
should now appear in then endpoint and conversation lists.  This was
essentially the request made at Sharkfest '11.  The actual request was for a
"GRE" tab to be added, but that doesn't really make much sense to me.  I
believe this change should fulfill that request.


------------------------------------------------------------------------
r37944 | guy | 2011-07-08 18:41:09 -0700 (Fri, 08 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/help_dlg.c

Point to the right place.

------------------------------------------------------------------------
r37943 | rbalint | 2011-07-08 17:20:13 -0700 (Fri, 08 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main.c

Show a hint to read http://wiki.wireshark.org/CaptureSetup/CapturePrivileges
when showing the warning about running Wireshark as root
Thanks to Evan Huus for the suggestion.

------------------------------------------------------------------------
r37942 | tuexen | 2011-07-08 11:29:02 -0700 (Fri, 08 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/gui_utils.c

Use a pixbuf for widgets used for icons.

------------------------------------------------------------------------
r37941 | martinm | 2011-07-08 09:10:25 -0700 (Fri, 08 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pdcp-lte.h

Trivial: add a couple of newlines.

------------------------------------------------------------------------
r37940 | martinm | 2011-07-08 09:08:32 -0700 (Fri, 08 Jul 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/catapult_dct2000.c

Change the way we scan past characters before the direction indicator.

------------------------------------------------------------------------
r37939 | tuexen | 2011-07-08 06:47:16 -0700 (Fri, 08 Jul 2011) | 6 lines
Changed paths:
   M /trunk/gtk/main.c

If no interface is specified on the command line, use the default
capture interface if given.

This patch is provided by Irene Ruengeler.


------------------------------------------------------------------------
r37938 | tuexen | 2011-07-08 06:40:00 -0700 (Fri, 08 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_if_dlg.c

You can't select/deselct interfaces in the capture/interfaces
dialog while you are capturing.
This patch is provided by Irene Ruengeler.

------------------------------------------------------------------------
r37937 | tuexen | 2011-07-08 02:26:34 -0700 (Fri, 08 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Try to make non-libpcap builds compiling.

------------------------------------------------------------------------
r37936 | tuexen | 2011-07-08 01:49:06 -0700 (Fri, 08 Jul 2011) | 5 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Use the interfaces from the last capturing process as a starting point
for the next one.

Obtained from Irene Ruengeler.

------------------------------------------------------------------------
r37935 | jake | 2011-07-08 00:52:31 -0700 (Fri, 08 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/dcerpc_stat.c

Avoid 'variable set but no used' error from compiler.

------------------------------------------------------------------------
r37934 | guy | 2011-07-07 19:02:37 -0700 (Thu, 07 Jul 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Alas, the libpcap API didn't use "void *" where it should have; squelch
some warnings from Clang.

------------------------------------------------------------------------
r37933 | guy | 2011-07-07 18:58:30 -0700 (Thu, 07 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-batadv.c

%u suffices, as varargs are widened. (It aslso doesn't cause Clang to
complain.)

------------------------------------------------------------------------
r37932 | tuexen | 2011-07-07 14:16:03 -0700 (Thu, 07 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_if_dlg.c

The argument of capture_get_if_icon() is used.

------------------------------------------------------------------------
r37931 | tuexen | 2011-07-07 13:20:55 -0700 (Thu, 07 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Try to unbreak the Mac OS X 10.5 buildbots.

------------------------------------------------------------------------
r37930 | cmaynard | 2011-07-07 09:37:33 -0700 (Thu, 07 Jul 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ansi_a.c

In elem_cell_id_aux(), in the case of an unknown/invalid disc, be sure to
increment the curr_offset by the correct number of bytes; otherwise we can run
into an infinite loop condition such as was the case for bug 6044.

Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6044


------------------------------------------------------------------------
r37929 | tuexen | 2011-07-07 06:57:08 -0700 (Thu, 07 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Bring back interface icons.

Obtained from Irene Ruengeler.

------------------------------------------------------------------------
r37928 | tuexen | 2011-07-07 06:34:40 -0700 (Thu, 07 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Use the interface descriptions again.

This patch is from Irene Ruengeler.

------------------------------------------------------------------------
r37927 | alagoutte | 2011-07-07 03:19:02 -0700 (Thu, 07 Jul 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Ali Bahar via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6093
802.11 Association Response Packet's "Status Code" field is imprecisely decoded/described.

From me :
* Display Reason code in decimal (not Hexa)
* Check list from last standard (802.11-2007, 802.11r-2008, 802.11n-2009, 802.11w-2009 & 802.11z-2011)
* Add link to 802.11z-2010 documentation

------------------------------------------------------------------------
r37926 | etxrab | 2011-07-07 00:44:25 -0700 (Thu, 07 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-csn1.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c

From Ludovic Haessler:
CSN Ack/Nack Description wrongly handled in gsm_rlcmac_dl dissector (3GPP TS 44.060)

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6101
------------------------------------------------------------------------
r37925 | tuexen | 2011-07-06 10:27:42 -0700 (Wed, 06 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Fix a crash when using hidden interfaces.

------------------------------------------------------------------------
r37924 | cmaynard | 2011-07-06 09:22:11 -0700 (Wed, 06 Jul 2011) | 5 lines
Changed paths:
   M /trunk/dumpcap.c

From Jakub Zawadzki via bug 6002:  Don't set state to STATE_EXPECT_DATA if there's no data to read.

Reference: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6002


------------------------------------------------------------------------
r37923 | cmaynard | 2011-07-06 09:03:43 -0700 (Wed, 06 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wsp.c

Fix memory leak, using ep_alloc() instead of g_malloc().

------------------------------------------------------------------------
r37922 | etxrab | 2011-07-06 08:45:56 -0700 (Wed, 06 Jul 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tcp.h

From György Szaniszló:
Introduced a new tcp state variable: maxseqtobeacked, this is the
maximum seq number that can be acked by the rev party in normal case.
This new state variable only serves the proper detection of
tcp.analysis.ack_lost_segment indicator, and decouples it from the detection of
tcp.analysis.lost_segment indicator.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6081
------------------------------------------------------------------------
r37921 | etxrab | 2011-07-06 08:39:25 -0700 (Wed, 06 Jul 2011) | 4 lines
Changed paths:
   M /trunk/plugins/wimax/msg_dlmap.c

From Kluchnikov Ivan:
Decoding Phy Synchronization Field in wimax DL-MAP and Compressed DL-MAP.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6068
------------------------------------------------------------------------
r37920 | martinm | 2011-07-06 07:56:42 -0700 (Wed, 06 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Add
#if defined(_WIN32) || defined(HAVE_PCAP_CREATE)
around access to interface_options.buffer_size

------------------------------------------------------------------------
r37919 | etxrab | 2011-07-06 05:53:04 -0700 (Wed, 06 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.c
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

From Ludovic Haessler:
Wrong decoding of RLC/MAC EGPRS Packet Downlink Ack/Nack (3GPP TS 44.060)

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6098
------------------------------------------------------------------------
r37918 | etxrab | 2011-07-06 05:47:21 -0700 (Wed, 06 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

From HAESSLER:
Abis interface not correctly handled in gsmtap dissector

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6097
------------------------------------------------------------------------
r37917 | tuexen | 2011-07-06 04:35:52 -0700 (Wed, 06 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Use g_object_set() instead of gtk_object_set().

------------------------------------------------------------------------
r37916 | tuexen | 2011-07-06 04:25:57 -0700 (Wed, 06 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Get it even linking...

------------------------------------------------------------------------
r37915 | tuexen | 2011-07-06 04:22:38 -0700 (Wed, 06 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Get it compiling when not having libpcap.

------------------------------------------------------------------------
r37914 | jmayer | 2011-07-06 02:28:40 -0700 (Wed, 06 Jul 2011) | 2 lines
Changed paths:
   M /trunk/cmake/modules/FindPCAP.cmake
   M /trunk/cmakeconfig.h.in

Add detection of rpcap support in libpcap and use it if available.

------------------------------------------------------------------------
r37913 | tuexen | 2011-07-06 02:17:06 -0700 (Wed, 06 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/main_welcome.h

Add support for multiple interface to the main welcome screen.

This patch is from Irene Ruengeler.

------------------------------------------------------------------------
r37912 | guy | 2011-07-05 22:31:42 -0700 (Tue, 05 Jul 2011) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppi-vector.c

Add a URL for the specifications.  (No, the Wireshark source code is not
a specification.)

Put V1 support back, in case there are captures out there with V1
packets and somebody wants to read them.

We don't need two identical tests against the minimum length.

For an unknown version, just put in a text item for the data, don't
append a note to the length field (which is the wrong field to append to
in any case).

Make routines not used outside this file static.

------------------------------------------------------------------------
r37911 | guy | 2011-07-05 21:45:50 -0700 (Tue, 05 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/summary_dlg.c

Constify to squelch compiler warning.

------------------------------------------------------------------------
r37910 | guy | 2011-07-05 21:09:49 -0700 (Tue, 05 Jul 2011) | 9 lines
Changed paths:
   M /trunk/gtk/summary_dlg.c

Don't check for "(null)" as the result of a printf operation; don't pass
in a null pointer to %s in the first place!  Not all printf
implementations necessarily emit "(null)" in that case; perhaps GLib's
does, but we shouldn't even depend on that - we should, instead, at
least print something semi-useful in that case (the link-layer type's
numerical value).

Fix syntax errors in the "no libpcap" case.

------------------------------------------------------------------------
r37909 | guy | 2011-07-05 16:59:23 -0700 (Tue, 05 Jul 2011) | 10 lines
Changed paths:
   M /trunk/epan/dfilter/semcheck.c
   M /trunk/epan/dissectors/packet-drda.c
   M /trunk/epan/dissectors/packet-tn3270.c
   M /trunk/epan/dissectors/packet-tn5250.c
   M /trunk/epan/ftypes/ftype-string.c
   M /trunk/epan/ftypes/ftypes.h
   M /trunk/epan/libwireshark.def
   M /trunk/epan/proto.c
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h
   M /trunk/gtk/packet_win.c
   M /trunk/tshark.c

Add some additional routine variants that handle string encodings, and
make FT_STRING and FT_UINT_STRING handle string encodings.

Get rid of FT_EBCDIC in favor of FT_STRING with ENC_EBCDIC.

Add some URLs for DRDA.

Clean up some stuff in TN3270 and TN5250, including using ENC_ values
for proto_tree_add_item().

------------------------------------------------------------------------
r37908 | guy | 2011-07-05 16:14:00 -0700 (Tue, 05 Jul 2011) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dis-fields.c

The #if 0'ed out code was being used; #if 0'ing it out meant that some
items didn't get put into the protocol tree.  See, for example, the
4548-Bug4668.pcap capture in the Wireshark menagerie (and attached to
bug 4668).

Instead, replace the #if 0'ed out code with code that does what the
non-commented-out line of code did, but doesn't assign to the unused and
now non-existent pi variable.

Make the "hf_id != -1" case the first one, as that should be the
"normal" case.

------------------------------------------------------------------------
r37907 | tuexen | 2011-07-05 14:29:06 -0700 (Tue, 05 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/summary_dlg.c

Don't use strcpy().

------------------------------------------------------------------------
r37906 | guy | 2011-07-05 14:11:58 -0700 (Tue, 05 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Add ett_a11_rqi_grantedqos to the list of ett_ values to be allocated.

Clean up indentation.

------------------------------------------------------------------------
r37905 | tuexen | 2011-07-05 14:11:24 -0700 (Tue, 05 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/summary_dlg.c

(Try to) fix compilation when no libpcap is available.

------------------------------------------------------------------------
r37904 | tuexen | 2011-07-05 13:34:03 -0700 (Tue, 05 Jul 2011) | 5 lines
Changed paths:
   M /trunk/gtk/summary_dlg.c
   M /trunk/summary.c
   M /trunk/summary.h

Add initial support for multiple interfaces. More to come after
the capture options dialog box supports also multiple interfaces.

This patch has been developed by Irene Ruengeler.

------------------------------------------------------------------------
r37903 | tuexen | 2011-07-05 13:29:33 -0700 (Tue, 05 Jul 2011) | 6 lines
Changed paths:
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/dlg_utils.c

Support selecting multiple interfaces in the capture/interfaces
dialog.
Until the capture/options dialog supports multiple interfaces, the
options button is only selectable when 0 or 1 interfaces are selected.
This patch is based on work by Irene Ruengeler.

------------------------------------------------------------------------
r37902 | etxrab | 2011-07-05 08:22:28 -0700 (Tue, 05 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-time.c

From Michael Mann:
Added choice to display UTC or local time.  Defaulted to local for "backwards compatibility"

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3384
------------------------------------------------------------------------
r37901 | etxrab | 2011-07-05 01:20:23 -0700 (Tue, 05 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-batadv.c

From Sven Eckelmann:
Add support for v14

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6046
------------------------------------------------------------------------
r37900 | etxrab | 2011-07-05 01:17:46 -0700 (Tue, 05 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-batadv.c

From Sven Eckelmann:
Rename HNA to TT to use the same names as upstream.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6046
------------------------------------------------------------------------
r37899 | guy | 2011-07-04 15:01:36 -0700 (Mon, 04 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dec-dnart.c

Add a URL for DECnet Phase IV specifications.

------------------------------------------------------------------------
r37898 | etxrab | 2011-07-04 14:43:34 -0700 (Mon, 04 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/column-utils.c
   M /trunk/epan/column.c
   M /trunk/epan/column_info.h
   M /trunk/epan/frame_data.c
   M /trunk/epan/timestamp.h
   M /trunk/epan/wslua/wslua_pinfo.c
   M /trunk/gtk/main.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/packet_list_store.c
   M /trunk/gtk/recent.c
   M /trunk/rawshark.c
   M /trunk/tshark.c

From Michael Mann:
Added ability to display UTC time or UTC time with date.  I liked having the
difference between UTC and local time, not just setting local=UTC.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=2629
------------------------------------------------------------------------
r37897 | etxrab | 2011-07-04 14:20:18 -0700 (Mon, 04 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-batadv.c

From Sven Eckelmann:
Fix size of unicast fragment packet in v12.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5658
------------------------------------------------------------------------
r37896 | etxrab | 2011-07-04 14:16:51 -0700 (Mon, 04 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-batadv.c

From Sven Eckelmann:
Remove unused length_remaining.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5658
------------------------------------------------------------------------
r37895 | stig | 2011-07-04 14:14:43 -0700 (Mon, 04 Jul 2011) | 1 line
Changed paths:
   M /trunk/make-version.pl

Fetch svn revision also when checked out with git-svn.
------------------------------------------------------------------------
r37894 | etxrab | 2011-07-04 14:14:02 -0700 (Mon, 04 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-batadv.c

From Sven Eckelmann:
Unify handling of NULL-tree in dissection routines.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5658
------------------------------------------------------------------------
r37893 | etxrab | 2011-07-04 13:43:29 -0700 (Mon, 04 Jul 2011) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

From Christopher Maynard:
From doc/README.tapping:

IF the tap is going to return private data using the last parameter to
tap_queue_packet() and IF the protocol can appear multiple times inside the
same packet, you will have to make sure that each instance of
tap_queue_packet() is using its own instance of private struct variable
so they don't overwrite each other.

This was the case here, so I changed the static allocation of tap_rec to be
ep_alloc'd.  I also tried to clean up the Info column a bit.  With this patch
applied, the graph now shows the APM and ANM correctly instead of 2 ANM's.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5966
------------------------------------------------------------------------
r37892 | etxrab | 2011-07-04 13:34:04 -0700 (Mon, 04 Jul 2011) | 6 lines
Changed paths:
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/docsis/packet-tlv.h

From Guido Reismueller:
This patch includes alle modem capabilities from DOCSIS 3.0
Until now only modem capabilities 1-12 where implemented.
Now all capabilities 1-40 are included.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6070
------------------------------------------------------------------------
r37891 | etxrab | 2011-07-04 08:04:50 -0700 (Mon, 04 Jul 2011) | 4 lines
Changed paths:
   M /trunk/plugins/wimax/msg_dcd.c

From Kluchnikov Ivan:
Update wimax DCD Message mac version values.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6069
------------------------------------------------------------------------
r37890 | etxrab | 2011-07-04 07:57:12 -0700 (Mon, 04 Jul 2011) | 4 lines
Changed paths:
   M /trunk/plugins/wimax/msg_dlmap.c
   M /trunk/plugins/wimax/msg_ulmap.c

From Kluchnikov Ivan:
Wrong length of items in wimax Compressed DL-MAP and UL-MAP.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6067
------------------------------------------------------------------------
r37889 | etxrab | 2011-07-04 07:33:22 -0700 (Mon, 04 Jul 2011) | 9 lines
Changed paths:
   M /trunk/plugins/wimax/mac_hd_generic_decoder.c
   M /trunk/plugins/wimax/packet-wmx.c
   M /trunk/plugins/wimax/wimax_pdu_decoder.c

From Kluchnikov Ivan:
Wireshark cannot decode wimax compressed DL-MAP without FCH burst.
Function is_down_link use the base station address (bs_address), which is set
in function dissect_wimax_fch_decoder.
Changed function is_down_link, it use packet_info->p2p_dir for check if packet
is downlink. 
packet_info->p2p_dir set in GSMTAP.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6066
------------------------------------------------------------------------
r37888 | etxrab | 2011-07-04 07:07:20 -0700 (Mon, 04 Jul 2011) | 13 lines
Changed paths:
   M /trunk/airpcap_loader.c
   M /trunk/epan/crypt/airpdcap.c
   M /trunk/epan/crypt/airpdcap_user.h
   M /trunk/epan/dissectors/packet-ieee80211.c

From Michael Mann:
Removed "key prefix" need within GUI so it's a little more intuitive (because
that's what this bug is complaining about).  Slight backwards compatibility
issue with UAT (because key prefix was in previous keys), but all development 
(including fix for BUG 1123 that created UAT) has just been on SVN and not
released.

Also adjusted AirPCap (airpcap_loader.c) to account for the lack of "key
prefix".

Addressed some memory leaks/excess string creation.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5985
------------------------------------------------------------------------
r37887 | etxrab | 2011-07-04 07:00:51 -0700 (Mon, 04 Jul 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
This patch will add preliminary Profinet IO transport protocol dissection to
the openSAFETY protocol.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6063
------------------------------------------------------------------------
r37886 | etxrab | 2011-07-03 23:22:15 -0700 (Sun, 03 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

From Pascal Quantin:
Do not trigger an assert when reaching an unknown extension in CHOICE and SEQUENCE types.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6087
------------------------------------------------------------------------
r37885 | etxrab | 2011-07-03 23:11:38 -0700 (Sun, 03 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Error: the blurb for field "Extension header" ("gtp.ext_hdr") matches the field name in packet-gtp.c
------------------------------------------------------------------------
r37884 | guy | 2011-07-03 18:39:13 -0700 (Sun, 03 Jul 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/mime_file.c

Explain a bit more what this does.

------------------------------------------------------------------------
r37883 | darkjames | 2011-07-03 14:18:22 -0700 (Sun, 03 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.nmake

Fix one more undefined reference to `EBCDIC_to_ASCII'

------------------------------------------------------------------------
r37882 | etxrab | 2011-07-03 12:25:34 -0700 (Sun, 03 Jul 2011) | 6 lines
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

From Roland Knall:
implement a named dissector for the PN/IO sub-protocol for
Profinet, as well as a heuristic dissector ("pn_io"), other protocols can
attach too.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6062
------------------------------------------------------------------------
r37881 | etxrab | 2011-07-03 12:17:18 -0700 (Sun, 03 Jul 2011) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Add enums to Event-Trigger" code="1006"
------------------------------------------------------------------------
r37880 | etxrab | 2011-07-03 12:16:21 -0700 (Sun, 03 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

From Martin Isaksson:
PDCP PDU number extension header support.
------------------------------------------------------------------------
r37879 | darkjames | 2011-07-03 11:59:41 -0700 (Sun, 03 Jul 2011) | 4 lines
Changed paths:
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/libwireshark.def

Fix: tvbuff.obj : error LNK2019: unresolved external symbol _EBCDIC_to_ASCII referenced in function _tvb_get_ephemeral_string_enc

Remove duplicated EBCDIC_to_ASCII from libwireshark.def

------------------------------------------------------------------------
r37878 | guy | 2011-07-03 10:54:00 -0700 (Sun, 03 Jul 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def

Need to export EBCDIC_to_ASCII().

------------------------------------------------------------------------
r37876 | guy | 2011-07-03 10:08:25 -0700 (Sun, 03 Jul 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mq.c
   M /trunk/epan/libwireshark.def
   M /trunk/epan/proto.h
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

Add a tvb_get_ephemeral_string_enc() routine that's like
tvb_get_ephemeral_string() but takes an ENC_ value for the character
encoding.  Use it in the MQ dissector to fetch strings to put, for
example, into the Info column, so we properly handle EBCDIC strings
there.

------------------------------------------------------------------------
r37874 | etxrab | 2011-07-03 09:03:46 -0700 (Sun, 03 Jul 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
The way heuristic dissection was handled by the openSAFETY plugin, could lead
to out-of-memory problems with large files (>50.000 packets). The new version
does not use ep_alloc anymore, but a static boolean instead.

Also, the code registering for the SercosIII dissector got simplified, as the
SercosIII dissector is no longer a plugin.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6061
------------------------------------------------------------------------
r37873 | gerald | 2011-07-03 08:19:31 -0700 (Sun, 03 Jul 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-07-03]
------------------------------------------------------------------------
r37872 | guy | 2011-07-02 18:40:12 -0700 (Sat, 02 Jul 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mq.c
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h

Add ENC_ values for UTF-8 and EBCDIC, support them for FT_STRINGZ
values, and use them in the MQ dissector, so EBCDIC strings are
displayed as such.

Fix up some other final arguments to proto_tree_add_item().

------------------------------------------------------------------------
r37871 | wmeier | 2011-07-02 14:36:25 -0700 (Sat, 02 Jul 2011) | 13 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c

Log:
 Fix incorrect usage of gtk_radio_button_new_with_label()/gtk_radio_button_get_group();
 Use gtk_radio_button_new_with_label_from_widget().

 Essentially: gtk_radio_button_get_group() must be called after each gtk_radio_button_new...()
 before using the 'group' GSList pointer in another call to gtk_radio_button_new...().

 In these cases the incorrect usage appears to only have resulted in allowing multiple
 radio buttons to be activated simultaneously.

 (In at least one case elsewhere, the incorrect usage resulted in a Wireshark crash).


------------------------------------------------------------------------
r37870 | wmeier | 2011-07-02 14:06:51 -0700 (Sat, 02 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c

Remove 3 lines of code no longer needed after SVN #37869

------------------------------------------------------------------------
r37869 | wmeier | 2011-07-02 14:00:56 -0700 (Sat, 02 Jul 2011) | 13 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c

Fix incorrect usage of gtk_radio_button_new_with_label()/gtk_radio_button_get_group();
Use gtk_radio_button_new_with_label_from_widget().

Essentially: gtk_radio_button_get_group() must be called after each gtk_radio_button_new...()
before using the 'group' GSList pointer in another call to gtk_radio_button_new...().

In these cases the incorrect usage appears to only have resulted in allowing multiple
radio buttons to be activated simultaneously.

(In at least one case elsewhere, the incorrect usage resulted in a Wireshark crash).



------------------------------------------------------------------------
r37868 | wmeier | 2011-07-02 13:14:41 -0700 (Sat, 02 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/file_import_dlg.c

Whitespace cleanup (trailing spaces).

------------------------------------------------------------------------
r37867 | wmeier | 2011-07-02 12:50:41 -0700 (Sat, 02 Jul 2011) | 14 lines
Changed paths:
   M /trunk/gtk/file_import_dlg.c

Fix: Wireshark crashes after repeating "File -> Import -> Cancel"
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6080

Apparently gtk_radio_button_get_group() must be called after
each addition to the group before the 'group' GSList pointer can be used
again in, for example, a call to get_radio_button_new_with_label().

(Where does it say this in the GTK docs ? It does make sense, tho, given
the way GSLists work).

We'll use gtk_radio_button_new_with_label_from_widget() instead to let GTK
handle the grouping.


------------------------------------------------------------------------
r37866 | stig | 2011-07-02 11:20:39 -0700 (Sat, 02 Jul 2011) | 3 lines
Changed paths:
   M /trunk/docbook
   M /trunk/docbook/Makefile.common
   D /trunk/docbook/wsluarm_src

Removed empty directory docbook/wsluarm_src.  It's generated during 'make',
and now removed during 'make clean'.

------------------------------------------------------------------------
r37865 | gerald | 2011-07-02 08:45:28 -0700 (Sat, 02 Jul 2011) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Update the status of 64-bit Windows.

------------------------------------------------------------------------
r37864 | gerald | 2011-07-02 08:44:17 -0700 (Sat, 02 Jul 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Disable DEBUG_CHILD_DUMPCAP.

------------------------------------------------------------------------
r37863 | jmayer | 2011-07-02 04:33:32 -0700 (Sat, 02 Jul 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

avoid warning about old style function definition

------------------------------------------------------------------------
r37862 | darkjames | 2011-07-01 15:26:02 -0700 (Fri, 01 Jul 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Revert r37857, r37861

------------------------------------------------------------------------
r37861 | darkjames | 2011-07-01 15:00:59 -0700 (Fri, 01 Jul 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Try to get more information about AV.

------------------------------------------------------------------------
r37860 | gerald | 2011-07-01 14:38:56 -0700 (Fri, 01 Jul 2011) | 2 lines
Changed paths:
   M /trunk/test/config.sh

Re-enable Cygwin's error_start environment variable.

------------------------------------------------------------------------
r37859 | stig | 2011-07-01 14:13:40 -0700 (Fri, 01 Jul 2011) | 2 lines
Changed paths:
   M /trunk/color_filters.c
   M /trunk/color_filters.h
   M /trunk/gtk/color_dlg.c

Renamed "___tmp_color_filter___" to "___conversation_color_filter___"
in the coloring rule name to better describe where it comes from.
------------------------------------------------------------------------
r37858 | gerald | 2011-07-01 13:58:10 -0700 (Fri, 01 Jul 2011) | 3 lines
Changed paths:
   M /trunk/test/config.sh

Comment out the addtion of error_start to CYGWIN in case it's clobbering
Jakub's change in r37857.

------------------------------------------------------------------------
r37857 | darkjames | 2011-07-01 13:07:34 -0700 (Fri, 01 Jul 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Catch system exceptions from pcap_open_live() :)

------------------------------------------------------------------------
r37856 | cmaynard | 2011-07-01 12:40:35 -0700 (Fri, 01 Jul 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Since the TCP Flags tree encompasses 12 bits including the 3 reserved bits and
the nonce bit, we should display 3 nibbles on the Flags summary line in order
to represent all flag bits.  While arguably we need not worry about reserved
bits, the nonce bit is not currently represented, so that bit alone pushes us
into the next nibble.


------------------------------------------------------------------------
r37855 | gerald | 2011-07-01 12:36:57 -0700 (Fri, 01 Jul 2011) | 2 lines
Changed paths:
   M /trunk/test/config.sh

Fix indentation.

------------------------------------------------------------------------
r37854 | cmaynard | 2011-07-01 12:17:02 -0700 (Fri, 01 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

I decode_tcp_ports(), don't abort processing zero window probe packets, even if the payload is only a single byte.  Also, for the keep-alives, display any payload that might be present.


------------------------------------------------------------------------
r37853 | cmaynard | 2011-07-01 12:00:14 -0700 (Fri, 01 Jul 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Initialize the TCP windows to the maximum value instead of 0 to avoid false zero window conditions, especially at the beginning of a capture or if only one side of a conversation is captured.  This resolves bug 4716: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=4716.


------------------------------------------------------------------------
r37852 | gerald | 2011-07-01 11:32:57 -0700 (Fri, 01 Jul 2011) | 2 lines
Changed paths:
   M /trunk/test/config.sh

Tell Cygwin to create a core file if we run into any issues.

------------------------------------------------------------------------
r37851 | cmaynard | 2011-07-01 08:44:42 -0700 (Fri, 01 Jul 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

From spamlookup via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6083:
Fix compile error introduced with r37830.


------------------------------------------------------------------------
r37850 | guy | 2011-06-30 16:34:53 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/capture_opts.c

Oops, indented one of the "Promiscuous" ones.

------------------------------------------------------------------------
r37849 | guy | 2011-06-30 15:41:54 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/capture_opts.c

Line up the colons.

------------------------------------------------------------------------
r37848 | guy | 2011-06-30 15:21:16 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/capture_opts.c

It's not made from semolina. :-)

------------------------------------------------------------------------
r37847 | tuexen | 2011-06-30 14:02:11 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Add paranoid debug output in open_capture_device().

------------------------------------------------------------------------
r37846 | gerald | 2011-06-30 13:17:26 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Log the success or failure of pcap_open/pcap_create/pcap_open_live.

------------------------------------------------------------------------
r37845 | guy | 2011-06-30 11:08:42 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def

Export tvb_get_unicode_string().

------------------------------------------------------------------------
r37844 | gerald | 2011-06-30 10:41:46 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/test/suite-capture.sh

Temporarily enable dumpcap debugging.

------------------------------------------------------------------------
r37843 | tuexen | 2011-06-30 04:40:50 -0700 (Thu, 30 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Remove all interfaces when available.
Add a missing g_strdup.

------------------------------------------------------------------------
r37842 | stig | 2011-06-30 02:31:11 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpcap.c

Avoid absurdly large values used in for-loops.

------------------------------------------------------------------------
r37841 | darkjames | 2011-06-30 01:54:24 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/export_object.c

Fix memory leak.

------------------------------------------------------------------------
r37840 | tuexen | 2011-06-29 23:31:52 -0700 (Wed, 29 Jun 2011) | 2 lines
Changed paths:
   M /trunk/capture_opts.c

Cleanup.

------------------------------------------------------------------------
r37839 | cmaynard | 2011-06-29 18:05:49 -0700 (Wed, 29 Jun 2011) | 3 lines
Changed paths:
   M /trunk/docbook/release-notes.xml
   M /trunk/gtk/capture_file_dlg.c
   M /trunk/packet-range.c
   M /trunk/win32/file_dlg_win32.c

Undo r37833 in favor of Sake's changes to be committed at some future date.


------------------------------------------------------------------------
r37838 | gerald | 2011-06-29 17:24:05 -0700 (Wed, 29 Jun 2011) | 2 lines
Changed paths:
   M /trunk/test/suite-capture.sh

Remove tracing.

------------------------------------------------------------------------
r37837 | gerald | 2011-06-29 16:10:49 -0700 (Wed, 29 Jun 2011) | 2 lines
Changed paths:
   M /trunk/test/suite-capture.sh

Temporarily enable tracing for the stdin capture step.

------------------------------------------------------------------------
r37836 | cmaynard | 2011-06-29 11:45:14 -0700 (Wed, 29 Jun 2011) | 3 lines
Changed paths:
   M /trunk/colorfilters
   M /trunk/docbook/release-notes.xml

Don't colorize TCP window updates as "Bad TCP".  This change was made in response to a user request at Sharkfest '11.


------------------------------------------------------------------------
r37835 | cmaynard | 2011-06-29 10:22:18 -0700 (Wed, 29 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

Although technically not needed, for clarity, explicity catch invalid Ethernet frames, increment the "other" count and return.  Previously, code execution would have fallen through to the ETHERNET_II case and capture_ethertype() would have incremented the "other" count.


------------------------------------------------------------------------
r37834 | cmaynard | 2011-06-29 09:59:37 -0700 (Wed, 29 Jun 2011) | 3 lines
Changed paths:
   M /trunk/docbook/release-notes.xml
   M /trunk/epan/dissectors/packet-tcp.c

Indicate TCP fast retransmissions as an expert info note, rather than a warning,just as TCP retransmissions are.  This was a user request from Sharkfest '11.


------------------------------------------------------------------------
r37833 | cmaynard | 2011-06-29 09:31:44 -0700 (Wed, 29 Jun 2011) | 3 lines
Changed paths:
   M /trunk/docbook/release-notes.xml
   M /trunk/gtk/capture_file_dlg.c
   M /trunk/packet-range.c
   M /trunk/win32/file_dlg_win32.c

Based on user feedback from Sharkfest '11, make the default choice when saving or printing packets apply to only displayed packets and not all packets.


------------------------------------------------------------------------
r37832 | cmaynard | 2011-06-29 09:05:56 -0700 (Wed, 29 Jun 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c
   M /trunk/epan/etypes.h

Based on Guy's suggestion from the user mailing list, dissect Ethernet frames with a type/len field in the range of 1501-1535 as invalid, and add an expert info to make it that much easier to find such invalid frames.

Also did some whitespace cleanup, converting tabs to spaces since most of the file was spaced, not tabbed, and swapped the order that the lg and ig bits get added to the tree because I think it looks better reading bits left-to-right.

TODO: I'm not entirely sure what to do in capture_eth() if that invalid range is encountered, so for now I just added some #if 0'd code as a placeholder.

Ref: http://www.wireshark.org/lists/wireshark-users/201106/msg00127.html


------------------------------------------------------------------------
r37831 | darkjames | 2011-06-29 04:03:41 -0700 (Wed, 29 Jun 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-json.c

Update my email address.

------------------------------------------------------------------------
r37830 | stig | 2011-06-29 03:42:29 -0700 (Wed, 29 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/prefs.c
   M /trunk/epan/prefs.h
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/prefs_capture.c

Added a preference to turn of capture filter syntax check.
This can be used to disable the effect in bug 5356.

------------------------------------------------------------------------
r37829 | stig | 2011-06-29 01:05:53 -0700 (Wed, 29 Jun 2011) | 3 lines
Changed paths:
   M /trunk/version_info.c

Show locale in version info (if !win32).
This may help us identifying bugs related to locale.

------------------------------------------------------------------------
r37828 | stig | 2011-06-29 00:02:04 -0700 (Wed, 29 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpcap.c

Strengthen heuristics for Packets.

This fixes bug 6073.

------------------------------------------------------------------------
r37827 | tuexen | 2011-06-28 23:33:54 -0700 (Tue, 28 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/dlg_utils.c

Cleanup whitespaces/indentation.

------------------------------------------------------------------------
r37826 | guy | 2011-06-28 22:21:10 -0700 (Tue, 28 Jun 2011) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpcap.c

Don't return an offset that you won't later use.

The length fields in a pcap_pkthdr are unsigned, so presumably the
equivalent fields in the rpcap protocol are also unsigned.

Make sure the captured data length isn't bigger than the remaining data
in the packet before attempting to construct a tvbuff for the packet
data.  If it is, report that as an error, and don't even try to
construct the tvbuff; that'll fail.  This fixes bug 6073.

------------------------------------------------------------------------
r37825 | gerald | 2011-06-28 16:08:05 -0700 (Tue, 28 Jun 2011) | 3 lines
Changed paths:
   M /trunk/test/suite-capture.sh

Add more error output to try to see what's causing the current test failure
on the XP buildbot. Use "capture_test_output_print" instead of "cat".

------------------------------------------------------------------------
r37824 | tuexen | 2011-06-28 15:02:43 -0700 (Tue, 28 Jun 2011) | 3 lines
Changed paths:
   M /trunk/doc/dumpcap.pod
   M /trunk/doc/tshark.pod
   M /trunk/doc/wireshark.pod.template

Document the handling of command line parameters with respect to
the capturing on multiple interfaces.

------------------------------------------------------------------------
r37820 | tuexen | 2011-06-28 09:57:42 -0700 (Tue, 28 Jun 2011) | 2 lines
Changed paths:
   M /trunk/capture_opts.c

Code cleanup.

------------------------------------------------------------------------
r37819 | stig | 2011-06-28 09:57:10 -0700 (Tue, 28 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile.am

Add $(GENERATED_H_FILES) to libui_a_SOURCES.

------------------------------------------------------------------------
r37817 | stig | 2011-06-28 08:30:28 -0700 (Tue, 28 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile.nmake

Add a missing dependency for text_import_scanner_lex.h

------------------------------------------------------------------------
r37816 | stig | 2011-06-28 08:18:21 -0700 (Tue, 28 Jun 2011) | 4 lines
Changed paths:
   M /trunk/capinfos.c

From Jose Pedro Oliveira via bug 5803:
#ifdef HAVE_LIBGCRYPT block includes a line too many.
"Fixes 2nd instance of the problem"

------------------------------------------------------------------------
r37815 | stig | 2011-06-28 08:04:24 -0700 (Tue, 28 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/text_import_scanner.l

Use the generated header file from Guy's Flex front-end script from 
revision 22446 for text_import_scanner.

------------------------------------------------------------------------
r37814 | darkjames | 2011-06-28 02:58:26 -0700 (Tue, 28 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def

Export all tfs from tfs.h

------------------------------------------------------------------------
r37813 | stig | 2011-06-28 02:11:18 -0700 (Tue, 28 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/wslua/wslua_gui.c

From bug 6057:
Improved set_color_filter_slot documentation.

------------------------------------------------------------------------
r37812 | stig | 2011-06-28 02:00:11 -0700 (Tue, 28 Jun 2011) | 6 lines
Changed paths:
   M /trunk/ConfigureChecks.cmake
   M /trunk/alert_box.c
   M /trunk/capinfos.c
   M /trunk/capture-pcap-util-unix.c
   M /trunk/capture_sync.c
   M /trunk/cmakeconfig.h.in
   M /trunk/color_filters.c
   M /trunk/config.h.win32
   M /trunk/configure.in
   M /trunk/dftest.c
   M /trunk/dumpcap.c
   M /trunk/epan/dfilter/dfilter-macro.c
   M /trunk/epan/diam_dict.l
   M /trunk/epan/dissectors/packet-giop.c
   M /trunk/epan/dtd_preparse.l
   M /trunk/epan/filesystem.c
   M /trunk/epan/radius_dict.l
   M /trunk/epan/uat.c
   M /trunk/epan/uat_load.l
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/color_dlg.c
   M /trunk/gtk/filter_dlg.c
   M /trunk/gtk/follow_stream.c
   M /trunk/gtk/follow_tcp.c
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/main.c
   M /trunk/gtk/prefs_dlg.c
   M /trunk/gtk/print_dlg.c
   M /trunk/gtk/profile_dlg.c
   M /trunk/gtk/proto_dlg.c
   M /trunk/gtk/recent.c
   M /trunk/gtk/simple_dialog.c
   M /trunk/gtk/text_page_utils.c
   M /trunk/mergecap.c
   M /trunk/packaging/macosx/native-gtk/config.h
   M /trunk/plugins/asn1/packet-asn1.c
   M /trunk/plugins/mate/mate_parser.l
   M /trunk/randpkt.c
   M /trunk/rawshark.c
   M /trunk/text2pcap.c
   M /trunk/tools/checkAPIs.pl
   M /trunk/tshark.c
   M /trunk/version_info.c
   M /trunk/wiretap/wtap.c
   M /trunk/wsutil/CMakeLists.txt
   M /trunk/wsutil/Makefile.am
   D /trunk/wsutil/strerror.c
   D /trunk/wsutil/strerror.h

Replace all strerror() with g_strerror().
Remove our local strerror implementation.
Mark strerror as locale unsafe API.

This fixes bug 5715.

------------------------------------------------------------------------
r37811 | tuexen | 2011-06-28 01:00:14 -0700 (Tue, 28 Jun 2011) | 4 lines
Changed paths:
   M /trunk/tshark.c

Use the filter argument as the capture filter for all interfaces.
Signal an error if another capture filter is provided using the
-f option.

------------------------------------------------------------------------
r37808 | gerald | 2011-06-27 13:48:26 -0700 (Mon, 27 Jun 2011) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/docbook/release-notes.xml
   M /trunk/packaging/nsis/wireshark.nsi
   M /trunk/tools/win32-setup.sh
   M /trunk/tools/win64-setup.sh

Use the latest libsmi package. Note that we now support OID resolution
on 64-bit Windows.

------------------------------------------------------------------------
r37807 | tuexen | 2011-06-27 13:00:30 -0700 (Mon, 27 Jun 2011) | 2 lines
Changed paths:
   M /trunk/tshark.c

Put variable under the correct #ifdef.

------------------------------------------------------------------------
r37806 | tuexen | 2011-06-27 12:07:36 -0700 (Mon, 27 Jun 2011) | 5 lines
Changed paths:
   M /trunk/capture_sync.c
   M /trunk/tshark.c

Fix the bug reported by Guy. Now
tshark -i en0 icmpp
returns a correct error message.


------------------------------------------------------------------------
r37805 | gerald | 2011-06-27 09:09:49 -0700 (Mon, 27 Jun 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/test/suite-clopts.sh

Update suite-clopts.sh to match dumpcap's error output. Add a comment
to dumpcap.c about keeping the errors synced.

------------------------------------------------------------------------
r37804 | tuexen | 2011-06-27 05:13:15 -0700 (Mon, 27 Jun 2011) | 3 lines
Changed paths:
   M /trunk/capture_sync.c
   M /trunk/dumpcap.c

Report the correct interface when there is a problem with a capture filter.
This patch is from Irene Ruengeler.

------------------------------------------------------------------------
r37803 | tuexen | 2011-06-27 04:45:27 -0700 (Mon, 27 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Enable the cap_history again. It was temporary disabled a couple of hours ago.

------------------------------------------------------------------------
r37802 | tuexen | 2011-06-27 04:30:39 -0700 (Mon, 27 Jun 2011) | 2 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/dumpcap.c
   M /trunk/tshark.c

Improve the report of illegal capture filters. Also show the interface description.

------------------------------------------------------------------------
r37801 | stig | 2011-06-27 04:07:31 -0700 (Mon, 27 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/funnel.h
   M /trunk/epan/wslua/wslua_gui.c
   M /trunk/gtk/funnel_stat.c
   M /trunk/tap-funnel.c

From bug 6057:
Lua API: add support to temporary color filters (10 color slots)

------------------------------------------------------------------------
r37800 | stig | 2011-06-27 03:39:50 -0700 (Mon, 27 Jun 2011) | 2 lines
Changed paths:
   M /trunk/docbook/wsdg_src/WSDG_chapter_quick_setup.xml

List cygwin 'zip' as a needed tool to build the U3 package.

------------------------------------------------------------------------
r37799 | tuexen | 2011-06-27 03:11:15 -0700 (Mon, 27 Jun 2011) | 3 lines
Changed paths:
   M /trunk/tshark.c

Use the interface description instead of the interface name when
reporting an error.

------------------------------------------------------------------------
r37798 | stig | 2011-06-27 02:18:37 -0700 (Mon, 27 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/crypt
   M /trunk/epan/dfilter
   M /trunk/epan/ftypes
   M /trunk/tools
   M /trunk/tools/lemon
   M /trunk/tools/tpg

Remove .cvsignore from svn:ignore.

------------------------------------------------------------------------
r37797 | stig | 2011-06-27 01:38:37 -0700 (Mon, 27 Jun 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Remove compile and ylwrap when 'make maintainer-clean'.

------------------------------------------------------------------------
r37796 | stig | 2011-06-27 01:02:46 -0700 (Mon, 27 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/dcerpc/Makefile.am
   M /trunk/epan/dissectors/pidl/Makefile.am

Remove Makefile.in when 'make maintainer-clean'.

------------------------------------------------------------------------
r37795 | tuexen | 2011-06-26 18:32:22 -0700 (Sun, 26 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix a bug when starting the capture without specifying an interface.
The capability history needs to be fixed.

------------------------------------------------------------------------
r37794 | tuexen | 2011-06-26 17:09:03 -0700 (Sun, 26 Jun 2011) | 4 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/capture_sync.c
   M /trunk/capture_ui_utils.c
   M /trunk/capture_ui_utils.h
   M /trunk/dumpcap.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main_statusbar.c
   M /trunk/gtk/main_welcome.c
   M /trunk/summary.c
   M /trunk/tshark.c

Get rid of old non-interface specific settings which are now interface
specifc. This finalizes the change of the infrastructure.
This patch is based on work by Irene Ruengeler.

------------------------------------------------------------------------
r37793 | stig | 2011-06-26 11:25:03 -0700 (Sun, 26 Jun 2011) | 6 lines
Changed paths:
   M /trunk/gtk/color_dlg.c

Changed adding a new coloring rule to put the new rule at the top of the list.
This because the user most likely wants to use the new rule right away, and do
not want to think about which filters it should be above.

This was requested in bug 5669.

------------------------------------------------------------------------
r37789 | gerald | 2011-06-26 08:03:44 -0700 (Sun, 26 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-06-26]
------------------------------------------------------------------------
r37788 | stig | 2011-06-25 13:47:13 -0700 (Sat, 25 Jun 2011) | 6 lines
Changed paths:
   M /trunk/epan/wslua/wslua_gui.c

From Tony Trinh via bug 6018:
Add NULL checks and fix typos in Lua error print-outs

From me:
Use the error message "GUI not available" when using GUI functions in tshark.

------------------------------------------------------------------------
r37787 | stig | 2011-06-25 12:39:16 -0700 (Sat, 25 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Added check for invalid chars in abbrev in ProtoField functions.

This fixes bug 5569.

------------------------------------------------------------------------
r37786 | stig | 2011-06-25 08:42:41 -0700 (Sat, 25 Jun 2011) | 5 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Remove "range" from Lua's Pref.range(), as this value shall be fetched from 
the "default".

This fixes bug 5896.

------------------------------------------------------------------------
r37785 | stig | 2011-06-25 08:24:55 -0700 (Sat, 25 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

From Tony Trinh via bug 5894:
Added argument validation to Pref.range.

------------------------------------------------------------------------
r37784 | stig | 2011-06-25 08:21:17 -0700 (Sat, 25 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/range.c

From Tony Trinh via bug 5895:
Add sanity checks in range.c

------------------------------------------------------------------------
r37783 | stig | 2011-06-25 07:58:06 -0700 (Sat, 25 Jun 2011) | 8 lines
Changed paths:
   M /trunk/epan/proto.c

Make guy's fix in revision 37236 actually work:
"You cannot just make the "len" field of a GByteArray larger, if there's
no data to back that length; you can only make it smaller."

Two equal values are always equal!

This fixes bug 5941.

------------------------------------------------------------------------
r37782 | jake | 2011-06-24 12:57:14 -0700 (Fri, 24 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-linx.c

Update the dissector_add call to use the current API.

------------------------------------------------------------------------
r37781 | jake | 2011-06-23 23:49:20 -0700 (Thu, 23 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cfm.c

From Peter Nahas:
This patch adds support for the two-way Sythetic Loss Measurement 
opcodes (SLM & SLR) defined in the latest ITU-T Y.1731. 

------------------------------------------------------------------------
r37780 | cmaynard | 2011-06-23 19:45:23 -0700 (Thu, 23 Jun 2011) | 2 lines
Changed paths:
   M /trunk/tap-comparestat.c

Print the filter string, if one was specified, just like Wireshark does.

------------------------------------------------------------------------
r37779 | cmaynard | 2011-06-23 19:35:46 -0700 (Thu, 23 Jun 2011) | 6 lines
Changed paths:
   M /trunk/gtk/main.c

Make Wireshark portable to all locales by calling setlocale().  This, along with my previous commits in revisions 36160 and 36166 ought to fix the problem that Bartosz Kiziukiewicz first reported on the wireshark-users mailing list here:

    http://www.wireshark.org/lists/wireshark-users/201103/msg00018.html

(I successfully generated Wireshark compare statistics after applying this change and also changing my locale to Polish.)

------------------------------------------------------------------------
r37778 | gerald | 2011-06-23 16:04:03 -0700 (Thu, 23 Jun 2011) | 4 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.h.win32
   M /trunk/config.nmake
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi

Remove old PCRE references from the Windows build environment. We're not
likely to add it back to wireshark-win32-libs and it was never available
in wireshark-win64-libs.

------------------------------------------------------------------------
r37777 | jake | 2011-06-23 14:52:58 -0700 (Thu, 23 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/epan/dissectors/packet-linx.c

From Dejan Bucar:
Added support new multicore header in the LINX Ethernet protocol.
Added linx/tcp.

------------------------------------------------------------------------
r37776 | jake | 2011-06-23 14:33:29 -0700 (Thu, 23 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

From Andrey Kulikov:
Patch to show GOST certificate types in CertificateRequest message.

------------------------------------------------------------------------
r37775 | jake | 2011-06-23 14:17:42 -0700 (Thu, 23 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

From Andrey Kulikov:
Patch to TLS dissector to show GOST ciphesuites names. 

------------------------------------------------------------------------
r37774 | gerald | 2011-06-23 12:22:21 -0700 (Thu, 23 Jun 2011) | 2 lines
Changed paths:
   M /trunk/test/suite-capture.sh

Add a check for TShark's return status.

------------------------------------------------------------------------
r37773 | gerald | 2011-06-23 11:54:07 -0700 (Thu, 23 Jun 2011) | 4 lines
Changed paths:
   M /trunk/dumpcap.c

Add pcap_options to the pcap_queue elements. This lets us keep interface
IDs in one place and fixes a bug which resulted in only writing
interface ID 0 to NG enhanced packet blocks.

------------------------------------------------------------------------
r37772 | wmeier | 2011-06-23 11:06:13 -0700 (Thu, 23 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/conversations_table.c

Whitespace cleanup ...

------------------------------------------------------------------------
r37771 | wmeier | 2011-06-23 08:40:34 -0700 (Thu, 23 Jun 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee802154.h

From Ivan Lawrow: GTS Descriptor count is a 3 bit field;

The IEEE 802.15.4 GTS descriptor count is a 3-bit field (see page 144
of attached spec).

The mask for this field is incorrectly defined as a 2-bit field in
epan/dissectors/packet-ieee802154.h line 74:


https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6055

------------------------------------------------------------------------
r37770 | stig | 2011-06-23 06:55:20 -0700 (Thu, 23 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/stats_tree_stat.c

Code from Jakub:
Put the "Filter" back in statistics dialogs, which was removed in r37559.

------------------------------------------------------------------------
r37769 | stig | 2011-06-23 06:51:26 -0700 (Thu, 23 Jun 2011) | 3 lines
Changed paths:
   M /trunk/randpkt.c

Use ws_open/ws_read to avoid prohibited APIs.
Close file handle after usage.

------------------------------------------------------------------------
r37768 | stig | 2011-06-23 06:50:07 -0700 (Thu, 23 Jun 2011) | 2 lines
Changed paths:
   M /trunk/editcap.c

Prohibited APIs: strncpy -> g_strlcpy.

------------------------------------------------------------------------
r37767 | stig | 2011-06-23 06:48:38 -0700 (Thu, 23 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sercosiii.c

Added missing $Id$

------------------------------------------------------------------------
r37766 | etxrab | 2011-06-23 06:36:25 -0700 (Thu, 23 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/io_stat.c

Fix some of the GTK deprecated functions.
------------------------------------------------------------------------
r37765 | etxrab | 2011-06-23 06:04:19 -0700 (Thu, 23 Jun 2011) | 1 line
Changed paths:
   M /trunk/tools/checkAPIs.pl

Add GDK deprecated functions.
------------------------------------------------------------------------
r37764 | etxrab | 2011-06-23 06:03:37 -0700 (Thu, 23 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c

Add a protocol decode.
------------------------------------------------------------------------
r37763 | stig | 2011-06-23 04:06:34 -0700 (Thu, 23 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/wslua/wslua_tvb.c

From Tony Trinh via bug 5960:
Fix TvbRange:string() so that it returns a string that contains all bytes
of the range, including zeroes (instead of being truncated at first zero).

------------------------------------------------------------------------
r37762 | stig | 2011-06-23 03:52:40 -0700 (Thu, 23 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Use guint32 internally to store mask.

This may fix bug 5734.

------------------------------------------------------------------------
r37761 | stig | 2011-06-23 03:43:49 -0700 (Thu, 23 Jun 2011) | 5 lines
Changed paths:
   M /trunk/epan/wslua/wslua_tvb.c

Rename Tvb_new_real to ByteArray_tvb, as it's a ByteArray function.
Documentation is generated from code.

This fixes bug 5199.

------------------------------------------------------------------------
r37760 | stig | 2011-06-23 03:28:53 -0700 (Thu, 23 Jun 2011) | 5 lines
Changed paths:
   M /trunk/epan/wslua/wslua_tvb.c

Rename Tvb_tvb to TvbRange_tvb, as it's a TvbRange function.
Documentation is generated from code.

This fixes bug 5006.

------------------------------------------------------------------------
r37759 | darkjames | 2011-06-23 01:23:39 -0700 (Thu, 23 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ftp.c

Remove not needed forward declaration.

------------------------------------------------------------------------
r37757 | wmeier | 2011-06-22 16:03:56 -0700 (Wed, 22 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcp-etsi.c
   M /trunk/epan/dissectors/packet-flip.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-q2931.c
   M /trunk/epan/dissectors/packet-rsl.c
   M /trunk/epan/dissectors/packet-tnef.c

Fix some gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
Also: misc minor cleanup: unneeded #include; whitespace, tvb_length-->tvb_reported_length

------------------------------------------------------------------------
r37756 | stig | 2011-06-22 13:15:34 -0700 (Wed, 22 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/column-utils.c

Don't assert on invalid custom columns, just set as invalid/unknown.

This fixes bug 6028.

------------------------------------------------------------------------
r37755 | wmeier | 2011-06-22 12:52:13 -0700 (Wed, 22 Jun 2011) | 8 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-vuze-dht.c

From Xiao Xiangquan: A new dissector for Vuze DHT;

 Vuze, called Azureus before, is a great BT client and has a lot of users,
 while its DHT implementation is different from the official one.

From me: New-style dissectors are supposed to to always return
         "bytes dissected" (not just when tree != NULL);

------------------------------------------------------------------------
r37754 | gerald | 2011-06-22 09:02:26 -0700 (Wed, 22 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppi-antenna.c
   M /trunk/epan/dissectors/packet-ppi-gps.c
   M /trunk/epan/dissectors/packet-ppi-sensor.c
   M /trunk/epan/dissectors/packet-ppi-vector.c

tvb_format_text → tvb_format_stringzpad.

------------------------------------------------------------------------
r37753 | etxrab | 2011-06-22 08:46:24 -0700 (Wed, 22 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtsp.c

Use ENC_BIG_ENDIAN.
------------------------------------------------------------------------
r37752 | etxrab | 2011-06-22 07:49:26 -0700 (Wed, 22 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Protect the columns from beeing overwritten.
------------------------------------------------------------------------
r37751 | etxrab | 2011-06-22 06:58:04 -0700 (Wed, 22 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Add a dissector table for CDR:s
------------------------------------------------------------------------
r37750 | alagoutte | 2011-06-22 05:30:07 -0700 (Wed, 22 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-skinny.c

Fix a checkhf Warning
Unused entry: epan/dissectors/packet-skinny.c, hf_skinny_modifyConfRes

------------------------------------------------------------------------
r37749 | etxrab | 2011-06-22 01:54:17 -0700 (Wed, 22 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_welcome.c

Make it possible to copy stuff from the welcome header.
------------------------------------------------------------------------
r37748 | alagoutte | 2011-06-22 01:09:55 -0700 (Wed, 22 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-skinny.c

From mtwire via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6041
Added party numbers and party names in message CM5CallInfoMessage

------------------------------------------------------------------------
r37747 | stig | 2011-06-22 00:41:35 -0700 (Wed, 22 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Added missing packet-mime-encap.c

------------------------------------------------------------------------
r37746 | jmayer | 2011-06-22 00:04:34 -0700 (Wed, 22 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/CMakeLists.txt

Oops, forgot to revert a variable after a test build
------------------------------------------------------------------------
r37745 | jmayer | 2011-06-21 23:52:18 -0700 (Tue, 21 Jun 2011) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt

rev 37741 added tap-rtspstat.c to Makefile.common.


------------------------------------------------------------------------
r37744 | wmeier | 2011-06-21 21:20:46 -0700 (Tue, 21 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

tvb_reported_length_remaining() can return -1;
Remove a few lines of not really req'd code;
Minor whitespace cleanup.

------------------------------------------------------------------------
r37743 | wmeier | 2011-06-21 18:20:20 -0700 (Tue, 21 Jun 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser: Fix forBug #6048 (fuzztest crash)

"this is caused by my newly added DVB-CI MMI code

endless loop when dissect_dvbci_text() returns 0 because the text pseudo-apdu
is invalid"

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6048

------------------------------------------------------------------------
r37742 | etxrab | 2011-06-21 08:04:14 -0700 (Tue, 21 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/menus.c

Add the correct casts to make it compile on some old ERHL box.
(Will this finally be correct?)
------------------------------------------------------------------------
r37741 | etxrab | 2011-06-21 05:45:37 -0700 (Tue, 21 Jun 2011) | 6 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-rtsp.c
   A /trunk/epan/dissectors/packet-rtsp.h
   M /trunk/epan/libwireshark.def
   A /trunk/tap-rtspstat.c

From Stéphane Gorse:

The menu gets a new item (Statistics -> RTSP -> Packet Counter).

Like HTTP, filter can be set and then the dialog windows shows the result of the RTSP analysis.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6042
------------------------------------------------------------------------
r37740 | etxrab | 2011-06-21 04:53:33 -0700 (Tue, 21 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

We need to start reassembly on a segment boundary.
------------------------------------------------------------------------
r37739 | etxrab | 2011-06-20 22:21:15 -0700 (Mon, 20 Jun 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
Two changes for openSAFETY over Modbus/TCP:

1. Changing the default preference for Big Endian encoding from TRUE to FALSE
2. Changing the position in the tree for the dissection to the top-level,
therefore, the openSAFETY entries no longer will show up as children of the
Modbus entry. This is the same behaviour as the other variants for openSAFETY
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6038
------------------------------------------------------------------------
r37738 | etxrab | 2011-06-20 22:16:23 -0700 (Mon, 20 Jun 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
adds dissection
of the Card Information Structure (CIS). It shows the CIS as a list of tuples
without going into the details of each tuple.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6036
------------------------------------------------------------------------
r37737 | etxrab | 2011-06-20 22:12:14 -0700 (Mon, 20 Jun 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
adds the MMI resource as defined in
the DVB-CI specification (EN50221), section 8.6 (low-level MMI is excluded as
it's not used in practice).

The patch allows dissection of all text boxes that a DVB-CI host displays on
behalf of the CI module.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6034
------------------------------------------------------------------------
r37736 | gerald | 2011-06-20 16:31:26 -0700 (Mon, 20 Jun 2011) | 5 lines
Changed paths:
   M /trunk/editcap.c
   M /trunk/mergecap.c
   M /trunk/tshark.c

Have mergecap, tshark, and editcap write pcap-ng files by default. This
is mainly an attempt to fix the currently-broken "test.sh" step on the
XP buildbot. If this causes too many problems we might want to have
suite-capture.sh:capture_step_snapshot pass "-P" to dumpcap instead.

------------------------------------------------------------------------
r37735 | gerald | 2011-06-20 15:36:39 -0700 (Mon, 20 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppi-sensor.c

Fix a type.

------------------------------------------------------------------------
r37734 | stig | 2011-06-20 14:06:01 -0700 (Mon, 20 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Added packet-ppi-gps.c and packet-ppi-sensor.c

------------------------------------------------------------------------
r37733 | gerald | 2011-06-20 13:51:42 -0700 (Mon, 20 Jun 2011) | 17 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-ppi-antenna.c
   M /trunk/epan/dissectors/packet-ppi-gps.c
   A /trunk/epan/dissectors/packet-ppi-sensor.c
   M /trunk/epan/dissectors/packet-ppi-vector.c
   M /trunk/epan/dissectors/packet-ppi.c

From Jon Ellch via bug 5175:

Please see the attached patch which updates the ppi-geolocation support
to v2.0 of the specification. This iteration adds a new tag (sensor) and
removes support for velocity/acceleration from the vector tag. Most of
the changes center on the Vector tag. Everything that takes place
elsewhere is cosmetic.

I ran this iteration through fuzz-test and check-APIs just like last
time.


From me:

Replace tvb_get_ephemeral_string with tvb_format_text. Move dissector
registration to the bottom of each file.

------------------------------------------------------------------------
r37732 | stig | 2011-06-20 03:33:35 -0700 (Mon, 20 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/conversations_table.c

One small step towards fixing outdated GtkTooltips.

------------------------------------------------------------------------
r37731 | etxrab | 2011-06-20 03:29:46 -0700 (Mon, 20 Jun 2011) | 1 line
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/asn1/gsm_map/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c

Pretyfy APN display and make it filterable as a string.
------------------------------------------------------------------------
r37730 | stig | 2011-06-20 01:58:59 -0700 (Mon, 20 Jun 2011) | 2 lines
Changed paths:
   M /trunk/config.h.win32

AttachConsole() needs _WIN32_WINNT 0x0500.

------------------------------------------------------------------------
r37729 | martinm | 2011-06-20 01:55:51 -0700 (Mon, 20 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Some fixes to UM sequence analysis.

------------------------------------------------------------------------
r37728 | stig | 2011-06-20 00:14:57 -0700 (Mon, 20 Jun 2011) | 2 lines
Changed paths:
   M /trunk/config.h.win32

Add back support for building with MSVC2005 (and older).

------------------------------------------------------------------------
r37727 | jmayer | 2011-06-20 00:13:17 -0700 (Mon, 20 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/STATUS.gtk3

Add some statistics

------------------------------------------------------------------------
r37726 | jmayer | 2011-06-19 23:32:55 -0700 (Sun, 19 Jun 2011) | 3 lines
Changed paths:
   D /trunk/gtk/STATUS.gtk2
   A /trunk/gtk/STATUS.gtk3

Migration to gtk2 has been completed, delete the status file.
Migration to gtk3 has just begun: add a status file.

------------------------------------------------------------------------
r37725 | jmayer | 2011-06-19 23:25:24 -0700 (Sun, 19 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt

Add some compiler flags that allow for gtk3 upward compatibility
checking while compiling on gtk2. Most are disabled.

------------------------------------------------------------------------
r37724 | wmeier | 2011-06-19 19:27:31 -0700 (Sun, 19 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-user_encap.c

Remove some unneeded #includes;
Use consistent indentation;
Reformat some long lines.

------------------------------------------------------------------------
r37723 | wmeier | 2011-06-19 18:13:21 -0700 (Sun, 19 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dect.c
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-lapdm.c
   M /trunk/epan/dissectors/packet-nbipx.c
   M /trunk/epan/dissectors/packet-ncp-nmas.c
   M /trunk/epan/dissectors/packet-ncp-sss.c
   M /trunk/epan/dissectors/packet-pdcp-lte.c
   M /trunk/epan/dissectors/packet-pvfs2.c
   M /trunk/epan/dissectors/packet-rsip.c
   M /trunk/epan/dissectors/packet-smb-pipe.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-tapa.c
   M /trunk/epan/dissectors/packet-v52.c
   M /trunk/epan/dissectors/packet-x224.c

Fix some gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
(Code commented out since it may be required in the future (at least in some cases).

------------------------------------------------------------------------
r37722 | jmayer | 2011-06-19 17:48:05 -0700 (Sun, 19 Jun 2011) | 5 lines
Changed paths:
   M /trunk/gtk/color_edit_dlg.c
   M /trunk/gtk/decode_as_dlg.c
   M /trunk/gtk/export_sslkeys.c
   M /trunk/gtk/filter_autocomplete.c
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main_proto_draw.c
   M /trunk/gtk/packet_win.c
   M /trunk/gtk/profile_dlg.c
   M /trunk/gtk/proto_dlg.c
   M /trunk/gtk/tcp_graph.c
   M /trunk/gtk/uat_gui.c

GTK3 fixes:
- Replace 2 cases where GtkObject was used (no longer exists in GTK3)
- Whenever gdkkeysyms.h is included also include gdkkeysyms-compat.h
  iff we are building against gtk3

------------------------------------------------------------------------
r37721 | sake | 2011-06-19 13:39:08 -0700 (Sun, 19 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Show and and a filter to non-zero ACK numbers and URG pointers whenever their respective flags are not set. As discussed at Sharkfest with Laura Chappell (OK Laura, go ahead and create some more butt-ugly filters now!).


------------------------------------------------------------------------
r37720 | stig | 2011-06-19 12:29:19 -0700 (Sun, 19 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/proto.c

Make creating a display filter from a custom column defined as integer with
strings and BASE_NONE equal to selecting the filter from the tree entry.

------------------------------------------------------------------------
r37719 | jmayer | 2011-06-19 12:27:45 -0700 (Sun, 19 Jun 2011) | 4 lines
Changed paths:
   M /trunk/README.macos

More newbie information:
- The developer tools are called Xcode.
Add link how to install developer's tools (posted by Tony Trinh)

------------------------------------------------------------------------
r37718 | wmeier | 2011-06-19 12:13:26 -0700 (Sun, 19 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi-se.c
   M /trunk/epan/dissectors/packet-multipart.c
   M /trunk/epan/dissectors/packet-user_encap.c
   M /trunk/epan/dissectors/packet-wai.c

 Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
 Also: whitespace cleanup.

------------------------------------------------------------------------
r37717 | jmayer | 2011-06-19 11:51:11 -0700 (Sun, 19 Jun 2011) | 4 lines
Changed paths:
   M /trunk/README.macos

Readability improvements for Mac newbies
- Add version numbers to the code names.
- Remove Darwin and just use Mac OS.

------------------------------------------------------------------------
r37716 | wmeier | 2011-06-19 11:47:35 -0700 (Sun, 19 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-dec-bpdu.c
   M /trunk/epan/dissectors/packet-dplay.c
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-eap.c
   M /trunk/epan/dissectors/packet-fcels.c
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-fix.c
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-hsrp.c
   M /trunk/epan/dissectors/packet-imf.c
   M /trunk/epan/dissectors/packet-ipmi-picmg.c
   M /trunk/epan/dissectors/packet-ipmi-storage.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-lapd.c
   M /trunk/epan/dissectors/packet-mrp-mmrp.c
   M /trunk/epan/dissectors/packet-nbns.c
   M /trunk/epan/dissectors/packet-pana.c
   M /trunk/epan/dissectors/packet-pcep.c
   M /trunk/epan/dissectors/packet-quakeworld.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-rlc.c
   M /trunk/epan/dissectors/packet-rmt-norm.c
   M /trunk/epan/dissectors/packet-sccpmg.c
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-sebek.c
   M /trunk/epan/dissectors/packet-skinny.c
   M /trunk/epan/dissectors/packet-stat.c
   M /trunk/epan/dissectors/packet-synphasor.c
   M /trunk/epan/dissectors/packet-tn3270.c
   M /trunk/epan/dissectors/packet-tn5250.c
   M /trunk/epan/dissectors/packet-uma.c
   M /trunk/epan/dissectors/packet-x11.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings.

------------------------------------------------------------------------
r37714 | guy | 2011-06-19 10:34:22 -0700 (Sun, 19 Jun 2011) | 2 lines
Changed paths:
   M /trunk/README.macos

Update for current reality, and give some more details.

------------------------------------------------------------------------
r37712 | alagoutte | 2011-06-19 09:05:29 -0700 (Sun, 19 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-slsk.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang
Use 2-space indenting

------------------------------------------------------------------------
r37711 | alagoutte | 2011-06-19 09:04:57 -0700 (Sun, 19 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

Fix Dead Store (Dead assignement/Dead increment) Warning found by Clang

------------------------------------------------------------------------
r37709 | etxrab | 2011-06-19 08:28:32 -0700 (Sun, 19 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Try to fix bug https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6029
Wireshark crashes when entering anything in capture filter textbox
------------------------------------------------------------------------
r37708 | gerald | 2011-06-19 08:03:54 -0700 (Sun, 19 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-06-19]
------------------------------------------------------------------------
r37707 | jmayer | 2011-06-19 06:53:42 -0700 (Sun, 19 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/menus.c

UI_MANAGER: #if 0 out add_menu_item as it is not used yet(?).
Move menu.c back to the list of clean files.

------------------------------------------------------------------------
r37706 | stig | 2011-06-19 03:15:58 -0700 (Sun, 19 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/expert.c

Revert r37702 in favour of r37705 for bug 6035.

------------------------------------------------------------------------
r37705 | stig | 2011-06-19 03:15:05 -0700 (Sun, 19 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/proto.c

Handle BASE_NONE as BASE_DEC for filter expression in custom columns.

This fixes bug 6035.

------------------------------------------------------------------------
r37704 | etxrab | 2011-06-19 02:33:18 -0700 (Sun, 19 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/menus.c

Mark parameters as unused when MAIN_MENU_USE_UIMANAGER.
------------------------------------------------------------------------
r37703 | etxrab | 2011-06-19 02:26:13 -0700 (Sun, 19 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/rpc_stat.c

Add missing part of menu.c checkin for UI manager code.
------------------------------------------------------------------------
r37702 | stig | 2011-06-18 15:52:00 -0700 (Sat, 18 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/expert.c

Use BASE_DEC for expert.group and expert.severity.

This fixes bug 6035.

------------------------------------------------------------------------
r37701 | jmayer | 2011-06-17 15:57:02 -0700 (Fri, 17 Jun 2011) | 4 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt
   M /trunk/cmakeconfig.h.in

Add configure options to make change the default file format
from pcap-ng to pcap.
Add a comment that GTK3 doesn't build yet.

------------------------------------------------------------------------
r37700 | stig | 2011-06-17 14:17:06 -0700 (Fri, 17 Jun 2011) | 3 lines
Changed paths:
   M /trunk/INSTALL

Added 'make osx-package' for building binary package for OSX.
Corrected text describing 'make svr4-package'.

------------------------------------------------------------------------
r37699 | stig | 2011-06-17 14:02:45 -0700 (Fri, 17 Jun 2011) | 2 lines
Changed paths:
   M /trunk/README

Added a note about Windows 2000.

------------------------------------------------------------------------
r37698 | stig | 2011-06-17 13:57:05 -0700 (Fri, 17 Jun 2011) | 2 lines
Changed paths:
   M /trunk/README

Wireshark now builds and runs on Windows 7, but not on Windows 2000.

------------------------------------------------------------------------
r37697 | stig | 2011-06-17 11:40:07 -0700 (Fri, 17 Jun 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake

Set PCAP_NG_DEFAULT correct in config.h on win32.

------------------------------------------------------------------------
r37696 | gerald | 2011-06-17 10:52:31 -0700 (Fri, 17 Jun 2011) | 7 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/capture_sync.c
   M /trunk/config.h.win32
   M /trunk/config.nmake
   M /trunk/configure.in
   M /trunk/doc/dumpcap.pod
   M /trunk/docbook/release-notes.xml
   M /trunk/dumpcap.c
   M /trunk/epan/prefs.c
   M /trunk/wiretap/file_access.c

Make pcap-ng the default. Add a compile-time option to prefer pcap-ng or
pcap.  Add a "-P" capture option which tries to use pcap instead of
pcap-ng ("-P" seemed to be the best option but we may want to use a
different letter).

Update the documentation and release notes.

------------------------------------------------------------------------
r37695 | darkjames | 2011-06-17 09:06:27 -0700 (Fri, 17 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pflog.c
   M /trunk/epan/dissectors/packet-pflog.h

pflog: use BSD_AF_ defines from <epan/aftypes.h>.

------------------------------------------------------------------------
r37694 | stig | 2011-06-17 06:39:56 -0700 (Fri, 17 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c

Added some casts from spotlight_ntoh64 to guint.

------------------------------------------------------------------------
r37693 | etxrab | 2011-06-17 06:19:44 -0700 (Fri, 17 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/expert_comp_table.c
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/proto_hier_stats_dlg.c
   M /trunk/gtk/service_response_time_table.c
   M /trunk/gtk/wlan_stat_dlg.c

Add the correct casts to make it compile on some old ERHL box.
------------------------------------------------------------------------
r37692 | alagoutte | 2011-06-17 05:28:21 -0700 (Fri, 17 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-windows-common.c

From Gregor Beck via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6004
dissect_nt_v2_ace: doesn't support ace type > 8

------------------------------------------------------------------------
r37691 | stig | 2011-06-17 04:56:56 -0700 (Fri, 17 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee802154.c

Added a cast from ieee802154_long_addr.addr (guint64) to guint.

------------------------------------------------------------------------
r37690 | alagoutte | 2011-06-17 04:54:51 -0700 (Fri, 17 Jun 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Update IKEv2 to last IANA Parameters (2011-05-09)
Add Notify Message Types of : 
* A Quick Crash Detection Method for IKE (RFC-ietf-ipsecme-failure-detection-08.txt)
* Protocol Support for High Availability of IKEv2/IPsec (RFC-ietf-ipsecme-ipsecha-protocol-06.txt)

------------------------------------------------------------------------
r37689 | stig | 2011-06-17 04:09:35 -0700 (Fri, 17 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

Added cast to int for nstime_t.nsecs.

------------------------------------------------------------------------
r37688 | stig | 2011-06-17 01:04:10 -0700 (Fri, 17 Jun 2011) | 2 lines
Changed paths:
   M /trunk
   M /trunk/epan
   M /trunk/epan/dissectors
   M /trunk/gtk
   M /trunk/wiretap

Reordered some svn:ignore targets.

------------------------------------------------------------------------
r37687 | stig | 2011-06-17 01:03:18 -0700 (Fri, 17 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/prefs.c

Preferences for x411 moved to p1.

------------------------------------------------------------------------
r37686 | etxrab | 2011-06-16 18:56:35 -0700 (Thu, 16 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall:
openSAFETY: Making the UDP ports configurable; Modbus/TCP support 
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5999
------------------------------------------------------------------------
r37685 | guy | 2011-06-16 11:34:17 -0700 (Thu, 16 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/strutil.c
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

Squelch some compiler warnings.

------------------------------------------------------------------------
r37684 | guy | 2011-06-16 10:17:55 -0700 (Thu, 16 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/oids.c

Squelch some compiler warnings.

------------------------------------------------------------------------
r37683 | alagoutte | 2011-06-16 01:04:31 -0700 (Thu, 16 Jun 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/snoop.c

From Kevin Kayes via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6026
Enhance Snoop file reader to include 10Gbit datalink value

------------------------------------------------------------------------
r37682 | alagoutte | 2011-06-16 00:55:55 -0700 (Thu, 16 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Enhance Cisco CCX1 CKIP Information Element (133)

------------------------------------------------------------------------
r37681 | tuexen | 2011-06-16 00:33:24 -0700 (Thu, 16 Jun 2011) | 4 lines
Changed paths:
   M /trunk/capture_opts.c

Really print the rpcap username when logging, not
the rpcap password.
This only affects remote capturing.

------------------------------------------------------------------------
r37680 | guy | 2011-06-16 00:27:48 -0700 (Thu, 16 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/epan.c
   M /trunk/epan/epan.h

Constify a return value, to squelch a compiler warning.

------------------------------------------------------------------------
r37679 | guy | 2011-06-16 00:02:23 -0700 (Thu, 16 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/address_to_str.c

Attempt to squelch some compiler warnings.

------------------------------------------------------------------------
r37678 | guy | 2011-06-15 23:55:11 -0700 (Wed, 15 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/addr_resolv.c

Attempt to squelch some compiler warnings.

------------------------------------------------------------------------
r37677 | guy | 2011-06-15 20:56:08 -0700 (Wed, 15 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/in_cksum.c

Attempt to squelch some compiler warnings.

------------------------------------------------------------------------
r37676 | guy | 2011-06-15 14:22:30 -0700 (Wed, 15 Jun 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Sigh.  Cast away a warning.

------------------------------------------------------------------------
r37675 | guy | 2011-06-15 13:21:45 -0700 (Wed, 15 Jun 2011) | 6 lines
Changed paths:
   M /trunk/dumpcap.c

Constify some arguments.

Technically, %p must be given a void * as an argument (although the
representation of pointers on all platforms we deal with is the same for
all pointed-to types).

------------------------------------------------------------------------
r37674 | guy | 2011-06-15 13:13:42 -0700 (Wed, 15 Jun 2011) | 2 lines
Changed paths:
   M /trunk/pcapio.c
   M /trunk/pcapio.h

Constify some arguments.

------------------------------------------------------------------------
r37673 | guy | 2011-06-15 12:48:27 -0700 (Wed, 15 Jun 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/netscaler.c

Try to squelch some compiler warnings.

------------------------------------------------------------------------
r37672 | guy | 2011-06-15 12:36:43 -0700 (Wed, 15 Jun 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/dct3trace.c

Squelch some compiler warnings.

------------------------------------------------------------------------
r37671 | guy | 2011-06-15 12:34:54 -0700 (Wed, 15 Jun 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/file_wrappers.c

Strings are not writable, and the compiler warns that assigning a
pointer to a string to a non-const pointer discards qualifiers; make the
err_info member of the wtap_reader structure a const pointer.

------------------------------------------------------------------------
r37670 | guy | 2011-06-15 12:27:01 -0700 (Wed, 15 Jun 2011) | 2 lines
Changed paths:
   M /trunk/tshark.c

See if this squelches some compiler warnings.

------------------------------------------------------------------------
r37669 | guy | 2011-06-15 12:23:58 -0700 (Wed, 15 Jun 2011) | 2 lines
Changed paths:
   M /trunk/editcap.c

See if this squelches some compiler warnings.

------------------------------------------------------------------------
r37668 | alagoutte | 2011-06-15 02:01:04 -0700 (Wed, 15 Jun 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Ali Bahar via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6022
802.11 Disassociation Packet's "Reason Code" field is imprecisely decoded/described

From me :
* Display Reason code in decimal (not Hexa)
* Update list from last standard (802.11-2007 & 802.11n-2009)

------------------------------------------------------------------------
r37667 | alagoutte | 2011-06-15 01:55:01 -0700 (Wed, 15 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Make checkAPIs Happy 
Error: the blurb for field "Status" ("icmpv6.6lowpannd.da.status") has leading space in epan/dissectors/packet-icmpv6.c

------------------------------------------------------------------------
r37666 | alagoutte | 2011-06-15 01:52:38 -0700 (Wed, 15 Jun 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

From Colin O'Flynn via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5363
Add latest 6lowpan-nd Support

From me :
* Add Description in Header Field
* Use FT_EUI64 for EUI64 Field


------------------------------------------------------------------------
r37665 | alagoutte | 2011-06-15 01:32:10 -0700 (Wed, 15 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

From Colin O'Flynn via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5363

Fix some error in ICMPv6 dissector...

------------------------------------------------------------------------
r37664 | stig | 2011-06-14 13:37:53 -0700 (Tue, 14 Jun 2011) | 5 lines
Changed paths:
   M /trunk/epan/address_to_str.c
   M /trunk/epan/ftypes/ftype-integer.c

Please don't use prohibited APIs in new code:
sprintf -> g_snprintf

Fixes coverity 1197 & 1198.

------------------------------------------------------------------------
r37663 | jake | 2011-06-13 13:29:51 -0700 (Mon, 13 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-q931.c

Fix for bug 6009:
Information transfer rate is a 7 bit field.

------------------------------------------------------------------------
r37662 | darkjames | 2011-06-13 08:28:37 -0700 (Mon, 13 Jun 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Remove not used cap_pipe_err_str.

------------------------------------------------------------------------
r37661 | etxrab | 2011-06-13 08:13:39 -0700 (Mon, 13 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_file_dlg.c

Handle deprecated GtkTooltips.
------------------------------------------------------------------------
r37660 | etxrab | 2011-06-13 07:54:33 -0700 (Mon, 13 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/color_dlg.c

Handle deprecated GtkTooltips.
------------------------------------------------------------------------
r37656 | gerald | 2011-06-12 08:03:37 -0700 (Sun, 12 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-06-12]
------------------------------------------------------------------------
r37655 | tuexen | 2011-06-12 03:35:55 -0700 (Sun, 12 Jun 2011) | 4 lines
Changed paths:
   M /trunk/gtk/cfilter_combo_utils.c

cfilter can be NULL. Handle this correctly.
This should fix
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6016

------------------------------------------------------------------------
r37654 | guy | 2011-06-11 14:49:24 -0700 (Sat, 11 Jun 2011) | 7 lines
Changed paths:
   M /trunk/acinclude.m4

Use spaces uniformly in AC_WIRESHARK_PYTHON_CHECK.

If we don't find python-config, set want_python to no, so the
end-of-configuration message says we're not using the Python
interpreter.  Also fix some cases where we were setting want_zlib rather
than want_python (cut-and-pasteo).

------------------------------------------------------------------------
r37653 | guy | 2011-06-11 13:24:24 -0700 (Sat, 11 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/Makefile.nmake

Just as with autoconf, we need to include the Python cflags when
building libwireshark.

------------------------------------------------------------------------
r37652 | guy | 2011-06-11 12:05:17 -0700 (Sat, 11 Jun 2011) | 11 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/acinclude.m4
   M /trunk/configure.in
   M /trunk/epan/Makefile.am

Do the Python embedding similarly to other "default = yes, if available"
items.

Add some quoting to the zlib tests, just in case the argument contains
white space.

Clean up capitalization of Lua and Python.

Link programs that use libwireshark with the Python libraries, and build
Epan with the Python cflags.

------------------------------------------------------------------------
r37651 | guy | 2011-06-11 10:20:44 -0700 (Sat, 11 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/epan.c

Include <Python.h> to get the Python version number.

------------------------------------------------------------------------
r37650 | guy | 2011-06-10 19:35:58 -0700 (Fri, 10 Jun 2011) | 7 lines
Changed paths:
   M /trunk/version_info.c

The "shared by every program in the Wireshark suite, including dumpcap"
version information doesn't include Python version information (only
programs using libwireshark have that) or GeoIP version information
(ditto).  Don't include headers required only for that information;
hopefully this will keep dumpcap from requiring the Python library on
Windows.

------------------------------------------------------------------------
r37649 | gerald | 2011-06-10 10:25:55 -0700 (Fri, 10 Jun 2011) | 3 lines
Changed paths:
   M /trunk/packaging/portableapps/win32/Makefile.nmake
   M /trunk/packaging/u3/win32/Makefile.nmake

Make the U3 and PortableApps "clean" and "distclean" targets more
consistent with the NSIS targets.

------------------------------------------------------------------------
r37648 | guy | 2011-06-10 10:16:09 -0700 (Fri, 10 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c

Add some more error checking.

------------------------------------------------------------------------
r37647 | etxrab | 2011-06-10 09:27:53 -0700 (Fri, 10 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/capture_dlg.c

Make capture dialog compile with GTK3+
------------------------------------------------------------------------
r37646 | etxrab | 2011-06-10 04:01:43 -0700 (Fri, 10 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/conversations_table.c

Seemingly this is needed to...
------------------------------------------------------------------------
r37645 | etxrab | 2011-06-10 01:31:14 -0700 (Fri, 10 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/hostlist_table.c

Add casts to make it compile on some old ERHL box.
------------------------------------------------------------------------
r37644 | etxrab | 2011-06-10 01:30:17 -0700 (Fri, 10 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc.c

From Pascal Quantin:
allowing Length Indicator 0x7ffb for RLC AM PDUs.
------------------------------------------------------------------------
r37643 | darkjames | 2011-06-10 00:16:10 -0700 (Fri, 10 Jun 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/file_access.c

Fix capinfo: ** ERROR **: Unknown capture file type 61

------------------------------------------------------------------------
r37642 | wmeier | 2011-06-09 19:10:44 -0700 (Thu, 09 Jun 2011) | 13 lines
Changed paths:
   M /trunk/gtk/prefs_dlg.c

Add a hack to prevent a gcc warning "ignoring return value of 'strtoul'..."
for some gcc configurations (see _FORTIFY_SOURCE).
This hack is used instead of storing the result returned by strtoul() in a
dummy variable so as to prevent a gcc 4.6 with -Wextra warning:
 "set but not used ...".

TBD: will this hack pass muster with other validators
     such as Coverity, CLang, & etc ?

For much gory detail: see the message thread starting at:
http://www.wireshark.org/lists/wireshark-dev/201106/msg00088.html


------------------------------------------------------------------------
r37641 | gerald | 2011-06-09 16:14:57 -0700 (Thu, 09 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mime-encap.c

Add another cast.

------------------------------------------------------------------------
r37640 | guy | 2011-06-09 15:46:00 -0700 (Thu, 09 Jun 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/ascend_scanner.l
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/wtap-int.h

The only place where we care about zlib is file_wrappers.c; include
<zlib.h> there, rather than wtap-int.h.  That obviates the need to
include config.h earlier in ascend_scanner.l; revert the previous
change, so we don't require a version of Flex that supports %top.

------------------------------------------------------------------------
r37639 | gerald | 2011-06-09 15:42:44 -0700 (Thu, 09 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mime-encap.c

Add a couple of casts to make Visual C++ happy.

------------------------------------------------------------------------
r37638 | darkjames | 2011-06-09 15:01:57 -0700 (Thu, 09 Jun 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/mime_file.c

Fix possible compilation errors.

------------------------------------------------------------------------
r37637 | darkjames | 2011-06-09 14:37:19 -0700 (Thu, 09 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mime-encap.c
   M /trunk/wiretap/CMakeLists.txt
   M /trunk/wiretap/mime_file.c

- Add something to columns when using  mime-encap
- Replace decoders in wiretap/CMakeLists.txt

------------------------------------------------------------------------
r37636 | darkjames | 2011-06-09 14:21:06 -0700 (Thu, 09 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-image-jfif.c
   A /trunk/epan/dissectors/packet-mime-encap.c
   M /trunk/wiretap/Makefile.common
   M /trunk/wiretap/file_access.c
   D /trunk/wiretap/jpeg_jfif.c
   D /trunk/wiretap/jpeg_jfif.h
   A /trunk/wiretap/mime_file.c
   A /trunk/wiretap/mime_file.h
   M /trunk/wiretap/wtap.h

- Replace jpeg_jfif decoder, with more generic mime_file (no more 64KB limit!).
- Add new dissector packet-mime-encap which understands mime_file fragmentation.

------------------------------------------------------------------------
r37635 | gerald | 2011-06-09 14:13:40 -0700 (Thu, 09 Jun 2011) | 4 lines
Changed paths:
   M /trunk/wiretap/ascend_scanner.l

Move the copyright notice and the config.h include to the top of the
file so that we have the proper definitions in place for large file
support on Solaris (bug 6102).

------------------------------------------------------------------------
r37634 | gerald | 2011-06-09 11:31:39 -0700 (Thu, 09 Jun 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/libpcap.c

Make sure we don't write invalid record lengths.

------------------------------------------------------------------------
r37633 | morriss | 2011-06-09 11:27:11 -0700 (Thu, 09 Jun 2011) | 14 lines
Changed paths:
   M /trunk/editcap.c

Simplify timestamp checking: only check the packet's timestamp if
check_startstop is set.

Refuse to write packets that do not fit in the file type we're writing.  This
allows fuzz testing to be done on JPEGs without generating bogus files (with
packets bigger than the maximum packet size).  This fixes
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6010 .

Note that this is only a problem with editcap is run with -T to force the
encapsulation type.

Maybe this needs a more generic solution (e.g., should this check be done in
the wiretap routines?), but at least for now it'll pacify the buildbot.

------------------------------------------------------------------------
r37632 | alagoutte | 2011-06-09 11:02:13 -0700 (Thu, 09 Jun 2011) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.c

From Colin O'Flynn via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5980
Add draft-ietf-6man-rpl-routing-header-03 Support (RH4 RPL Routing Header)

From me :
* Display Bytes of Address and Full Address (Generated)
* Fix some Whitespace and minor enhance...




------------------------------------------------------------------------
r37631 | gerald | 2011-06-09 10:30:13 -0700 (Thu, 09 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload-framing.c

Only count an ACK if it's part of an existing conversation, otherwise we
get a lot of false positives.

------------------------------------------------------------------------
r37630 | etxrab | 2011-06-09 05:54:44 -0700 (Thu, 09 Jun 2011) | 1 line
Changed paths:
   M /trunk/tools/Makefile.am

Add ws-coding-style.cfg to dist.
------------------------------------------------------------------------
r37629 | etxrab | 2011-06-09 01:51:30 -0700 (Thu, 09 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/expert_comp_table.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/proto_hier_stats_dlg.c
   M /trunk/gtk/service_response_time_table.c
   M /trunk/gtk/wlan_stat_dlg.c

Add casts to make it compile on some old ERHL box.
------------------------------------------------------------------------
r37628 | etxrab | 2011-06-09 01:28:04 -0700 (Thu, 09 Jun 2011) | 8 lines
Changed paths:
   A /trunk/tools/ws-coding-style.cfg

From Francesco Fondelli:
Add crustyfy .cfg file

I found it useful on some inetnal dissector where the indentation
was relay messed up so I think it's a usfel tool to have in the toolbox.
I don't think we should run it on every file.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5924
------------------------------------------------------------------------
r37627 | etxrab | 2011-06-08 23:36:40 -0700 (Wed, 08 Jun 2011) | 6 lines
Changed paths:
   M /trunk/Makefile.am
   A /trunk/diameter/Cisco.xml
   A /trunk/diameter/Vodafone.xml
   M /trunk/diameter/dictionary.xml
   M /trunk/packaging/nsis/wireshark.nsi

From Madhusudhan M:
Cisco and Vodafone Diameter AVP:s

I have axtracted the relevant vendor AVP:s and separated them out in Vendor specific xml files.

Part of https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5972
------------------------------------------------------------------------
r37626 | jmayer | 2011-06-08 14:33:38 -0700 (Wed, 08 Jun 2011) | 4 lines
Changed paths:
   M /trunk/cmake/modules/FindZLIB.cmake

As pointed out by Jakub Zawadzki:
While updating to the current cmake version of FindZLIB I missed
a Wireshark specific addition. Add it back.

------------------------------------------------------------------------
r37625 | gerald | 2011-06-08 13:58:44 -0700 (Wed, 08 Jun 2011) | 3 lines
Changed paths:
   M /trunk/wiretap/ascend_scanner.l

Limit the lengths of some of our patterns. Fixes an infinite loop found
when trying to read a TPNCP data file.

------------------------------------------------------------------------
r37624 | alagoutte | 2011-06-08 11:26:50 -0700 (Wed, 08 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mongo.c

* Add Keep Going bit flag in insert command
* Replace tab by space

------------------------------------------------------------------------
r37623 | jmayer | 2011-06-08 11:10:03 -0700 (Wed, 08 Jun 2011) | 2 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/CMakeOptions.txt
   A /trunk/cmake/modules/FindGTK3.cmake

Add GTK3 cmake options. It doesn't build, just like its configure pendant.

------------------------------------------------------------------------
r37622 | martinm | 2011-06-08 10:10:40 -0700 (Wed, 08 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Fix a typo (spotted by Pascal Quantin).

------------------------------------------------------------------------
r37621 | martinm | 2011-06-08 10:08:27 -0700 (Wed, 08 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/mac_lte_stat_dlg.c
   M /trunk/gtk/rlc_lte_stat_dlg.c

The passed-in filter string can no longer be NULL, so use strlen instead of testing pointer.

------------------------------------------------------------------------
r37620 | jmayer | 2011-06-08 10:07:06 -0700 (Wed, 08 Jun 2011) | 2 lines
Changed paths:
   M /trunk/cmake/modules/FindZLIB.cmake

Last patch removed $Id$ head line

------------------------------------------------------------------------
r37619 | jmayer | 2011-06-08 09:24:36 -0700 (Wed, 08 Jun 2011) | 2 lines
Changed paths:
   M /trunk/cmake/modules/FindGTK2.cmake
   M /trunk/cmake/modules/FindZLIB.cmake

Copy over changes from cmake git HEAD.

------------------------------------------------------------------------
r37618 | tuexen | 2011-06-08 07:12:47 -0700 (Wed, 08 Jun 2011) | 8 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

This fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6008

Clear the list of interfaces before adding new interfaces.
Also fix an endless loop which would occur in case of an error
when getting remote interfaces.

From Irene Ruengeler.

------------------------------------------------------------------------
r37617 | etxrab | 2011-06-08 06:11:51 -0700 (Wed, 08 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/iax2_analysis.c

Try to fix the Ubuntu buildbot.
------------------------------------------------------------------------
r37616 | etxrab | 2011-06-08 05:05:49 -0700 (Wed, 08 Jun 2011) | 1 line
Changed paths:
   M /trunk/gtk/prefs_dlg.c

Assign to a dummy variable to squelch the warning.
------------------------------------------------------------------------
r37615 | etxrab | 2011-06-08 05:02:38 -0700 (Wed, 08 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

Move the warning "...SercosIII heuristic dissector cannot be registered.." to the handoff routine as sercosIII most probably will
not have registered it's name when opensafty's register routine is executed e.g the warning will always be printed.
------------------------------------------------------------------------
r37614 | stig | 2011-06-08 00:03:53 -0700 (Wed, 08 Jun 2011) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt

From Roland Knall via bug 6007:
Remove plugins/interlink from CMake.

------------------------------------------------------------------------
r37612 | etxrab | 2011-06-07 22:27:39 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   D /trunk/plugins/interlink

Remove the interlinki plugin dir as it's now a builtin dissector.
------------------------------------------------------------------------
r37611 | etxrab | 2011-06-07 22:23:17 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   D /trunk/plugins/interlink/AUTHORS
   D /trunk/plugins/interlink/CMakeLists.txt
   D /trunk/plugins/interlink/COPYING
   D /trunk/plugins/interlink/ChangeLog
   D /trunk/plugins/interlink/INSTALL
   D /trunk/plugins/interlink/Makefile.am
   D /trunk/plugins/interlink/Makefile.common
   D /trunk/plugins/interlink/Makefile.nmake
   D /trunk/plugins/interlink/NEWS
   D /trunk/plugins/interlink/README
   D /trunk/plugins/interlink/moduleinfo.h
   D /trunk/plugins/interlink/moduleinfo.nmake
   D /trunk/plugins/interlink/plugin.rc.in

Remove theinterlinki plugin dir as it's now a builtin dissector.
------------------------------------------------------------------------
r37610 | etxrab | 2011-06-07 22:20:43 -0700 (Tue, 07 Jun 2011) | 3 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/configure.in
   A /trunk/epan/dissectors/packet-interlink.c (from /trunk/plugins/interlink/packet-interlink.c:37608)
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi
   M /trunk/plugins/Makefile.am
   M /trunk/plugins/Makefile.nmake
   D /trunk/plugins/interlink/packet-interlink.c

From Michael Mann:
Make interlink built-in dissector (from plugin).
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6005
------------------------------------------------------------------------
r37609 | etxrab | 2011-06-07 22:06:02 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   D /trunk/plugins/sercosiii

Remove the sercosiii plugin dir as it's now a builtin dissector.
------------------------------------------------------------------------
r37608 | etxrab | 2011-06-07 21:55:29 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   D /trunk/plugins/sercosiii/AUTHORS
   D /trunk/plugins/sercosiii/CMakeLists.txt
   D /trunk/plugins/sercosiii/COPYING
   D /trunk/plugins/sercosiii/Makefile.am
   D /trunk/plugins/sercosiii/Makefile.common
   D /trunk/plugins/sercosiii/Makefile.nmake
   D /trunk/plugins/sercosiii/moduleinfo.h
   D /trunk/plugins/sercosiii/moduleinfo.nmake
   D /trunk/plugins/sercosiii/plugin.rc.in

Remove the sercosiii plugin dir as it's now a builtin dissector.
------------------------------------------------------------------------
r37607 | guy | 2011-06-07 21:49:35 -0700 (Tue, 07 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/prefs_dlg.c

Didn't need to introduce that variable.

------------------------------------------------------------------------
r37606 | guy | 2011-06-07 21:07:15 -0700 (Tue, 07 Jun 2011) | 8 lines
Changed paths:
   M /trunk/gtk/prefs_dlg.c

Try to squelch the warning about not using the return value of strtoul()
- we really *are* using it just for its side-effects if it fails; its
return value is not the best way to check for failure, as the failure
return values are also valid return values on success.

While we're at it, check for it setting errno, which is one of the
better ways to check for failure.

------------------------------------------------------------------------
r37605 | guy | 2011-06-07 18:37:18 -0700 (Tue, 07 Jun 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

The SERCOS III dissector is now built-in.

------------------------------------------------------------------------
r37604 | wmeier | 2011-06-07 16:05:53 -0700 (Tue, 07 Jun 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/iseries.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warning.

------------------------------------------------------------------------
r37603 | wmeier | 2011-06-07 16:03:12 -0700 (Tue, 07 Jun 2011) | 3 lines
Changed paths:
   M /trunk/capture_sync.c
   M /trunk/tap-diameter-avp.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
Also: whitespace cleanup.

------------------------------------------------------------------------
r37602 | wmeier | 2011-06-07 15:59:19 -0700 (Tue, 07 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/rtp_analysis.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
Also: do some whitespace cleanup.

------------------------------------------------------------------------
r37601 | wmeier | 2011-06-07 15:50:49 -0700 (Tue, 07 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/dcerpc_stat.c
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/prefs_dlg.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/sctp_assoc_analyse.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/sctp_stat.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings;
Also: whitespace cleanup in some cases.

------------------------------------------------------------------------
r37600 | wmeier | 2011-06-07 15:28:55 -0700 (Tue, 07 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/epan/sigcomp-udvm.c
   M /trunk/epan/sigcomp_state_hdlr.c
   M /trunk/epan/to_str.c

Fix gcc 4.6 "set but not used [-Wunused-but-set-variable]" warnings

------------------------------------------------------------------------
r37599 | wmeier | 2011-06-07 14:10:44 -0700 (Tue, 07 Jun 2011) | 13 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-lon.c

From Daniel Willmann: Lontalk protocol (EIA-709.1)

Attached is a dissector for the Lontalk protocol (EIA-709.1). This dissector
registers as a subdissector of the CN/IP protocol.

Some code (mostly definitions) were taken from Bug #2252
(http://bugs.wireshark.org/bugzilla/attachment.cgi?id=4562)

From me: minor mostly cosmetic changes.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5909


------------------------------------------------------------------------
r37598 | wmeier | 2011-06-07 14:02:29 -0700 (Tue, 07 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/CMakeLists.txt

Put packet-cnip.c in the right group (DISSECTOR_SRC not ASN1_DISSECTOR_SRC).

------------------------------------------------------------------------
r37597 | etxrab | 2011-06-07 13:33:26 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.am
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-sercosiii.c (from /trunk/plugins/sercosiii/packet-sercosiii.c:37596)
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/wireshark.nsi
   M /trunk/plugins/Makefile.am
   M /trunk/plugins/Makefile.nmake
   D /trunk/plugins/sercosiii/packet-sercosiii.c
   D /trunk/plugins/sercosiii/packet-sercosiii.h
   D /trunk/plugins/sercosiii/packet-sercosiii_1v1.c
   D /trunk/plugins/sercosiii/packet-sercosiii_1v1_at.c
   D /trunk/plugins/sercosiii/packet-sercosiii_1v1_at_devstat.c
   D /trunk/plugins/sercosiii/packet-sercosiii_1v1_hp.c
   D /trunk/plugins/sercosiii/packet-sercosiii_1v1_mdt.c
   D /trunk/plugins/sercosiii/packet-sercosiii_1v1_mdt_devctrl.c
   D /trunk/plugins/sercosiii/packet-sercosiii_1v1_mst.c
   D /trunk/plugins/sercosiii/packet-sercosiii_1v1_svc.c

Move packet-sercosiii.c to be a builtin dissector.
------------------------------------------------------------------------
r37596 | wmeier | 2011-06-07 11:56:24 -0700 (Tue, 07 Jun 2011) | 12 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-cnip.c

From Daniel Willmann: dissector for EIA-852 protocol (Component Network over IP)

Attached is a dissector for CN/IP protocol described in EIA-852. It is mainly
used to encapsulate and send Lontalk (EIA-709.1) or EIA-600 frames over UDP (or
TCP).

This dissector can only decode the common header and data frames can be decoded
by further dissectors.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5907


------------------------------------------------------------------------
r37593 | etxrab | 2011-06-07 08:05:45 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/tools/Makefile.am
   M /trunk/wiretap/Makefile.am

Add more missing files.
------------------------------------------------------------------------
r37590 | etxrab | 2011-06-07 07:16:40 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   D /trunk/epan/dissectors/packet-spnego.h

Delete no longer used .h file
------------------------------------------------------------------------
r37589 | etxrab | 2011-06-07 07:15:50 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/packaging/macosx/Makefile.am
   M /trunk/packaging/nsis/Makefile.am

Add files to distribution.
------------------------------------------------------------------------
r37588 | tuexen | 2011-06-07 05:23:15 -0700 (Tue, 07 Jun 2011) | 6 lines
Changed paths:
   M /trunk/dumpcap.c

When doing remote capturing using WinPCap, dumpcap crashes inside the WinPCap
library when no capture filter is used. Then cfilter is NULL and 
capture_loop_init_filter() does not call compile_capture_filter() and
pcap_setfilter(). Providing an empty string instead of NULL works around
the problem.

------------------------------------------------------------------------
r37587 | sahlberg | 2011-06-07 03:27:44 -0700 (Tue, 07 Jun 2011) | 3 lines
Changed paths:
   M /trunk/doc/tshark.pod

Add description of LOAD stats for tshark to the manpage


------------------------------------------------------------------------
r37584 | grahamb | 2011-06-06 15:32:37 -0700 (Mon, 06 Jun 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dnp.c

Added code to distinguish conversations between different RTUs that happen to use the same address\port pair.

Based on patch supplied by Kelvin Proctor.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3626
------------------------------------------------------------------------
r37582 | gerald | 2011-06-06 14:40:40 -0700 (Mon, 06 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/Makefile.am
   M /trunk/wiretap/Makefile.am
   M /trunk/wsutil/Makefile.am

Add links to libtool's recommendations for library versions.

------------------------------------------------------------------------
r37577 | gerald | 2011-06-06 14:03:49 -0700 (Mon, 06 Jun 2011) | 2 lines
Changed paths:
   M /trunk/docbook/developer-guide.xml

Bump the version.

------------------------------------------------------------------------
r37576 | etxrab | 2011-06-06 13:01:53 -0700 (Mon, 06 Jun 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fp_hint.c
   M /trunk/epan/dissectors/packet-rlc.c
   M /trunk/epan/dissectors/packet-rlc.h

From Pascal Quantin:
Add the following enhancements to the UMTS RLC dissector
(as specified in 3GPP 25.322 v9.2.0):
- UDP framing protocol to allow dissection of RLC PDUs over UDP (like what is
done for LTE MAC/RLC/PDCP protocols)
- 15 bits Length Indicator support (both with variable and fixed LI size)
- Poll type SUFI
- enhanced dissection of LIST, Relative List and Bitmap SUFI
- dissection of Reset and Reset Ack Control PDU
- an option to decode RLC headers only
- an option to skip SDU reassembly
------------------------------------------------------------------------
r37575 | sfisher | 2011-06-06 12:49:31 -0700 (Mon, 06 Jun 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c


Fix Unix compilation error...

packet-3g-a11.c:135: warning: 'hf_a11_fqi_granted_qos' defined but not used

... by removing definition


------------------------------------------------------------------------
r37574 | etxrab | 2011-06-06 12:45:51 -0700 (Mon, 06 Jun 2011) | 9 lines
Changed paths:
   M /trunk/epan/Makefile.am
   M /trunk/plugins/sercosiii/CMakeLists.txt
   M /trunk/plugins/sercosiii/Makefile.common
   A /trunk/plugins/sercosiii/packet-sercosiii.c

From Michael Mann:

I made 2 changes when merging the source into a single file:
1. Changed filtername to "siii" to match display filter fields (was quicker
than changing all display filter fields to "sercosiii"
2. Converted the "ett_siii arrays" to a single value.   Each subtree doesn't
need its own ett_ value.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5990
------------------------------------------------------------------------
r37573 | etxrab | 2011-06-06 12:17:32 -0700 (Mon, 06 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

On behalf of Ericsson - enhance A11 dissection.
------------------------------------------------------------------------
r37571 | gerald | 2011-06-06 09:29:23 -0700 (Mon, 06 Jun 2011) | 2 lines
Changed paths:
   M /trunk/config.nmake

Bump the wiretap version.

------------------------------------------------------------------------
r37570 | martinm | 2011-06-06 09:07:09 -0700 (Mon, 06 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Warn if there are > 2 padding subheaders at the beginning of a frame.

------------------------------------------------------------------------
r37569 | wmeier | 2011-06-06 08:32:40 -0700 (Mon, 06 Jun 2011) | 3 lines
Changed paths:
   M /trunk/docbook/README.txt

We're now using fop-1.0 on Windows;
Also: remove trailing whitespace from lines.

------------------------------------------------------------------------
r37568 | etxrab | 2011-06-06 06:34:53 -0700 (Mon, 06 Jun 2011) | 1 line
Changed paths:
   M /trunk/tap-iostat.c

Make the windows builds work again.
------------------------------------------------------------------------
r37567 | sahlberg | 2011-06-06 03:34:51 -0700 (Mon, 06 Jun 2011) | 9 lines
Changed paths:
   M /trunk/tap-iostat.c

Add support for LOAD() calculations to tshark too just like I incorrectly
stated it had at SNIA years ago.


Example :
tshark -n -r ../captures/smbwrite.cap
  -z "io,stat,0.001,LOAD(smb.time)smb.time" -q


------------------------------------------------------------------------
r37566 | etxrab | 2011-06-06 03:32:19 -0700 (Mon, 06 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mbtcp.c

From Roland Knall:
Modbus/TCP: Calculating the drop-out criteria for special data dissection fails.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5997
------------------------------------------------------------------------
r37565 | martinm | 2011-06-06 02:40:30 -0700 (Mon, 06 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mbtcp.h

Avoid no-newline-at-end-of-file warning.

------------------------------------------------------------------------
r37564 | stig | 2011-06-06 01:33:33 -0700 (Mon, 06 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_airpcap_toolbar.c

From Roland Knall via bug 5996:
Corrected old-style function definition.

------------------------------------------------------------------------
r37563 | stig | 2011-06-06 00:09:49 -0700 (Mon, 06 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt

From Roland Knall via bug 5995:
Fix CMake build.

------------------------------------------------------------------------
r37562 | guy | 2011-06-05 18:04:56 -0700 (Sun, 05 Jun 2011) | 5 lines
Changed paths:
   M /trunk/gtk/afp_stat.c
   M /trunk/gtk/diameter_stat.c
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/gtp_stat.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/ncp_stat.c
   M /trunk/gtk/scsi_stat.c
   M /trunk/gtk/smb2_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/tap_param_dlg.c

Add support for PARAM_ENUM tap parameters, and use the tap_param_dlg
stuff for the SCSI SRT tap.

Get rid of include of gtk/filter_dlg.h in stats taps that don't need it.

------------------------------------------------------------------------
r37561 | guy | 2011-06-05 16:16:14 -0700 (Sun, 05 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/tap_param_dlg.c

Clean up indentation - use 4-space indentation uniformly.  (No tabs -
tab stops aren't necessarily every 4 spaces.)

------------------------------------------------------------------------
r37560 | guy | 2011-06-05 16:04:11 -0700 (Sun, 05 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/afp_stat.c
   M /trunk/gtk/bootp_stat.c
   M /trunk/gtk/camel_counter.c
   M /trunk/gtk/camel_srt.c
   M /trunk/gtk/diameter_stat.c
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/gtp_stat.c
   M /trunk/gtk/h225_counter.c
   M /trunk/gtk/h225_ras_srt.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/mac_lte_stat_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/megaco_stat.c
   M /trunk/gtk/mgcp_stat.c
   M /trunk/gtk/ncp_stat.c
   M /trunk/gtk/radius_stat.c
   M /trunk/gtk/rlc_lte_stat_dlg.c
   M /trunk/gtk/sctp_chunk_stat.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/smb2_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/stats_tree_stat.c
   D /trunk/gtk/tap_dfilter_dlg.c
   D /trunk/gtk/tap_dfilter_dlg.h
   A /trunk/gtk/tap_param_dlg.c (from /trunk/gtk/tap_dfilter_dlg.c:37559)
   A /trunk/gtk/tap_param_dlg.h (from /trunk/gtk/tap_dfilter_dlg.h:37559)
   M /trunk/gtk/wsp_stat.c
   M /trunk/stat_menu.h

Rename the tap_dfilter_dlg.[ch] files to reflect that they can do more
than just filters.

------------------------------------------------------------------------
r37559 | guy | 2011-06-05 15:39:23 -0700 (Sun, 05 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/Makefile.common
   A /trunk/epan/params.h
   M /trunk/epan/prefs.h
   M /trunk/gtk/afp_stat.c
   M /trunk/gtk/bootp_stat.c
   M /trunk/gtk/camel_counter.c
   M /trunk/gtk/camel_srt.c
   M /trunk/gtk/diameter_stat.c
   M /trunk/gtk/dlg_utils.h
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/gtp_stat.c
   M /trunk/gtk/h225_counter.c
   M /trunk/gtk/h225_ras_srt.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/mac_lte_stat_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/megaco_stat.c
   M /trunk/gtk/mgcp_stat.c
   M /trunk/gtk/ncp_stat.c
   M /trunk/gtk/radius_stat.c
   M /trunk/gtk/rlc_lte_stat_dlg.c
   M /trunk/gtk/sctp_chunk_stat.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/smb2_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/stats_tree_stat.c
   M /trunk/gtk/tap_dfilter_dlg.c
   M /trunk/gtk/tap_dfilter_dlg.h
   M /trunk/gtk/wsp_stat.c

Some work on generalizing the "display filter" tap parameter dialog box
to more generally support fetching parameters for taps.

------------------------------------------------------------------------
r37558 | etxrab | 2011-06-05 13:12:44 -0700 (Sun, 05 Jun 2011) | 10 lines
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-snmp.c

From Sean Van Gorder:
When Wireshark attempts to read an SNMP packet with a variable-bindings item
with an OID containing an index string which includes an entry of type
"Unsigned32", Wireshark will stop dissecting the packet at this index entry and
end with the error:

[Dissector bug, protocol SNMP: proto.c:2761: failed assertion
"DISSECTOR_ASSERT_NOT_REACHED"]

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5883
------------------------------------------------------------------------
r37557 | etxrab | 2011-06-05 12:58:02 -0700 (Sun, 05 Jun 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

From Ivan Kluchnikov:

GSMTAP carries payload in various formats of WiMAX interfaces.
It uses the wimax plugin to decode the WiMAX bursts.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5964
------------------------------------------------------------------------
r37556 | etxrab | 2011-06-05 12:45:22 -0700 (Sun, 05 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

From Aamer Akhter:
This patch adds support for a number of performance related metric in NetFlow.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5986
------------------------------------------------------------------------
r37555 | etxrab | 2011-06-05 12:40:05 -0700 (Sun, 05 Jun 2011) | 22 lines
Changed paths:
   M /trunk/doc/tshark.pod
   M /trunk/tap-iostat.c

From Cal Turney:

1.) The resolution of the time values displayed by tshark's "-z io,stat, ..."
should be increased from milliseconds to microseconds (from 3 to 6 decimal
places) in order to be consistent with -z relative time-related options such as
"-z smb,rtt" and "-z rpc,rtt" which display values to 5 decimal places. 
[Please note that separate enhancement requests for 6 decimal of precision in
Wireshark will be submitted shortly.)  

2.) The "frames  bytes" column displayed in '-z io,stat' is too narrow, frames
    and bytes should each have 15 spaces like all the other column types. 

3.) The types "FRAMES" and "BYTES" should be added to allow users to display
    these values separately and allow for filters to be specified.  

4.) The 'SUM' option should allow for relative time values such as SRTs to be
    summed.  This would be useful for the calculation of such things as
    request concurrency (total_SRT_time / duration).

5.) The tshark man page needs some corrections and readability improvements

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=4915
------------------------------------------------------------------------
r37554 | darkjames | 2011-06-05 12:35:36 -0700 (Sun, 05 Jun 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_stream_dlg.c

Fix memleaks and sigsegv when coping to clipboard RTP Streams.

------------------------------------------------------------------------
r37553 | rbalint | 2011-06-05 12:29:30 -0700 (Sun, 05 Jun 2011) | 2 lines
Changed paths:
   M /trunk/tools/compare-abis.sh

Collect number of errors form ABI checks runs in compare-abis.sh.

------------------------------------------------------------------------
r37550 | etxrab | 2011-06-05 09:33:00 -0700 (Sun, 05 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/rtp_stream_dlg.c

wrong sort of column “Packets” in “RTP Streams” window.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5988
------------------------------------------------------------------------
r37548 | gerald | 2011-06-05 08:03:58 -0700 (Sun, 05 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-06-05]
------------------------------------------------------------------------
r37547 | guy | 2011-06-04 19:48:03 -0700 (Sat, 04 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mbtcp.c

Clean up indentation.

------------------------------------------------------------------------
r37546 | rbalint | 2011-06-04 15:27:38 -0700 (Sat, 04 Jun 2011) | 2 lines
Changed paths:
   A /trunk/tools/compare-abis.sh

Adding script for comparing ABI's of different Wireshark versions.

------------------------------------------------------------------------
r37545 | rbalint | 2011-06-04 14:30:27 -0700 (Sat, 04 Jun 2011) | 2 lines
Changed paths:
   M /trunk/abi-descriptor.template

Include config.h and define _U_ for dumping ABI.

------------------------------------------------------------------------
r37544 | rbalint | 2011-06-04 14:29:13 -0700 (Sat, 04 Jun 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am.inc

Use more include dirs for ABI dumping to make preprocessor happier.

------------------------------------------------------------------------
r37543 | rbalint | 2011-06-04 14:20:57 -0700 (Sat, 04 Jun 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/5views.h
   M /trunk/wiretap/airopeek9.h
   M /trunk/wiretap/ascend-int.h
   M /trunk/wiretap/ascendtext.h
   M /trunk/wiretap/atm.h
   M /trunk/wiretap/ber.h
   M /trunk/wiretap/btsnoop.h
   M /trunk/wiretap/buffer.h
   M /trunk/wiretap/catapult_dct2000.h
   M /trunk/wiretap/commview.h
   M /trunk/wiretap/cosine.h
   M /trunk/wiretap/csids.h
   M /trunk/wiretap/daintree-sna.h
   M /trunk/wiretap/dbs-etherwatch.h
   M /trunk/wiretap/dct3trace.h
   M /trunk/wiretap/erf.h
   M /trunk/wiretap/etherpeek.h
   M /trunk/wiretap/eyesdn.h
   M /trunk/wiretap/file_wrappers.h
   M /trunk/wiretap/hcidump.h
   M /trunk/wiretap/i4b_trace.h
   M /trunk/wiretap/i4btrace.h
   M /trunk/wiretap/ipfix.h
   M /trunk/wiretap/iptrace.h
   M /trunk/wiretap/iseries.h
   M /trunk/wiretap/jpeg_jfif.h
   M /trunk/wiretap/k12.h
   M /trunk/wiretap/lanalyzer.h
   M /trunk/wiretap/libpcap.h
   M /trunk/wiretap/mpeg.h
   M /trunk/wiretap/netmon.h
   M /trunk/wiretap/netscaler.h
   M /trunk/wiretap/netscreen.h
   M /trunk/wiretap/nettl.h
   M /trunk/wiretap/network_instruments.h
   M /trunk/wiretap/netxray.h
   M /trunk/wiretap/ngsniffer.h
   M /trunk/wiretap/packetlogger.h
   M /trunk/wiretap/pcap-common.h
   M /trunk/wiretap/pcap-encap.h
   M /trunk/wiretap/pcapng.h
   M /trunk/wiretap/pppdump.h
   M /trunk/wiretap/radcom.h
   M /trunk/wiretap/snoop.h
   M /trunk/wiretap/tnef.h
   M /trunk/wiretap/toshiba.h
   M /trunk/wiretap/visual.h
   M /trunk/wiretap/vms.h
   M /trunk/wiretap/wtap-int.h
   M /trunk/wiretap/wtap.h

Fix wiretap headers to allow error-free ABI dumping.

------------------------------------------------------------------------
r37542 | etxrab | 2011-06-04 13:14:06 -0700 (Sat, 04 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mbtcp.c

Try to pacify the OSX build bot.
------------------------------------------------------------------------
r37541 | etxrab | 2011-06-04 12:17:28 -0700 (Sat, 04 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mbtcp.c

Try to fix part of the build bot errors.
------------------------------------------------------------------------
r37540 | rbalint | 2011-06-04 09:44:37 -0700 (Sat, 04 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/Makefile.am
   M /trunk/wiretap/Makefile.am
   M /trunk/wsutil/Makefile.am

Reorganize dumpabi targets to keep temporary files

------------------------------------------------------------------------
r37539 | etxrab | 2011-06-04 08:45:50 -0700 (Sat, 04 Jun 2011) | 25 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-mbtcp.c
   A /trunk/epan/dissectors/packet-mbtcp.h

From Michael Mann:
I made the following improvements to the Modbus/TCP dissector:

1. Implemented protocol to the latest specification (v1.1b).  See
http://www.modbus.org/specs.php.
2. Upgraded to "tcp_dissect_pdus" instead of having the dissector do it
manually.  This also provides TCP packet reassembly support.
3. Removed support for UDP port 502 because it's not supported by the protocol
specification.  I believe "Decode As..." could be used in its place.
4. Added dissector support for the following function codes:
  a) 8 - Diagnostics
  b) 11 - Event Counter
  c) 12 - Event Log
  d) 43 - Encapsulation Transport (mostly for 43/14)
5. Removed support for function codes not in the protocol specification. None
of them were really being parsed, they just offered a "name" for the function
code.
6. Moved protocol #defines to header file for access from other dissectors.  I
plan to have other dissectors use this, but one patch at a time.
7. Created "modbus" dissector that is accessible to other dissectors.
8. Renamed base "display filter name" to reflect PROTOABBREV.

I removed defines for value_strings, I think it's better to export the vaöue strings if needed.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5923
------------------------------------------------------------------------
r37538 | rbalint | 2011-06-04 07:23:49 -0700 (Sat, 04 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/Makefile.am

Dump ABI using all header files related to libwireshark

------------------------------------------------------------------------
r37537 | etxrab | 2011-06-04 06:50:38 -0700 (Sat, 04 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-vcdu.c

From Michael Mann:
UATification of vcdu.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5989
------------------------------------------------------------------------
r37536 | etxrab | 2011-06-04 06:47:19 -0700 (Sat, 04 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

From Michael Mann:
UATification of isakmp dissector.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5989
------------------------------------------------------------------------
r37533 | gerald | 2011-06-03 09:56:09 -0700 (Fri, 03 Jun 2011) | 20 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall via bug 5977:

Handling of SercosIII if the plugin can not be loaded.

Changed the behaviour - if the SercosIII plugin is not available, the
openSAFETY dissector registers itself for ETHERTYPE_SERCOS. SercosIII
packages can not be dissected anyway in such a case and currently no
other dissector will handle those packages.

The following steps will be taken to display the situation to the user:

The message "SercosIII dissector not available, openSAFETY/SercosIII
native dissection." will be added to the tree. Additionally a similar
warning will be presented on the console during startup of wireshark.

All openSAFETY packages will be dissected, displaying the normal
openSAFETY information.

This will be more transparent for the customer.

------------------------------------------------------------------------
r37530 | alagoutte | 2011-06-02 23:47:23 -0700 (Thu, 02 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Mark Phillips via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5830
Fix a minor typo about bitmask of a reserved field.

------------------------------------------------------------------------
r37529 | guy | 2011-06-02 18:26:08 -0700 (Thu, 02 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

Add some notes about attributes with a special format.

------------------------------------------------------------------------
r37528 | guy | 2011-06-02 18:05:22 -0700 (Thu, 02 Jun 2011) | 2 lines
Changed paths:
   M /trunk/radius/dictionary.cisco

Update a URL.

------------------------------------------------------------------------
r37526 | guy | 2011-06-02 11:33:14 -0700 (Thu, 02 Jun 2011) | 3 lines
Changed paths:
   M /trunk/radius/dictionary.cisco

Give some additional information about the format of the Command-Code
value.

------------------------------------------------------------------------
r37525 | cmaynard | 2011-06-02 10:19:38 -0700 (Thu, 02 Jun 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Add Michael Chen for his contributions to DTLS.

------------------------------------------------------------------------
r37524 | cmaynard | 2011-06-02 10:12:13 -0700 (Thu, 02 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c

From Michael Chen via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5983:
Use offset instead of fragment_offset for boundary check. 

------------------------------------------------------------------------
r37521 | wmeier | 2011-06-02 07:22:19 -0700 (Thu, 02 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-opensafety.c

Fix Bug #5984: Infinite loop caused by fcn call arg conversion: guint->guint8
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5984

------------------------------------------------------------------------
r37519 | etxrab | 2011-06-02 04:06:26 -0700 (Thu, 02 Jun 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Remove extra space at end of IMSI.
------------------------------------------------------------------------
r37518 | jmayer | 2011-06-02 00:59:36 -0700 (Thu, 02 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

Add Id to info column. Makes detecting duplicates and
matching answers so much easier.

------------------------------------------------------------------------
r37517 | jmayer | 2011-06-02 00:46:08 -0700 (Thu, 02 Jun 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

Commit 37516 broke compilation for me in 3 places (with -Werror):
- get_full_XXX functions are unused in the code
- A case statement which handles only 2 of the many enum elements
  creates another warning promoted to error
- The patch removed usage of a variable but not the variable declaration
  itself.

------------------------------------------------------------------------
r37516 | etxrab | 2011-06-02 00:11:26 -0700 (Thu, 02 Jun 2011) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

From Michael Mann:
UATification of ESP

UATification of ESP SA keys.  Some notes:
1. Trimmed a lot of fat removing the code that parsed (and reparsed) ESP SA
keys, since UATs can take care of all that. 
2. There was no validation on the src/dest, so that was carried through (ie
there is still no validation of src/dest fields)
3. Formatting of the source was a little off, so I attempted to fix the
functions I needed to deal with.  I know that's frowned upon, but the braces
were such that I couldn't tell if/else blocks to understand the code.  If
somebody wanted to run an indent program on the file, that would be
appreciated.

Added some casts to make it compile on win64.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=1123
------------------------------------------------------------------------
r37515 | sahlberg | 2011-06-01 23:59:23 -0700 (Wed, 01 Jun 2011) | 6 lines
Changed paths:
   M /trunk/cmake/modules/FindGTK2.cmake

From Matthieu Patou <mat@matws.net>

Add extra paths for finding GTK2
This makes wireshark build on 64 bit Natty boxens


------------------------------------------------------------------------
r37514 | wmeier | 2011-06-01 17:56:41 -0700 (Wed, 01 Jun 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Allow filtering on docsis-capability-type field;
Rename docs_cm_... to docsis_cm_cap_....
Do whitespace & indentation cleanup.

------------------------------------------------------------------------
r37513 | gerald | 2011-06-01 14:56:11 -0700 (Wed, 01 Jun 2011) | 2 lines
Changed paths:
   M /trunk/tools/fuzz-test.sh

Exit if we don't have enough plugins.

------------------------------------------------------------------------
r37512 | gerald | 2011-06-01 14:48:17 -0700 (Wed, 01 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/libwireshark.def
   M /trunk/epan/plugins.c
   M /trunk/epan/plugins.h
   M /trunk/epan/wslua/init_wslua.c
   M /trunk/gtk/plugins_dlg.c
   M /trunk/tshark.c

Show the plugin paths in Help→About→Plugins. Add a "-G plugins" option
to TShark which dumps a list of plugins.

------------------------------------------------------------------------
r37511 | cmaynard | 2011-06-01 11:34:41 -0700 (Wed, 01 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtls.c

From Michael Chen via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5863, with some additional enhancements by me:  Add dtls heuristics.

------------------------------------------------------------------------
r37510 | guy | 2011-06-01 11:02:16 -0700 (Wed, 01 Jun 2011) | 3 lines
Changed paths:
   M /trunk/epan/packet.c

If a dissector table doesn't exist, print a more useful message, and
only abort if WIRESHARK_ABORT_ON_DISSECTOR_BUG is set.

------------------------------------------------------------------------
r37509 | guy | 2011-06-01 09:23:51 -0700 (Wed, 01 Jun 2011) | 2 lines
Changed paths:
   M /trunk/tools/fuzz-test.sh

Remove the temporary debugging stuff.

------------------------------------------------------------------------
r37508 | stig | 2011-06-01 06:58:19 -0700 (Wed, 01 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dmp.c

Yet another cast to uint.

------------------------------------------------------------------------
r37507 | stig | 2011-06-01 06:57:13 -0700 (Wed, 01 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dmp.c

Corrected usage of uint/pointer conversion.

------------------------------------------------------------------------
r37506 | stig | 2011-06-01 06:31:48 -0700 (Wed, 01 Jun 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dmp.c

Added support for DMP version 2 and some national variants.

------------------------------------------------------------------------
r37505 | tuexen | 2011-06-01 02:26:33 -0700 (Wed, 01 Jun 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main.c

Improve handling of command line arg errors (for example "wireshark -f").
From Irene Ruengeler.

------------------------------------------------------------------------
r37504 | guy | 2011-06-01 02:12:10 -0700 (Wed, 01 Jun 2011) | 4 lines
Changed paths:
   M /trunk/tools/fuzz-test.sh

Temporary debugging stuff to see in what environment tshark is being
run - the plugins might not be getting loaded, and the goal is to figure
out why.

------------------------------------------------------------------------
r37497 | alagoutte | 2011-05-31 14:41:43 -0700 (Tue, 31 May 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eapol.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ieee80211.h

From Mark Phillips via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5830
802.11 Tag WME Qos Info field is not decoded

From me :
* Update from Trunk
* Make item fiterable


------------------------------------------------------------------------
r37496 | etxrab | 2011-05-31 14:41:00 -0700 (Tue, 31 May 2011) | 1 line
Changed paths:
   M /trunk/configure.in

Remove HAVE_AIRPDCAP
------------------------------------------------------------------------
r37495 | etxrab | 2011-05-31 14:38:39 -0700 (Tue, 31 May 2011) | 1 line
Changed paths:
   M /trunk/config.h.win32
   M /trunk/config.nmake

Remove HAVE_AIRPDCAP
------------------------------------------------------------------------
r37494 | etxrab | 2011-05-31 14:34:23 -0700 (Tue, 31 May 2011) | 1 line
Changed paths:
   M /trunk/airpcap.h
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/airpcap_gui_utils.c
   M /trunk/gtk/airpcap_gui_utils.h
   M /trunk/gtk/main.c
   M /trunk/gtk/main_airpcap_toolbar.c

REmove the check for HAVE_AIRPDCAP
------------------------------------------------------------------------
r37490 | gerald | 2011-05-31 13:45:28 -0700 (Tue, 31 May 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Add abi-descriptor.template to the distribution.

------------------------------------------------------------------------
r37488 | cmaynard | 2011-05-31 13:24:26 -0700 (Tue, 31 May 2011) | 4 lines
Changed paths:
   M /trunk/editcap.c

Handle snaplen before choplen for consistency.  Also, if chopping more bytes
than present, just chop all by setting caplen to 0.  In all cases, don't touch
len.  In other words, change incl_len but leave orig_len alone.

------------------------------------------------------------------------
r37487 | guy | 2011-05-31 12:31:45 -0700 (Tue, 31 May 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-opensafety.c

From Roland Knall: openSAFETY dissector.

------------------------------------------------------------------------
r37486 | alagoutte | 2011-05-31 12:30:53 -0700 (Tue, 31 May 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Enhance Vendor Specific IE (227) 
Specifically WPA/WME sub dissector 
* Rework from scratch VS WPA/WME dissector
* Replace proto_tree_add_text/string (ugly hf_ieee80211_tag_interpretation header field...) by proto_tree_add_item
* Make item filterable
* and other stuff...

Based on WMM_Specification_1-1

------------------------------------------------------------------------
r37485 | gerald | 2011-05-31 11:34:24 -0700 (Tue, 31 May 2011) | 2 lines
Changed paths:
   M /trunk/test/suite-capture.sh

Try adding the fifo step to Wireshark. Clean up the order of tests.

------------------------------------------------------------------------
r37482 | wmeier | 2011-05-31 08:49:59 -0700 (Tue, 31 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/text_import_scanner.l
   M /trunk/text2pcap-scanner.l
   M /trunk/wiretap/ascend.y

Fix some gcc 'old-style function definition' warnings.

------------------------------------------------------------------------
r37480 | cmaynard | 2011-05-31 08:31:34 -0700 (Tue, 31 May 2011) | 4 lines
Changed paths:
   M /trunk/editcap.c

When a snaplen is specified using "-s <snaplen", if it's smaller than the
original capture file's snaplen, save the new snaplen in the capture file
header so wireshark and capinfos can report it.

------------------------------------------------------------------------
r37479 | cmaynard | 2011-05-31 08:27:48 -0700 (Tue, 31 May 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap-int.h
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

Declare the snapshot_length as unsigned.

------------------------------------------------------------------------
r37478 | tuexen | 2011-05-31 07:49:21 -0700 (Tue, 31 May 2011) | 2 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/dumpcap.c
   M /trunk/gtk/main.c
   M /trunk/tshark.c

Get rid of has_cfilter to simplify the handling of multiple interfaces.

------------------------------------------------------------------------
r37477 | tuexen | 2011-05-31 07:45:55 -0700 (Tue, 31 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Improve handling of command line errors.

------------------------------------------------------------------------
r37476 | rbalint | 2011-05-31 07:33:49 -0700 (Tue, 31 May 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am

Add top-level dumpabi target.

------------------------------------------------------------------------
r37475 | rbalint | 2011-05-31 05:09:47 -0700 (Tue, 31 May 2011) | 1 line
Changed paths:
   M /trunk/wsutil/Makefile.am

Fixing wrong library names in r37474
------------------------------------------------------------------------
r37474 | rbalint | 2011-05-31 05:07:25 -0700 (Tue, 31 May 2011) | 3 lines
Changed paths:
   M /trunk/Makefile.am.inc
   A /trunk/abi-descriptor.template
   M /trunk/epan/Makefile.am
   M /trunk/wiretap/Makefile.am
   M /trunk/wsutil/Makefile.am

Add dumpabi target to Makefiles in wsutil, epan and wiretap directories.
We can use the dumped ABI description for comparing ABI changes between revisions.

------------------------------------------------------------------------
r37473 | tuexen | 2011-05-31 00:30:38 -0700 (Tue, 31 May 2011) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Don't limit the snaplen if not reqested.
Found by Irene Ruengeler.

------------------------------------------------------------------------
r37472 | etxrab | 2011-05-30 23:01:09 -0700 (Mon, 30 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Michael Mann:
Dissect DVB-CI host control resource
according to section 8.5.1 of the DVB-CI specification (EN50221). 

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5951
------------------------------------------------------------------------
r37471 | stig | 2011-05-30 05:49:04 -0700 (Mon, 30 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/menus.c
   M /trunk/gtk/menus.h
   M /trunk/gtk/profile_dlg.c

Include the profile name in the Edit item in the profiles popup.

------------------------------------------------------------------------
r37470 | stig | 2011-05-30 05:43:35 -0700 (Mon, 30 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smtp.c

Renamed reassembled snmp bytes buffer to "Reassembled SMTP".

------------------------------------------------------------------------
r37469 | stig | 2011-05-30 05:42:46 -0700 (Mon, 30 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/menus.c
   M /trunk/gtk/profile_dlg.c
   M /trunk/gtk/profile_dlg.h

Changed "Rename" to "Edit" in profiles popup menu.

------------------------------------------------------------------------
r37468 | etxrab | 2011-05-29 23:10:25 -0700 (Sun, 29 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From Michael Mann:
UATification of 802.11 decryption keys.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=1123
------------------------------------------------------------------------
r37467 | etxrab | 2011-05-29 12:50:55 -0700 (Sun, 29 May 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/iseries.c

Remove unused varable:
iseries.c:305: warning: unused variable 'tcpformat'
------------------------------------------------------------------------
r37466 | etxrab | 2011-05-29 12:36:21 -0700 (Sun, 29 May 2011) | 6 lines
Changed paths:
   M /trunk/wiretap/iseries.c

From Martin Warnes:
This is significant update to the existing iseries wiretap module. It adds
support for IPv6 (formatted & unformatted comms traces), in addition I've
tidied up the sscanf routines to better handle traces files with offset lines.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5957
------------------------------------------------------------------------
r37462 | gerald | 2011-05-29 08:03:59 -0700 (Sun, 29 May 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-05-29]
------------------------------------------------------------------------
r37461 | jmayer | 2011-05-29 07:06:14 -0700 (Sun, 29 May 2011) | 1 line
Changed paths:
   M /trunk/doc/rawshark.pod

Remove an (almost) duplicate entry
------------------------------------------------------------------------
r37460 | alagoutte | 2011-05-29 06:04:06 -0700 (Sun, 29 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Add some comments about RSN IE
Fix some Clang Warnings

------------------------------------------------------------------------
r37459 | alagoutte | 2011-05-29 05:51:10 -0700 (Sun, 29 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Don't return offset when it is the end of Extended Capability IE (Only use break)

------------------------------------------------------------------------
r37458 | alagoutte | 2011-05-29 05:16:53 -0700 (Sun, 29 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Fix a wrong length when there is unknown Atheros IE Data

------------------------------------------------------------------------
r37457 | jmayer | 2011-05-29 01:51:04 -0700 (Sun, 29 May 2011) | 1 line
Changed paths:
   M /trunk/gtk/CMakeLists.txt

Rev 37446 added export_sslkeys.c
------------------------------------------------------------------------
r37456 | etxrab | 2011-05-28 23:59:54 -0700 (Sat, 28 May 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
allows filtering
of the event in the pseudo header and removes the pointless filter for
version_number+current_next_indicator.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5832
------------------------------------------------------------------------
r37455 | etxrab | 2011-05-28 23:43:27 -0700 (Sat, 28 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
DVB-CI dissector: exception in close_session_request apdus (wrong offset)

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5955
------------------------------------------------------------------------
r37454 | etxrab | 2011-05-28 23:34:05 -0700 (Sat, 28 May 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
 checks the address of the Configuration
Option Register that is used for switching a PC-Card in DVB-CI mode.

The address must be <= 0xffe..

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5940
------------------------------------------------------------------------
r37453 | etxrab | 2011-05-28 23:29:48 -0700 (Sat, 28 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser:
 implements the DVB-CI date-time resource
according to section 8.5.2 of the DVB-CI specification (EN50221).

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5936
------------------------------------------------------------------------
r37452 | etxrab | 2011-05-28 23:16:19 -0700 (Sat, 28 May 2011) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload-framing.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h

- Added new SignatureIdentity values.
From Marc Petit-Huguenin:
- Removed directResponseForwarding.
- The certificate_type enum is now defined as RFC 6091's CertificateType
  so moved the definition to packet-ssl-utils.[ch].
- Fixed invalid values for CERTIFICATE_BY_NODE and CERTIFICATE_BY_USER
  Kinds.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5967
------------------------------------------------------------------------
r37451 | etxrab | 2011-05-28 23:06:22 -0700 (Sat, 28 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

From Pascal Quantin:
Update 3GPP NAS MS Radio Access Capability dissection to Release 9.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5970

From me change all enc type to ENC_BIG_ENDIAN.
------------------------------------------------------------------------
r37450 | guy | 2011-05-28 17:08:27 -0700 (Sat, 28 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/export_sslkeys.c

Make a routine not used outside this file static.

------------------------------------------------------------------------
r37449 | guy | 2011-05-28 15:52:00 -0700 (Sat, 28 May 2011) | 4 lines
Changed paths:
   M /trunk/win32/file_dlg_win32.c

Squelch yet another warning.

Use the ws_ "routines" (really #defines) for consistency.

------------------------------------------------------------------------
r37448 | guy | 2011-05-28 15:17:22 -0700 (Sat, 28 May 2011) | 3 lines
Changed paths:
   M /trunk/gtk/export_sslkeys.c

More warning squelching.  (Thank you, GLib developers, for using gulong
rather than gsize as the second argument to the GLib snprintf routines.)

------------------------------------------------------------------------
r37447 | guy | 2011-05-28 13:55:21 -0700 (Sat, 28 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/export_sslkeys.c

Get rid of some warnings on Win64.

------------------------------------------------------------------------
r37446 | sake | 2011-05-28 11:17:50 -0700 (Sat, 28 May 2011) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-ssl.h
   M /trunk/epan/libwireshark.def
   M /trunk/gtk/Makefile.common
   A /trunk/gtk/export_sslkeys.c
   A /trunk/gtk/export_sslkeys.h
   M /trunk/gtk/menus.c
   M /trunk/image/file_dlg_win32.rc
   M /trunk/win32/file_dlg_win32.c
   M /trunk/win32/file_dlg_win32.h

Add "File -> Export -> SSL Session Keys..." to be able to save the keyring info for each session in the trace file. This makes it possible to give someone the trace and the exported keys so that they can decrypt the traffic in the trace, but not new sessions to the same server.

(See also: https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3444)


------------------------------------------------------------------------
r37445 | tuexen | 2011-05-28 05:48:21 -0700 (Sat, 28 May 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Initialize pcap using an empty array instead of NULL. So no special
check is needed.

------------------------------------------------------------------------
r37442 | cmaynard | 2011-05-27 11:18:28 -0700 (Fri, 27 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

From Martin Kaiser via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5959
Use _U_ for unused function parameter.

------------------------------------------------------------------------
r37441 | cmaynard | 2011-05-27 11:08:46 -0700 (Fri, 27 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c

Use a non-volatile temporary variable as a parameter to DISSECTOR_ASSERT().
This avoids an "assert with side effects" warning and resolves Coverity CID322.

------------------------------------------------------------------------
r37440 | wmeier | 2011-05-27 08:51:21 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-homeplug-av.c

Put proto_reg_handoff_...() at the end of the file as per the usual Wireshark convention.

------------------------------------------------------------------------
r37439 | cmaynard | 2011-05-27 07:38:42 -0700 (Fri, 27 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dhcpv6.c

When parsing OPTION_REMOTE_ID, don't modify optlen or we'll return the wrong
number of bytes consumed.
Fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5962

------------------------------------------------------------------------
r37438 | wmeier | 2011-05-27 06:23:54 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c

Fix a gcc 4.6 error: "variable might be clobbered by 'longjmp' or 'vfork' [-Werror=clobbered]"

------------------------------------------------------------------------
r37437 | etxrab | 2011-05-27 06:16:28 -0700 (Fri, 27 May 2011) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/docbook/Makefile.am
   M /trunk/docbook/Makefile.common

Remove some stuff again.
------------------------------------------------------------------------
r37436 | stig | 2011-05-27 05:46:35 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

One more still dirty.

------------------------------------------------------------------------
r37435 | etxrab | 2011-05-27 05:22:20 -0700 (Fri, 27 May 2011) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/docbook/Makefile.am
   M /trunk/docbook/Makefile.common

Include missing files in distribution.
------------------------------------------------------------------------
r37434 | stig | 2011-05-27 04:58:47 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Moved nbap and pcap back as dirty dissectors.

------------------------------------------------------------------------
r37433 | stig | 2011-05-27 04:03:04 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/asn1/pkcs12/packet-pkcs12-template.c
   M /trunk/epan/dissectors/packet-pkcs12.c

Corrected "old-style function definition".

------------------------------------------------------------------------
r37432 | stig | 2011-05-27 03:52:25 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Try building some ASN.1 dissectors as clean.

------------------------------------------------------------------------
r37431 | etxrab | 2011-05-27 03:49:34 -0700 (Fri, 27 May 2011) | 1 line
Changed paths:
   M /trunk/gtk/Makefile.am

Include text_import_scanner.l in the distribution.
------------------------------------------------------------------------
r37430 | etxrab | 2011-05-27 03:24:36 -0700 (Fri, 27 May 2011) | 1 line
Changed paths:
   D /trunk/gtk/expert_dlg.c
   D /trunk/gtk/expert_dlg.h

Remove no longer used files.
------------------------------------------------------------------------
r37429 | stig | 2011-05-27 03:18:17 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/asn1/p1/packet-p1-template.c
   M /trunk/epan/dissectors/packet-p1.c

Corrected "old-style function definition".

------------------------------------------------------------------------
r37428 | stig | 2011-05-27 00:39:13 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/profile_dlg.c

Added some row space to "Create New Profile".

------------------------------------------------------------------------
r37427 | stig | 2011-05-27 00:38:08 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/new_packet_list.c

Added some row space to "Edit Column Details".

------------------------------------------------------------------------
r37426 | jake | 2011-05-27 00:02:26 -0700 (Fri, 27 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-6lowpan.c

From Colin O'Flynn:
Avoid processing tvb when fragment dissection didn't create one.

------------------------------------------------------------------------
r37425 | stig | 2011-05-26 23:52:32 -0700 (Thu, 26 May 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Initialize global_ld.pcaps before we setup signal handlers, which 
uses this list to cleanup.

------------------------------------------------------------------------
r37424 | morriss | 2011-05-26 20:27:12 -0700 (Thu, 26 May 2011) | 1 line
Changed paths:
   M /trunk/epan/Makefile.common

Add tvbuff-int.h to the list of include files.
------------------------------------------------------------------------
r37423 | morriss | 2011-05-26 20:22:48 -0700 (Thu, 26 May 2011) | 2 lines
Changed paths:
   M /trunk/configure.in

AirPcap is disabled by default; fix the help text to reflect that fact.

------------------------------------------------------------------------
r37422 | morriss | 2011-05-26 20:06:50 -0700 (Thu, 26 May 2011) | 4 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-dtls.c
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-megaco.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/libwireshark.def
   M /trunk/epan/proto.c
   A /trunk/epan/tvbuff-int.h
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h
   M /trunk/epan/wslua/init_wslua.c
   M /trunk/epan/wslua/wslua_tvb.c
   M /trunk/gtk/follow_udp.c
   M /trunk/gtk/packet_win.c

Make TVBs opaque for most users.

Convert TVB_RAW_OFFSET() and TVB_GET_DS_TVB() into functions.

------------------------------------------------------------------------
r37421 | wmeier | 2011-05-26 19:25:20 -0700 (Thu, 26 May 2011) | 11 lines
Changed paths:
   M /trunk/epan/radius_dict.l

SVN #37419 fixed an OSX compile issue and reverted SVN #37408.

The actual cause of an OSX compile problem: The text   [^[:blank:]]   in a comment.

SVN #37408 was reverted because a period (or most other characters)
in a RE character class don't need to be escaped.

This patch adds some replacement text in the spot in the comment
originally occupied by the text    [^[:blank:]]


------------------------------------------------------------------------
r37420 | morriss | 2011-05-26 18:57:33 -0700 (Thu, 26 May 2011) | 3 lines
Changed paths:
   M /trunk/asn1/gsm_map/gsm_map.cnf
   M /trunk/epan/dissectors/packet-aim-messaging.c
   M /trunk/epan/dissectors/packet-ansi_637.c
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-etch.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_sms.c
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-lsc.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-sebek.c
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smpp.c

Treat TVBs as opaque: use the accessor functions instead of accessing the fields
directly.

------------------------------------------------------------------------
r37419 | wmeier | 2011-05-26 18:33:24 -0700 (Thu, 26 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/radius_dict.l

Try a stab-in-the-dark to see if we can fix the OSX compile issue.

------------------------------------------------------------------------
r37418 | gerald | 2011-05-26 16:20:35 -0700 (Thu, 26 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Don't call g_log(); as the comment indicates it can cause problems.

------------------------------------------------------------------------
r37417 | gerald | 2011-05-26 15:12:27 -0700 (Thu, 26 May 2011) | 6 lines
Changed paths:
   M /trunk/dumpcap.c

Don't call pcap_breakloop() if we're not capturing anything. Fixes a
crash found by Stig.

Add debugging output to capture_cleanup_handler() on non-Windows
systems.

------------------------------------------------------------------------
r37416 | gerald | 2011-05-26 13:23:38 -0700 (Thu, 26 May 2011) | 2 lines
Changed paths:
   M /trunk/test/suite-capture.sh

Add a "capture from stdin" test.

------------------------------------------------------------------------
r37415 | cmaynard | 2011-05-26 13:05:11 -0700 (Thu, 26 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Append received percentage after received/dropped counts.

------------------------------------------------------------------------
r37414 | tuexen | 2011-05-26 12:22:16 -0700 (Thu, 26 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Provide consistent counters for received and dropped packets.

------------------------------------------------------------------------
r37413 | tuexen | 2011-05-26 11:12:41 -0700 (Thu, 26 May 2011) | 4 lines
Changed paths:
   M /trunk/dumpcap.c

Fix the handling of pipes on Windows platforms.
This should fix
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5939

------------------------------------------------------------------------
r37412 | cmaynard | 2011-05-26 09:03:29 -0700 (Thu, 26 May 2011) | 2 lines
Changed paths:
   M /trunk/plugins/tpg/packet-http.c

Add SVN Id and GPL.  Minor whitespace cleanup.

------------------------------------------------------------------------
r37411 | etxrab | 2011-05-26 07:44:12 -0700 (Thu, 26 May 2011) | 1 line
Changed paths:
   M /trunk/plugins/Makefile.am

Add the possibillity of adding custom extra dist files.
------------------------------------------------------------------------
r37410 | cmaynard | 2011-05-26 07:33:55 -0700 (Thu, 26 May 2011) | 6 lines
Changed paths:
   M /trunk/dumpcap.c

Change "captured/dropped" terminology to "received/dropped".  Also, unless
we're a capture child, always report the final caputure count regardless of the
'quiet' setting.  This ensures that each interface prints its statistics on a
new line, rather than the first one being printed on the same line as the
packet count in the case when we're not 'quiet'.

------------------------------------------------------------------------
r37409 | etxrab | 2011-05-26 07:23:40 -0700 (Thu, 26 May 2011) | 1 line
Changed paths:
   M /trunk/Makefile.am

Add FindGMODULE2.cmake and FindGTHREAD2.cmake to the dist.
------------------------------------------------------------------------
r37408 | morriss | 2011-05-26 07:15:51 -0700 (Thu, 26 May 2011) | 1 line
Changed paths:
   M /trunk/epan/radius_dict.l

Escape the '.' in radius dictionary ATTRIBUTE names.  This may fix the OSX-10.5 builds too.
------------------------------------------------------------------------
r37407 | morriss | 2011-05-26 06:32:04 -0700 (Thu, 26 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/tools/checkAPIs.pl

Inspired by one of the changes from r37406 and bug 2794: detect hf abbreviations
with two or more periods in a row.  Fix one case of that.

------------------------------------------------------------------------
r37406 | etxrab | 2011-05-25 23:32:51 -0700 (Wed, 25 May 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-acn.c
   M /trunk/epan/dissectors/packet-afp.c
   M /trunk/epan/dissectors/packet-fmp_notify.c
   M /trunk/epan/dissectors/packet-infiniband_sdp.c
   M /trunk/epan/dissectors/packet-ldss.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-q708.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-tn3270.c
   M /trunk/epan/dissectors/packet-wassp.c
   M /trunk/epan/dissectors/packet-who.c
   M /trunk/epan/dissectors/packet-wlccp.c

From Michael Mann.
Part of "display filters with redundancies of PROTABBREV in them."
The ones left outs should be fixed differently I think.
Rename som ndps hf variables while at it.

https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=2794
------------------------------------------------------------------------
r37405 | wmeier | 2011-05-25 19:59:25 -0700 (Wed, 25 May 2011) | 7 lines
Changed paths:
   M /trunk/epan/radius_dict.l
   M /trunk/radius/dictionary.foundry

Allow the character '.' in radius dictionary ATTRIBUTE names;

Fixes issue caused by dictionary.foundry having ATTRIBUTE names containing
 a '.' (e.g., Foundry-MAC-Authent-needs-802.1x).

So: Revert SVN #37386 which temporarily changed the '.' to '-'.

------------------------------------------------------------------------
r37404 | morriss | 2011-05-25 19:20:23 -0700 (Wed, 25 May 2011) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cip.c
   M /trunk/epan/dissectors/packet-cip.h

From Michael Mann via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5749 :

Added support for the following services of the Connection Manager object:
LargeForwardOpen
GetConnectionOwner

Added support for the following services of the Connection Configuration
Object:
GetAttributeAll
SetAttributeAll

From me:
Replace tabs with spaces; adjust modelines for 8-space tabs instead of 3.

------------------------------------------------------------------------
r37403 | morriss | 2011-05-25 18:55:04 -0700 (Wed, 25 May 2011) | 20 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/CMakeLists.txt
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-homeplug-av.c

From Florian Fainelli via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5943 :

The two patches attached allow the dissection of the Homeplug AV Ethernet MAC
management frames between a controlling device and a Homeplug AV Ethernet to
PLC adapter. This protocol is pretty similar to the previous generation
Homeplug protocol (dissected by packet-homeplug.c) but a couple of noticeable
differences make it require its own dissector handler.

This dissector is based on the work done by Nicolas Thill, Xavier Carcelle and
myself in the Faifa project (https://dev.open-plc.org).

The dissector handles the standard Homeplug AV Ethernet MAC management frames
(called public) as well as the Intellon specific management frames (vendor).

From me:
Remove unnecessary global variables.
Add to COL_INFO even when !tree.
Remove gotos.
Remove unnecessary includes.

------------------------------------------------------------------------
r37401 | sake | 2011-05-25 14:49:29 -0700 (Wed, 25 May 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl.c

Extended the SSL key log import routine to be able to read the following format:

RSA Session-ID:xxxx Master-Key:xxxx

This makes it easy to use the "openssl s_client" output for decryption
(see: http://ask.wireshark.org/questions/4229/follow-ssl-stream-using-master-key-and-session-id)

It also paves the way for exporting SSL keyring material. See also the enhancement request in:
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3444


------------------------------------------------------------------------
r37400 | morriss | 2011-05-25 14:47:35 -0700 (Wed, 25 May 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-sccp.h

Add some expert infos for unusual messages:
 - routing on SSN but the SSN is not present or is unspecified (zero)
 - message handling has an unexpected value
 - message class is incorrect for the message type

Also clean up some indentation and other white space.

------------------------------------------------------------------------
r37396 | gerald | 2011-05-25 11:38:39 -0700 (Wed, 25 May 2011) | 2 lines
Changed paths:
   M /trunk/wsutil/Makefile.am

Filter out arg_list_utf_16to8.

------------------------------------------------------------------------
r37395 | gerald | 2011-05-25 11:09:04 -0700 (Wed, 25 May 2011) | 2 lines
Changed paths:
   M /trunk/asn1/Custom.make

Remove a backslash.

------------------------------------------------------------------------
r37394 | etxrab | 2011-05-25 08:01:07 -0700 (Wed, 25 May 2011) | 1 line
Changed paths:
   M /trunk/configure.in

Copy-paste error.
------------------------------------------------------------------------
r37393 | etxrab | 2011-05-25 07:21:42 -0700 (Wed, 25 May 2011) | 1 line
Changed paths:
   A /trunk/asn1/Custom.make
   M /trunk/asn1/Makefile.am
   M /trunk/configure.in

Make it easier to add custom asn1 dissectors.
------------------------------------------------------------------------
r37392 | etxrab | 2011-05-25 06:17:51 -0700 (Wed, 25 May 2011) | 1 line
Changed paths:
   M /trunk/epan/expert.c

Use PI_UNDECODED instead.
------------------------------------------------------------------------
r37391 | etxrab | 2011-05-25 04:05:23 -0700 (Wed, 25 May 2011) | 1 line
Changed paths:
   M /trunk/epan/expert.c
   M /trunk/epan/expert.h
   M /trunk/epan/libwireshark.def

Add a convinience function to add expert warnings for not dissected items.
------------------------------------------------------------------------
r37390 | martinm | 2011-05-25 02:08:27 -0700 (Wed, 25 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/io_stat.c

Allow longer field names in the advanced filter control.

------------------------------------------------------------------------
r37389 | alagoutte | 2011-05-25 00:15:05 -0700 (Wed, 25 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

From tschardt via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5949
802.11 IE tag number 61/62 still decoded to "Unknown"/Reserved tag Number

Remove inadvertently by me in rev36120

------------------------------------------------------------------------
r37388 | etxrab | 2011-05-24 22:33:00 -0700 (Tue, 24 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/epan/etypes.h

From Florian Fainelli:
Patch adding the Homeplug AV ethertype.
Part of https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5943
------------------------------------------------------------------------
r37387 | guy | 2011-05-24 19:35:30 -0700 (Tue, 24 May 2011) | 3 lines
Changed paths:
   M /trunk/configure.in

One "-Warray-bounds" suffices; as we're including it in the default
options, no need to include it in the "extra warnings" options as well.

------------------------------------------------------------------------
r37386 | wmeier | 2011-05-24 18:44:13 -0700 (Tue, 24 May 2011) | 3 lines
Changed paths:
   M /trunk/radius/dictionary.foundry

An Attribute Name with a '.' (Foundry-MAC-Authent-needs-802.1x) causes an access violation.
Change '802.1x' to '802-1x' in 2 places temporarily until I get a chance to see what's going on.

------------------------------------------------------------------------
r37385 | wmeier | 2011-05-24 17:40:35 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/packaging/nsis/wireshark.nsi
   A /trunk/radius/dictionary.ukerna

Add new dictionary from freeradius.org: GIT 2.1.x branch.

------------------------------------------------------------------------
r37384 | wmeier | 2011-05-24 17:30:09 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   M /trunk/radius/dictionary.eltex

Use freeradius.org version [from the GIT 2.1.x branch]

------------------------------------------------------------------------
r37383 | wmeier | 2011-05-24 17:07:37 -0700 (Tue, 24 May 2011) | 4 lines
Changed paths:
   M /trunk/radius/dictionary.rfc2866

Tunnel related VALUEs are actually defined in dictionary.rfc2867.
Also: remove 3 "unassigned" entries to match the FreeRadius dictionary.rfc2866.
Note: This version (w/o the dup Acct-Status-Type) will be submitted upstream.

------------------------------------------------------------------------
r37382 | wmeier | 2011-05-24 13:59:34 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   M /trunk/radius/dictionary.airespace

Use latest version from FreeRadius 2.1.10 release.

------------------------------------------------------------------------
r37381 | wmeier | 2011-05-24 12:20:59 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   M /trunk/packaging/nsis/wireshark.nsi

Remove blank line added by mistake ...

------------------------------------------------------------------------
r37380 | wmeier | 2011-05-24 12:13:04 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/packaging/nsis/wireshark.nsi

Update list of radius dictionary files to reflect adds/deletes.

------------------------------------------------------------------------
r37379 | wmeier | 2011-05-24 11:47:03 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   D /trunk/radius/dictionary.tunnel

Obsolete; See dictionary.rfc2868

------------------------------------------------------------------------
r37378 | wmeier | 2011-05-24 11:42:04 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   D /trunk/radius/dictionary.unisphere

Obsolete; See dictionary.erx

------------------------------------------------------------------------
r37377 | wmeier | 2011-05-24 11:24:29 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   M /trunk/radius/dictionary.cisco
   M /trunk/radius/dictionary.compat
   M /trunk/radius/dictionary.erx
   M /trunk/radius/dictionary.extreme
   M /trunk/radius/dictionary.foundry
   M /trunk/radius/dictionary.freeradius
   M /trunk/radius/dictionary.freeradius.internal
   M /trunk/radius/dictionary.hp
   M /trunk/radius/dictionary.huawei
   M /trunk/radius/dictionary.juniper
   M /trunk/radius/dictionary.patton
   M /trunk/radius/dictionary.redback

Updated dictionary files released as part of FreeRadius v2.1.7 thru v2.1.10

------------------------------------------------------------------------
r37376 | wmeier | 2011-05-24 10:18:34 -0700 (Tue, 24 May 2011) | 3 lines
Changed paths:
   A /trunk/radius/dictionary.alcatel.esam
   A /trunk/radius/dictionary.audiocodes
   A /trunk/radius/dictionary.wimax.wichorus

Some dictionary files added in FreeRadius v2.1.7 - 2.1.10.
(These aren't list in the dictionary file).

------------------------------------------------------------------------
r37375 | wmeier | 2011-05-24 09:30:32 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   M /trunk/radius/dictionary
   A /trunk/radius/dictionary.acme
   A /trunk/radius/dictionary.alcatel.sr
   A /trunk/radius/dictionary.iea
   A /trunk/radius/dictionary.motorola.wimax
   A /trunk/radius/dictionary.rfc4603
   A /trunk/radius/dictionary.rfc5580
   A /trunk/radius/dictionary.rfc5607
   A /trunk/radius/dictionary.rfc5904
   A /trunk/radius/dictionary.wichorus

Add new dictionary files from FreeRadius v2.1.7 thru 2.1.10

------------------------------------------------------------------------
r37374 | guy | 2011-05-24 09:17:43 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   M /trunk/tshark.c

Don't print hidden columns.

------------------------------------------------------------------------
r37372 | gerald | 2011-05-23 17:07:56 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/capinfos.c
   M /trunk/dumpcap.c
   M /trunk/editcap.c
   M /trunk/gtk/main.c
   M /trunk/mergecap.c
   M /trunk/randpkt.c
   M /trunk/rawshark.c
   M /trunk/text2pcap.c
   M /trunk/tshark.c
   M /trunk/wsutil/Makefile.nmake
   M /trunk/wsutil/libwsutil.def
   M /trunk/wsutil/unicode-utils.c
   M /trunk/wsutil/unicode-utils.h

Move the Windows argument list conversion code to a common routine.

------------------------------------------------------------------------
r37371 | wmeier | 2011-05-23 11:04:45 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcgi.c
   M /trunk/epan/dissectors/packet-infiniband.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-nisplus.c
   M /trunk/epan/dissectors/packet-nlsp.c
   M /trunk/epan/dissectors/packet-pgsql.c
   M /trunk/epan/dissectors/packet-xtp.c

Fix various benign cases of Coverity [UNUSED]: 996,995,956,936,899,1133,1000

------------------------------------------------------------------------
r37370 | cmaynard | 2011-05-23 10:53:51 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-dect.c

From Romain Fliedel via bug 5947: Fix the mask for extracting FMID.

------------------------------------------------------------------------
r37369 | wmeier | 2011-05-23 10:51:33 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-maccontrol.c

Use the 'proto_tree *' (not the 'proto_item *') for a proto_tree_add_item(): Coverity 963 {UNUSED]

------------------------------------------------------------------------
r37368 | martinm | 2011-05-23 10:15:00 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Pass tap info into sequence analysis function.

------------------------------------------------------------------------
r37367 | martinm | 2011-05-23 09:11:32 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Detect when padding non-final padding comes after other control subheaders.

------------------------------------------------------------------------
r37366 | wmeier | 2011-05-23 09:09:09 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/version_info.c

(Trivial) Testing _MSC_FULL_VER can be done at compile time.

------------------------------------------------------------------------
r37365 | tuexen | 2011-05-23 07:41:04 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-zbee-zdp-management.c

Fix compilation.

------------------------------------------------------------------------
r37364 | wmeier | 2011-05-23 07:34:59 -0700 (Mon, 23 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pnrp.c

Remove an unneeded redundant line of code: Fixes Coverity 1001.
Also:
 Use a separate ett variable for a subtree;
 Convert what appears to be '4 space tabs' to '4 spaces'.

------------------------------------------------------------------------
r37363 | wmeier | 2011-05-23 07:30:00 -0700 (Mon, 23 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h221_nonstd.c

Use correct subtree in two cases: Fixes Coverity 920;
Also:
  Remove a number of unneeded #include statements;
  Do some whitespace cleanup.

------------------------------------------------------------------------
r37362 | tuexen | 2011-05-23 07:28:02 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lwapp.c

Fix compilation.

------------------------------------------------------------------------
r37361 | wmeier | 2011-05-23 07:26:43 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dect.c
   M /trunk/epan/dissectors/packet-epl.c
   M /trunk/epan/dissectors/packet-hclnfsd.c
   M /trunk/epan/dissectors/packet-zbee-zdp-management.c

Use correct subtree in a few cases: Fixes Coverity 921,894,878 & 1136;

------------------------------------------------------------------------
r37360 | wmeier | 2011-05-23 07:17:30 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi-se.c

Use correct subtree in several 'proto_tree_add_text(...)' statements: Fixes Coverity 938 [UNUSED].

------------------------------------------------------------------------
r37359 | wmeier | 2011-05-23 07:14:43 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lwapp.c

Use correct subtree in 'call dissector(...)': Fixes Coverity 962 [UNUSED].

------------------------------------------------------------------------
r37358 | wmeier | 2011-05-23 07:13:03 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mikey.c

Add a missing line of code: Fixes Coverity 967 [UNUSED].

------------------------------------------------------------------------
r37357 | wmeier | 2011-05-23 07:11:14 -0700 (Mon, 23 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xcsl.c

Use correct subtree for proto_tree_add_item in several places: Coverity 1130 [UNUSED];
Also: Reformat a few lines and do some whitespace cleanup.

------------------------------------------------------------------------
r37356 | martinm | 2011-05-23 03:09:08 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tapa.c

Add missing braces.

------------------------------------------------------------------------
r37355 | jmayer | 2011-05-23 01:54:47 -0700 (Mon, 23 May 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

7.3.2.25 or 802.11-2007 gives an example of length 20, so it is unclear where the 24 came from (unintentionally fixes bug 5942)
------------------------------------------------------------------------
r37354 | darkjames | 2011-05-23 01:03:50 -0700 (Mon, 23 May 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Clean duplicated contributors.

------------------------------------------------------------------------
r37353 | cmaynard | 2011-05-22 17:32:40 -0700 (Sun, 22 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-batadv.c
   M /trunk/epan/dissectors/packet-dcerpc-fileexp.c
   M /trunk/epan/dissectors/packet-dcerpc-spoolss.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-erldp.c

Delete unused header field entries found by running checkhf.pl.

------------------------------------------------------------------------
r37352 | cmaynard | 2011-05-22 17:05:07 -0700 (Sun, 22 May 2011) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Added Michael Mann for his contributions to bug 2794.

------------------------------------------------------------------------
r37351 | cmaynard | 2011-05-22 17:00:53 -0700 (Sun, 22 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-batadv.c
   M /trunk/epan/dissectors/packet-dcerpc-fileexp.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_acct.c
   M /trunk/epan/dissectors/packet-dcerpc-rs_repadm.c
   M /trunk/epan/dissectors/packet-dcerpc-spoolss.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcom-dispatch.c
   M /trunk/epan/dissectors/packet-dlm3.c
   M /trunk/epan/dissectors/packet-erldp.c
   M /trunk/epan/dissectors/packet-image-jfif.c
   M /trunk/epan/dissectors/packet-lanforge.c
   M /trunk/epan/dissectors/packet-maccontrol.c

From Micheal Mann via bug 2794: Fix some display filter field names.

------------------------------------------------------------------------
r37350 | wmeier | 2011-05-22 15:04:24 -0700 (Sun, 22 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

From Yaniv Kaul: Some 'set but not used' compilation fixes;
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5858

From me: 2 corrections to the patch and sevral other minor changes.

------------------------------------------------------------------------
r37346 | gerald | 2011-05-22 08:04:14 -0700 (Sun, 22 May 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-05-22]
------------------------------------------------------------------------
r37345 | tuexen | 2011-05-22 04:11:00 -0700 (Sun, 22 May 2011) | 8 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/main_welcome.c

Fix the case where you start with interfaces on the command line
(so using ifaces) and then using the GUI (which only deals with
iface).

These kind of problems will completely disappear when the
old strucuture components like iface have completely be
retired. This is the next thing we will work on.

------------------------------------------------------------------------
r37344 | tuexen | 2011-05-21 13:57:00 -0700 (Sat, 21 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Use appropriate temporary filename when capturing from multiple interfaces.

------------------------------------------------------------------------
r37343 | tuexen | 2011-05-21 11:51:25 -0700 (Sat, 21 May 2011) | 4 lines
Changed paths:
   M /trunk/dumpcap.c

As suggested on the dev list: Use pcapng and threads
when capturing on multiple interfaces even if not specified
on the command line.

------------------------------------------------------------------------
r37342 | tuexen | 2011-05-21 06:22:38 -0700 (Sat, 21 May 2011) | 7 lines
Changed paths:
   M /trunk/capture_sync.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main_statusbar.c

Fix the capturing from the GUI. Honor the iface variable.

The next step is to retire the iface variable and use
the ifaces array only. This should simplify things and
fix the cases, where you start wireshark with command
line arguments and also use the GUI.

------------------------------------------------------------------------
r37341 | gerald | 2011-05-20 17:10:57 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Pass a pcap_options * instead of a pcap_options **.

------------------------------------------------------------------------
r37340 | wmeier | 2011-05-20 13:41:23 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

Don't assign to a variable which is then not referenced: Coverity 998 [UNUSED].

------------------------------------------------------------------------
r37339 | wmeier | 2011-05-20 13:29:19 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcom-remunkn.c

Don't assign to an unused variable: Fixes Coverity 874 [UNUSED].

------------------------------------------------------------------------
r37338 | wmeier | 2011-05-20 13:22:59 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtpt.c

Fix a typo ...

------------------------------------------------------------------------
r37337 | wmeier | 2011-05-20 13:21:14 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtpt.c

Remove unneeded code: Fixes Coverity 890 [UNUSED].

------------------------------------------------------------------------
r37336 | wmeier | 2011-05-20 13:10:41 -0700 (Fri, 20 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtpv2.c

Use (what appears to be) the correct tvb for a function call: Fixes Coverity 919 [UNUSED];
#include <stdlib.h> not req'd.

------------------------------------------------------------------------
r37335 | wmeier | 2011-05-20 13:00:16 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mp2t.c

Remove unused code: Fixes Coverity 972 [UNUSED].

------------------------------------------------------------------------
r37334 | wmeier | 2011-05-20 12:00:09 -0700 (Fri, 20 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ajp13.c
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-dpnss.c
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-fix.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ipsec.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-ldss.c
   M /trunk/epan/dissectors/packet-megaco.c
   M /trunk/epan/dissectors/packet-msrp.c
   M /trunk/epan/dissectors/packet-nasdaq-itch.c
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-rtsp.c
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/dissectors/packet-smtp.c
   M /trunk/epan/dissectors/packet-telnet.c

Add #include <stdlib.h> to files which reference fcns declared in stdlib.h;
 (In many cases I previously incorrectly removed the #include <stdlib.h>).

------------------------------------------------------------------------
r37333 | gerald | 2011-05-20 10:02:20 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add bugs 4985 and 5580 to the list of known problems.

------------------------------------------------------------------------
r37331 | wmeier | 2011-05-20 08:44:25 -0700 (Fri, 20 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fix.c
   M /trunk/epan/dissectors/packet-imf.c
   M /trunk/epan/dissectors/packet-miop.c
   M /trunk/epan/dissectors/packet-netflow.c
   M /trunk/epan/dissectors/packet-nsip.c
   M /trunk/epan/dissectors/packet-pflog.c
   M /trunk/epan/dissectors/packet-rtmpt.c
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-zbee-security.c

Don't assign to a proto_item* if the value won't be used:
 Fixes Coverity 903,935,968,985,997,999,1024,1025,1134;
Remove unneeded #includes;
Do whitespace cleanup.

------------------------------------------------------------------------
r37330 | wmeier | 2011-05-20 08:34:29 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bt-utp.c

Add to comment about using a heuristic; Fix a typo.

------------------------------------------------------------------------
r37329 | wmeier | 2011-05-20 08:22:58 -0700 (Fri, 20 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fefd.c

Use correct parent tree when creating a subtree: Fixes Coverity 902 [UNUSED];
Remove unneeded #includes;
Do some whitespace cleanup.

------------------------------------------------------------------------
r37328 | wmeier | 2011-05-20 08:19:26 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dis-fields.c

'#if 0' code related to already commented out code: Fixes Coverity 881.

------------------------------------------------------------------------
r37327 | wmeier | 2011-05-20 07:21:02 -0700 (Fri, 20 May 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mpls.c

Don't assign to a proto_item* if the value won't be used: Coverity 975 [UNUSED]
Remove unneeded prefs callback in prefs registration;
Remove 'if (!initialized)' test from proto_reg_handoff...();
Remove unneeded #include;
Do some whitespace cleanup.

------------------------------------------------------------------------
r37326 | etxrab | 2011-05-20 06:55:21 -0700 (Fri, 20 May 2011) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml
   M /trunk/epan/dissectors/packet-diameter_3gpp.c

Prettify som 3GPP AVP:s
------------------------------------------------------------------------
r37325 | stig | 2011-05-20 04:58:00 -0700 (Fri, 20 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/profile_dlg.c

gtk_menu_item_set_label() is from gtk 2.16.

------------------------------------------------------------------------
r37324 | stig | 2011-05-20 04:30:51 -0700 (Fri, 20 May 2011) | 4 lines
Changed paths:
   M /trunk/gtk/menus.c
   M /trunk/gtk/menus.h
   M /trunk/gtk/profile_dlg.c

Include the profile name in the Delete item in the profiles popup.
Fixed creating a new profile from the popup without setting a create from.
Removed some unneeded ep_strdup_printf.

------------------------------------------------------------------------
r37323 | morriss | 2011-05-19 20:22:27 -0700 (Thu, 19 May 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rmt-lct.c

Copy data from the TVB into ep_alloc'd memory, rather than saving a pointer into the TVB.
------------------------------------------------------------------------
r37322 | morriss | 2011-05-19 20:20:20 -0700 (Thu, 19 May 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Use tvb_get_ephemeral_string() instead of tvb_get_ptr().
------------------------------------------------------------------------
r37321 | morriss | 2011-05-19 20:17:01 -0700 (Thu, 19 May 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Use tvb_bytes_to_str() instead of a homegrown version.
------------------------------------------------------------------------
r37320 | morriss | 2011-05-19 20:15:18 -0700 (Thu, 19 May 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rmi.c
   M /trunk/epan/dissectors/packet-tapa.c

Use TVB accessor functions instead of tvb_get_ptr()
------------------------------------------------------------------------
r37319 | morriss | 2011-05-19 20:12:56 -0700 (Thu, 19 May 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-retix-bpdu.c
   M /trunk/epan/dissectors/packet-rtnet.c

Use tvb_ether_to_str()
------------------------------------------------------------------------
r37318 | guy | 2011-05-19 19:44:12 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/packaging/macosx/osx-app.sh

Fix annoying typo.

------------------------------------------------------------------------
r37317 | morriss | 2011-05-19 19:42:14 -0700 (Thu, 19 May 2011) | 7 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/addr_resolv.h
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-pw-eth.c
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/epan/dissectors/packet-slowprotocols.c
   M /trunk/epan/libwireshark.def

Use proto_tree_add_item() instead of proto_tree_add_xxx() with a pointer into
the TVB.

Introduce and start using tvb_get_manuf_name() and tvb_get_manuf_name_if_known()
which do the same as the non-tvb versions but take a tvb and an offset instead
of (commonly) a pointer into a TVB.

------------------------------------------------------------------------
r37316 | guy | 2011-05-19 19:35:05 -0700 (Thu, 19 May 2011) | 3 lines
Changed paths:
   M /trunk/packaging/macosx/osx-app.sh

In at least some versions of OS X SystemStarter gets cranky if the
startup item is group-writable.

------------------------------------------------------------------------
r37314 | guy | 2011-05-19 14:11:44 -0700 (Thu, 19 May 2011) | 6 lines
Changed paths:
   M /trunk/Makefile.am

Add pdml2html.xsl to the source tarball.

(Can we have a macro that has everything in pkgdata_DATA except for
COPYING, and use that macro in both the definition of pkgdata_DATA and
EXTRA_DIST?)

------------------------------------------------------------------------
r37312 | gerald | 2011-05-19 14:09:29 -0700 (Thu, 19 May 2011) | 1 line
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/tools/win32-setup.sh
   M /trunk/tools/win64-setup.sh

Update the User's Guide.
------------------------------------------------------------------------
r37311 | tuexen | 2011-05-19 13:48:58 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Drop privileges after opening all pcap devices, not after the first one...

------------------------------------------------------------------------
r37309 | gerald | 2011-05-19 13:37:36 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/docbook/user-guide.xml

1.6 → 1.7.

------------------------------------------------------------------------
r37308 | wmeier | 2011-05-19 13:21:08 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-ziop.c

Don't assign to an unused 'proto item *': Coverity 1033 & 906

------------------------------------------------------------------------
r37307 | tuexen | 2011-05-19 13:20:35 -0700 (Thu, 19 May 2011) | 3 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture_sync.c
   M /trunk/gtk/main_statusbar.c

In case we have no interface information in the array, use the global value.
This fixes https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5935.

------------------------------------------------------------------------
r37306 | wmeier | 2011-05-19 13:16:10 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-browse.c

Create subtree under the correct parent tree: Coverity 1138.

------------------------------------------------------------------------
r37305 | wmeier | 2011-05-19 13:13:54 -0700 (Thu, 19 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-zbee-aps.c

Don't assign a value which is never used to a 'proto item *': Covertiy 1135;
Remove some unneeded #includes.

------------------------------------------------------------------------
r37304 | gerald | 2011-05-19 13:13:33 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/docbook/wsug_src/WSUG_app_tools.xml

Fix markup.

------------------------------------------------------------------------
r37303 | gerald | 2011-05-19 12:52:56 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/docbook/user-guide.xml
   M /trunk/docbook/wsug_src/WSUG_app_tools.xml

Update the version and command output.

------------------------------------------------------------------------
r37302 | wmeier | 2011-05-19 12:48:39 -0700 (Thu, 19 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-meta.c

#if 0 some not currently used code: Fixes Coverity 966 [UNUSED]
Convert apparent "4 space tabs" to "4 spaces".

------------------------------------------------------------------------
r37301 | wmeier | 2011-05-19 12:22:49 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/prefs_gui.c

Remove unneeded variable and code; Rename a function arg; Fix usage of _U_: Fixes Coverity 1146 [UNUSED]

------------------------------------------------------------------------
r37300 | gerald | 2011-05-19 12:03:22 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/config.nmake

FOP 0.95 → 1.0.

------------------------------------------------------------------------
r37298 | gerald | 2011-05-19 11:10:21 -0700 (Thu, 19 May 2011) | 26 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/Makefile.am
   M /trunk/Makefile.nmake
   M /trunk/file.c
   M /trunk/packaging/nsis/wireshark.nsi
   A /trunk/pdml2html.xsl
   M /trunk/print.c
   M /trunk/print.h
   A /trunk/tools/colorfilters2js.pl
   M /trunk/tshark.c

From Dirk Jagdmann via bug 5875:

My attachment adds a link to a XSLT file to the preamble of the PDML.
The XSLT will transform the PDML to a HTML page, and the HTML page
features a look similar to Wireshark. See
http://cubic.org/~doj/ebay/a.pdml for an example.

The patch also contains a small perl program which converts the
Wireshark colortable into javascript code which is used in the XSLT
file. If you want to use a different color scheme you would execute the
perl program and insert the generated javascript function into your XSLT
file.

To view the HTML you could either place the PDML and XSLT file on your
webserver and verify that your webserver sends the PDML file as
"text/xml".  Then your webbrowser will find the linked XSLT file,
download that as well and convert the PDML to HTML on the fly.

You could also use an XSLT processor like xsltproc to convert the PDML
and XSLT into a static HTML file.


From me:

Minor fixups.

------------------------------------------------------------------------
r37297 | guy | 2011-05-19 09:22:21 -0700 (Thu, 19 May 2011) | 32 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

Give some routines used for info levels that appear both in set and get
names beginning with dissect_qspi_, and give some of them names with the
info level structure in them rather than the SNIA CIFS specification
section number.

Have separate routines for SMB_INFO_STANDARD and SMB_INFO_QUERY_EA_SIZE;
SMB_INFO_STANDARD is specified differently in the SNIA CIFS
specification and the MS-CIFS specification, and some captures have the
SNIA CIFS version, with the EA length and some have the MS-CIFS version
without it.  The dissector for SMB_INFO_STANDARD will dissect it if it's
there and not say "this structure is truncated" if it's not there.

Rename dissect_qfi_SMB_FILE_ALTERNATE_NAME_INFO() to
dissect_qfi_SMB_FILE_NAME_INFO(), as it also dissects
SMB_QUERY_FILE_NAME_INFO.

Merge the dissectors for SMB_FILE_ALLOCATION_INFO and
SMB_SET_FILE_ALLOCATION_INFO, and for SMB_FILE_END_OF_FILE_INFO and
SMB_SET_FILE_END_OF_FILE_INFO, as the structures are the same.

Dissect some presumed "passthrough info levels" the same way the
corresponding official SMB infos are dissected.

Expand some comments for info level dissectors to give the MS-CIFS
section number and to give some other details.
 
If an info level is truncated, put in an expert info error.

If we don't know about a given info level, just dissect the body as
"Information level unknown", rather than having it dissected as an
"unknown information" trailer.

------------------------------------------------------------------------
r37296 | tuexen | 2011-05-19 09:11:02 -0700 (Thu, 19 May 2011) | 5 lines
Changed paths:
   M /trunk/gtk/main_statusbar.c

When capturing from multiple interface, indicate this in the main status bar.

This patch is, as all other patches related to capturing from multiple interfaces,
based on work of Irene Ruengeler.

------------------------------------------------------------------------
r37295 | tuexen | 2011-05-19 08:38:44 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/prefs_nameres.c

Fix compilation.

------------------------------------------------------------------------
r37294 | etxrab | 2011-05-19 08:23:19 -0700 (Thu, 19 May 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter_3gpp.c

Fix a typo.
------------------------------------------------------------------------
r37293 | wmeier | 2011-05-19 07:48:05 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/prefs_nameres.c

Don't assign a value to a variable which is then not used: Coverity 1145

------------------------------------------------------------------------
r37292 | etxrab | 2011-05-19 07:41:58 -0700 (Thu, 19 May 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter_3gpp.c

Subdissect 2 3GPP AVP:s that are actually text.
------------------------------------------------------------------------
r37291 | wmeier | 2011-05-19 07:32:14 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/proto_help.c

Don't assign to an unused variable; remove variable definition: Coverity 1144.

------------------------------------------------------------------------
r37290 | wmeier | 2011-05-19 07:11:01 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate_runtime.c

Don't assign a value to a variable which is then never used: Coverity 1160 [UNUSED]

------------------------------------------------------------------------
r37289 | tuexen | 2011-05-19 05:19:03 -0700 (Thu, 19 May 2011) | 3 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture_ui_utils.c
   M /trunk/capture_ui_utils.h
   M /trunk/gtk/main.c

When capturing from multiple interfaces, indicate this in the window
title of the wireshark main window.

------------------------------------------------------------------------
r37288 | tuexen | 2011-05-19 05:14:27 -0700 (Thu, 19 May 2011) | 2 lines
Changed paths:
   M /trunk/tshark.c

Remove unused define.

------------------------------------------------------------------------
r37287 | tuexen | 2011-05-19 04:58:18 -0700 (Thu, 19 May 2011) | 5 lines
Changed paths:
   M /trunk/capture_opts.c

It is not an error (anymore) to specify multiple capture filters.
This was
wireshark -i lo0 -f sctp -i en0 -f udp -k
will work.

------------------------------------------------------------------------
r37286 | guy | 2011-05-19 02:47:03 -0700 (Thu, 19 May 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

The routines declared in packet-smb.h are defined in packet-smb.c;
include packet-smb.h in packet-smb.c so that we check the declarations
against the definitions.

In query ops, info level 2 is Query EA Size, not Query EAs From List. 
In set ops, info level 2 is Set EAs, not Query EA Size.

Expand the constants for the Trans2 subcodes to 16 bits.

The tvb argument to dissect_find_file_unix_info2() is used.

------------------------------------------------------------------------
r37285 | tuexen | 2011-05-18 22:51:52 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Actually use the defaults from the last commit message.
... and switch off debug output.

------------------------------------------------------------------------
r37284 | tuexen | 2011-05-18 22:49:46 -0700 (Wed, 18 May 2011) | 4 lines
Changed paths:
   M /trunk/dumpcap.c

Add a queue and byte limit to the capture queue. Current default
values: 1000 packets, 1 MB. Should be made configurable via
command line options.

------------------------------------------------------------------------
r37283 | jmayer | 2011-05-18 22:46:07 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/gtk/CMakeLists.txt
   M /trunk/gtk/gsm_a_stat.c

Fix warnings about unused variables in UI_MANAGER code.
Move gsm_a_stat.c back to clean dissectors.

------------------------------------------------------------------------
r37282 | jmayer | 2011-05-18 22:44:32 -0700 (Wed, 18 May 2011) | 7 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Fix two warning in case of UIMANAGER:
- Unused variable
- ‘graph_type’ may be used uninitialized

Is the second part of the patch (added inside the else clause)
correct?

------------------------------------------------------------------------
r37281 | jmayer | 2011-05-18 22:08:42 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate_setup.c

Fix another old style function declaration warning

------------------------------------------------------------------------
r37280 | tuexen | 2011-05-18 22:00:28 -0700 (Wed, 18 May 2011) | 4 lines
Changed paths:
   M /trunk/gtk/capture_info_dlg.c

When capturing from multiple interfaces, indicate this in the
capture info dialog.
This is based on wirk from Irene Ruengeler.

------------------------------------------------------------------------
r37279 | tuexen | 2011-05-18 21:56:04 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/capture_info.c

Fix the capture info dialog. Reset the EOF state such that the
number get actually updated.

------------------------------------------------------------------------
r37278 | jmayer | 2011-05-18 21:42:57 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c

Fix an old style function declaration warning.

------------------------------------------------------------------------
r37277 | jmayer | 2011-05-18 21:35:04 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/CMakeLists.txt
   M /trunk/configure.in

Update CMakeLists to follow commit 37219.
Remove a duplicate check in configure.in

------------------------------------------------------------------------
r37276 | tuexen | 2011-05-18 21:30:05 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

Move the debug output for the generated command line arguments to the correct place.

------------------------------------------------------------------------
r37275 | wmeier | 2011-05-18 18:42:49 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dec-dnart.c

For old times' sake: Fix bad dissection of Ethernet Router Hello Messages: Coverity 876 & 877 [UNUSED]

------------------------------------------------------------------------
r37274 | martinm | 2011-05-18 18:21:48 -0700 (Wed, 18 May 2011) | 10 lines
Changed paths:
   M /trunk/epan/proto.c

Add a check that (plain) value_strings that are used in hf items don't have
any conflicting entries.  i.e. lots of value_strings have repeated items, but
for now only warn for cases where the same numeric value appears with a
different string.

Because this will slow down startup and output distracting warnings, it has been
#if 0'd out for now.  As discussed on the dev mailing list, it'd be good to
create a #define for developer/non-release builds so that tests such as this
can regularly be run.

------------------------------------------------------------------------
r37273 | martinm | 2011-05-18 18:09:05 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

Only declare a variable if its going to be used.

------------------------------------------------------------------------
r37272 | martinm | 2011-05-18 18:05:26 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlc-lte.c

Improve AM sequence analysis, check ACK looks sensible compared with latest SN received in opposite direction.

------------------------------------------------------------------------
r37271 | martinm | 2011-05-18 18:03:56 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mac-lte.c

Set subheader root length to 1, so if contentsinvalid will already be correctl length.

------------------------------------------------------------------------
r37269 | wmeier | 2011-05-18 16:24:50 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Don't create 2 unneeded subtrees; Fixes Coverity 879 & 880 [UNUSED];
#include <stdio.h> & <time.h> not needed.

------------------------------------------------------------------------
r37268 | wmeier | 2011-05-18 16:09:18 -0700 (Wed, 18 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dlm3.c

Don't assign to an unused 'proto_item *': Fixes Coverity 883 [UNUSED];
Use correct 'tree' arg in a dissect(...) fcn call: Fixes Coverity 884 [UNUSED];
#include <stdlib.h> not req'd.

------------------------------------------------------------------------
r37267 | wmeier | 2011-05-18 16:01:05 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcswils.c

Create 2 subtrees using the correct 'proto_item *'; Fixes Coverity 900 & 901 [UNUSED];
#inclide <stdlib.h> not req'd.

------------------------------------------------------------------------
r37266 | wmeier | 2011-05-18 15:49:33 -0700 (Wed, 18 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gprs-llc.c

#include <stdlib.h> not req'd;
Reformat hf[] definition;
Misc whitespace cleanup;

------------------------------------------------------------------------
r37265 | wmeier | 2011-05-18 15:01:29 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gprs-llc.c

Add a missing creation of a subtree: Fixes Coverity 907 [UNUSED];
Don't create an unused subtree: Fixes Coverity 908 [UNUSED];

------------------------------------------------------------------------
r37264 | darkjames | 2011-05-18 14:33:05 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/tvbuff.c

Fix tvb_get_bits_buf for LSB.

------------------------------------------------------------------------
r37263 | wmeier | 2011-05-18 14:20:22 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c

(Trivial) Fix a typo; Add spme punctuation in a coment.

------------------------------------------------------------------------
r37262 | morriss | 2011-05-18 14:07:59 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsl.c
   M /trunk/epan/dissectors/packet-uma.c
   M /trunk/epan/dissectors/packet-windows-common.c

Fix some (value) mistakes in value_strings.  Found by Martin's patch on the -dev list.

------------------------------------------------------------------------
r37261 | morriss | 2011-05-18 13:56:03 -0700 (Wed, 18 May 2011) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-drsuapi.c

Fix a couple (value) mistakes in a value_string, taking the values from the IDL
file.  Found by Martin's patch on the -dev list.

Add a comment to answer the question of whether this file is autogenerated by
pointing to the IDL file.

------------------------------------------------------------------------
r37260 | morriss | 2011-05-18 13:26:55 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsmtap.c

Fix a (value) mistake in a value_string.  Found by Martin's patch on the -dev list.

------------------------------------------------------------------------
r37259 | morriss | 2011-05-18 13:06:17 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c
   M /trunk/epan/dissectors/packet-ansi_map.c

Fix a couple (value) mistakes in value_strings.  Found by Martin's patch on the -dev list.

------------------------------------------------------------------------
r37255 | guy | 2011-05-18 12:29:47 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

We don't have the ability to set the capture buffer size on all platforms.

------------------------------------------------------------------------
r37254 | darkjames | 2011-05-18 11:49:33 -0700 (Wed, 18 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

- Optimize tvb_get_bits_buf
- Add lsb0 (read: least significant bit is 0) parameter to tvb_get_bits_buf() 
  (not tested, might be buggy...)

------------------------------------------------------------------------
r37253 | tuexen | 2011-05-18 11:35:57 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/tshark.c

Don't print too many interface names...

------------------------------------------------------------------------
r37250 | tuexen | 2011-05-18 11:04:50 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

Add support for multiple interfaces for the -L option.

------------------------------------------------------------------------
r37249 | tuexen | 2011-05-18 11:03:58 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/tshark.c

Support multiple interfaces when used with -L option.
Show multiple interfaces when capturing from them.

------------------------------------------------------------------------
r37248 | tuexen | 2011-05-18 11:02:30 -0700 (Wed, 18 May 2011) | 10 lines
Changed paths:
   M /trunk/capture_sync.c

Use the interface specific parameter array.

This enables the capturing from mulitple interfaces using 
tshark and wireshark (at the command line).
(tshark -i lo0 -i en0) or (wireshark -k -i lo0 -i en0)
works. You can capture from multiple remote and local
interfaces.

Based on work from Irene Ruengeler.

------------------------------------------------------------------------
r37247 | morriss | 2011-05-18 10:31:48 -0700 (Wed, 18 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c

Finish removing tabs and fix up some indentation.

Add a break after decoding CSData Codec Type.

------------------------------------------------------------------------
r37246 | wmeier | 2011-05-18 10:19:42 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-clv.c

Mark a function arg as _U_

------------------------------------------------------------------------
r37245 | wmeier | 2011-05-18 10:17:08 -0700 (Wed, 18 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_sms.c

Do PROTO_ITEM_SET_GENERATED for two 'proto_item *': Fixes Coverity 914 & 915 [UNUSED]

------------------------------------------------------------------------
r37244 | morriss | 2011-05-18 10:09:55 -0700 (Wed, 18 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_bssmap.c

Add a default (else) case in the default case for cause values to avoid passing
a NULL string pointer to format routines.

While we're there, update the cause list from 48.008 v10.1.0.

------------------------------------------------------------------------
r37243 | wmeier | 2011-05-18 09:52:45 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-clv.c

Don't assign to an unused 'proto_item *': Coverity 939 [UNUSED];
Don't create a subtree which is never used: Coverity 940 [UNUSED].

------------------------------------------------------------------------
r37242 | wmeier | 2011-05-18 09:19:15 -0700 (Wed, 18 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mp4ves.c

Use subtree rather than parent tree to add items; Fixes Coverity 973 & 974;
#include <stdlib.h> not needed;
Minor whitespace cleanup.

------------------------------------------------------------------------
r37241 | cmaynard | 2011-05-18 08:56:46 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Per destination flags is a 1-byte field.  Grab it with tvb_get_guint8(), not
with tvb_get_letohs().  (Bug surfaced while trying out MESH_OVERRIDES.)

------------------------------------------------------------------------
r37240 | alagoutte | 2011-05-18 08:34:34 -0700 (Wed, 18 May 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

From discussion in dev mailing ( http://www.wireshark.org/lists/wireshark-dev/201105/msg00235.html )
* Fix a duplicate value_string in cp_version table
* Fix a typo error (Cersion => Version)
Also fix some whitespaces/4tab-spaces (Need more work...)



------------------------------------------------------------------------
r37239 | morriss | 2011-05-18 08:33:07 -0700 (Wed, 18 May 2011) | 7 lines
Changed paths:
   M /trunk/epan/wslua/wslua_proto.c

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5930 :

with a variant of the patch submitted by Alexander Stein on the -dev list:

Allow FT_FRAMENUMs to be added (as base BASE_NONE).  My change from Alexander's
patch is to disallow BASE_NONE for non-framenum integers.

------------------------------------------------------------------------
r37238 | rbalint | 2011-05-18 06:08:02 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/gtk/main_welcome.c

Refer to "Capture Help" as "Capture Help below" when there are no interfaces
to capture on.

------------------------------------------------------------------------
r37237 | stig | 2011-05-18 01:10:37 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/gtk/menus.c
   M /trunk/gtk/profile_dlg.c
   M /trunk/gtk/profile_dlg.h

Removed "Copy" from the profiles popup menu in favour of a "Create from"
dropdown in the "Create New Profile" window.

------------------------------------------------------------------------
r37236 | guy | 2011-05-18 00:20:45 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/proto.c

You cannot just make the "len" field of a GByteArray larger, if there's
no data to back that length; you can only make it smaller.

------------------------------------------------------------------------
r37235 | guy | 2011-05-17 20:28:26 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/proto.c

Make some more routines not used outside epan/proto.c static.

------------------------------------------------------------------------
r37234 | wmeier | 2011-05-17 18:37:06 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-msrp.c

Convert tabs to "4 spaces" since it appears that tabs are "4 space tabs";

------------------------------------------------------------------------
r37233 | wmeier | 2011-05-17 18:29:25 -0700 (Tue, 17 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-msrp.c

Remove code to generate an unuse sub-tree: Coverity: 976;
Don't assign to an unused variable: Coverity 977;
#include <stdlib.h> & <string.h> not req'd.

------------------------------------------------------------------------
r37232 | wmeier | 2011-05-17 17:59:24 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-quake2.c

Don't assign to unused proto_item *  variables: Coverity 1015 & 1016.

------------------------------------------------------------------------
r37231 | wmeier | 2011-05-17 17:37:35 -0700 (Tue, 17 May 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c

Remove altogether code '#if 0'd in SVN #37229.
Further research shows that registering the dissector
to "tcp.port" and "udp.port" was explicitly removed in SVN #34969
and thus the code to create tcp and udp handles and the associated
dissect_reload_tcp() and dissect_reload_udp() code is no longer
needed.

------------------------------------------------------------------------
r37230 | guy | 2011-05-17 17:29:48 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/oids.c

Get rid of unused function.

------------------------------------------------------------------------
r37229 | wmeier | 2011-05-17 17:07:32 -0700 (Tue, 17 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-reload.c

#if 0 some unused code & vars: Coverity 1018 & 1019;
Add a comment the unused code.

------------------------------------------------------------------------
r37228 | guy | 2011-05-17 16:39:06 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Squelch a narrowing warning.

------------------------------------------------------------------------
r37227 | guy | 2011-05-17 16:37:27 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dfilter/scanner.l

Squelch a narrowing warning.

------------------------------------------------------------------------
r37226 | guy | 2011-05-17 16:36:25 -0700 (Tue, 17 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/geoip_db.c

Make some routines static that aren't used outside the source file in
which they're defined.

------------------------------------------------------------------------
r37225 | wmeier | 2011-05-17 16:36:12 -0700 (Tue, 17 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtps2.c

Add items to subtree rather than tree: Coverity 1026;
Don't assign to an unused variable: Coverity 1027;
#include <stdlib.h> not req'd.

------------------------------------------------------------------------
r37224 | guy | 2011-05-17 16:35:12 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/ringbuffer.c

Fix another old-style function definition.

------------------------------------------------------------------------
r37223 | guy | 2011-05-17 16:33:23 -0700 (Tue, 17 May 2011) | 9 lines
Changed paths:
   M /trunk/epan/oids.c
   M /trunk/gtk/export_object_smb.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/manual_addr_resolv.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/packet_list_store.h
   M /trunk/gtk/proto_help.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/voip_calls.c
   M /trunk/util.c

Make some routines static that aren't used outside the source file in
which they're defined.

Include some header files that declare functions in the source files
that define the functions.

Declare packet_list_get_type() in gtk/packet_list_store.h, as it defines
a macro that uses that function.

------------------------------------------------------------------------
r37219 | guy | 2011-05-17 15:24:26 -0700 (Tue, 17 May 2011) | 11 lines
Changed paths:
   M /trunk/configure.in

Add -Wold-style-definition and -Wdeclaration-after-statement to the list
of warnings we enable by default; we'll move them if they break any
builds in non-fixable ways.

Add -Wmissing-prototypes and -Wmissing-declarations to the list of
things we don't enable by default, and explain why those, and
-Wstrict-prototypes can't be used.

Also explain why we check for clang before checking whether we can
enable -fexcess-precision=fast.

------------------------------------------------------------------------
r37218 | morriss | 2011-05-17 15:21:25 -0700 (Tue, 17 May 2011) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Always add the parameter length field to the tree; only make it visible
if the preference is set.

Add %d to the "not found" string in val_to_str() calls.

Upgrade the "ITU address format seen in ANSI" expert info from NOTE to WARN.

------------------------------------------------------------------------
r37217 | darkjames | 2011-05-17 15:20:14 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/libwireshark.def
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

Add generic tvb_get_bits_buf() which accepts any no_of_bits.

------------------------------------------------------------------------
r37216 | guy | 2011-05-17 15:18:32 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/color_filters.c
   M /trunk/epan/funnel.c
   M /trunk/epan/packet.c
   M /trunk/epan/wslua/init_wslua.c
   M /trunk/file.c
   M /trunk/gtk/prefs_stream.c
   M /trunk/gtk/sctp_stat_dlg.c
   M /trunk/print.c
   M /trunk/u3.c

More eradication of old-style function definitions.

------------------------------------------------------------------------
r37215 | guy | 2011-05-17 15:17:04 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/wiretap/wtap.h

Declare wtap_dump_has_name_resolution().

------------------------------------------------------------------------
r37214 | morriss | 2011-05-17 14:59:58 -0700 (Tue, 17 May 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Add a filterable item for the length of the GT digits in a subtree under the
digits.

Since we now have a subtree from which to hang things, make the generic (called
or calling) digits fields visible under this new subtree (one less hidden item).

Don't use add_string_format() to add the GT digits, let epan format it for us.
Use more descriptive field descriptions for these entries.

------------------------------------------------------------------------
r37212 | guy | 2011-05-17 14:28:07 -0700 (Tue, 17 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/oids.c

This ain't C++; you have to put "void" in as the argument list of
functions that take no arguments, otherwise the function is treated as a
crufty old C function with undeclared arguments.

------------------------------------------------------------------------
r37211 | guy | 2011-05-17 14:26:25 -0700 (Tue, 17 May 2011) | 4 lines
Changed paths:
   M /trunk/file.h
   M /trunk/gtk/export_object.h
   M /trunk/gtk/export_object_smb.c
   M /trunk/gtk/file_import_dlg.c
   M /trunk/gtk/main_welcome.c
   M /trunk/gtk/new_packet_list.c
   M /trunk/gtk/text_import.h

This ain't C++; you have to put "void" in as the argument list of
functions that take no arguments, otherwise the function is treated as a
crufty old C function with undeclared arguments.

------------------------------------------------------------------------
r37210 | gerald | 2011-05-17 14:00:58 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Fix docbook errors.

------------------------------------------------------------------------
r37209 | guy | 2011-05-17 13:04:22 -0700 (Tue, 17 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Don't leave the truncation flag unset in any of the info level
dissectors.

------------------------------------------------------------------------
r37208 | morriss | 2011-05-17 12:59:18 -0700 (Tue, 17 May 2011) | 5 lines
Changed paths:
   M /trunk/configure.in

Fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5875 :

Error out if the user asked us to install dumpcap with a particular group but
we are not building dumpcap.

------------------------------------------------------------------------
r37207 | tuexen | 2011-05-17 12:51:55 -0700 (Tue, 17 May 2011) | 5 lines
Changed paths:
   M /trunk/wiretap/wtap.c

* Don't declare a used arg as unused.
* Really clear the EOF flag. This fixes a bug where
  tshark is not able to do a live capture from a pcapng
  file.

------------------------------------------------------------------------
r37206 | gerald | 2011-05-17 12:26:00 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Update the release notes for 1.7/1.8.

------------------------------------------------------------------------
r37204 | morriss | 2011-05-17 11:58:40 -0700 (Tue, 17 May 2011) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-amqp.c
   M /trunk/epan/dissectors/packet-ansi_637.c
   M /trunk/epan/dissectors/packet-gsm_a_gm.c
   M /trunk/epan/dissectors/packet-hci_h1.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ncp-nmas.c
   M /trunk/epan/dissectors/packet-ncp-sss.c
   M /trunk/epan/dissectors/packet-rpc.c
   M /trunk/epan/dissectors/packet-ses.c
   M /trunk/epan/dissectors/packet-spp.c

As suggested by Chris: use val_to_str_const() instead of match_strval() plus a
NULL-return check.

Use val_to_str_const instead of val_to_str() in a couple places where the string
is constant.

Use val_to_str() instead of blindly passing the return value from match_strval()
into a format routine (to ensure a non-NULL string pointer).  A couple of these
were cases where it could not actually return NULL, but I changed it for
consistency.

Store the return value of match_strval() rather than calling it repeatedly.

------------------------------------------------------------------------
r37203 | morriss | 2011-05-17 11:53:35 -0700 (Tue, 17 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dvbci.c
   M /trunk/epan/dissectors/packet-reload.c
   M /trunk/epan/dissectors/packet-stun.c
   M /trunk/epan/dissectors/packet-xcsl.c

Use val_to_str() instead of blindly passing the return value from match_strval()
into a format routine (to ensure a non-NULL string pointer).

------------------------------------------------------------------------
r37202 | morriss | 2011-05-17 10:40:26 -0700 (Tue, 17 May 2011) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

As suggested by Chris: use val_to_str_const() instead of match_strval() plus a
NULL-return check.

Use val_to_str_const instead of val_to_str() in a couple places where the string
is constant.

Use val_to_str() instead of blindly passing the return value from match_strval()
into a format routine (to ensure a non-NULL string pointer).

------------------------------------------------------------------------
r37201 | morriss | 2011-05-17 09:07:24 -0700 (Tue, 17 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Avoid passing a NULL string pointer to format routines: some libc's (e.g.,
Solaris') will seg-fault on that.

------------------------------------------------------------------------
r37200 | cmaynard | 2011-05-17 07:41:01 -0700 (Tue, 17 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nas_eps.c

All ELEM_MAND_* macros ensure curr_len > 0; no need to check again afterwards.
Resolves Coverity CIDs 381-382.

------------------------------------------------------------------------
r37199 | etxrab | 2011-05-17 01:23:30 -0700 (Tue, 17 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a_gm.c

Use the correct value string and bitmasks.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5928
------------------------------------------------------------------------
r37198 | jmayer | 2011-05-16 21:20:35 -0700 (Mon, 16 May 2011) | 3 lines
Changed paths:
   M /trunk/cmake/modules/FindGTK2.cmake

Update to FindGTK2 from cmake 2.8.3. Add back quartz options which
are not part of the official cmake release.

------------------------------------------------------------------------
r37197 | guy | 2011-05-16 19:29:43 -0700 (Mon, 16 May 2011) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

According to MS-NLMP, the "version" field in the NTLMSSP blobs is
present only if the NTLMSSP_NEGOTIATE_VERSION flag is set in the flags
field, and that appears to be true in at least one capture I've seen.

------------------------------------------------------------------------
r37196 | guy | 2011-05-16 18:38:28 -0700 (Mon, 16 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

Fix cut-and-pasteo.

------------------------------------------------------------------------
r37195 | guy | 2011-05-16 17:08:47 -0700 (Mon, 16 May 2011) | 8 lines
Changed paths:
   M /trunk/dumpcap.c

Dear GLib Developers:

Thank you very much for using "gulong" rather than "gsize" as the
"buffer length" argument to g_snprintf(), the fact that the
corresponding argument to snprintf() is a size_t nonwithstanding. 
Developers building for LLP64 platforms such as Win32 greatly appreciate
this decision.

------------------------------------------------------------------------
r37194 | wmeier | 2011-05-16 16:15:08 -0700 (Mon, 16 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-6lowpan.c

From beth.tridium [At] gmail.com: 6LoWPAN dissector selects wrong byte for HC_UDP Encoding subtree
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5926

------------------------------------------------------------------------
r37192 | guy | 2011-05-16 15:55:22 -0700 (Mon, 16 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Give the UNIX-extension routines used for info levels that appear both
in set and get names beginning with dissect_qspi_.

------------------------------------------------------------------------
r37191 | tuexen | 2011-05-16 14:56:12 -0700 (Mon, 16 May 2011) | 8 lines
Changed paths:
   M /trunk/dumpcap.c

Add support for capturing from multiple interfaces.
This patch is basedon work done by Irene Ruengeler.

This feature is considered experimental at the moment.
However, you need to use the -t command line option
to use the feature. When not providing it, the old
method will be used.

------------------------------------------------------------------------
r37190 | guy | 2011-05-16 14:42:49 -0700 (Mon, 16 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/address_to_str.c
   M /trunk/epan/ftypes/ftype-integer.c

Cast away some warnings about alignment; ep_alloc() guarantees
sufficient alignment for all types of data.

------------------------------------------------------------------------
r37189 | cmaynard | 2011-05-16 13:33:39 -0700 (Mon, 16 May 2011) | 3 lines
Changed paths:
   M /trunk/gtk/packet_list_store.h

A gboolean is a gint; technically, it doesn't fit in a bit field of length 1,
so eliminate the bit field.  Fixes Coverity CIDs 1195-1196.

------------------------------------------------------------------------
r37188 | cmaynard | 2011-05-16 13:02:14 -0700 (Mon, 16 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aim-messaging.c

Fix endian issues, especially w/endian arg to proto_tree_add_item().
Should fix https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5464.

------------------------------------------------------------------------
r37187 | cmaynard | 2011-05-16 12:56:27 -0700 (Mon, 16 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

#include <conio.h> when compiling under Windows with DEBUG_DUMPCAP defined.

------------------------------------------------------------------------
r37183 | guy | 2011-05-16 11:32:35 -0700 (Mon, 16 May 2011) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Fix some comments.

Get rid of null-pointer tests for t2i in the "not null" branch of an
earlier test whether it's null, as those tests are redundant.

Use a switch statement to check the subcommand for Trans2.

If t2i->info_level is -1, it means we don't know the info level, for
whatever reason (e.g., the request was cut short by the snapshot length
before the info level).  Report it as such.

------------------------------------------------------------------------
r37181 | morriss | 2011-05-16 10:02:22 -0700 (Mon, 16 May 2011) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

Avoid passing a NULL string pointer to format routines: some libc's (e.g.,
Solaris') will seg-fault on that.

------------------------------------------------------------------------
r37180 | tuexen | 2011-05-16 09:27:42 -0700 (Mon, 16 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Use correct variable...

------------------------------------------------------------------------
r37179 | tuexen | 2011-05-16 08:25:33 -0700 (Mon, 16 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Fix compilation on windows (hopefully).

------------------------------------------------------------------------
r37178 | tuexen | 2011-05-16 08:19:54 -0700 (Mon, 16 May 2011) | 5 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/dumpcap.c

Make remote capturing settings a per interface thing. You can now
configure that you want to capture on multiple remote interfaces
on mulitple hosts.
Improve some #ifdef mess in dumpcap.

------------------------------------------------------------------------
r37177 | etxrab | 2011-05-16 07:42:34 -0700 (Mon, 16 May 2011) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_rlcmac.h

Remove extra ;
------------------------------------------------------------------------
r37176 | tuexen | 2011-05-16 07:12:35 -0700 (Mon, 16 May 2011) | 6 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/dumpcap.c

Make pcap samping a per interface setting.
Use consistent naming of variables on capture_options.
Make pcap sampling independent of remote capturing, since
it seems to work local pcap devices using winpcap (at
least that is what the documentation says).

------------------------------------------------------------------------
r37175 | etxrab | 2011-05-15 23:28:33 -0700 (Sun, 15 May 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/mcast_stream_dlg.c
   M /trunk/gtk/menus.c
   M /trunk/gtk/rpc_progs.c
   M /trunk/gtk/wlan_stat_dlg.c

More GUIManager stuff.
------------------------------------------------------------------------
r37174 | tuexen | 2011-05-15 17:55:04 -0700 (Sun, 15 May 2011) | 3 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h

* Fix a bug when printing a pointer.
* Remove number_of_ifaces, since ifaces->len can be used instead.

------------------------------------------------------------------------
r37173 | tuexen | 2011-05-15 17:19:47 -0700 (Sun, 15 May 2011) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

Don't use debug output.
BTW: Why does compilation fail with it being enabled?

------------------------------------------------------------------------
r37172 | tuexen | 2011-05-15 16:41:21 -0700 (Sun, 15 May 2011) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Fix compilation on Windows (hopefully).

------------------------------------------------------------------------
r37171 | tuexen | 2011-05-15 15:54:52 -0700 (Sun, 15 May 2011) | 8 lines
Changed paths:
   M /trunk/dumpcap.c

Change internal data structures to store and handle mulitple
pcap devices / pipes to capture from and open and close them.
However, capturing currently happens only on the last specified
interface.
So this does not add user visible functionality except that
some bugs are fixed. For example a crash when capturing on
a pipe and saving in pcapng format.

------------------------------------------------------------------------
r37170 | wmeier | 2011-05-15 14:28:21 -0700 (Sun, 15 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/sctp_graph_dlg.c

Mark a function arg as unused.

------------------------------------------------------------------------
r37169 | wmeier | 2011-05-15 14:12:55 -0700 (Sun, 15 May 2011) | 6 lines
Changed paths:
   M /trunk/gtk/sctp_graph_dlg.c

Replace a number if 'if(...){exit(10);}' by _g_asserts;
Fix an event callback function signature;
Change quit() signal calback function to return void;
#include <stdlib.h> not req'd;
Misc minor changes.

------------------------------------------------------------------------
r37168 | wmeier | 2011-05-15 14:09:04 -0700 (Sun, 15 May 2011) | 3 lines
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Don't assign to an unused variable;
#include <stdlib.h> not req'd

------------------------------------------------------------------------
r37167 | gerald | 2011-05-15 12:25:50 -0700 (Sun, 15 May 2011) | 5 lines
Changed paths:
   M /trunk/packaging/macosx/Scripts/chmodbpf-postinstall.sh

Fix the ChmodBPF startup item permissions. Handling this within
PackageMaker would be a more correct fix. Replacing PackageMaker with
something that fits our development and deployment model would be an
even more correct fix.

------------------------------------------------------------------------
r37166 | wmeier | 2011-05-15 12:01:38 -0700 (Sun, 15 May 2011) | 5 lines
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Replace some 'if(...){exit(10);}' by g_asserts;
Fix some event callback functon signatures;
Change the "destroy" callback function (quit()) to return void: It's not an event callback.
Do some whitespace cleanup.

------------------------------------------------------------------------
r37165 | alagoutte | 2011-05-15 11:48:39 -0700 (Sun, 15 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Add EUI64 display type for Source/Target Link-layer Address (RFC4861)

------------------------------------------------------------------------
r37163 | stig | 2011-05-15 10:54:33 -0700 (Sun, 15 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_player.c

Mark an unused argument.

------------------------------------------------------------------------
r37162 | alagoutte | 2011-05-15 10:47:56 -0700 (Sun, 15 May 2011) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

From Colin O'Flynn via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=5921
Fix for RPL DAO-ACK Processing when DODAG ID present

Reported and fixed by Jakob Ruhe

------------------------------------------------------------------------
r37160 | martinm | 2011-05-15 09:52:05 -0700 (Sun, 15 May 2011) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-umts_fp.c

Add missing trailing 0 to an hf mask value.

------------------------------------------------------------------------
r37159 | wmeier | 2011-05-15 09:51:21 -0700 (Sun, 15 May 2011) | 6 lines
Changed paths:
   M /trunk/gtk/rtp_player.c

Use correct signature for event callback functions;
Use event callback function user_data arg instead of using a property;
Replace an 'if(...) {... exit(10);}' by a g_assert;
Remove several unneeded 'if(...) {... exit(10);}' groups of code;
Do whitespace cleanuip.

------------------------------------------------------------------------
r37157 | etxrab | 2011-05-15 08:09:44 -0700 (Sun, 15 May 2011) | 1 line
Changed paths:
   M /trunk/gtk/menus.c

Remove debug code.
------------------------------------------------------------------------
r37156 | etxrab | 2011-05-15 08:08:47 -0700 (Sun, 15 May 2011) | 1 line
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/menus.c
   M /trunk/gtk/tcp_graph.c

Set menu sensitivity.
------------------------------------------------------------------------
r37155 | gerald | 2011-05-15 08:03:59 -0700 (Sun, 15 May 2011) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers
   M /trunk/services

[Automatic manuf, services and enterprise-numbers update for 2011-05-15]
------------------------------------------------------------------------
r37154 | etxrab | 2011-05-15 07:18:22 -0700 (Sun, 15 May 2011) | 2 lines
Changed paths:
   M /trunk/gtk/gui_stat_menu.h
   M /trunk/gtk/menus.c
   M /trunk/gtk/tcp_graph.c

Add the TCPGraph for UIManager.
Note sensitivity remains to be fixed.
------------------------------------------------------------------------
r37152 | morriss | 2011-05-14 19:48:18 -0700 (Sat, 14 May 2011) | 1 line
Changed paths:
   M /trunk/gtk/main_airpcap_toolbar.c

Whitespace cleanup.
------------------------------------------------------------------------
r37151 | morriss | 2011-05-14 19:45:18 -0700 (Sat, 14 May 2011) | 1 line
Changed paths:
   M /trunk/gtk/airpcap_dlg.c

gtk_combo_box_get_active_text() may return NULL and g_ascii_strcasecmp() complains if its first argument is NULL, so check for the NULL pointer before using it.
------------------------------------------------------------------------
r37150 | morriss | 2011-05-14 19:42:52 -0700 (Sat, 14 May 2011) | 1 line
Changed paths:
   M /trunk/gtk/main.c

main_widgets_rearrange(): only pack the airpcap_tb once (to avoid GTK complaints about the child already having a parent).
------------------------------------------------------------------------
r37148 | gerald | 2011-05-14 13:17:37 -0700 (Sat, 14 May 2011) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/configure.in
   M /trunk/debian/changelog
   M /trunk/docbook/release-notes.xml

1.5.2 → 1.7.0.

------------------------------------------------------------------------
